    API of HTTP Protocol Specification

V3.26
2023-02-28

Cybersecurity Recommendations

Mandatory actions to be taken towards cybersecurity

1. Change Passwords and Use Strong Passwords:

The number one reason systems get "hacked" is due to having weak or default passwords. It is

recommended to change default passwords immediately and choose a strong password whenever

possible. A strong password should be made up of at least 8 characters and a combination of special

characters, numbers, and upper and lower case letters.

2. Update Firmware

As is standard procedure in the tech-industry, we recommend keeping NVR, DVR, and IP camera

firmware up-to-date to ensure the system is current with the latest security patches and fixes.

"Nice to have" recommendations to improve your network security

1. Change Passwords Regularly

Regularly change the credentials to your devices to help ensure that only authorized users are able to

access the system.

2. Change Default HTTP and TCP Ports:

● Change default HTTP and TCP ports for systems. These are the two ports used to communicate and

to view video feeds remotely.

● These ports can be changed to any set of numbers between 1025-65535. Avoiding the default ports

reduces the risk of outsiders being able to guess which ports you are using.

3. Enable HTTPS/SSL:

Set up an SSL Certificate to enable HTTPS. This will encrypt all communication between your devices

and recorder.

4. Enable IP Filter:

Enabling your IP filter will prevent everyone, except those with specified IP addresses, from accessing

the system.

5. Change ONVIF Password:

On older IP Camera firmware, the ONVIF password does not change when you change the system's

credentials. You will need to either update the camera's firmware to the latest revision or manually

change the ONVIF password.

6. Forward Only Ports You Need:

● Only forward the HTTP and TCP ports that you need to use. Do not forward a huge range of numbers

to the device. Do not DMZ the device's IP address.

● You do not need to forward any ports for individual cameras if they are all connected to a recorder on

site; just the NVR is needed.

7. Limit Features of Guest Accounts:

If your system is set up for multiple users, ensure that each user only has rights to features and functions

they need to use to perform their job.

8. UPnP:

Cybersecurity Recommendations I

● UPnP will automatically try to forward ports in your router or modem. Normally this would be a good

thing. However, if your system automatically forwards the ports and you leave the credentials defaulted,

you may end up with unwanted visitors.

● If you manually forwarded the HTTP and TCP ports in your router/modem, this feature should be

turned off regardless. Disabling UPnP is recommended when the function is not used in real

applications.

9. SNMP:

Disable SNMP if you are not using it. If you are using SNMP, you should do so only temporarily, for

tracing and testing purposes only.

10. Multicast:

Multicast is used to share video streams between two recorders. Currently there are no known issues

involving Multicast, but if you are not using this feature, deactivation can enhance your network security.

11. Check the Log:

If you think that someone has gained unauthorized access to your system, you can check the system log.

The system log will show you which IP addresses were used to login to your system and what was

accessed.

12. Physically Lock Down the Device:
    Ideally, you want to prevent any unauthorized physical access to your system. The best way to achieve
    this is to install the recorder in a lockbox, locking server rack, or in a room that is behind a lock and key.

13. Connect IP Cameras to the PoE Ports on the Back of an NVR:

Cameras connected to the PoE ports on the back of an NVR are isolated from the outside world and

cannot be accessed directly.

14. Isolate NVR and IP Camera Network

The network your NVR and IP camera resides on should not be the same network as your public

computer network. This will prevent any visitors or unwanted guests from getting access to the same

network the security system needs in order to function properly.

Cybersecurity Recommendations II

Foreword

Purpose

Welcome to use API of HTTP protocol specification.

Reader

 API software development engineers

 Project managers

 Product managers

Safety Instructions

The following categorized signal words with defined meaning might appear in the Manual.

Signal Words

Meaning

DANGER

Indicates a high potential hazard which, if not avoided, will result in death
or serious injury.

WARNING

Indicates a medium or low potential hazard which, if not avoided, could
result in slight or moderate injury.

CAUTION

Indicates a potential risk which, if not avoided, could result in property
damage, data loss, lower performance, or unpredictable result.

TIPS

NOTE

Provides methods to help you solve a problem or save you time.

Provides additional information as the emphasis and supplement to the
text.

Revision History

No.

Version

Revision Content

V2.40

Based on the old version.

Release Time

August 8, 2018

V2.60

Add find media file with TrafficCar info.

September 12, 2018

V2.61

Add the "16 AI APIs" chapter.

October 24, 2018

V2.62

Add find media files with NonMotor info

November 06, 2018

V2.63

Add close door and access control custom password

November 27, 2018

V2.64

Add access control and video talk settings.

December 12, 2018

V2.65

Add intelligent caps and resource usage info

January 17, 2019

Foreword III

1

2

3

4

5

6

7

8

9

10

11

12

13

14

15

17

18

19

20

21

22

23

24

26

27

30

31

32

33

34

35

36

37

38

No.

Version

Revision Content

Release Time

V2.66

Add people heat map, realtime trace, history trace info

February 13, 2019

V2.67

Add subscribe heat map raw data

V2.68

Add get traffic snap event info record

V2.69

Add export traffic blacklist/redlist record

V2.70

Add privacy masking

April 18, 2019

May 15, 2019

May 20, 2019

May 29, 2019

V2.71

Add get the max and min temperature values

June 3, 2019

V2.72

Add smart motion detection config

V2.73

Add ecrypted download media file

16

V2.74

Adjust Camera Image, Exposure, Backlight, White
Balance, Day-Night, Zoom and Focus, Lighting, Video
in Options config.

June 27, 2019

July 16, 2019

July 25, 2019

V2.75

Add adjust angle and depth field

August 13, 2019

V2.76

Add subscribe vehicles distribution data.

September 10, 2019

V2.77

Add Seek Find Logs

October 18, 2019

V2.78

Add face recognition event handler config

October 30, 2019

V2.79

Add RemoveEx Traffic BlackList/RedList record.

December 9, 2019

V2.80

Add Get GPS Status

V2.81

Add Get Last Event Info

V2.82

Add Radar Adaptor

25

V2.83

Add Radar Adaptor getCapsEx
Delete Radar Adaptor getCaps

V2.84

Add AccessControl getLockStatus

V2.85

Add GlobalDeviceParam SupportGlobalDeviceParam

July 2, 2020

28

V2.86

29

V2.87

Add ObjectPlacementDetection
ObjectRemovalDetection

Add Radar Adaptor addRadarLinkSD, delRadarLinkSD
Add VideoInAnalyse getTemplateRule

December 12, 2019

February 28, 2020

March 23, 2020

May 20, 2020

June 12, 2020

November 5,2020

November 6,2020

November 26,2020

December 3, 2020

January 7, 2021

January 12, 2021

February 23, 2021

V2.88

Add LensManager, resetAngle

V2.89

Add config to Radar Adaptor

V2.90

Add Get Heat Map Info

V2.91

Add export Encryped Log

V2.92

Add controller related

V2.93

Add config to objectdetect DirectionStats

March 1,2021

V2.94

Add Camera to a Specific NVR Channel

V2.95

Add add and remove configure

V2.96

Add Add WorkSuitCompareServer

March 11, 2021

March 26, 2021

April 22,2021

Foreword IV

44

45

46

47

48

49

50

51

52

54

55

56

57

58

January 11,2022

January 21, 2022

February 16, 2022

February 17, 2022

April 20, 2022

June 1, 2022

June 29, 2022

August 3, 2022

No.

Version

Revision Content

39

V2.97

Add VideoAnalyseRule head. Type add
ObjectPlacement and ObjectRemoval

40

41

V2.98

Modify WorkSuitCompareServer

V2.99

Modify WorkSuitCompareServer doFind

42

V3.00

43

V3.01

Add trafficFlowStat stopFind, trafficFlowStat doFind and
trafficFlowStat startFind

Add configManager setConfig
IntelliSchemeTour.Enable

Release Time

April 25,2021

May 11,2021

May 11,2021

May 27,2021

June 3,2021

V3.02

Add configManager getConfig IntelliSchemeTour

June 11,2021

V3.03

Add method cancel upgrade

V3.04

doFindHistoryByPic Add Time

June 21, 2021

Sept 29, 2021

V3.05

Add Cloud Upgrade, add find smd data

December 22, 2021

V3.06

Add OpenAI

V3.07

Add correctScene api

V3.08

Add SSHD config

V3.09

Add Water Data Analyse

V3.10

Add Http Uploading api

53

V3.11

Add PassedNumber, EnteredDupNumber, … to People
Count Information.

V3.12

Add method export account file

V3.13

Add method query data flux

V3.14

Add method about SCADA

August 23, 2022

V3.15

Add method get gyroscope info

September 6, 2022

V3.16

Add Vehicle Manager

October 11, 2022

59

V3.17

Add method getCompleteMachineVersion

October 17, 2022

60

V3.18

Add Tcp Test

November 1, 2022

61

V3.19

Modify method WorkSuitCompareServer.doFind,
getFlux, queryHistoryFlux and SCADA.doFind

December 7,2022

62

V3.20

Add method AudioAnalyseManager.setClassConfig,
AudioAnalyseManager.getClassConfig,
AudioAnalyseManager.setConfig and
AudioAnalyseManager.getConfig.

December 8,2022

63

V3.21

Add method getViewRangeStatus

December 19, 2022

Foreword V

No.

Version

Revision Content

64

V3.22

Add method Get Device Info,
Add method Get Camera States
Add method Get Camera Recording State

Release Time

January 3, 2023

65

V3.23

Add FaceAnalysis Report Data Upload

January 5,2023

66

V3.24

Add Play the Specified Audio File

February 6, 2023

67

V3.25

Modify State of Getting the Analysis Configurations of
the Specified Audio Channel

February 21, 2023

68

V3.26

Add devVideoAnalyse.disableScene,
devVideoAnalyse.enableScene,
devVideoAnalyse.getSceneList

February 28, 2023

Privacy Protection Notice

As the device user or data controller, you might collect personal data of other such as face,
fingerprints, car plate number, Email address, phone number, GPS and so on. You need to be in
compliance with the local privacy protection laws and regulations to protect the legitimate rights and
interests of other people by implementing measures include but not limited to: providing clear and
visible identification to inform data subject the existence of surveillance area and providing related
contact.

About the Manual



The Manual is for reference only. If there is inconsistency between the Manual and the actual
product, the actual product shall prevail.

 We are not liable for any loss caused by the operations that do not comply with the Manual.



The Manual would be updated according to the latest laws and regulations of related regions.
For detailed information, see the paper manual, CD-ROM, QR code or our official website. If
there is inconsistency between paper manual and the electronic version, the electronic version
shall prevail.

 All the designs and software are subject to change without prior written notice. The product
updates might cause some differences between the actual product and the Manual. Please
contact the customer service for the latest program and supplementary documentation.



There still might be deviation in technical data, functions and operations description, or errors in
print. If there is any doubt or dispute, please refer to our final explanation.

 Upgrade the reader software or try other mainstream reader software if the Manual (in PDF

format) cannot be opened.

 All trademarks, registered trademarks and the company names in the Manual are the properties

of their respective owners.

 Please visit our website, contact the supplier or customer service if there is any problem

occurred when using the device.

Foreword VI



If there is any uncertainty or controversy, please refer to our final explanation.

Foreword VII

Table of Contents

Cybersecurity Recommendations ........................................................................................................... I
Foreword .................................................................................................................................................. III
Table of Contents .................................................................................................................................. VIII
1 Overview ............................................................................................................................................... 23
2 References......................................................................................................................................... 24
3 Definitions ......................................................................................................................................... 25
3.1 Abbreviations ............................................................................................................................... 25
3.2 Syntax Convention ...................................................................................................................... 25
3.3 HTTP API Protocol Format ......................................................................................................... 25
3.3.1 key=value format .............................................................................................................. 26
3.3.2 JSON format ..................................................................................................................... 27
3.4 Authentication .............................................................................................................................. 30
3.5 Conventions ................................................................................................................................ 31
3.5.1 Channels ........................................................................................................................... 31
4 General APIs ...................................................................................................................................... 32
4.1 APIs of RTSP .............................................................................................................................. 32
4.1.1 Get Real-Time Stream ...................................................................................................... 32
4.1.2 Get Playback Stream ........................................................................................................ 34
4.1.3 Get File Stream ................................................................................................................. 34
4.1.4 Get MJPG Stream ............................................................................................................ 34
4.2 Configure Manager ..................................................................................................................... 35
4.2.1 Get and Set Configure ...................................................................................................... 36
4.2.2 Add and Remove Configure ............................................................................................. 37
4.2.3 Restore the Config ............................................................................................................ 38
4.2.4 Restore except the Config ................................................................................................ 38
4.3 Audio ........................................................................................................................................... 39
4.3.1 Get Audio Input Channel Numbers ................................................................................... 39
4.3.2 Get Audio Output Channel Numbers ................................................................................ 39
4.3.3 Post Audio Stream ............................................................................................................ 39
4.3.4 Get Audio Stream ............................................................................................................. 41
4.3.5 [Config] Volume Control .................................................................................................... 42
4.4 Snapshot ..................................................................................................................................... 42
4.4.1 [Config] Snap .................................................................................................................... 66
4.4.2 Get a Snapshot ................................................................................................................. 68
4.4.3 Subscribe to Snapshot ..................................................................................................... 68
4.5 Video Attributes ........................................................................................................................... 71
4.5.1 Get Max Extra Stream Numbers ...................................................................................... 71
4.5.2 Get Encode Capability ...................................................................................................... 71
4.5.3 Get Encode Config Capability .......................................................................................... 72
4.5.4 [Config] Encode of Media ................................................................................................. 76
4.5.5 [Config] Encode of Region Interested .............................................................................. 81
4.5.6 [Config] Channel Title ....................................................................................................... 82

Table of Contents VIII

4.5.7 Get Video Input Channels Device Supported .................................................................. 83
4.5.8 Get Video Output Channels Device Supported ................................................................ 83
4.5.9 Get Max Remote Input Channels ..................................................................................... 83
4.5.10 [Config] Video Standard ................................................................................................. 83
4.5.11 [Config] Video Widget ..................................................................................................... 84
4.5.12 Get Video Input Capability .............................................................................................. 87
4.5.13 Get Coordinates of Current Window .............................................................................. 90
4.5.14 Set Coordinates of Current Window ............................................................................... 91
4.5.15 [Config] Video Out .......................................................................................................... 91
4.5.16 [Config] Smart Encode ................................................................................................... 92
4.5.17 Get Decoder Caps .......................................................................................................... 93
4.5.18 [Config] PrivacyMasking ................................................................................................. 94
4.5.19 Get Privacy Masking ....................................................................................................... 96
4.5.20 Set Privacy Masking ....................................................................................................... 97
4.5.21 Goto Privacy Masking ..................................................................................................... 98
4.5.22 Delete Privacy Masking .................................................................................................. 98
4.5.23 Clear Privacy Masking .................................................................................................... 99
4.5.24 Get Privacy Masking Rect .............................................................................................. 99
4.5.25 [Config] Motion Detection Settings ................................................................................. 99
4.5.26 [Config] LAEConfig ....................................................................................................... 105
4.5.27 Enable/Disable all privacy masking covers .................................................................. 107
4.5.28 Get enable/disable state of all privacy masking covers ............................................... 107
4.6 System ...................................................................................................................................... 108
4.6.1 [Config] General .............................................................................................................. 108
4.6.2 Get Current Time ............................................................................................................ 109
4.6.3 Set Current Time ............................................................................................................. 109
4.6.4 [Config] Locales .............................................................................................................. 109
4.6.5 [Config] Holiday Management ......................................................................................... 111
4.6.6 Get Language Capability .................................................................................................112
4.6.7 [Config] Language ...........................................................................................................112
4.6.8 Get Device Type ..............................................................................................................113
4.6.9 Get Hardware Version .....................................................................................................113
4.6.10 Get Serial Number of Device .........................................................................................114
4.6.11 Get Machine Name ........................................................................................................114
4.6.12 Get System Information1 ...............................................................................................114
4.6.13 Get System Information2 ...............................................................................................115
4.6.14 Get Vendor Information .................................................................................................116
4.6.15 Get Software Information ...............................................................................................116
4.6.16 Get Version of Onvif ......................................................................................................117
4.6.17 Get Version of HTTP API ...............................................................................................117
4.6.18 Get Device Class ...........................................................................................................117
4.6.19 [Config] Auto Maintain ...................................................................................................117
4.6.20 Reboot ...........................................................................................................................119
4.6.21 Shutdown .......................................................................................................................119
4.6.22 Factory Reset ................................................................................................................119
4.6.23 Get Tracing Code of Device ......................................................................................... 120
4.6.24 Add Camera to Specified Channel ............................................................................... 120

Table of Contents IX

4.6.25 Acquiring All Available Resources ................................................................................ 121
4.6.26 Subscribing for Device Online/Offline Status ............................................................... 128
4.7 User management .................................................................................................................... 129
4.7.1 Get Information of a Particular User ............................................................................... 133
4.7.2 Get Information of All Users ............................................................................................ 133
4.7.3 Get Information of All Active Users ................................................................................. 134
4.7.4 Get Information of a Particular Group ............................................................................ 134
4.7.5 Get Information of All Groups ......................................................................................... 134
4.7.6 Add a New User .............................................................................................................. 135
4.7.7 Delete a User .................................................................................................................. 135
4.7.8 Modify User Information ................................................................................................. 136
4.7.9 Modify User's Password ................................................................................................. 136
4.7.10 Manager Modify Common User's Password ................................................................ 136
4.7.11 [Config] Set User Login Authentication Policy .............................................................. 137
4.7.12 Export all the user info .................................................................................................. 137
4.8 Network ..................................................................................................................................... 138
4.8.1 Get Network Interfaces ................................................................................................... 138
4.8.2 Get Client Access Filter .................................................................................................. 138
4.8.3 [Config] Network Basic Config ........................................................................................ 139
4.8.4 [Config] PPPoE ............................................................................................................... 140
4.8.5 [Config] DDNS ................................................................................................................ 141
4.8.6 [Config] Email ................................................................................................................. 144
4.8.7 [Config] WLan ................................................................................................................. 145
4.8.8 Scan Wlan Devices......................................................................................................... 146
4.8.9 [Config] UPnP ................................................................................................................. 147
4.8.10 Get UPnP Status .......................................................................................................... 148
4.8.11 [Config] NTP.................................................................................................................. 148
4.8.12 [Config] RTSP ............................................................................................................... 149
4.8.13 [Config] Alarm Server ................................................................................................... 150
4.8.14 [Config] Onvif Service Authorization ............................................................................. 151
4.8.15 [Config] SSHD Config ................................................................................................... 151
4.8.16 [Config] Cellular Network Traffic Packages .................................................................. 152
4.8.17 Obtaining the Traffic Information of Current Month ...................................................... 153
4.8.18 Searching for History Traffic Statistics According to Specified Conditions .................. 155
4.9 Event ......................................................................................................................................... 157
4.9.1 [DataType] Event Handler .............................................................................................. 157
4.9.2 [Config] Alarm Event ....................................................................................................... 161
4.9.3 [Config] Alarm Out .......................................................................................................... 162
4.9.4 Get Alarm Input Channels .............................................................................................. 163
4.9.5 Get Alarm Output Channels ............................................................................................ 163
4.9.6 Get States of Alarm Input Channels ............................................................................... 163
4.9.7 Get States of Alarm Output Channels ............................................................................ 163
4.9.8 [Config] Video Blind Event .............................................................................................. 164
4.9.9 [Config] Video Loss Event .............................................................................................. 165
4.9.10 [Config] Login Failure Event ......................................................................................... 165
4.9.11 [Config] Storage Not Exist Event .................................................................................. 166
4.9.12 [Config] Storage Access Failure Event ......................................................................... 167

Table of Contents X

4.9.13 [Config] Storage Low Space Event .............................................................................. 168
4.9.14 [Config] Net Abort Event ............................................................................................... 169
4.9.15 [Config] IP Conflict Event .............................................................................................. 169
4.9.16 Get Channels Event Happened .................................................................................... 170
4.9.17 Subscribe to Event Message ........................................................................................ 171
4.9.18 Get Capability of Event Management ........................................................................... 173
4.9.19 [Config] Net Alarm Event .............................................................................................. 174
4.9.20 Set Net Alarm State ...................................................................................................... 176
4.9.21 Get Supported Events .................................................................................................. 176
4.10 Record ..................................................................................................................................... 177
4.10.1 Get Capability of Recording.......................................................................................... 177
4.10.2 [Config] Record Config ................................................................................................. 177
4.10.3 [Config] Record Mode ................................................................................................... 178
4.10.4 [Config] Media Global ................................................................................................... 179
4.10.5 Find Media Files ........................................................................................................... 180
4.10.6 Find media files with FaceDetection info ...................................................................... 183
4.10.7 Find media files with FaceRecognition info .................................................................. 186
4.10.8 Find media files with HumanTrait info .......................................................................... 189
4.10.9 Find media files with TrafficCar info ............................................................................. 193
4.10.10 Find media files with IVS info ..................................................................................... 196
4.10.11 Find media files with NonMotor info ........................................................................... 198
4.10.12 Download Media File with the File Name ................................................................... 201
4.10.13 Download Media File between Times......................................................................... 207
4.10.14 Encrypted Download Media File with the File Name ................................................. 208
4.11 Log ........................................................................................................................................... 208
4.11.1 Find Logs ...................................................................................................................... 209
4.11.2 Clear All the Logs .......................................................................................................... 210
4.11.3 Backup Logs ..................................................................................................................211
4.11.4 Seek Find Logs ..............................................................................................................211
4.11.5 Export Encryped Log .................................................................................................... 212
4.11.6 [Config] Serial Port Log Redirection ............................................................................. 212
4.12 Upgrader ................................................................................................................................. 213
4.12.1 Strat to Upgrade ........................................................................................................... 213
4.12.2 Get Upgrade State ........................................................................................................ 214
4.12.3 Set upgrader url ............................................................................................................ 214
4.12.4 Cancel Upgrade ............................................................................................................ 215
4.12.5 Checking Cloud Update Version .................................................................................. 215
4.12.6 Performing Online Update ............................................................................................ 217
4.12.7 Canceling Online Update .............................................................................................. 218
4.13 Http Uploading ........................................................................................................................ 219
4.13.1 [Config] Active Image and Event Uploading ................................................................. 219
4.13.2 Active Image and Event Uploading .............................................................................. 220
4.13.3 [Config] Active Event Uploading ................................................................................... 221
4.13.4 Active Event Uploading ................................................................................................. 222
4.13.5 [Config] Active Report Data Uploading ......................................................................... 223
4.13.6 People Counting Report Data Uploading ..................................................................... 224
4.13.7 Video Structuring Report Data Upload ......................................................................... 227

Table of Contents XI

4.13.8 People Flow Heat Map Report Data Upload ................................................................ 228
4.13.9 ANPR Report Data Upload ........................................................................................... 229
4.13.10 Crowd Distribution Report Data upload ...................................................................... 230
4.13.11 Vehicle Density Report Data Upload .......................................................................... 231
5 Camera APIs ...................................................................................................................................... 235
5.1 Image ........................................................................................................................................ 235
5.1.1 [Config] Brightness, Contrast and Saturation ................................................................. 235
5.1.2 [Config] Sharpness ......................................................................................................... 236
5.1.3 [Config] Flip, Mirror and Rotate90 .................................................................................. 237
5.2 Exposure ................................................................................................................................... 238
5.2.1 [Config] Exposure Config ................................................................................................ 238
5.3 Backlight .................................................................................................................................... 240
5.3.1 [Config] Backlight Config ................................................................................................ 240
5.4 White Balance ........................................................................................................................... 241
5.4.1 [Config] White Balance Config ....................................................................................... 241
5.5 Day-Night .................................................................................................................................. 242
5.5.1 [Config] Day-Night Config ............................................................................................... 242
5.6 Zoom and Focus ....................................................................................................................... 243
5.6.1 Adjust Focus ................................................................................................................... 243
5.6.2 Adjust Focus Continuously ............................................................................................. 244
5.6.3 Auto Focus ...................................................................................................................... 244
5.6.4 Get Focus Status ............................................................................................................ 245
5.6.5 [Config] Zoom Config ...................................................................................................... 245
5.6.6 [Config] Focus Config ..................................................................................................... 246
5.7 Lighting ...................................................................................................................................... 247
5.7.1 [Config] Lighting Config .................................................................................................. 247
5.8 Video in Options ........................................................................................................................ 249
5.8.1 Change binocular camera's splice mode ....................................................................... 249
5.8.2 [Config] Video in Options Config .................................................................................... 250
6 Storage APIs .................................................................................................................................... 259
6.1 Storage Devices ........................................................................................................................ 259
6.1.1 Get Hard Disk Information .............................................................................................. 259
6.1.2 Get the Name of All Storage Devices ............................................................................. 260
6.1.3 Get Storage Device Information ..................................................................................... 260
6.1.4 Get Storage Capability ................................................................................................... 261
6.1.5 Format Camera SD-Card ............................................................................................... 261
6.1.6 [Config] Hard Disk Recording Type ................................................................................ 262
6.2 NAS ........................................................................................................................................... 262
6.2.1 [Config] NAS Information ................................................................................................ 271
6.3 Storage Point ............................................................................................................................ 272
6.3.1 [Config] Record Storage Point ........................................................................................ 272
6.3.2 [Config] Storage Group ................................................................................................... 274
6.4 SDEncrypt ................................................................................................................................. 275
6.4.1 Encrypt SD Card ............................................................................................................. 275
6.4.2 Decrypt SD Card ............................................................................................................. 276
6.4.3 Clear SD Card Password ............................................................................................... 276
6.4.4 Modify SD Card Password ............................................................................................. 276

Table of Contents XII

6.4.5 Get SD Card Operate Error Policy ................................................................................. 277
6.4.6 [Config] Storage Health Alarm Settings .......................................................................... 277
7 Display APIs ..................................................................................................................................... 279
7.1 GUI ............................................................................................................................................ 279
7.1.1 [Config] GUISet ............................................................................................................... 279
7.2 Split Screen ............................................................................................................................... 280
7.2.1 Split Screen Mode .......................................................................................................... 280
7.3 Moniter Tour .............................................................................................................................. 281
7.3.1 [Config] Moniter Tour ...................................................................................................... 281
7.3.2 Enable Tour ..................................................................................................................... 282
7.3.3 [Config] Monitor Collection ............................................................................................. 282
8 Comm APIs ....................................................................................................................................... 284
8.1 PTZ ............................................................................................................................................ 284
8.1.1 [Config] PTZ Config ........................................................................................................ 284
8.1.2 Get PTZ Protocol List ..................................................................................................... 285
8.1.3 Get PTZ Capability of Current Protocol .......................................................................... 285
8.1.4 Get PTZ Status ............................................................................................................... 287
8.1.5 PTZ Control .................................................................................................................... 287
8.1.6 Preset .............................................................................................................................. 292
8.1.7 Tour ................................................................................................................................. 294
8.1.8 Scan ................................................................................................................................ 296
8.1.9 Pattern ............................................................................................................................ 298
8.1.10 Pan ................................................................................................................................ 299
8.1.11 [Config] PTZ Auto Movement ........................................................................................ 300
8.1.12 PTZ Restart .................................................................................................................. 301
8.1.13 PTZ Reset ..................................................................................................................... 301
8.1.14 OSD Menu .................................................................................................................... 302
8.1.15 [Config] Set up electronic PTZ ..................................................................................... 303
8.2 Wiper ......................................................................................................................................... 305
8.2.1 Move Continuously ......................................................................................................... 306
8.2.2 Stop Move ....................................................................................................................... 307
8.2.3 Move Once...................................................................................................................... 307
8.3 Illuminator .................................................................................................................................. 307
8.3.1 [Config] Visible-light Illuminator ...................................................................................... 307
8.4 Flashlight ................................................................................................................................... 308
8.4.1 [Config] Flashlight Config ............................................................................................... 308
8.5 Coaxial Control IO ..................................................................................................................... 309
8.5.1 Control White Light or Speaker ...................................................................................... 309
8.5.2 Get White Light and Speaker Status .............................................................................. 310
8.6 Pir Alarm .................................................................................................................................... 310
8.6.1 [Config] Pir Parameter .................................................................................................... 310
8.7 SCADA ...................................................................................................................................... 314
8.7.1 Searching for SCADA Attributes ..................................................................................... 314
8.7.2 Configuring SCADA Attributes ........................................................................................ 316
8.7.3 Obtaining Real-time Data of Monitoring Points .............................................................. 318
8.7.4 Configuring Monitoring Points ........................................................................................ 319
8.7.5 Starting Searching for Historical Data ............................................................................ 320

Table of Contents XIII

8.7.6 Obtaining Historical Data ................................................................................................ 321
8.7.7 Stopping Searching for Historical Data .......................................................................... 323
8.7.8 Obtaining IDs of External Devices Connected to the Host ............................................ 323
8.8 Gyro ........................................................................................................................................... 324
8.8.1 get gyroscope info .......................................................................................................... 324
9 Video Analyse APIs ........................................................................................................................... 326
9.1 Video Analyse Event ................................................................................................................. 326
9.1.1 [Event] LeftDetection ...................................................................................................... 326
9.1.2 [Event] TakenAwayDetection .......................................................................................... 326
9.1.3 [Event] WanderDetection ................................................................................................ 327
9.1.4 [Event] StayDetection ..................................................................................................... 327
9.1.5 [Event] HumanTrait ......................................................................................................... 328
9.1.6 [Event] CrossLineDetection ............................................................................................ 330
9.1.7 [Event] CrossRegionDetection ....................................................................................... 331
9.1.8 [Event] QueueStayDetection .......................................................................................... 332
9.1.9 [Event] QueueNumDetection .......................................................................................... 333
9.2 FaceRecognitionServer ............................................................................................................ 334
9.2.1 Create Face Group ......................................................................................................... 334
9.2.2 Modify Face Group ......................................................................................................... 334
9.2.3 Delete Face Group ......................................................................................................... 334
9.2.4 Deploy Face Group......................................................................................................... 335
9.2.5 Find Face Group ............................................................................................................. 337
9.2.6 Re-Abstract Feature By Group ....................................................................................... 339
9.2.7 Add Person ..................................................................................................................... 340
9.2.8 Modify Person ................................................................................................................. 340
9.2.9 Delete Person ................................................................................................................. 341
9.2.10 Find Person .................................................................................................................. 342
9.2.11 Re-Abstract Features By Person .................................................................................. 344
9.2.12 [Config] Face Recognition AlarmOut Setting ................................................................ 345
9.2.13 Find Person by Picture ................................................................................................. 347
9.2.14 Find History Person by Picture ..................................................................................... 350
9.2.15 [Event] FaceDetection .................................................................................................. 354
9.2.16 [Event] FaceRecognition .............................................................................................. 355
9.2.17 [Event] FaceFeatureAbstract ........................................................................................ 357
9.2.18 [Config] Face Recognition Event Handler Setting ........................................................ 358
9.2.19 [Config] Face-ID Recognition Threshold ...................................................................... 360
9.2.20 Export Face Database .................................................................................................. 360
9.2.21 Importing Face Database ............................................................................................. 361
9.3 People Counting........................................................................................................................ 362
9.3.1 Get Summary .................................................................................................................. 362
9.3.2 Query the Count of People ............................................................................................. 364
9.3.3 Clear the People Count Information ............................................................................... 367
9.3.4 Subscribe the People Count Information ....................................................................... 367
9.3.5 Clear statistics in time section ........................................................................................ 370
9.3.6 [Config] Video Widget Number Status ............................................................................ 370
9.3.7 [Event] NumberStat ........................................................................................................ 371
9.3.8 [Event] ManNumDetection .............................................................................................. 372

Table of Contents XIV

9.3.9 [Event] CrowdDetection .................................................................................................. 372
9.4 Heat Map ................................................................................................................................... 373
9.4.1 Get Heat Map Information .............................................................................................. 373
9.4.2 Get People Heat Map Information .................................................................................. 374
9.4.3 Subscribe People Realtime Trace Information ............................................................... 375
9.4.4 Get People Histroy Trace Information ............................................................................ 377
9.4.5 Subscribe Heat Map Raw Data ...................................................................................... 378
9.5 Crowd Distribute Map ............................................................................................................... 379
9.5.1 Get Channel Caps .......................................................................................................... 379
9.5.2 Subscribe to Realtime Crowd Stat ................................................................................. 379
9.5.3 Get Current Crowd Stat .................................................................................................. 381
9.6 Video Analyse ........................................................................................................................... 381
9.6.1 Get Video Analyse Capability ......................................................................................... 381
9.6.2 [Config] Video Analyse Global ........................................................................................ 382
9.6.3 [Config] Video Analyse Rule ........................................................................................... 384
9.6.4 Get Last Event Info ......................................................................................................... 388
9.6.5 [Config] GlobalDeviceParam .......................................................................................... 389
9.6.6 Get Template Rule .......................................................................................................... 389
9.6.7 [Config] IntelliSchemeTourEnableSetting ....................................................................... 391
9.6.8 [Config] Intelligent Tour Plan ........................................................................................... 391
9.6.9 Export Intelligent Diagnosis, Allowlist, and Blocklist Information ................................... 397
9.6.10 Import Intelligent O&M, Allowlist, and Blocklist Information ......................................... 397
9.6.11 Get Intelligent Capability ............................................................................................... 399
9.6.12 Subscribe Resource Usage Info ................................................................................... 400
9.6.13 Export Encrypted Files ................................................................................................. 401
9.7 WorkSuitCompareServer .......................................................................................................... 402
9.7.1 Add Compliance Library ................................................................................................. 405
9.7.2 Delete Compliance Library ............................................................................................. 406
9.7.3 Find Compliance Library ................................................................................................. 407
9.7.4 Get Compliance Library Arming Information of Channels .............................................. 408
9.7.5 Modify Compliance Group Information ........................................................................... 409
9.7.6 Deploy Compliance Library ............................................................................................ 410
9.7.7 Find Workwear Information in Compliance Library ........................................................ 410
9.7.8 Get Find Workwear Information Result ...........................................................................411
9.7.9 Stop Find Workwear Information .................................................................................... 414
9.7.10 Delete Workwear Information ....................................................................................... 414
9.7.11 Re-extracting Features by Workwear ........................................................................... 415
9.7.12 Stop Re-extracting Workwear Features ....................................................................... 416
9.8 Smart Motion Detection ............................................................................................................ 416
9.8.1 [Config] SmartMotionDetect ........................................................................................... 416
9.8.2 Start SMD Data Search .................................................................................................. 417
9.8.3 Get SMD Data Search Result......................................................................................... 418
9.8.4 End SMD Data Search ................................................................................................... 419
10 Intelligent Traffic APIs ..................................................................................................................... 440
10.1 Intelligent Traffic Event ............................................................................................................ 440
10.1.1 [Event] TrafficJunction .................................................................................................. 440
10.1.2 [Event] TrafficRetrograde .............................................................................................. 442

Table of Contents XV

10.1.3 [Event] TrafficJam ......................................................................................................... 442
10.1.4 [Event] TrafficUnderSpeed ........................................................................................... 443
10.1.5 [Event] TrafficOverSpeed ............................................................................................. 443
10.1.6 [Event] TrafficPedestrain .............................................................................................. 444
10.1.7 [Event] TrafficParking .................................................................................................... 445
10.2 Traffic Flow .............................................................................................................................. 445
10.2.1 [Event] TrafficFlowStat .................................................................................................. 445
10.2.2 Find Traffic Flow History ............................................................................................... 446
10.2.3 Start Traffic Statistics Search ....................................................................................... 447
10.2.4 Get Traffic Statistics ...................................................................................................... 448
10.2.5 End Traffic Statistics Search ......................................................................................... 449
10.3 Traffic Record .......................................................................................................................... 450
10.3.1 Insert Traffic BlockList/AllowList Record ...................................................................... 450
10.3.2 Update Traffic BlockList/AllowList Record .................................................................... 451
10.3.3 Remove Traffic BlockList/AllowList Record .................................................................. 451
10.3.4 Find Traffic BlockList/AllowList Record ........................................................................ 452
10.3.5 RemoveEx Traffic BlockList/AllowList Record .............................................................. 453
10.3.6 Import Traffic BlockList/AllowList .................................................................................. 453
10.3.7 Export Traffic BlockList/AllowList .................................................................................. 454
10.3.8 Export Traffic Flow ........................................................................................................ 456
10.3.9 Export Traffic Snap Event Info ...................................................................................... 457
10.4 Traffic Snap Operation ............................................................................................................ 459
10.4.1 Open Strobe ................................................................................................................. 459
10.4.2 Open/Close Unlicensed Vehicle Detection ................................................................... 459
10.4.3 Manual Snap ................................................................................................................. 459
10.5 Traffic Parking ......................................................................................................................... 460
10.5.1 Get the Specific Parking Space Status ........................................................................ 460
10.5.2 Get All Status of Parking Spaces ................................................................................. 461
10.5.3 [Config] Parking Space Light State .............................................................................. 461
10.5.4 Set Order State ............................................................................................................. 463
10.5.5 Set Light State .............................................................................................................. 463
10.5.6 [Config] Parking Space Access Filter Setting ............................................................... 464
10.5.7 Set OverLine State ....................................................................................................... 465
10.6 Vehicles Distribution ................................................................................................................ 465
10.6.1 Subscribe Vehicles Distribution Data ........................................................................... 465
11 Thermography and Radiometry APIs ............................................................................................ 481
11.1 Thermography Manager .......................................................................................................... 481
11.1.1 Get Capability of Thermography ................................................................................... 481
11.1.2 [Config] Thermography Options .................................................................................... 482
11.1.3 Get ExternSystem Information ...................................................................................... 484
11.1.4 Get Information of Preset Mode.................................................................................... 484
11.1.5 Get Optimized Region Information ............................................................................... 485
11.1.6 Enable Shutter .............................................................................................................. 485
11.1.7 Fix Focus ....................................................................................................................... 486
11.1.8 Do Flat Field Correction ................................................................................................ 486
11.2 Radiometry .............................................................................................................................. 486
11.2.1 Get Capability of Radiometry ........................................................................................ 486

Table of Contents XVI

11.2.2 [Config] Heat Image Thermometry ............................................................................... 487
11.2.3 [Config] Thermometry Rule ........................................................................................... 489
11.2.4 [Config] Heat Image Temper Event............................................................................... 491
11.2.5 Get Temperature of Particular Point ............................................................................. 492
11.2.6 Get Temperature of Particular Condition ...................................................................... 493
11.2.7 Find Temperature Information ....................................................................................... 493
11.2.8 Subscribe Temperature Information.............................................................................. 495
11.2.9 Subscribe Radiometry Data .......................................................................................... 496
11.2.10 Fetch Radiometry Data ............................................................................................... 498
11.2.11 [Config] Get FireWarning Config ................................................................................. 498
11.2.12 [Config] Set FireWarning Config ................................................................................. 499
11.2.13 [Config] Get FireWarningMode Config ....................................................................... 500
11.2.14 [Config] Set FireWarningMode Config ........................................................................ 500
11.2.15 Get Current Hot Cold Spot .......................................................................................... 501
11.2.16 [Config] Heat Image Temper PreAlarm Event ............................................................ 501
11.2.17 Get Heat Map Info ....................................................................................................... 502
11.3 TemperCustom ........................................................................................................................ 504
11.3.1 Set Environment Temperature ...................................................................................... 504
12 Access Control APIs ..................................................................................................................... 505
12.1 Access Control ........................................................................................................................ 505
12.1.1 Open Door .................................................................................................................... 505
12.1.2 Close Door .................................................................................................................... 505
12.1.3 Get Door Status ............................................................................................................ 506
12.1.4 Get Lock Status ............................................................................................................ 506
12.1.5 Capture Fingerprint ....................................................................................................... 506
12.1.6 Capture Face Picture .................................................................................................... 507
12.1.7 Query AccessControl Record ....................................................................................... 509
12.1.8 Query Access Control Alarm Record .............................................................................511
12.1.9 [Event] AccessControl .................................................................................................. 512
12.1.10 [Event] CitizenPictureCompare .................................................................................. 515
12.1.11 [Event] Door Status Event .......................................................................................... 517
12.1.12 [Config] Access Control General Setting .................................................................... 517
12.1.13 [Config] Access Control Setting .................................................................................. 520
12.1.14 [Config] Wiegand Setting ............................................................................................ 523
12.1.15 [Config] Access Time Schedule Setting ..................................................................... 525
12.1.16 [Config] Special Day Group Setting............................................................................ 526
12.1.17 [Config] Special Days Schedule Setting ..................................................................... 527
12.1.18 [Config] MeasureTemperature Setting ....................................................................... 528
12.1.19 [Config] CitizenPictureCompare Setting ..................................................................... 532
12.2 Access Control Manager ......................................................................................................... 533
12.2.1 Get Access Control Capability ...................................................................................... 533
12.2.2 Add SubController......................................................................................................... 534
12.2.3 Modify SubController .................................................................................................... 535
12.2.4 Remove SubController ................................................................................................. 535
12.2.5 Get SubController Info .................................................................................................. 535
12.2.6 Get SubController States .............................................................................................. 536
12.2.7 Set RepeatEnter Route ................................................................................................ 537

Table of Contents XVII

12.2.8 Get RepeatEnter Route ................................................................................................ 537
12.2.9 Set ABLock Route......................................................................................................... 538
12.2.10 Get ABLock Route ...................................................................................................... 539
12.2.11 Get Log Status ............................................................................................................ 539
12.2.12 Sync Offline Log ......................................................................................................... 540
12.2.13 Sync SubController Time ............................................................................................ 540
12.3 Access User Account ( V1 ) .................................................................................................... 541
12.3.1 Add Access User Face ................................................................................................. 541
12.3.2 Modify Access User Face ............................................................................................. 541
12.3.3 Delete Access User Face ............................................................................................. 542
12.3.4 Find Access User Face ................................................................................................. 543
12.3.5 Add Access User Card and Fingerprint ........................................................................ 544
12.3.6 Modify Access User Card and Fingerprint .................................................................... 547
12.3.7 Delete Access User Card and Fingerprint .................................................................... 548
12.3.8 Find Access User Card and Fingerprint ....................................................................... 549
12.3.9 Get the Total Number of Records of Access User Card and Fingerprint ..................... 553
12.4 Access User Account ( V2 ) .................................................................................................... 554
12.4.1 Add Access User ........................................................................................................... 554
12.4.2 Modify Access User ...................................................................................................... 555
12.4.3 Delete All Access User ................................................................................................. 557
12.4.4 Delete Multiple Access Users ....................................................................................... 557
12.4.5 Find Multiple Access Users .......................................................................................... 558
12.4.6 Start Find Access User Related Information ................................................................ 559
12.4.7 Get Find Result of Access User Related Information ................................................... 560
12.4.8 Stop Find Access User Related Information ................................................................ 561
12.4.9 Add Multiple Access Cards ........................................................................................... 561
12.4.10 Modify Multiple Access Cards .................................................................................... 562
12.4.11 Delete All Access Cards .............................................................................................. 563
12.4.12 Delete Multiple Access Cards ..................................................................................... 563
12.4.13 Find Multiple Access Cards ........................................................................................ 564
12.4.14 Start Find Access User Card Related Information ..................................................... 565
12.4.15 Get Find Result of Access User Card Related Information ........................................ 566
12.4.16 Stop Find Access User Card Related Information ..................................................... 566
12.4.17 Add Multiple Access User Fingerprint......................................................................... 566
12.4.18 Modify Access User Fingerprint .................................................................................. 567
12.4.19 Delete All Access User Fingerprint ............................................................................. 568
12.4.20 Delete Multiple Access User Fingerprint .................................................................... 569
12.4.21 Find Access User Fingerprint ..................................................................................... 569
12.4.22 Add Multiple Access User Face .................................................................................. 570
12.4.23 Update Multiple Access User Face ............................................................................ 570
12.4.24 Delete All Access User Face ...................................................................................... 571
12.4.25 Delete Multiple Access User Face .............................................................................. 572
12.4.26 Find Access User Face ............................................................................................... 572
12.4.27 Start Find Access User Face Related Information ..................................................... 573
12.4.28 Get Find Result of Access User Face Related Information ....................................... 573
12.4.29 Stop Find Access User Face Related Information ..................................................... 574
12.4.30 Access Control Protocol Capability Query ................................................................. 574

Table of Contents XVIII

12.5 Admin Password ..................................................................................................................... 580
12.5.1 Add Access Control Admin Password .......................................................................... 580
12.5.2 Modify Access Control Admin Password ...................................................................... 580
12.5.3 Delete Access Control Admin Password ...................................................................... 581
12.5.4 Find Access Control Admin Password.......................................................................... 582
12.5.5 Get the Total Number of Records of Access Control Admin Password ....................... 584
13 Intelligent Building APIs ................................................................................................................. 585
13.1 Video Talk ................................................................................................................................ 585
13.1.1 Subscribe Video Talk Status ......................................................................................... 585
13.1.2 Unsubscribe Video Talk Status ..................................................................................... 587
13.1.3 Invite Server on Video Talk ........................................................................................... 587
13.1.4 Cancel the Video Talk ................................................................................................... 589
13.1.5 Answer the Invitation .................................................................................................... 589
13.1.6 Refuse to Answer the Video Talk Invitation .................................................................. 590
13.1.7 Hang Up ........................................................................................................................ 591
13.2 Intelligent Building Record ...................................................................................................... 591
13.2.1 Query Video Talk Log Record ....................................................................................... 591
13.2.2 Insert Announcement Record ....................................................................................... 592
13.2.3 Query Alarm Record ..................................................................................................... 592
13.3 SIP ........................................................................................................................................... 593
13.3.1 [Config] SIP Configuration ............................................................................................ 593
13.3.2 [Config] Registar Configuration .................................................................................... 597
13.4 Room Number Database Management .................................................................................. 599
13.4.1 Adding Room Number .................................................................................................. 599
13.4.2 Getting Records by Video Talk short number ............................................................... 600
13.4.3 Getting Records by recno ............................................................................................. 602
13.4.4 Updating Room Number Records ................................................................................ 604
13.4.5 Deleting Records by recno ........................................................................................... 606
13.4.6 Clearing All Room Numbers ......................................................................................... 606
13.4.7 Getting Total Quantity of Room Number ...................................................................... 606
13.5 ElevatorFloorCounter .............................................................................................................. 607
13.5.1 Set Elevator Floor Info .................................................................................................. 607
13.5.2 Get Elevator WorkInfo .................................................................................................. 607
13.5.3 Get Capability ............................................................................................................... 608
14 DVR Custom APIs............................................................................................................................ 609
14.1 File Finder ............................................................................................................................... 609
14.1.1 Create a File Finder ...................................................................................................... 609
14.1.2 Create a Motion File Finder .......................................................................................... 610
14.1.3 Get the File Information Found by the Finder ...............................................................611
14.1.4 Stop the Finder ............................................................................................................. 612
14.1.5 Get Bound Files ............................................................................................................ 612
14.2 BandLimit ................................................................................................................................ 613
14.2.1 Get Bandwidth Limit State ............................................................................................ 613
14.3 Record Files Protection ........................................................................................................... 613
14.3.1 Add Protection .............................................................................................................. 613
14.3.2 Cancel Protection ......................................................................................................... 614
14.3.3 Remove Protection ....................................................................................................... 614

Table of Contents XIX

14.3.4 DownloadFile ................................................................................................................ 614
14.3.5 UploadFile ..................................................................................................................... 615
14.3.6 List all elements in the specified directory .................................................................... 616
14.4 Daylight ................................................................................................................................... 617
14.4.1 Get Daylight .................................................................................................................. 617
15 Other APIs ...................................................................................................................................... 618
15.1 Discover Devices .................................................................................................................... 618
15.1.1 Discover Devices on Internet........................................................................................ 618
15.2 Open Platform ......................................................................................................................... 619
15.2.1 Application Start and Stop ............................................................................................ 619
15.2.2 Install Application .......................................................................................................... 619
15.2.3 Update Application and License ................................................................................... 620
15.2.4 Uninstall Application ..................................................................................................... 622
15.2.5 Download Application Log ............................................................................................ 622
15.3 GPS ......................................................................................................................................... 622
15.3.1 Get Capablity ................................................................................................................ 622
15.3.2 [Config] GPS config ...................................................................................................... 623
15.3.3 Get GPS Status ............................................................................................................ 623
15.4 Lens Function .......................................................................................................................... 624
15.4.1 Get Lens Capability ...................................................................................................... 624
15.4.2 Adjust Angle Continuously ............................................................................................ 624
15.4.3 Stop Adjusting Angle ..................................................................................................... 625
15.4.4 Adjust Depth Field......................................................................................................... 625
15.4.5 Adjust Depth Field Continuously .................................................................................. 625
15.4.6 Get Depth Field Status ................................................................................................. 626
15.4.7 Auto Adjust Depth Field ................................................................................................ 626
15.4.8 Scene Correction .......................................................................................................... 627
15.4.9 Reset Angle .................................................................................................................. 628
15.5 FishEye ................................................................................................................................... 628
15.5.1 Get FishEye Capability ................................................................................................. 628
15.5.2 [Config] FishEye Setting ............................................................................................... 629
15.6 Radar Adaptor ......................................................................................................................... 630
15.6.1 Get Radar Capability .................................................................................................... 630
15.6.2 Get Radar Capbility ( Enhanced ) ................................................................................ 630
15.6.3 Get Status ..................................................................................................................... 631
15.6.4 Calculate Real Size ...................................................................................................... 631
15.6.5 Subscribe Alarm Point Info ........................................................................................... 631
15.6.6 Manual Locate .............................................................................................................. 633
15.6.7 Start Radar Calibration ................................................................................................. 633
15.6.8 Add Radar Link SD ....................................................................................................... 633
15.6.9 Del Radar Link SD ........................................................................................................ 634
15.6.10 Get Link SD State ....................................................................................................... 635
15.6.11 [Config] MapPara ........................................................................................................ 635
15.6.12 [Config] RadarAnalyseRule ........................................................................................ 637
15.6.13 [Config] RadarCalibration ........................................................................................... 638
15.6.14 [Config] RadarGuardLine ............................................................................................ 639
15.6.15 [Config] RadarLink ...................................................................................................... 640

Table of Contents XX

15.6.16 [Config] RadarLinkDevice ........................................................................................... 640
15.6.17 [Config] RadarPara ..................................................................................................... 640
15.6.18 [Config] RadarTrackGlobal ......................................................................................... 641
15.6.19 [Config] RemoteSDLink .............................................................................................. 642
15.7 Water Radar ............................................................................................................................ 642
15.7.1 Acquire Radar Capability .............................................................................................. 642
15.7.2 Get Radar Detection Target Data ................................................................................. 642
15.8 Water Quality Detection .......................................................................................................... 643
15.8.1 Get Capability ............................................................................................................... 643
15.8.2 Get Real-time Detection Data ...................................................................................... 643
15.8.3 Start Find Water Quality Report ................................................................................... 645
15.8.4 Get Find Water QUality Report Search Results ........................................................... 646
15.8.5 Stop Find Water Quality Report .................................................................................... 648
15.9 Advertisement ......................................................................................................................... 648
15.9.1 Changing Stay Time of Advertisement Image .............................................................. 648
15.9.2 Acquiring Video and Image Files Played by the Device ............................................... 649

Table of Contents XXI

1 Overview

This document specifies the HTTP-based application programming interface of video products.

The HTTP-based interface provides the functionality for requesting snapshot and media stream,
controlling camera functions (for example, PTZ and focus), and getting and setting internal
parameter values.

The video products serve as a server. The client sends requests to server, and then server handles
requests and returns resources accordingly.

Overview 23

2 References

[1] RFC 2326 Real Time Streaming Protocol (RTSP)

[2] RFC 2616 Hypertext Transfer Protocol-HTTP/1.1

[3] RFC 3986 Uniform Resource Identifiers (URI) Generic Syntax

[4] RFC 7616 HTTP Digest Access Authentication

[5] RFC 8259 The JavaScript Object Notation (JSON) Data Interchange Format

References 24

3 Definitions

3.1 Abbreviations

The following abbreviations are used throughout this document.

API

Application Programming Interface. In the document, it especially presents

application programming interface of video products.

3.2 Syntax Convention



In URL syntax and in descriptions of API parameters, text in italic within angle brackets denotes
content that should be replaced with either a value or a string. When replacing the text string,
the angle brackets must also be replaced. For example, <server> in URL syntax is replaced
with the IP number of server, e.g., 192.168.1.108.

 String shown in bold face denotes a brief explanatory note of the string close to it.

 Name-value pair in square brackets denotes content that is optional. For example,

"http ://<server>/cgi-bin/snapshot.cgi[?channel=1]" can be like this
"http ://<server>/cgi-bin/snapshot.cgi".











The API syntax must follow the standard of URI. (RFC 3986: Uniform Resource Identifiers (URI)
Generic Syntax); that is, spaces and other reserved characters (e.g, ":", "/", "?", "@", ";", "=", "+",
",", "$", "&") within a name-value pair should be replaced with %< ASCII hex>. For example, the
blank should be replaced with %20.

To describe the range of a variable, we use some symbols such as "[]" and "{}". For example,
"[0-100]" denotes an integer not less than 0 and not larger than 100. "{0, 1, 2, 3}" denotes the
valid value of an integer among 0, 1, 2 and 3.

"[]" following a string denotes an array. The index is an integer and starts from 0. For example,
"Snap[channel]" may be "Snap[0]" "Snap[0]" etc.

The variable may be different types: string, integer, bool or float. Integer is 32 bits. The range of
bool is "true" and "false".

"R/O" in parameters means this parameter is required or not, "R"means required, "O"means
optional.

3.3 HTTP API Protocol Format

HTTP APIs support HTTP and HTTPS protocol. It is recommend using HTTPS to improve network
security.

The request and response parameters of the HTTP APIs have two formats: key=value format and
JSON format. Each HTTP API will choose one of these formats, please refer to the API detail in later
chapters.

Definitions 25

3.3.1 key=value format

If the HTTP API use key=value format for it's parameters, the URL syntax is :

<protocol>://<server><abs_path>[?query]

protocol: URL scheme for the particular request. The http protocol and https protocol are both
supported in this specification. So "http", as most of the APIs' default protocol except several RTSP
APIs, can be replaced by "https".

server: Server could be "hostname[:port]". The hostname can be IP address or the fully qualified
domain name of an IP device. The port is the port number of server listening for TCP connections.
If the port is not given, the default port is assumed. For HTTP, the default port is 80. For HTTPS, the
default port is 443.

abs_path: The Request-URI for the resources is abs_path. The abs_path in this specification is
most often of the form "/cgi-bin/\*.cgi".

query: The query field is a string of information to be interpreted by the resource. It consists of
resource-related parameters. And it must be listed in name-value pair syntax
(p1=v1&p2=v2&…&pn=vn).

For the HTTP API that use key=value format for it's parameters, it usually has no HTTP Body.

Request Example: HTTP request with key=value format parameters

GET http://192.168.1.108/cgi-bin/devVideoInput.cgi?action=getFocusStatus&channel=1 HTTP/1.1
User-Agent: client/1.0
Content-Length: 0

The server uses the standard HTTP status codes, the syntax of the status line of the response is:

HTTP/1.1 <HTTP code> <HTTP text>

With the following HTTP code and meanings:

HTTP code HTTP text

Description

200

400

401

403

404

500

501

OK

Bad Request

Unauthorized

Forbidden

Not Found

Internal Server Error

The request has succeeded. The requested
resource will be returned in the HTTP text.

The request had bad syntax or was inherently
impossible to be satisfied.

The request requires user authentication or the
authorization has been refused.

The user does not have the right to access the
service.

The server has not found anything matching the
request.

The server encountered an unexpected condition
that prevented it from fulfilling the request.

Not Implemented

The server has not implemented the service.

If the HTTP code is 200, means the API execute success, and the response data in HTTP Body
( maybe multipart ) can be a multiline key=value data, or just a line with a word "OK".

Definitions 26

Reponse Example: success respose with multiline key=value

HTTP/1.1 200 OK
Server: Device/1.0
Content-Type: text/plain
Content-Length: <length>

status.Focus=0.5
status.Zoom=0.5
…

Reponse Example: success respose with a word "OK"

HTTP/1.1 200 OK
Server: Device/1.0
Content-Type: text/plain
Content-Length: <length>

OK

If the HTTP code is not 200, means the API execute failed, and the response data in HTTP Body
maybe empty, or just two line, first line is a word "Error" to indicate error happened, the second line
contain error detail.

Reponse Example: request does not fit with syntax.

HTTP/1.1 404 Not Found
Server: Device/1.0

Reponse Example: Request spells wrong.

HTTP/1.1 400 Bad Request
Server: Device/1.0
Content-Type: text/plain
Content-Length: <length>

Error
Bad Request!

Reponse Example: If the request fits with syntax but an error occurs while the server handles it, the
response would like this:

HTTP/1.1 500 Internal Server Error
Server: Device/1.0
Content-Type: text/plain
Content-Length: <length>

Error
Internal Server Error!

3.3.2 JSON format

If the HTTP API use JSON format for it's parameters, the URL syntax is :

Definitions 27

<protocol>://<server><abs_path>

protocol: URL scheme for the particular request. The http and https protocols are both supported in
this specification. So "http", as most of the APIs' default protocol except several RTSP APIs, can be
replaced by "https".

server: Server could be "hostname[:port]". The hostname can be IP address or the fully qualified
domain name of an IP device. The port is the port number of server listening for TCP connections.
If the port is not given, the default port is assumed. For HTTP, the default port is 80. For HTTPS, the
default port is 443.

abs_path: The Request-URI for the resources is abs_path. The abs_path in this specification is
most often prefix with "/cgi-bin/api/" , and followed with resource name, for example :
"/cgi-bin/api/CloudUpgrader/check" .

For the HTTP API that use JSON format for it's parameters, the parameters are put to the HTTP
Body as a JSON object. If the API has no request parameter, then the HTTP Body is an empty
JSON object, for example " {} ", or there is no HTTP Body.

Request Example: HTTP request with JSON format parameters

GET http://192.168.1.108/cgi-bin/api/CloudUpgrader/check HTTP/1.1
User-Agent: client/1.0
Content-Type: application/json
Content-Length: xxx

{

}

"way" : 0,
"proxy" : {

"IP" : "10.1.2.3",
"Port" : 8080

}

The server uses the standard HTTP status codes, the syntax of the status line of the response is:

HTTP/1.1 <HTTP code> <HTTP text>

With the following HTTP code and meanings:

HTTP code HTTP text

Description

200

400

401

403

404

500

OK

Bad Request

Unauthorized

Forbidden

Not Found

Internal Server Error

The request has succeeded. The requested
resource will be returned in the HTTP text.

The request had bad syntax or was inherently
impossible to be satisfied.

The request requires user authentication or the
authorization has been refused.

The user does not have the right to access the
service.

The server has not found anything matching the
request.

The server encountered an unexpected condition
that prevented it from fulfilling the request.

Definitions 28

HTTP code HTTP text

Description

501

Not Implemented

The server has not implemented the service.

If the HTTP code is 200, means the API execute success, and the response data in HTTP Body
( maybe multipart ) can be a JSON object. If the API has no response parameter, then the HTTP
Body is an empty JSON object, for example " {} ", or there is no HTTP Body.

Reponse Example: success respose with JSON format Body

HTTP/1.1 200 OK
Server: Device/1.0
Content-Type: application/json
Content-Length: <length>

{

"info" : {

"State" : "None",
"PackageType" : "all",
"OldVersion" : "0000",
"NewVersion" : "0004",
"Attention" : "What is new",
"PackageUrl" : "https://example.com/1.zip",
"PackageId" : "1d2ee7",
"CheckSum" : "F3D288AB",
"BuildTime" : "08-10-2018 01:01:02"

}

}

If the HTTP code is not 200, means the API execute failed, and the response data in HTTP Body
maybe empty, or a JSON object to describe the error detail. The value of "ErrorCode" contains error
code, and the value of "ErrorMsg" contains error detail.

Reponse Example: request does not fit with syntax.

HTTP/1.1 404 Not Found
Server: Device/1.0

Reponse Example: Request spells wrong.

HTTP/1.1 400 Bad Request
Server: Device/1.0
Content-Type: application/json
Content-Length: <length>

{

}

"ErrorCode" : 10086,
"ErrorMsg" : "Bad Request!"

Reponse Example: If the request fits with syntax but an error occurs while the server handles it, the
response would like this:

Definitions 29

HTTP/1.1 500 Internal Server Error
Server: Device/1.0
Content-Type: application/json
Content-Length: <length>

{

}

"ErrorCode" : 10097
"ErrorMsg" : "Internal Server Error!"

3.4 Authentication

Video products support digest authentication, see RFC 7616 for detail. If the http request sent by
client does not provide valid "Authorization" header information, video products would return HTTP
status code 401 and some information for authentication, then client should calculate authentication
information according to RFC 7616, and sent request again with authentication information using
“Authorization” header. Video products return the required resource only if authorization information
correct.

1.  When the client does not provoding digest authentication or the client calculates digest
    authentication with expired "nonce" data, video product reply 401 with information for
    authorization.

Request Example: The client send request without authentication infomation

GET /cgi-bin/magicBox.cgi?action=getLanguageCaps HTTP/1.1
User-Agent: client/1.0
Content-Length: 0

Reponse Example: The device send 401 reponse with parameters for authentication calculation.

HTTP/1.1 401 Unauthorized
Server: Device/1.0
WWW-Authenticate: Digest realm="Device_00408CA5EA04",

nonce="000562fd20ef95ad", qop="auth",
opaque="5ccc069c403ebaf9f0171e9517f40e41"

2.  Then the client generate "nc" and "cnonce", calculates the digest authorization using "username"
    "password" "HTTP method" "URI" "nc" "cnonce" "realm" "nonce" , according to RFC 7616, and
    then sends it to video product again. If the digest authorization is correct, the video product will
    reply HTTP status code 200 with the response data. If digest authorization is not correct, the
    video product will reply HTTP status code 403 .

Request Example: The client send request again with authentication information ( suppose the
password of admin user is "abcd1234" )

Definitions 30

GET /cgi-bin/magicBox.cgi?action=getLanguageCaps HTTP/1.1
User-Agent: client/1.0
Authorization: Digest username="admin", realm="Device_00408CA5EA04",

nonce="000562fd20ef95ad", nc=00000001, cnonce="0a4f113b", qop="auth",
uri="/cgi-bin/magicBox.cgi?action=getLanguageCaps",
response="dfd0f24bed4c336d20c8f0729dd5dbc8"
opaque="5ccc069c403ebaf9f0171e9517f40e41"

Content-Length: 0

Reponse Example: If the authentication information is correct, the device send 200 reponse.

HTTP/1.1 200 OK
Server: Device/1.0
Content-Type: text/plain
Content-Length: <length>

Languages=SimpChinese,English,French

Reponse Example: If the authentication information is not correct, the device send 403 reponse.

HTTP/1.1 403 Forbidden
Server: Device/1.0
Content-Length: 0

3.5 Conventions

3.5.1 Channels

For requests containing the param ‘channel’ like :

http://<server>/cgi-bin/mjpg/video.cgi[?channel=<ChannelNo>]

ChannelNo: integer, must starts from 1. Default is 1 if not present.

But for responses, the ‘ChannelNo’ should start from 0. In other words, the request channel 1
equals response channel 0.

Definitions 31

4 General APIs

The APIs specified in this section are supported by all video products.

4.1 APIs of RTSP

4.1.1 Get Real-Time Stream

Get real-time media stream APIs use RTSP protocol, please refer to RFC 2326 for detail. The rtsp
service default port is 554. The IP Camera supports both TCP and UDP transmission forms. It
supplies digest authentication ways. The authentication process is similar with "3.5 Authentication".



The format of the RTSP URL parameter for getting real-time media stream is as follows.

rtsp://<server>:[port]/cam/realmonitor
DESCRIBE, SETUP, PLAY, PAUSE, TEARDOWN, ...

URL
Method
URL Params ( key=value format in URL )
Type
Name
int
channel

R/O Description
R

Example
1
0

Video channel number, starting from 1.
The stream type, including main stream and sub
stream.
Execute the "4.5.1 Getting Maximum Number of
Sub Streams" command to get the number of sub
streams.
Optional values:
0: Main stream
1: Sub stream 1
2: Sub stream 2

subtype

int

R

URL Example
rtsp://192.168.1.108:554/cam/realmonitor?channel=1&subtype=0

Step 1: Obtain media description by executing the DESCRIBE command.

Request Example
DESCRIBE rtsp://192.168.1.108/cam/realmonitor?channel=1&subtype=0 RTSP/1.0
CSeq: 1
User-Agent: LibVLC/3.0.5

Response Example
RTSP/1.0 200 OK
CSeq: 1
Server: Rtsp Server/3.0
Content-Base: rtsp://192.168.1.108/cam/realmonitor?channel=1&subtype=0/
Content-Length: xxx
Content-Type: application/sdp

General APIs 32

v=0
o=- 2253484289 2253484289 IN IP4 0.0.0.0
s=Media Server
c=IN IP4 0.0.0.0
t=0 0
a=control:\*
a=range:npt=now-
m=video 0 RTP/AVP 98
a=control:trackID=0
a=framerate:25.000000
a=rtpmap:98 H265/90000
a=recvonly

Step 2: Establish a transmission channel for each media by executing the SETUP command.

Take RTP over UDP as an example. Establish the UDP socket for receiving and sending UDP
packages on 63088 and 63089 interfaces.

Request Example
SETUP rtsp://192.168.1.108/cam/realmonitor?channel=1&subtype=0/trackID=0 RTSP/1.0
CSeq: 2
User-Agent: LibVLC/3.0.5
Transport: RTP/AVP;unicast;client_port=63088-63089

Response Example
RTSP/1.0 200 OK
CSeq: 2
Server: Rtsp Server/3.0
Session: 1546116282447;timeout=60
Transport: RTP/AVP/UDP;unicast;client_port=63088-63089;server_port=24764-24765;ssrc=71B0AFDC

Step 3: Execute the play command to play the media, and receive and send RTP and RTCP data
through the UDP socket established in step 2.

Request Example
PLAY rtsp://192.168.1.108/cam/realmonitor?channel=1&subtype=0/ RTSP/1.0
CSeq: 3
User-Agent: LibVLC/3.0.5
Session: 1546116282447
Range: npt=0.000-

Response Example
RTSP/1.0 200 OK
CSeq: 3
Server: Rtsp Server/3.0
Session: 1546116282447
Range: npt=0.000-
RTP-Info: url=trackID=0;seq=45020;rtptime=1907404764

General APIs 33

Step 4: Execute the TEARDOWN command to stop playing the media, and then disable the UDP
socket.

Request Example
TEARDOWN rtsp://192.168.1.108/cam/realmonitor?channel=1&subtype=0/ RTSP/1.0
CSeq: 4
User-Agent: LibVLC/3.0.5
Session: 1546116282447

Response Example
RTSP/1.0 200 OK
CSeq: 4
Server: Rtsp Server/3.0
Session: 1546116282447

4.1.2 Get Playback Stream

It's similar with "4.1.1 Get Real-Time Stream", except that there are parameters "starttime" and
"endtime".

rtsp://<server>:[port]/cam/playback
DESCRIBE, SETUP, PLAY, PAUSE, TEARDOWN, ...

URL
Method
URL Params ( key=value format in URL )
Type
Name

R/O Description

channel

int

R

starttime
endtime

char[32] R
char[32] O

The video channel index which starts
from 1
The playback begin time
The playback end time

Example
1

2012_09_15_12_37_05
2012_09_15_18_34_14

URL Example
rtsp://192.168.1.108:554/cam/playback?channel=1&starttime=2012*09_15_12_37_05&endtime=2012*
09_15_18_34_14

4.1.3 Get File Stream

It's similar with "4.1.1 Get Real-Time Stream". The filename with absolute path of file stream to get is
place in rtsp url.

rtsp://<server>:[port]/<path to filename>
DESCRIBE, SETUP, PLAY, PAUSE, TEARDOWN, ...

URL
Method
URL Params ( key=value format in URL )
Name
Type
URL Example
rtsp://192.168.1.108:554//mnt/sd/2015-09-16/001/dav/20/20.32.08-20.32.28[M][0@0][0].dav

R/O Description

Example

4.1.4 Get MJPG Stream

Get a video stream encoded by mjpg ( motion jpeg ).

Request URL

http://<server>/cgi-bin/mjpg/video.cgi

General APIs 34

GET

Method
Request Params ( key=value format in URL )
Name
channel

R/O Description
R

Type
int

subtype

int

R

The video channel index which starts from 1
The stream type, It can be the following value:
0-Main Stream
1-Extra Stream 1
2-Extra Stream 2

Example
1
0

Request Example
http://192.168.1.108/cgi-bin/mjpg/video.cgi?channel=1&subtype=0

Response Params ( multipart, binary in body )
<binary data> : JPEG image data

Response Example
HTTP/1.1 200 OK
Server: Device/1.0
Content-Type: multipart/x-mixed-replace; boundary=<boundary>

--<boundary>
Content-Type: image/jpeg
Content-Length:<image size>

<JPEG image data>
--<boundary>
Content-Type: image/jpeg
Content-Length:<image size>

<JPEG image data>
--<boundary>
……

4.1.5 Create RTSP Pull and Authentication Token

http://<server>/cgi-bin/api/TokenManager/createToken
Request URL
POST
Method
Request Params ( JSON format in body )
Name
Channel

R/O Description
R

Type
uint32

Example
0

video channel number
which starts from 0

Request Example
{
"Channel": 0
}

Response Params ( key=value format in body )

General APIs 35

Name
Token

Type
char[128] R

R/O Description
Token

Example
"AwDSEci0j4EUW6pUz5bcQ0yK8\_
Rbq0vaUsUwqQKmFoUpuMJjOxy9k
gcV6BlCty8U"

Response Example
{
"Token": "AwDSEci0j4EUW6pUz5bcQ0yK8_Rbq0vaUsUwqQKmFoUpuMJjOxy9kgcV6BlCty8U"
}

4.2 Configure Manager

4.2.1 Get and Set Configure

 Get Configure

Get configure detail by name. Each configure name has it’s specific configure detail. Please refer to
configure detail APIs in later [Config] chapters.

http://<server>/cgi-bin/configManager.cgi?action=getConfig
GET

Request URL
Method
Request Params ( key=value format in URL )
Type
Name
name
string R
Request Example
http://<server>/cgi-bin/configManager.cgi?action=getConfig&name=General

The name of the configure

R/O Description

Response Params ( key=value format in body )
Name
table

Type
object

R/O Description
R

Sample
SmartEncode

Sample

The configure table object.
The configure detail of the requested
configure name. Each configure
name has
it’s specific configure
detail. Please refer to configure detail
apis in later chapters.

+<config name>

string/object/object[]

R

Response Example
table.General.MachineID=20832748927
table.General.MachineName=DVR001
table.General.MachineAddress=XXX Road
…

 Set Configure

Set configure detail by name. Each configure name has it’s specific configure detail. Please refer to
configure detail APIs in later [Config] chapters.

Request URL
Method
Request Params ( key=value format in URL )

http://<server>/cgi-bin/configManager.cgi?action=setConfig
GET

General APIs 36

Name

Type

R/O Description

Sample

<config name>

string/o
bject/ob
ject[]

R

The configure detail of the configure name.
it’s specific
Each configure name has
configure detail. Please refer to configure
detail apis in later chapters.

Request Example
http://192.168.1.108/cgi-bin/configManager.cgi?action=setConfig&General.MachineID=20832748927&
General.MachineName=DVR001&General.MachineAddress=XXX%20Road

Response Params ( OK in body )
Response Example
OK

4.2.2 Add and Remove Configure

 Add configure

The configuration name is put in the URL in the form of key-value; the specific configuration field can
be obtained through getConfig. Each configure name has it’s specific configure detail. Please refer
to configure detail APIs in later [Config] chapters.

http://<server>/cgi-bin/configManager.cgi?action=addConfig
GET

Request URL
Method
Request Params ( key=value format in URL )
Name

Type

R/O Description

Sample

<config name>

string/o
bject/ob
ject[]

R

The configure detail of the configure name.
Each configure name has
it’s specific
configure detail. Please refer to configure
detail apis in later chapters.

Request Example
http://192.168.1.108/cgi-bin/configManager.cgi?action=addConfig&General.MachineAddress=XXX%20
Road

Response Params ( OK in body )
Response Example
OK

 Remove configure

Specific configuration fields can be obtained through getConfig. Only configuration fields can be
deleted, not configuration items. Each configure name has it’s specific configure detail. Please refer
to configure detail APIs in later [Config] chapters.

http://<server>/cgi-bin/configManager.cgi?action=removeConfig
GET

Request URL
Method
Request Params ( key=value format in URL )
Name
name
Request Example

R/O Description
R

Type
string

configuration param name

Sample
VSP_CGI.ServiceStart

General APIs 37

http://192.168.1.108/cgi-bin/configManager.cgi?action=removeConfig&General.MachineAddress

Response Params ( OK in body )
Response Example
OK

4.2.3 Restore the Config

Restore specified configurations to the default values.

http://<server>/cgi-bin/configManager.cgi?action=restore
GET

Request URL
Method
Request Params ( key=value format in URL )
Name
names

Type
char[][32] R

R/O Description

Array of the configuration names that
needs to be restored to the default
values.

Example
[ "General", "UPnP" ]

Request Example
http://<server>/cgi-bin/configManager.cgi?action=restore&names[0]=General&names[1]=UPnp

Response Params ( OK in body )
Response Example
OK

4.2.4 Restore except the Config

Restore all other configurations except for the specified configurations to the default values.

http://<server>/cgi-bin/configManager.cgi?action=restoreExcept
GET

Request URL
Method
Request Params ( key=value format in URL )
Name
names

Type
char[][32] R

R/O Description

Example
[ "General", "UPnP" ]

Array of the configuration names that
does not need to be restored to the
default values.

Request Example
http://<server>/cgi-bin/configManager.cgi?action=restoreExcept&names[0]=General&names[1]=UPnp

Response Params ( OK in body )
Response Example
OK

General APIs 38

4.3 Audio

4.3.1 Get Audio Input Channel Numbers

Get audio input channel number.

http://<server>/cgi-bin/devAudioInput.cgi?action=getCollect
GET

Request URL
Method
Request Params ( key=value format in URL )
Name
Request Example
http://192.168.1.108/cgi-bin/devAudioInput.cgi?action=getCollect

R/O Description

Type

Response Params ( key=value format in body )
R/O Description
Name
R
result

Type
int

audio input channel number.

Response Example
result=1

4.3.2 Get Audio Output Channel Numbers

Get audio output channel number.

http://<server>/cgi-bin/devAudioOutput.cgi?action=getCollect
GET

Request URL
Method
Request Params ( key=value format in URL )
Name
Request Example
http://192.168.1.108/cgi-bin/devAudioOutput.cgi?action=getCollect

R/O Description

Type

Response Params ( key=value format in body )
R/O Description
Name
R
result

Type
int

audio output channel number.

Example

Example
1

Example

Example
2

Response Example
result=2

4.3.3 Post Audio Stream

Post audio stream to device, request is very long and client continues to send audio data. If client
want to stop, just close the connection.

http://<server>/cgi-bin/audio.cgi?action=postAudio
POST

Request URL
Method
Request Params ( key=value format in URL )
Name

Type

R/O Description

httptype

string

R

audio http transmit format, can be :
singlepart: HTTP content is a continuous flow of

Example
singlepart

General APIs 39

HTTP

audio packets
multipart:
is
multipart/x-mixed-replace, and each audio packet
ends with a boundary string
The audio channel index which starts from 1.

content

type

1

channel

int

R

Request Example ( singlepart )
POST http://192.168.1.108/cgi-bin/audio.cgi?action=postAudio&httptype=singlepart&channel=1 HTTP/
1.1
User-Agent: client/1.0
Content-Type: Audio/G.711A
Content-Length: 9999999

<Audio data>
<Audio data>
…

Request Example ( multipart )
POST http://192.168.1.108/cgi-bin/audio.cgi?action=postAudio&httptype=multipart&channel=1 HTTP/
1.1
User-Agent: client/1.0
Content-Type: multipart/x-mixed-replace; boundary=<boundary>

--<boundary>
Content-Type: Audio/G.711A
Content-Length: 800

<Audio data>
--<boundary>
Content-Type: Audio/G.711A
Content-Length: 800

<Audio data>
--<boundary>
…

Response Params ( N/A )
Name
Response Example
( N/A )

Type

R/O Description

Example

Appendix A: Audio Encode Type

MIME ( Content-Type )

Audio/PCM

Audio/ADPCM

Audio/G.711A

Audio/G.711Mu

Audio/G.726

Description

PCM

ADPCM

G.711 A Law

G.711 Mu Law

G.726

General APIs 40

MIME ( Content-Type )

Description

Audio/G.729

Audio/MPEG2

Audio/AMR

Audio/AAC

4.3.4 Get Audio Stream

G.729

MPEG2

AMR

AAC

Get audio stream from device, response is very long and client continues to recv audio data. If client
want to stop, just close the connection.

http://<server>/cgi-bin/audio.cgi?action=getAudio
GET

Request URL
Method
Request Params ( key=value format in URL )
Name

R/O Description

Type

httptype

string

R

channel

int

R

audio http transmit format, can be :
singlepart: HTTP content is a continuous flow of
audio packets
is
multipart:
multipart/x-mixed-replace, and each audio packet
ends with a boundary string
The audio channel index which starts from 1.

content

HTTP

type

Request Example
http://192.168.1.108/cgi-bin/audio.cgi?action=getAudio&httptype=singlepart&channel=1

R/O Description

Type

Response Params ( binary in body )
Name
Response Example ( singlepart )
200 OK HTTP/1.1
Server: device/1.0
Content-Type: Audio/G.711A
Content-Length: 9999999

Example
singlepart

1

Example

<Audio data>
<Audio data>
…
Response Example ( multipart )
200  OK  HTTP/1.1
Server:  device/1.0
Content-Type:  multipart/x-mixed-replace;  boundary=<boundary>

--<boundary>
Content-Type: Audio/G.711A
Content-Length: 800

<Audio data>
--<boundary>

General APIs 41

Content-Type: Audio/G.711A
Content-Length: 800

<Audio data>
--<boundary>
…

4.3.5 [Config] Volume Control

Volume control configuration parameters:

Config Data Params
Name

Type

AudioOutputVolume

int[]

R/O Description
R

Audio output volume. Each element of the
array represents the volume value of an
audio output channel, and the range is
[0-100].

Example
[80,50]

Please refer to "4.2.1 Get and Set Configure" for configuration getting and setting. Specific
examples are as follows :

Get Config Request Example
http://192.168.1.108/cgi-bin/configManager.cgi?action=getConfig&name=AudioOutputVolume

Get Config Response Example
table.AudioOutputVolume[0]=80
table.AudioOutputVolume[1]=50
…

Set Config Request Example
http://192.168.1.108/cgi-bin/configManager.cgi?action=setConfig&AudioOutputVolume[0]=80&AudioOut
putVolume[1]=50

Set Config Response Example
OK

4.3.6 Getting the Analysis Configurations of the Specified Audio

Channel

Get the analysis configurations of the specified audio channel.

Request URL http://<server>/cgi-bin/api/AudioAnalyseManager/getConfig

Method

POST

Parameter
Format

JSON format in body

Name

Type

Required

Description

Example

General APIs 42

0

0

"12345678"

Preset. The field is valid
when the analysis channel
is specified. When there
are no fields, the default
preset is 0, and the field
can be empty for IPC.
When the preset is -1, all
the preset configurations
will be returned.

Audio channel number.
When there are no signs
indicating that the audio
source is from the Internet,
then the AudioChannel
means the local channel
number. When using the
number, it must be linked
with logical audio channel
through channel number
or other fields. If it fails to
link, the API will be failed
to return.

Device ID. It is mainly
used in the back-end
cascade scenes, and if
there are no special
requirements, it will not be
used in front-end devices.

PresetID

int32

O

AudioChannel

int32

O

DeviceID

char[128] O

Complete Example

{

}

"PresetID": 0,
"AudioChannel": 0,
"DeviceID": "12345678"

Response Params ( JSON format in body )

Name

Type

Required

Description

Example

Configuratio
n

+AudioChan
nel

object

O

uint32

O

Analysis configuration of
audio channel

Audio channel number.
When there are no signs
indicating that the audio

0

General APIs 43

source is from the
Internet, then the
AudioChannel means
the local channel
number.

+Rules

object[]

O

Analysis rule

++Class

char[64] O

Rule category

"<ClassType>"

++Type

char[64] O

Rule type

"<RuleType>"

++Id

uint

O

0

Rule ID. The field can be
0, which means the
system will automatically
allocate the appropriate
ID. If there are
businesses that bonds
the rule ID, the client will
be responsible for
ensuring that the code
and the name are
unique.

++Name

char[64] O

Rule name

++Enable

bool

++PresetID

uint32

++EventHan
dler

object

+++TimeSec
tion

char[8][6]
[20]

O

O

O

O

+++RecordE
nable

bool

O

Enable the rules

Preset spots

Rule linkage items

Alarm period

Enable recording, with
RecordChannels.
Record is enabled if it is
true; start recording
when the event action is
start and stop recording
when it is stop. Record is
disabled if it is false.

"..."

true

0

[["1
00:00:00-08:00:00",
"1
10:00:00-24:00:00",]
]

true

+++RecordC
hannels

int[]

O

Recording channel
number list

[0, 1, 2]

One-dimensional array.

General APIs 44

+++RecordL
atch

int

O

+++AlarmOu
tEnable

bool

+++AlarmOu
tChannels

int[]

O

O

+++AlarmOu
tLatch

int

O

+++Snapsho
tEnable

bool

+++Snapsho
tChannels

int[]

O

O

+++MailEna
ble

bool

O

+++Dejitter

int

O

Each member indicates
that the corresponding
channel needs to record,
and the channel number
starts from 0.

Recording delay time
(second)
Range [10, 300]

10

Enable alarm output

true

[1, 4]

Alarm output channel
number list
One-dimensional array.
Each member indicates
that the corresponding
channel needs to output
alarm, and the channel
number starts from 0.

10

Output delay time
(second) after the alarm
output stops. Range: [1,
300]

Enable snapshot

true

Snapshots channel
number list

[2, 4]

One-dimensional array.
Each member indicates
that the corresponding
channel needs to take
snapshot, and the
channel number starts
from 0.

Send emails. If there are
images, the images will
be sent as email
attachment.

Dejitter time. The field is
only meaningful for part
of the start or stop type
events. Unit: Second (0
s–600 s). It can only be

true

0

General APIs 45

used for applications to
automatically tour the
detected events, such as
motion detection and
tampering. The similar
intelligent events that
reported by the algorithm
database such as
tripwire and face
detection cannot
configure dejitter time.

Buzzer

Set the delay time for the
event to take effect. Unit:
second [0-300].

Expands alarm output
channel list
One-dimensional array.
Each member indicates
that the corresponding
channel needs to output
extension alarm, and the
channel number starts
from 0.

true

30

[2, 3]

Enable expand alarm
output

true

PTZ illuminator linkage
item

Enable

true

Flicker light type
enumchar[32]{
"WhiteLight": indicates
the flashing light is white
light
"RedBlueLight":
indicates the flashing
light is red and blue light
}

Light linkage way
enumchar[32]{
"Filcker": flicker (by

"WhiteLight"

"Filcker"

+++BeepEn
able

bool

+++Delay

uint

O

O

+++ExAlarm
OutChannels

int[]

O

+++ExAlarm
OutEnable

+++LightingL
ink

bool

O

object

O

++++Enable

bool

++++FilckerL
ightType

enumcha
r[32]

O

O

++++LightLin
kType

enumcha
r[32]

O

General APIs 46

++++FilckerI
ntevalTime

float

O

++++Filcker
Times

int

O

++++LightDu
ration

uint

O

++++LightBri
ght

uint

O

+++LogEnab
le

bool

O

+++LogRem
ote

bool

O

5

5

10

50

false

false

defaut)
"KeepLighting": solid on
}

Flicker interval
Unit: 0.1 s, and the
default value is 0.5 s.

The flicker times that can
be configured.
Unit: times, and the
default value is 5.

The duration time of the
flicker or normally
lighting. Unit: second.

Brightness of the linkage
light.
The range refers to the
capacity of
LinkLightBrightRange. If
this item does not exist,
the default brightness
will be adopted.

Whether to record alarm
logs (Includes local and
remote logs). The type is
fixed to
EventStart/EventStop/Ev
entPulse and the original
event type is recorded in
the Detail.Code field in
the log.

Whether to record
remote logs. The type is
fixed as
EventStart/EventStop/Ev
entPulse and the original
event type is recorded in
the Detail.Code field in
the log. (When
LogRemote and
LogEnable exist at the
same time, the remote
log records will use the
data from LogRemote).

General APIs 47

+++MMSEn
able

bool

+++MatrixCh
annels

int[]

+++MatrixEn
able

bool

+++Message
Enable

bool

O

O

O

O

+++PtzLink

object[][] O

Enable sending MMS

false

[1, 6]

true

true

[ ["Preset", 3, 0, 0,
0], ["Tour", 4, 0, 0,
1], ["Pattern", 1, 0,
0, 2] ]

Link with video matrix
channels number

Enable linkage video
matrix

Whether to upload the
message to the alarm
central server. Alarm
center does not need to
log in to the device, and
the device itself can
directly send the
message to alarm
center.

PTZ linkage. It is a
two-dimensional array,
each member indicates a
linkage item, and the last
item indicates channel
number. Each linkage
item includes 5
components including
linkage type, three
relating parameters and
the PTZ channel it linked
with.
Linkage types include:
"Preset": linkage preset;
"Tour": linkage tour；
"Pattern" : linkage mode;
"Zoom” : linkage zoom
"SingleScene”: link with
single scene. (The
second linkage
parameter indicates the
scene number, and the
third linkage parameter
indicates the stay time of
the scene after the alarm
finished, the fourth
linkage parameter
indicates reserve the
parameter and the fifth

General APIs 48

linkage parameter
indicates the PTZ
channel it linked with.
"QuickFocus”: the
thermal imaging PTZ
links with quick focus
function (the second one
indicates the zoom of the
thermal imaging
channel), and its value
ranges from 0 to 24. The
third parameter indicates
the stay time and the
fourth indicates reserve
the parameter. If it is a
positive value, then it
means zoom in, and the
fifth parameter indicates
the PTZ channel number
it linked with.
“None” can be empty or
none, which is used for
compatibility.

Enable PTZ linkage

true

3

5

Frame interval. It means
the number of frames it
takes to capture one
image, and in a certain
period of time, the
number of images
depends on the
capturing frame rate.
0 indicates it takes
multiple snapshots
continuously.

Times of continuous
snapshot. When
SnapshotEnable is true,
snapshortTimes=0
means the device will
continuously take
snapshots until the
event ends.

+++PtzLinkE
nable

bool

+++Snapsho
tPeriod

int

O

O

+++Snapsho
tTimes

int

O

General APIs 49

+++VoiceEn
able

bool

O

Voice prompts

true

+++Voice

object

O

++++Channe
ls

int[]

O

++++AudioFi
leName

char[256] O

++++PlayTi
mes

uint

++++LinkTim
e

uint

O

O

++++Interval uint

O

++Config

object

O

Linkage prompted by
voice

The channel number that
the audio prompts
playing.

[1, 2]

"/mnt/alarm.g711a"

3

30

30

Absolute path of the
linkage audio file. It can
be an empty string. If it
is, it means the default
alarm linkage voice that
specified by Sound.
AlarmSound. “Null”
means no audio linkage.

Playing times of the
linkage audio.

The playing time of the
linkage audio. Unit:
second

The playing interval of
the sound, and the
default value is 0. Unit:
second.

The specific
configuration of rule, and
the corresponding
configuration depends
on the value of Type. For
more information, please
see
AudioAnalyseRule(<Rul
eType>).

+Global

object

O

Global

configuration. This field
has no relationship with
PTZ position.

++ClassList

char[32][ 64]

O

The valid intelligent
business

["<ClassType1>","<
ClassType2>"]

++Module

object

O

Business configuration.

General APIs 50

The field name indicates
the business name. For
the detailed
configuration, please see
AudioAnalyseModule(<C
lassType>).

Sound detection
business

Sound intensity
threshold, and it ranges
from [1,100]

50

Other universal or
non-service related
global configurations.

Scene configuration

Preset ID

0

Valid intelligent business

["<ClassType1>","<
ClassType2>"]

Refer to the module
under“Global”

Other universal or
non-service related
scene configurations.

Analysis status of audio
channel

1

0 : not support

1 : support

+++SmartSo
undDetect

++++Thresh
old

object

O

uint32

O

++Detail

object

O

+Scene

object[]

++PresetID

uint

++ClassList

char[32][ 64]

O

O

O

++Module

object

O

++Detail

object

O

+State

uint32

O

Complete Example

{

"Config": {

"AudioChannel": 0,
"Global": {

"ClassList": [],
"Detail": null,
"Module": null

},
"Rules": [
{

"Class": "SmartSoundDetect",
"Config": {

General APIs 51

"Sensitive": 5,
"TimesThreshold": 2,
"Types": [

"AudioCrashingGlass",
"AudioScream",
"AudioGunshot",
"AudioExplosion"

]

},
"Enable": false,
"EventHandler": {

"TourEnable": false,
"VoiceEnable": false,
...

},
"Id": 1,
"Name": "SmartSoundDetect",
"PresetID": 0,
"Type": "SmartSoundDetect"

}

],
"Scene": [
{

"ClassList": [],
"Detail": null,
"Module": {

"SmartSoundDetect": {
"Threshold": 50

}

},
"PresetID": 0

}

],
"State": 1

}

}

4.3.7 Setting the Analysis Configuration of the Specified Audio

Channel

Configure the analysis configuration of the specified audio channel. We recommend you to use it in
combination with getConfig. http://<server>/cgi-bin/api/AudioAnalyseManager/getConfig

Request
URL

http://<server>/cgi-bin/api/AudioAnalyseManager/setConfig

General APIs 52

Method

POST

Parameter
Format

key=value format at URL

Name

Type

Required Description

Example

For the detailed content,
please see getConfig to
request for the returned
value.
http://<server>/cgi-bin/api/Au
dioAnalyseManager/getConfi
g

Audio channel number. When
there are no signs indicate
that the audio source is from
the Internet, then the
AudioChannel means the
local channel number. When
using the number, it must be
linked with logical audio
channel through channel
number or other fields. If fails
to link, the API will be failed to
return.

Device ID. It mainly used in
the back-end cascade
scenes, and if there are no
special requirements, it will
not be used in front-end
devices.

0

"12345678"

Config

object

R

AudioChann
el

int32

O

DeviceID

char[64] O

Complete Example

{

"AudioChannel": 0,
"DeviceID": "12345678",
"Config": {

"AudioChannel": 0,
"Global": {

"ClassList": [],
"Detail": null,
"Module": null

},
"Rules": [
{

General APIs 53

"Class": "SmartSoundDetect",
"Config": {

"Sensitive": 6,
"TimesThreshold": 1,
"Types": [

"AudioCrashingGlass",
"AudioScream",
"AudioGunshot",
"AudioExplosion"

]

},
"Enable": false,
"EventHandler": {

"TourEnable": false,
"VoiceEnable": false,
...

},
"Id": 1,
"Name": "SmartSoundDetect",
"PresetID": 0,
"Type": "SmartSoundDetect"

}

],
"Scene": [
{

"ClassList": [],
"Detail": null,
"Module": {

"SmartSoundDetect": {
"Threshold": 50

}

},
"PresetID": 0

}

],
"State": 1

}

}

Response Params ( JSON format in body )

Name

Type

R/O

Description

Example

Response Example

{}

General APIs 54

4.3.8 Getting the Related Business Configuration of the Specified

Audio Channel

Get the relating business configuration of the specified audio channel.

Request
URL

http://<server>/cgi-bin/api/AudioAnalyseManager/getClassConfig

Method

POST

Parameter
Format

key=value format at URL

Name

Type

Required Description

Example

Class

char[64] R

Audio analysis business

"<ClassType>"

PresetID

int32

O

AudioChann
el

int32

O

0

0

Preset. If it is empty, the
default value 0 is taken and
the field can be empty for
IPC.

Audio channel number. When
there are no signs indicating
that the audio source is from
the Internet, then the
AudioChannel means the
local channel number. When
using the number, it must be
linked with logical audio
channel through channel
number or other fields. If it
fails to link, the API will be
failed to return.

DeviceID

char[128] O

Device ID. It mainly used

"12345678"

in the back-end cascade
scenes, and if there are no
special requirements, it will
not be used in front-end
devices.

Complete Example

{
"Class": "SmartSoundDetect",
"PresetID": 0,
"AudioChannel": 0,
"DeviceID": "12345678"

General APIs 55

}

Response Params ( JSON format in body )

Name

Type

Required Description

Example

Config

object

+Rules

object[]

O

O

++Class

char[64] O

Rule category

"<ClassType>"

++Type

char[64] O

Rule type

"<RuleType>"

++Id

uint

O

0

Rule ID. It can be 0, which
means the system will
automatically allocate the
appropriate ID. If there are
businesses that bonds the
rule ID, the client will be
responsible for ensuring that
the code and the name are
unique.

++Name

char[64] O

Rule name

++Enable

bool

++PresetID

uint32

++EventHan
dler

object

+++TimeSec
tion

char[8][6]
[20]

O

O

O

O

Enable the rules

Preset spots

Rule linkage ltems

Alarm period

+++RecordE
nable

bool

O

Enable recording, with
RecordChannels. Record is
enabled if it is true; start
recording when the event
action is start and stop
recording when it is stop.
Record is disabled if it is
false.

"..."

true

0

[["1
00:00:00-08:00:00",
"1
10:00:00-24:00:00",]
]

true

+++RecordC
hannels

int[]

O

Recording channel number
list
One-dimensional array. Each

[0, 1, 2]

General APIs 56

+++RecordL
atch

int

O

+++AlarmOu
tEnable

bool

+++AlarmOu
tChannels

int[]

O

O

+++AlarmOu
tLatch

int

O

+++Snapsho
tEnable

bool

+++Snapsho
tChannels

int[]

O

O

+++MailEna
ble

bool

O

+++Dejitter

int

O

member indicates that the
corresponding channel needs
to record, and the channel
number starts from 0.

Recording delay time
(second)
Range [10, 300]

10

Enable alarm output

true

[1, 4]

Alarm output channel number
list
One-dimensional array. Each
member indicates that the
corresponding channel needs
to output alarm, and the
channel number starts from 0.

Output delay time (second)
after the alarm output stops.
Scope [1,300]

10

Enable snapshot

true

[2, 4]

true

0

Snapshot channel number list
One-dimensional array. Each
member indicates that the
corresponding channel needs
to take snapshot, and the
channel number starts from 0.

Send emails. If there are
images, the images will be
sent as email attachment.

Dejitter time. The field is only
meaningful for part of the
start or stop type events. Unit:
Second (0 s–600 s). It can
only be used for applications
to automatically tour the
detected events, such as
motion detection and
tampering. The similar
intelligent events that

General APIs 57

+++BeepEn
able

bool

+++Delay

uint

O

O

+++ExAlarm
OutChannels

int[]

O

reported by the algorithm
database such as tripwire
and face detection cannot
configure dejitter time.

Buzzer:

true

[2, 3]

Set the delay time for the
event to take effect. Unit:
second [0-300].

Expands alarm output
channel list
One-dimensional array. Each
member indicates that the
corresponding channel needs
to output extension alarm,
and the channel number
starts from 0.

+++ExAlarm
OutEnable

+++LightingL
ink

bool

O

Enable alarm output
extension

true

object

O

PTZ illuminator linkage item

++++Enable

bool

++++FilckerL
ightType

enumcha
r[32]

O

O

++++LightLin
kType

enumcha
r[32]

O

++++FilckerI
ntevalTime

float

O

++++Filcker
Times

int

O

Enable

true

Flicker light type
enumchar[32]{
"WhiteLight": indicates the
flashing light is white light
"RedBlueLight": indicates the
flashing light is red and blue
light
}

Light linkage way
enumchar[32]{
"Filcker": flicker (by defaut)
"KeepLighting": solid on
}

Flicker interval
Unit: 0.1s, and the default
value is 0.5 s.

The flicker times that can be
configured.
Unit: times, and the default

"WhiteLight"

"Filcker"

5

5

General APIs 58

++++LightDu
ration

uint

O

++++LightBri
ght

uint

O

+++LogEnab
le

bool

O

+++LogRem
ote

bool

O

+++MMSEn
able

bool

+++MatrixCh
annels

int[]

+++MatrixEn
able

bool

+++Message
Enable

bool

O

O

O

O

10

50

false

false

value is 5.

The duration time of the
flicker or normally lighting.
Unit: second.

Brightness of the linked light
The range refers to the
capacity of
LinkLightBrightRange. If this
item does not exist, the
default brightness will be
adopted.

Whether to record alarm logs.
The type is fixed to
EventStart/EventStop/EventP
ulse and the original event
type is recorded in the
Detail.Code field in the log.

Whether to record remote
logs. The type is fixed as
EventStart/EventStop/EventP
ulse and the original event
type is recorded in the
Detail.Code field in the log.
(When LogRemote and
LogEnable exist at the same
time, the remote log records
will use the data from
LogRemote).

Enable sending MMS

false

Link with video matrix
channels number

[1, 6]

Enable linkage video matrix

true

true

Whether to upload the
message to the alarm central
server. Alarm center does not
need to log in to the device,
and the device itself can
directly send the message to
alarm center.

General APIs 59

+++PtzLink

object[][] O

[ ["Preset", 3, 0, 0,
0], ["Tour", 4, 0, 0,
1], ["Pattern", 1, 0,
0, 2] ]

PTZ linkage. It is a
two-dimensional array, each
member indicates a linkage
item, and the last item
indicates channel number.
Each linkage item includes 5
components including linkage
type, three relating
parameters and the PTZ
channel it linked with.

Linkage types include:

"Preset": linkage preset;

"Tour": linkage tour；

"Pattern" : linkage mode.

"Zoom” : linkage zoom

"SingleScene”: link with
single scene. (The second
linkage parameter indicates
the scene number, and the
third linkage parameter
indicates the stay time of the
scene after the alarm
finished, the fourth linkage
parameter indicates reserve
the parameter and the fifth
linkage parameter indicates
the PTZ channel it linked
with.

"QuickFocus”: the thermal
imaging PTZ links with quick
focus function (the second
one indicates the zoom of the
thermal imaging channel),
and its value ranges from 0 to 24. The third parameter
indicates the stay time and
the fourth indicates reserve
the parameter. If it is a
positive value, then it means
zoom in, and the fifth
parameter indicates the PTZ
channel number it linked with.

“None” can be empty or
none, which is used for

General APIs 60

+++PtzLinkE
nable

bool

+++Snapsho
tPeriod

int

O

O

+++Snapsho
tTimes

int

O

+++VoiceEn
able

bool

+++Voice

object

++++Channe
ls

int[]

O

O

O

++++AudioFi
leName

char[256] O

++++PlayTi
mes

uint

++++LinkTim
e

uint

++++Interval uint

O

O

O

++Config

object

O

compatibility.

Enable PTZ linkage

true

3

5

Frame interval. It means the
number of frames it takes to
capture one image, and in a
certain period of time, the
number of images depends
on the capturing frame rate.
0 indicates it takes multiple
snapshots continuously.

Times of continuous
snapshot. When
SnapshotEnable is true,
snapshortTimes=0 means the
device will continuously take
snapshots until the event
ends.

Voice prompts

true

Audio Linkage

Channel

[1, 2]

"/mnt/alarm.g711a"

3

30

30

Absolute path of the linkage
audio file. It can be an empty
string. If it is, it means the
default alarm linkage voice
that specified by Sound.
AlarmSound. “Null” means no
audio linkage.

Play times of the linkage
audio.

The playing time of the
linkage audio. Unit: second

The playing interval of the
sound, and the default value
is 0. Unit: second.

The specific configuration of
rule, and the corresponding
configuration depends on the

General APIs 61

value of Type. For more
information, please see
AudioAnalyseRule(<RuleTyp
e>).

The specific business
configuration, and its value
refer to the "request" section.
For more information, please
see
AudioAnalyseModule(<Class
Type>)

Universal configuration of the
global business

The business universal
configuration of the current
preset

Preset ID

0

+Module

object

O

+Global

object

++Detail

object

O

O

+Scene

object

O

++PresetID

uint32

++Detail

object

O

O

Complete Example

{

"Config": {

"Global": {

"Detail": null

},
"Module": {

"Threshold": 50

},
"Rules": [
{

"Class": "SmartSoundDetect",
"Config": {

"Sensitive": 6,
"TimesThreshold": 1,
"Types": [

"AudioCrashingGlass",
"AudioScream",
"AudioGunshot",
"AudioExplosion"

]

},
"Enable": false,

General APIs 62

"EventHandler": {

"TourEnable": false,
"VoiceEnable": false,
...

},
"Id": 1,
"Name": "SmartSoundDetect",
"PresetID": 0,
"Type": "SmartSoundDetect"

}

],
"Scene": {

"Detail": null

}

}

}

4.3.9 Configuring the Related Business Configuration of the Specified

Audio Channel

Configure the analysis configuration of the specified audio channel. We recommend you to use it in
combination with getConfig. http://<server>/cgi-bin/api/AudioAnalyseManager/getConfig

Request
URL

http://<server>/cgi-bin/api/AudioAnalyseManager/setClassConfig

Method

POST

Parameter
Format

key=value format at URL

Name

Type

Required Description

Example

Configuratio
n

object

R

For the detailed content,
please see getConfig to
request for the returned
value.
http://<server>/cgi-bin/api/A
udioAnalyseManager/getCo
nfig

Class

char[64] R

Audio analysis business

"<ClassType>"

AudioChann
el

int32

O

0

Audio channel number.
When there are no signs
indicate that the audio
source is from the Internet,
then the AudioChannel
means the local channel

General APIs 63

number. When using the
number, it must be linked
with logical audio channel
through channel number or
other fields. If fails to link,
the API will be failed to
return.

Device ID. It is mainly used
in the back-end cascade
scenes, and if there are no
special requirements, it will
not be used in front-end
devices.

"12345678"

Preset. When there are no
fields, the default preset is
0, and the field can be
empty for IPC.

0

DeviceID

char[128] O

PresetID

int32

O

Complete Example

{

"Config": {

"Global": {

"Detail": null

},
"Module": {

"Threshold": 50

},
"Rules": [
{

"Class": "SmartSoundDetect",
"Config": {

"Sensitive": 6,
"TimesThreshold": 1,
"Types": [

"AudioCrashingGlass",
"AudioScream",
"AudioGunshot",
"AudioExplosion"

]

},
"Enable": false,
"EventHandler": {

"TourEnable": false,
"VoiceEnable": false,
...

},

General APIs 64

"Id": 1,
"Name": "SmartSoundDetect",
"PresetID": 0,
"Type": "SmartSoundDetect"

}

],
"Scene": {

"Detail": null

}

},
"Class": "SmartSoundDetect",
"AudioChannel": 0,
"DeviceID": "12345678",

                "PresetID": 0

}

Response Params ( JSON format in body )

Name

Type

R/O

Description

Example

Response Example

{}

4.3.10 AudioAnalyseRule Config

4.3.10.1 AudioAnalyseRule(SmartSoundDetect)

Name

Types

Type

R/O Description

char[32][32]

R

Sound Type
enumchar[][32]{
"AudioCry"
"AudioAlarm"
"AudioGunshot"
"AudioExplosion"
"AudioScream"
"AudioCrashingGlass"
}

Example

["AudioCry"]

Sensitive

uint32

TimesThreshold uint32

O

O

Detection sensitivity, range [1,10]

Times threshold, range [1, 5]

5

2

4.3.11 AudioAnalyseModule Config

4.3.11.1 AudioAnalyseModule(SmartSoundDetect)

Name

Type

R/O Description

Example

General APIs 65

Threshold

uint32

O

Sound intensity threshold, range [1,
100]

50

4.3.12 Play the Specified Audio in the Device

Request URL

http://<server>/cgi-bin/api/Speak/startPlayByTime

Method

POST

Request Params ( JSON format in body )

R/O Description

Audio file path

Audio file name

Example

"/Audio_Path"

"alarm.wav"

times of broadcasts, default once

1

R

R

O

Name

Path

FileName

PlayTimes

Type

string

string

int32

Request Example

{
"Path":"/Audio_Path",
"FileName":"alarm.wav",
"PlayTimes":1
}

Response Params (JSON format in body )

Name

Status

Example

"OK"

Type

R/O Description

enumcha
r[32]

R

enumchar[32]{
"OK": indicates that the operation
is successful and returns before
the end of the broadcast, which is
different from API "PostAudio"
"Busy": Indicates that the device is
broadcasting
"Error": Broadcast error
}

Response Example

{
"Status" : "OK"
}

4.4 Snapshot

4.4.1 [Config] Snap

Snapshot configuration parameters:

Config Data Params

General APIs 66

Example
[80,50]

false

[ [ "6 00:00:00-23:
59:59", "0 00:00:
00-23:59:59","0 0
0:00:00-23:59:59"
, "0 00:00:00-23:5
9:59", … ] ]

Name

Snap

Type

object[]

R/O Description
R

One element for each channel, and the
array index represents the channel
number which starts from 0.

+HolidayEnable

bool

TimeSection

char[8][2 4][32]

the period of capturing

O Whether holiday setting is supported.
It is not supported by default.
Configure
snapshots.
Two-dimensional array in strings.
The first dimension of the array is the day
of the week, and the range is [0–7]
(Sunday–Saturday). The last item is for
holiday.
The second dimension is the period
index. One day is divided into multiple
periods, and the range is [0–23].
Each period is set as a string in the
format of:mask hh: mm: ss-hh: mm: ss
Mask: The range is [0–4294967295], and
each bit carries a special meaning. See
the description as follows:
hh: Hour; range: [0–24]
mm: Minute; range: [0–59]
ss: Description; ranges [0 to 59]
Mask: record type.
Meaning of each bit:
Bit0: Normal snapshot
Bit1: Motion detection snapshot
Bit2: Alarm snapshot
Bit3: Card-swiping snapshot
Bit6: POS snapshot
Bit4, Bit5, Bit7–Bit31: Reserved.

Please refer to "4.2.1 Get and Set Configure" for configuration getting and setting. Specific
examples are as follows :

Get Config Request Example
http://192.168.1.108/cgi-bin/configManager.cgi?action=getConfig&name=Snap

Get Config Response Example
table.Snap[0].HolidayEnable=true
table.Snap[0].TimeSection[0][0]=6 00:00:00-23:59:59
table.Snap[0].TimeSection[0][1]=0 00:00:00-23:59:59
…
table.Snap[1].HolidayEnable=false
table.Snap[1].TimeSection[0][1]=0 00:00:00-23:59:59
table.Snap[1].TimeSection[0][1]=0 00:00:00-23:59:59
…

General APIs 67

Set Config Request Example
http://192.168.1.108/cgi-bin/configManager.cgi?action=setConfig&Snap[0].HolidayEnable=true&Snap
[0].TimeSection[0][0]=6 00:00:00-23:59:59&Snap[0].TimeSection[0][1]=0 00:00:00-23:59:59&Snap[1].
HolidayEnable=false&Snap[1].TimeSection[0][1]=0 00:00:00-23:59:59&Snap[1].TimeSection[0][1]=0 0
0:00:00-23:59:59

Set Config Response Example
OK

4.4.2 Get a Snapshot

Get snapshots of a specified video channel

http://<server>/cgi-bin/snapshot.cgi
GET

Request URL
Method
Request Params ( key=value format in URL )
Name
channel

R/O Description
O

Type
int

type

uint32

O

Video channel number starting from 1, and the default
value is 1.
0: Acquire the snapshot from the front end
1: Represent capture of local real-time video
secondary decoding encoding
Default 0

Example
1

0

Request Example
http://192.168.1.108/cgi-bin/snapshot.cgi?channel=1&type=0

Response Params ( binary in body )
<binary data>: images in JPEG format
Response Example
HTTP/1.1 200 OK
Server: Device/1.0
Content-Type: image/jpeg
Content-Length:<image size>

<jpeg data>

4.4.3 Subscribe to Snapshot

Subscribe to the events and event snapshots. For details on the event name and parameters, see
the corresponding [Event] sections.

http://<server>/cgi-bin/snapManager.cgi?action=attachFileProc
GET

Request URL
Method
Request Params ( key=value format in URL )
Name
channel

R/O Description
O

Type
int

Video channel number, starting from 1.
If not specified, the default value is 1.
-1 means subscribing to all channels.
Heartbeat interval.

heartbeat

int

O

Example
1

5

General APIs 68

Flags

char[][32] R

Events

char[][32] R

"Event"

[ "VideoMotion" ,
"TrafficJunction" ]

Unit: s
Range: [1–60], and the default value is 5.
While sending the events, the device
regularly sends a heartbeat message to keep
itself alive.
The message is a string named "heartbeat".
Subscription parameter.
The value "Event" should be included.
The list of event codes
Select All to subscribe all events
Common event codes are as follows:
VideoMotion: Motion detection
VideoLoss: Video loss
VideoBlind: Video Tampering
AlarmLocal: Local alarms
TrafficJunction: ANPR
TrafficRetrograde: Wrong-way driving
TrafficParking: Illegal parking
TrafficJam: Traffic congestion
TrafficThrow: Throwing out of the vehicle
TrafficPedestrain: A pedestrian walks onto a
motor vehicle lane
TrafficParkingSpaceParking: A vehicle is in
the parking space
TrafficParkingSpaceNoParking: No vehicle is
in the parking space
TrafficParkingSpaceOverLine: A
crosses the line of a parking space
TrafficManualSnap: Manual
capturing
FaceRecognition: Face recognition
Parking
TrafficParkingStatistics:
counting
AccessControl: Access control unlocking
…

snapshot

vehicle

space

Request Example
http://192.168.1.108/cgi-bin/snapManager.cgi?action=attachFileProc&channel=1&heartbeat=5&Flags[0]
=Event&Events=[VideoMotion%2CVideoLoss]

Response Params ( multipart in body )
Name
Events
Channel

Type
object[] R
O
int

R/O Description

+EventBaseInfo
++Code

object
R
char[32] R

Event detail array
The video channel number of the generated
picture, starting from 0.
Shared basic information for all events
Event code

Example

0

“”FaceReco

General APIs 69

++Action

char[16] R

++Index

int

+…

…

…

See the description on Events
Event action
Value: "Start", "Stop" and "Pulse"
The channel number where the event happens,
starting from 0
Unique parameters of each event
For details on each event, see the corresponding
section.

gnition“”
"Pulse"

0

Response Example
HTTP/1.1 200 OK
Server: Device/1.0
Content-Type: multipart/x-mixed-replace; boundary=<boundary>
Connection: closed

--<boundary>
Content-Type: text/plain
Content-Length: <data length>

Events[0].Channel=0
Events[0].EventBaseInfo.Code=TrafficJunction
Events[0].EventBaseInfo.Action=Pulse
Events[0].EventBaseInfo.Index=0
Events[0].CountInGroup=3
Events[0].IndexInGroup=1
Events[0].Lane=1
Events[0].PTS=42949485818.0
Events[0].TrafficCar.PlateNumber=ZZZ12345
Events[0].TrafficCar.DeviceAddress=XXXRoad
……
Events[1].Channel=1
Events[1].EventBaseInfo.Code=TrafficJunction
Events[1].EventBaseInfo.Action=Pulse
Events[1].EventBaseInfo.Index=1
Events[1].CountInGroup=3
Events[1].IndexInGroup=2
Events[1].Lane=1
……
--<boundary>
Content-Type: image/jpeg
Content-Length:<image size>

<JPEG image data>
--<boundary>
Content-Type: text/plain
Content-Length:<data length>

Heartbeat

General APIs 70

--<boundary>
……

4.5 Video Attributes

4.5.1 Get Max Extra Stream Numbers

Get the maximum number of sub streams

http://<server>/cgi-bin/magicBox.cgi?action=getProductDefinition
GET

Request URL
Method
Request Params ( key=value format in URL )
Name
name

Type
char[]

R/O Description
Name
R
Fixed value: MaxExtraStream

Example
"MaxExtraStream"

Request Example
http://192.168.1.108/cgi-bin/magicBox.cgi?action=getProductDefinition&name=MaxExtraStream

Response Params ( key=value format in body )
Type
Name
object
table

R/O Description
R

+MaxExtraStream

int

R

Response Example
table.MaxExtraStream=1

Return content
The maximum number of sub streams
Values: 1, 2 and 3.

4.5.2 Get Encode Capability

Get encoding capabilities.

http://<server>/cgi-bin/encode.cgi?action=getCaps
GET

Request URL
Method
Request Params ( key=value format in URL )
Name
Request Example
http://192.168.1.108/cgi-bin/encode.cgi?action=getCaps

R/O Description

Type

Example

1

Example

Response Params ( key=value format in body )
Type
Name
object
caps
int
+MaxExtraStream
+PreviewSplitNum
List
+PlaybackCompre
ssSplitNumList

R/O Description
R
O

int[]

int[]

O

O

+PreviewMode

char[16] O

Encoding capability
Maximum number of sub stream channels
The live view page can be split to multiple
windows
Secondary compressed playback supports
being split to multiple windows.
Multi-window live view mode.
Values:

Example

3
[1, 4, 9, 16]

[1, 4, 9, 16]

"SplitEncode"

General APIs 71

SplitEncode: Split encoding mode
SnapShot: Fast snapshot mode
SplitSnap: Split fast snapshot mode
If the field does not exist or is null, it means the
device does not support multi-window live
view.
Encoding capability
Each element of the array represents a
channel.
Whether independent resolution for snapshots
is supported
Whether independent resolutions for motion
detection and alarm videos are supported.
CIF maximum value of the P frame.
Unit: Kbits
CIF minimum value of the P frame.
Unit: Kbits
Display capability of mixed exposure.
Each element of the array represents a
channel.
Supported display mode:
0: Default
1: Vehicle mode
2: Person mode

true

true

40

7

[0,1,2]

+VideoEncodeDe
vices

++SupportIndividu
alResolution
++RecordIndividu
alResolution
++MaxCIFPFrame
Size
++MinCIFPFrame
Size

object[] O

bool

bool

int

int

O

O

O

O

+CoriaDisplay

object[] O

++CoriaDisplaySw
itchs

int[]

O

Response Example
caps.MaxExtraStream=3
caps.PreviewSplitNumList[0]=1
caps.PreviewSplitNumList[1]=4
caps.PreviewSplitNumList[2]=9
caps.PlaybackCompressSplitNumList[0]=1
caps.PlaybackCompressSplitNumList[1]=4
caps.PlaybackCompressSplitNumList[2]=9
caps.PreviewMode=SplitSnap
caps.VideoEncodeDevices[0].SupportIndividualResolution=true
caps.VideoEncodeDevices[0].RecordIndividualResolution=true
caps.VideoEncodeDevices[0].MaxCIFPFrameSize=40
caps.VideoEncodeDevices[0].MinCIFPFrameSize=7
caps.CoriaDisplay[0].CoriaDisplaySwitchs[0]=0
caps.CoriaDisplay[0].CoriaDisplaySwitchs[1]=1
caps.CoriaDisplay[0].CoriaDisplaySwitchs[2]=2

4.5.3 Get Encode Config Capability

Get encoding configuration capabilities

Request URL
Method
Request Params ( key=value format in URL )

http://<server>/cgi-bin/encode.cgi?action=getConfigCaps
GET

General APIs 72

Name
channel

Type
int

R/O Description
O

Video channel number.
It an integer starting from 1.
When the channel does not exist, the default
number is 1.
The encoding configurations set before will
influence the encoding configurations of
other channels and streams.
Main stream.
Each element of the array represents a
recording type.
0: General encoding
1: Motion detection encoding
2: Alarm encoding
Video format
Video encoding mode
For example, "MPEG4", "H.264", "H.265"
Video width
Unit: pixels
Video height
Unit: pixels
Video stream
Unit: kbps
Sub stream
Each element of the array represents a sub
stream.
0: Sub stream 1
1: Sub stream 2
2: Sub stream 3
Video format
Video encoding mode
For example, "MPEG4", "H.264", "H.265"
Video width
Unit: pixels
Video height
Unit: pixels
Video stream
Unit: kbps

Example

"H.264"

1920

1080

2048

"H.264"

720

576

512

Encode

object[] O

+MainFormat

object[] O

++Video
+++Compressi
on
+++Width

+++Height

+++BitRate

object
O
char[16] O

int

int

int

O

O

O

+ExtraFormat

object[] O

++Video
+++Compressi
on
+++Width

+++Height

+++BitRate

object
O
char[16] O

int

int

int

O

O

O

Request Example
http://192.168.1.108/cgi-bin/encode.cgi?action=getConfigCaps&channel=1&Encode[0].MainFormat[0].V
ideo.Compression=H.264&Encode[0].MainFormat[0].Video.Width=1920&Encode[0].MainFormat[0].Vide
o.Height=1080

Response Params ( key=value format in body )
Type
Name
object
caps

R/O Description
R

Encoding configuration capability

Example

General APIs 73

+MainFormat

object[] O

++Audio
+++CompressionT
ypes

object
char[]

++Video
+++CompressionT
ypes

object
char[]

O
O

O
O

+++ResolutionTyp
es
+++BitRateOption
s

char[]

O

char[]

O

+++FPSMax

int

O

+ExtraFormat

object[] O

Audio In
+++CompressionT
ypes

object
char[]

++Video
+++CompressionT
ypes

object
char[]

O
O

O
O

+++ResolutionTyp
es
+++BitRateOption
s

char[]

O

char[]

O

+++FPSMax

int

O

+SnapFormat

object[] O

Main stream.
Each element of the array represents a
recording type.
0: General encoding
1: Motion detection encoding
2: Alarm encoding
Audio encoding capability
Supported audio encoding formats: PCM,
ADPCM, G.711A, G.711Mu, G.726, G.729,
MPEG2, AMR, and SVAC.
Video encoding capability
Supported vidio encoding formats: MPEG4,
MPEG2, MPEG1, MJPG, H.263, H.264 and
H.265.
Supported video resolutions.
See the table below for the optional values.
Stream capability
Two numbers are divided by a comma. The
former number represents the minimal stream,
and the latter represents the maximum
stream.
Unit: kbps
Maximum frame rate
Sub stream.
Each element of the array represents a sub
stream.
0: Sub stream 1
1: Sub stream 2
2: Sub stream 3
Audio encoding capabilities
Supported audio encoding formats: PCM,
ADPCM, G.711A, G.711Mu, G.726, G.729,
MPEG2, AMR, and SVAC.
Video encoding capability
Supported video encoding formats: MPEG4,
MPEG2, MPEG1, MJPG, H.263, H.264 and
H.265.
Supported video resolutions.
See the table below for the options.
Stream capability
Two numbers are divided by a comma. The
former number represents the minimal stream,
and the latter represents the maximum
stream. Unit: kbps
Maximum frame rate:
Snapshot encoding capability
Each element of the array represents a

G.711A, AMR

MPEG4,
H.264, H.265

D1, 1920x1080

80,448

25

G.711A, AMR

MPEG4,
H.264, H.265

D1, 1280x720

80,448

25

General APIs 74

snapshot capturing type.
0: General snapshot
1: Motion detection snapshot
2: Alarm snapshot
Snapshot format
Supported encoding formats
For example, "JPEG"
Supported video resolutions
See the table below for the options.
Maximum frame rate

++Video
+++CompressionT
ypes
+++ResolutionTyp
es
+++FPSMax

object
O
char[16] O

int

int

O

O

JPEG

D1, 1280x720

2

Response Example
caps.MainFormat[0].Audio.CompressionTypes=G.711A, AMR
caps.MainFormat[0].Video.CompressionTypes=H.264,MJPG
caps.MainFormat[0].Video.ResolutionTypes=2048 x 1536,1080,SXGA, 1280 x 960,720,D1,CIF
caps.MainFormat[0].Video.BitRateOptions=448,2560
caps.MainFormat[0].Video.FPSMax=25
caps.ExtraFormat[0].Audio.CompressionTypes=G.711A, AMR
caps.ExtraFormat[0].Video.CompressionTypes=H.264,MJPG
caps.ExtraFormat[0].Video.ResolutionTypes=2048 x 1536,1080,SXGA, 1280 x 960,720,D1,CIF
caps.ExtraFormat[0].Video.BitRateOptions=448,2560
caps.ExtraFormat[0].Video.FPSMax=25
caps.SnapFormat[0].Video.CompressionTypes=JPEG
caps.SnapFormat[0].Video.ResolutionTypes=2048 x 1536,1080,SXGA, 1280 x 960,720,D1,CIF
caps.SnapFormat[0].Video.FPSMax=2

Appendix A: Video Resolution

Fixed Resolution Name

Size in PAL

Size in NTSC

"D1"

"HD1"

"BCIF"/"2CIF"

"CIF"

"QCIF"

"NHD"

"VGA"

"QVGA"

"SVCD"

"QQVGA"

"SVGA"

"SVGA1"

"WVGA"

"FWVGA"

"DVGA"

"XVGA"

"WXGA"

"WXGA2"

"WXGA3"

704 x 576

352 x 576

704 x 288

352 x 288

176 x 144

640 x 360

640 x 480

320 x 240

480 x 480

160 x 128

800 x 592

800 x 600

800 x 480

854 x 480

960 x 640

1024 x 768

1280 x 800

1280 x 768

1280 x 854

704 x 480

352 x 480

704 x 240

352 x 240

176 x 120

—

—

—

—

—

—

—

—

—

—

—

—

—

—

General APIs 75

Fixed Resolution Name

"WXGA4"

"SXGA"

"SXGA+"

"WSXGA"

"UXGA"

"WUXGA"

"ND1"

"720P"

"1080P"

"QFHD"

Size in PAL

1366 x 768

1280 x 1024

1400 x 1050

1600 x 1024

1600 x 1200

1920 x 1200

240 x 192

1280 x 720

1920 x 1080

3840 x 2160

"1_3M", "1280x960"

1280 x 960 (1.3 Mega Pixels)

"2_5M", "1872x1408"

1872 x 1408 (2.5 Mega Pixels)

"5M", "3744x1408"

"3M", "2048x1536"

"5_0M", "2432x2048"

"1_2M", "1216x1024"

"1408x1024"

"3296x2472"

3744 x 1408 (5 Mega Pixels)

2048 x 1536 (3 Mega Pixels)

2432 x 2048 (5 Mega Pixels)

1216 x 1024 (1.2 Mega Pixels)

1408 x 1024 (1.5 Mega Pixels)

3296 x 2472 (8 Mega Pixels)

"5_1M", "2560x1920"

2560 x 1920 (5 Mega Pixels)

Size in NTSC

—

—

—

—

—

—

—

—

—

—

—

—

—

—

—

—

—

—

—

"960H",

"DV720P"

"2560x1600"

"2336x1752"

"2592x2048"

"2448x2048"

"1920x1440"

"2752x2208"

"3840x2160"

"4096x2160"

"3072x2048"

960 x 576

960 x 720

2560 x 1600 (4 Mega Pixels)

2336 x 1752 (4 Mega Pixels)

2592 x 2048

2448 x 2048

1920x1440

2752x2208

3840x2160

4096x2160

3072x2048

960 x 480

—

—

—

—

—

—

—

—

—

—

4.5.4 [Config] Encode of Media

 Get encode config

Table 4-1

Syntax

Method

http://<server>/cgi-bin/configManager.cgi?action=getConfig&name=Encode

GET

Description

Get video encode config.

Example

http://192.168.1.108/cgi-bin/configManager.cgi?action=getConfig&name=Encode

Success
Return

table.Encode[0].MainFormat[0].Audio.Bitrate=64
table.Encode[0].MainFormat[0].Audio.Channels[0]=0
table.Encode[0].MainFormat[0].Audio.Compression=G.711A
table.Encode[0].MainFormat[0].Audio.Depth=16

General APIs 76

table.Encode[0].MainFormat[0].Audio.Frequency=8000
table.Encode[0].MainFormat[0].Audio.Mode=0
table.Encode[0].MainFormat[0].Audio.Pack=PS
table.Encode[0].MainFormat[0].AudioEnable=true
table.Encode[0].MainFormat[0].Video.resolution=1920x1080
table.Encode[0].MainFormat[0].Video.BitRate=4096
table.Encode[0].MainFormat[0].Video.BitRateControl=CBR
table.Encode[0].MainFormat[0].Video.Compression=H.264
table.Encode[0].MainFormat[0].Video.CustomResolutionName=1080P
table.Encode[0].MainFormat[0].Video.FPS=18
table.Encode[0].MainFormat[0].Video.GOP=36
table.Encode[0].MainFormat[0].Video.Height=1080
table.Encode[0].MainFormat[0].Video.Pack=PS
table.Encode[0].MainFormat[0].Video.Profile=High
table.Encode[0].MainFormat[0].Video.Quality=4
table.Encode[0].MainFormat[0].Video.QualityRange=6
table.Encode[0].MainFormat[0].Video.SVCTLayer=1
table.Encode[0].MainFormat[0].Video.Width=1920
table.Encode[0].MainFormat[0].Video.Priority=0
table.Encode[0].MainFormat[0].VideoEnable=true
table.Encode[0].MainFormat[1].Audio.Bitrate=64
table.Encode[0].MainFormat[1].Audio.Channels[0]=0
table.Encode[0].MainFormat[1].Audio.Compression=G.711A
table.Encode[0].MainFormat[1].Audio.Depth=16
table.Encode[0].MainFormat[1].Audio.Frequency=8000
table.Encode[0].MainFormat[1].Audio.Mode=0
table.Encode[0].MainFormat[1].Audio.Pack=PS
table.Encode[0].MainFormat[1].AudioEnable=true
table.Encode[0].MainFormat[1].Video.resolution=1920x1080
table.Encode[0].MainFormat[1].Video.BitRate=4096
table.Encode[0].MainFormat[1].Video.BitRateControl=CBR
table.Encode[0].MainFormat[1].Video.Compression=H.264
table.Encode[0].MainFormat[1].Video.CustomResolutionName=1080P
table.Encode[0].MainFormat[1].Video.FPS=18
table.Encode[0].MainFormat[1].Video.GOP=36
table.Encode[0].MainFormat[1].Video.Height=1080
table.Encode[0].MainFormat[1].Video.Pack=PS
table.Encode[0].MainFormat[1].Video.Profile=High
table.Encode[0].MainFormat[1].Video.Quality=4
table.Encode[0].MainFormat[1].Video.QualityRange=6
table.Encode[0].MainFormat[1].Video.SVCTLayer=1
table.Encode[0].MainFormat[1].Video.Width=1920
table.Encode[0].MainFormat[1].Video.Priority=0
table.Encode[0].MainFormat[1].VideoEnable=true
table.Encode[0].MainFormat[2].Audio.Bitrate=64
table.Encode[0].MainFormat[2].Audio.Channels[0]=0
table.Encode[0].MainFormat[2].Audio.Compression=G.711A

General APIs 77

table.Encode[0].MainFormat[2].Audio.Depth=16
table.Encode[0].MainFormat[2].Audio.Frequency=8000
table.Encode[0].MainFormat[2].Audio.Mode=0
table.Encode[0].MainFormat[2].Audio.Pack=PS
table.Encode[0].MainFormat[2].AudioEnable=true
table.Encode[0].MainFormat[2].Video.resolution=1920x1080
table.Encode[0].MainFormat[2].Video.BitRate=4096
table.Encode[0].MainFormat[2].Video.BitRateControl=CBR
table.Encode[0].MainFormat[2].Video.Compression=H.264
table.Encode[0].MainFormat[2].Video.CustomResolutionName=1080P
table.Encode[0].MainFormat[2].Video.FPS=18
table.Encode[0].MainFormat[2].Video.GOP=36
table.Encode[0].MainFormat[2].Video.Height=1080
table.Encode[0].MainFormat[2].Video.Pack=PS
table.Encode[0].MainFormat[2].Video.Profile=High
table.Encode[0].MainFormat[2].Video.Quality=4
table.Encode[0].MainFormat[2].Video.QualityRange=6
table.Encode[0].MainFormat[2].Video.SVCTLayer=1
table.Encode[0].MainFormat[2].Video.Width=1920
table.Encode[0].MainFormat[2].Video.Priority=0
table.Encode[0].MainFormat[2].VideoEnable=true
table.Encode[0].MainFormat[3].Audio.Bitrate=64
table.Encode[0].MainFormat[3].Audio.Channels[0]=0
table.Encode[0].MainFormat[3].Audio.Compression=G.711A
table.Encode[0].MainFormat[3].Audio.Depth=16
table.Encode[0].MainFormat[3].Audio.Frequency=8000
table.Encode[0].MainFormat[3].Audio.Mode=0
table.Encode[0].MainFormat[3].Audio.Pack=PS
table.Encode[0].MainFormat[3].AudioEnable=true
table.Encode[0].MainFormat[3].Video.resolution=704x576
table.Encode[0].MainFormat[3].Video.BitRate=2048
table.Encode[0].MainFormat[3].Video.BitRateControl=VBR
table.Encode[0].MainFormat[3].Video.Compression=H.264
table.Encode[0].MainFormat[3].Video.FPS=25
table.Encode[0].MainFormat[3].Video.GOP=50
table.Encode[0].MainFormat[3].Video.Height=576
table.Encode[0].MainFormat[3].Video.Pack=PS
table.Encode[0].MainFormat[3].Video.Profile=Main
table.Encode[0].MainFormat[3].Video.Quality=4
table.Encode[0].MainFormat[3].Video.QualityRange=6
table.Encode[0].MainFormat[3].Video.SVCTLayer=1
table.Encode[0].MainFormat[3].Video.Width=704
table.Encode[0].MainFormat[3].Video.Priority=0
table.Encode[0].MainFormat[3].VideoEnable=true
table.Encode[0].ExtraFormat[0].Audio.Bitrate=64
…
table.Encode[0].SnapFormat[0].Audio.Bitrate=64

General APIs 78

…

Parameters in Response:
The format of the config is head.configItems. The head can be:
headMain= table. Encode[Channel].MainFormat[Type]
headSnap = table. Encode[Channel].SnapFormat[Type]
headExtra =table. Encode[Channel].ExtraFormat[ExtraStream]

Comment

Channel: integer, array index starts from 0, which means video channel (equals to video
channel index -1, and so 0 means channel 1).
Type:
0 = regular encode
1 = motion detection encode
2 = alarm encode
3= emergency encode
ExtraStream:
0 = extra stream 1
1 = extra stream 2
2 = extra stream 3
The configItems are list as bellow.

 Set encode config

Table 4-2

Syntax

http://<server>/cgi-bin/configManager.cgi?action=setConfig&<paramName>=<paramV
alue>[&<paramName>=<paramValue>...]

Method

GET

Description

Set encode config.

Example

Success
Return

Comment

http://192.168.1.108/cgi-bin/configManager.cgi?action=setConfig&Encode[1].MainForm
at[0].Video.Compression=MPEG4&

OK

Parameters in URL:
In table below,
head=Encode[Channel].MainFormat[RecordType] (or)
Encode[Channel].ExtraFormat[ExtraStream]

Channel: integer, array index starts from 0, which means video channel(equals to video
channel index -1, and so 0 means channel 1).
RecordType:
0 = regular record
1 = motion detection record
2 = alarm record
ExtraStream:
0 = extra stream 1
1 = extra stream 2
2 = extra stream 3

Appendix A: Video Encode Config

General APIs 79

ParamName

ParamValue type Description

head.Video.BitRate

integer

Unit is Kbps
Range depends on capability in GetVideoConfigCaps

head.Video.BitRateControl string

head.Video.Compression

String

head.Video.FPS

float

head.Video.GOP

integer

Range is {CBR, VBR}
CBR: constant bitrates
VBR: variable bitrates

Range is {MPEG4, MPEG2, MPEG1, MJPG, H.263,
H.264, H.265, SVAC2}
Depends on capacity in GetVideoConfigCaps

Frames per second.
<1.0: several seconds/frame, FPS=0.3333: 3 seconds
per frame.

> 1.0: several frames/second. FPS=3: 3 frames per
> second.
> Range depends on capability in GetVideoConfigCaps
> Range is [1—100].
> Group of picture, it's the interval of I Frame,
> Example: GOP=50, means there is one I frame every
> 49 P or B frames

head.Video.Height

head.Video.Width

integer

integer

Video height

Video Width

head.Video.Profile

String

head.Video.Quality

integer

head.Video.Priority

integer

Range is { Baseline, Main , Extended , High }
Only when video compression is H.264, it's effective.
Range is [1—6].
Image Quality, available when
Video.BitRateControl=VBR
1: worst quality
6: best quality

Range is 0 or 1
0 for Image Quality first
1 for Bitstream first

head.VideoEnable

bool

True: enable video

Appendix B: Audio Encode Config

ParamName

ParamValue type Description

head.Audio.Bitrate

integer

head.Audio.Compression

string

head.Audio.Depth

head.Audio.Frequency

integer

integer

Unit is kbps
Range depends on capacity in
GetAudioConfigCaps

Range depends on capacity in
GetAudioConfigCaps

Audio sampling depth

Audio sampling frequency

General APIs 80

ParamName

ParamValue type Description

head.Audio.Mode

integer

Range is {0,1,2,3,4,5,6,7}
Audio encode mode.
0: 4.75kbps,
1: 5.15 kbps,
2: 5.9 kbps,
3: 6.7 kbps,
4: 7.4 kbps,
5: 7.95 kbps,
6: 10.2 kbps,
7: 12.2 kbps,

head.AudioEnable

bool

Enable/Disable audio

4.5.5 [Config] Encode of Region Interested

 Get encode config of region interested

Table 4-3

Syntax

Method

http://<server>/cgi-bin/configManager.cgi?action=getConfig&name=VideoEncodeROI

GET

Description

Get video encode config of region interested.

Example

http://192.168.1.108/cgi-bin/configManager.cgi?action=getConfig&name=VideoEncode
ROI

Success
Return

head.Regions[0][0]=0
head.Regions[0][1]=0
head.Regions[0][2]=0
head.Regions[0][3]=0
head.Regions[1][0]=0
…
head.Quality=4,
head.Main=true,
head.Extra1=true,
head.Extra2=true,
head.Extra3=true,
head.Snapshot=true
head.DynamicTrack=true,
head.DynamicDelayTime=60

Comment

Parameters in Response:
head=table.VideoEncodeROI[ChannelNo]
ChannelNo: integer, array index starts from 0, which means video channel (equals to
video channel index -1, and so 0 means channel 1).

 Set encode config of region interested

Syntax

http://<server>/cgi-bin/configManager.cgi?action=setConfig&<paramName>=<paramV

Table 4-4

General APIs 81

alue>[&<paramName>=<paramValue>…]

Method

GET

Description

Set video encode config of region interested.

Example

Success
Return

Comment

http://192.168.1.108/cgi-bin/configManager.cgi?action=setConfig&VideoEncodeROI[0].
DynamicTrack=true

OK

Parameters in URL:
paramName and paramValue are as table below.
In table below,
head = VideoEncodeROI[ChannelNo]
ChannelNo: integer, array index starts from 0, which means video channel(equals to
video channel index -1, and so 0 means channel 1).

Appendix:

ParamName

ParamValue type

Description

head. DynamicTrack

bool

Enable/Disable

4.5.6 [Config] Channel Title

Channel title configuration parameters:

Config Data Params
Name

Type

ChannelTitle

object[]

+Name

char[]

R

R/O Description
Array
One element for each channel, and the
array index represents the channel
number which starts from 0.
The content represented in the form of
string.
'|' means line change, and up to two
lines are supported.

R

Example

"CAM1|123"

Please refer to "4.2.1 Get and Set Configure" for configuration getting and setting. Specific
examples are as follows :

Get Config Request Example
http://192.168.1.108/cgi-bin/configManager.cgi?action=getConfig&name=ChannelTitle

Get Config Response Example
table.ChannelTitle[0].Name=CAM1|123
table.ChannelTitle[1].Name=CAM2|456
…

Set Config Request Example
http://192.168.1.108/cgi-bin/configManager.cgi?action=setConfig&ChannelTitle[0].Name=CAM1|123&C
hannelTitle[1].Name=CAM2|456

Set Config Response Example
OK

General APIs 82

4.5.7 Get Video Input Channels Device Supported

Table 4-5

Syntax

Method

http://<server>/cgi-bin/devVideoInput.cgi?action=getCollect

GET

Description

Get the video input channel numbers.

Example

Success
Return

http://192.168.1.108/cgi-bin/devVideoInput.cgi?action=getCollect

result=1

Comment

—

4.5.8 Get Video Output Channels Device Supported

Table 4-6

Syntax

Method

http://<server>/cgi-bin/devVideoOutput.cgi?action=getCollect

GET

Description

Get the video output channel numbers.

Example

Success
Return

http://192.168.1.108/cgi-bin/devVideoOutput.cgi?action=getCollect

result=2

Comment

—

4.5.9 Get Max Remote Input Channels

Table 4-7

Syntax

http://<server>/cgi-bin/magicBox.cgi?action=getProductDefinition&name=MaxRemoteI
nputChannels

Method

GET

Description

Get max remote input channels.

Example

Success
Return

http://192.168.1.108/cgi-bin/magicBox.cgi?action=getProductDefinition&name=MaxRe
moteInputChannels

table.MaxRemoteInputChannels=16

Comment

MaxRemoteInputChannels: max remote input channels.

4.5.10 [Config] Video Standard

 Get video standard

Syntax

Method

http://<server>/cgi-bin/configManager.cgi?action=getConfig&name=VideoStandard

GET

Table 4-8

General APIs 83

Description

Get video standard config.

Example

Success
Return

http://192.168.1.108/cgi-bin/configManager.cgi?action=getConfig&name=VideoStandar
d

table.VideoStandard=PAL

Comment

—

 Set video standard

Table 4-9

Syntax

http://<server>/cgi-bin/configManager.cgi?action=setConfig&VideoStandard=<paramV
alue>

Method

GET

Description

Set video standard config.

Example

Success
Return

http://192.168.1.108/cgi-bin/configManager.cgi?action=setConfig&VideoStandard=PAL

OK

Comment

VideoStandard: string, range is {PAL, NTSC} Video Standard.

4.5.11 [Config] Video Widget

 Get video widget config

Syntax

Method

Description

Example

Success
Return

Table 4-10

http://<server>/cgi-bin/configManager.cgi?action=getConfig&name=VideoWidget

GET

Video widget config contains Channel Title, User-defined Title, Covers and Time Title
parameters, defines the background color, front color and positions of channel title and
time title, User-defined title and defines the regions which are not visible (cover).

http://192.168.1.108/cgi-bin/configManager.cgi?action=getConfig&name=VideoWidget

head.BackColor[0]=0
head.BackColor[1]=0
head.BackColor[2]=0
head.BackColor[3]=128
head.EncodeBlend=true
head.FrontColor[0]=255
head.FrontColor[1]=255
head.FrontColor[2]=255
head.FrontColor[3]=0
head.Rect[0]=0
head.Rect[1]=8191
head.Rect[2]=0
head.Rect[3]=8191
…

Comment

Parameters in Response:
head=table.VideoWidget[Channel].ChannelTitle (or)

General APIs 84

table.VideoWidget[Channel].Covers[CoReg] (or)
table.VideoWidget[Channel].TimeTitle
table.VideoWidget[Channel].UserDefinedTitle[Index]

Channel: integer, array index starts from 0, which means video channel (equals to
video channel index -1, and so 0 means channel 1).
CoReg: Cover Region, Covers is an array which sustains multi- Cover regions
0 = region 1
1 = region 2
2 = region 3
3 = region 4

Index: integer, User-defined title index, now only index 0 is valid, others are reserved.

 Set video widget config

Table 4-11

Syntax

http://<server>/cgi-bin/configManager.cgi?action=setConfig&<paramName>=<paramV
alue>[&<paramName>=<paramValue>…]

Method

GET

Description

Set video widget config.

Example

Success
Return

Comment

http://192.168.1.108/cgi-bin/configManager.cgi?action=setConfig&VideoWidget[1].Cov
ers[0].BackColor[0]=128&VideoWidget[1].Covers[0].BackColor[1]=128&VideoWidget[1]
.Covers[0].BackColor[2]=128&VideoWidget[1].Covers[0].BackColor[3]=0

OK

Parameters in URL:
In table below,
headChannelTitle = VideoWidget[Channel].ChannelTitle
headCover = VideoWidget[Channel].Covers[CoReg]
headTimeTitle = VideoWidget[Channel].TimeTitle
headUserDefinedTitle = VideoWidget[Channel].UserDefinedTitle[Index]

Channel: integer, array index starts from 0, which means video channel(equals to video
channel index -1, and so 0 means channel 1).
CoReg: Cover region index. Covers is an array which contains multiple cover regions
0 = region 1
1 = region 2
2 = region 3
3 = region 4

Index: integer, User-defined title index, now only index 0 is valid, others are reserved.

Appendix:

ParamName

ParamValue type

Description

General APIs 85

ParamName

ParamValue type

headCover.BackColor[0]
headCover.BackColor[1]
headCover.BackColor[2]
headCover.BackColor[3]

integer

headCover.EncodeBlend

bool

headCover.FrontColor[0]
headCover.FrontColor[1]
headCover.FrontColor[2]
headCover.FrontColor[3]

headCover.Rect[0]
headCover.Rect[1]
headCover.Rect[2]
headCover.Rect[3]

headChannelTitle.BackColor[0]
headChannelTitle.BackColor[1]
headChannelTitle.BackColor[2]
headChannelTitle.BackColor[3]

integer

integer

integer

Description
Range is [0—255].
BackColor[0]:red value
BackColor[1]:green value
BackColor[2]:blue value
BackColor[3]: alpha value

false - widget blend is not enabled.
Range is [0—255].
FrontColor[0]:red value
FrontColor[1]:green value
FrontColor[2]:blue value
FrontColor[3]: alpha value
Range is [0—8191].
Rect[0]: top left corner x coordinate (left)
Rect[1]: top left corner y coordinate (top)
Rect[2]: bottom right x coordinate (right)
Rect[3]: bottom
right y coordinate
(bottom)

headChannelTitle.EncodeBlend

bool

Range is the same with headCover.

headChannelTitle.FrontColor[0]
headChannelTitle.FrontColor[1]
headChannelTitle.FrontColor[2]
headChannelTitle.FrontColor[3]

headChannelTitle.Rect[0]
headChannelTitle.Rect[1]
headChannelTitle.Rect[2]
headChannelTitle.Rect[3]

integer

integer

headUserDefinedTitle.Text

string

headUserDefinedTitle.TextAlign

integer

headUserDefinedTitle.BackColor[0]
headUserDefinedTitle.BackColor[1]
headUserDefinedTitle.BackColor[2]
headUserDefinedTitle.BackColor[3]

integer

headUserDefinedTitle.EncodeBlend bool

headUserDefinedTitle.FrontColor[0]
headUserDefinedTitle.FrontColor[1]
headUserDefinedTitle.FrontColor[2]
headUserDefinedTitle.FrontColor[3]

integer

headUserDefinedTitle.Rect[0]

integer

Only use the value of (left, top),the value
of (right, bottom) is the same as (left,
top)
Rect[0], Rect[1] are used, and Rect[2]
must be same with Rect[0], Rect[3] must
be same with Rect[1].

Title content. Character
newlines.
Limit: Support 2 lines at most.

'|' means

Range is the same with
headChannelTitle
These are configs about User-defined
title.

General APIs 86

ParamName

ParamValue type

Description

headUserDefinedTitle.Rect[1]
headUserDefinedTitle.Rect[2]
headUserDefinedTitle.Rect[3]

headTimeTitle.BackColor[0]
headTimeTitle.BackColor[1]
headTimeTitle.BackColor[2]
headTimeTitle.BackColor[3]

integer

headTimeTitle.EncodeBlend

bool

headTimeTitle.FrontColor[0]
headTimeTitle.FrontColor[1]
headTimeTitle.FrontColor[2]
headTimeTitle.FrontColor[3]

headTimeTitle.Rect[0]
headTimeTitle.Rect[1]
headTimeTitle.Rect[2]
headTimeTitle.Rect[3]

integer

integer

Range is the same with
headChannelTitle.
These are configs about time title.

headTimeTitle.ShowWeek

bool

True: Display week within the time title.

4.5.12 Get Video Input Capability

Table 4-12

Syntax

Method

http://<server>/cgi-bin/devVideoInput.cgi?action=getCaps&channel=<ChannelNo>

GET

Description

Get video input capabilities.

Example

http://192.168.1.108/cgi-bin/devVideoInput.cgi?action=getCaps&channel=1

Success
Return

caps.AutoSyncPhase=false
caps.Backlight=2
caps.BrightnessCompensation=true
caps.ChipID=0
caps.CoverCount=4
caps.CoverType=1
caps.CustomManualExposure=true
caps.DayNightColor=true
caps.DayNightColorIO=false
caps.DoubleExposure=0
caps.DownScaling=false
caps.EEModeRange=100
caps.ElectricFocus=false
caps.Exposure=16
caps.ExposureMode=31
caps.ExternalSyncInput=false
caps.FishEye=false
caps.FlashAdjust=false
caps.Flip=true
caps.FormatCount=5

General APIs 87

caps.Gain=true
caps.GainAuto=true
caps.Gamma=true
caps.GammaModeRange=100
caps.GlareInhibition=1
caps.HorizontalBinning=0
caps.IRCUT=true
caps.ImageEnhancement.LevelRange[0]=0
caps.ImageEnhancement.LevelRange[1]=100
caps.ImageEnhancement.Support=true
caps.InfraRed=true
caps.Iris=true
caps.IrisAuto=true
caps.LadenBitrate=972000
caps.LimitedAutoExposure=true
caps.MaxExposureTime=300.0
caps.MaxExposureTime1=0.0
caps.MaxHeight=1080
caps.MaxMultiProfile=3
caps.MaxWidth=1920
caps.MeteringRegionCount=0
caps.MinExposureTime=1.0
caps.MinExposureTime1=0.0
caps.Mirror=true
caps.MultiOptions=false
caps.NightOptions=true
caps.ReferenceLevel=false
caps.Rotate90=true
caps.SetColor=true
caps.SignalFormats=Inside
caps.SignalType[0]=VGA
caps.SnapshotExposure=false
caps.SupportProfile=false
caps.SupportWhiteLevel=true
caps.SupportWriteLevel=false
caps.SyncChipChannels=false
caps.SyncFocus=false
caps.TitleCount=4
caps.TridimDenoise=2
caps.TridimDenoiseDetails=0
caps.UTC=0
caps.UpScaling=false
caps.Version=0
caps.VerticalBinning=0
caps.VideoInDenoise.2D.LevelRange[0]=0
caps.VideoInDenoise.2D.LevelRange[1]=100
caps.VideoInDenoise.2D.Support=true

General APIs 88

caps.VideoInDenoise.3D.3DAutoType.ModRange[0]=0
caps.VideoInDenoise.3D.3DAutoType.ModRange[1]=100
caps.VideoInDenoise.3D.Support=true
caps.VideoInDenoise.Support=true
caps.WhiteBalance=3
caps.WideDynamicRange=1

Parameters in URL:
ChannelNo: integer, video channel index which starts from 1.
Parameters in Response:
see table below

Comment

Appendix:

Field in response

Value type Description

Backlight

ChipID

CoverCount

integer

String

integer

CoverType

integer

CustomManualExposur
e

DayNightColor

DownScaling

Exposure

ExternalSyncInput

FlashAdjust

Flip

Gain

GainAuto

bool,

bool

bool

integer

bool

bool

bool

bool

bool

HorizontalBinning

integer

VerticalBinning

integer

InfraRed

Iris

IrisAuto

bool

bool

bool

LadenBitrate

integer

0: not support backlight ;
1: support backlight;
2: support regional regulation

ID of chips in this channel

The maximum cover region count.

0: don't support cover
1: support realtime cover
2: support non-realtime cover

true: support use defined manual exposure time

true: support color alternate between day and night.

true: support down scaling, binning mode not included.
Exposure grade. 0 — don't support exposure control.
true: support HD signal external synchronization.

true: support flash adjust

true: support picture flip.

true: support gain control.

true: support auto gain.

Horizontal/Vertical pixel binning mask,
1 — support 2 pixel binning,
2 — support 3 pixel binning
4 — support 4 pixel binning
…
2^n — support n+2 pixel binning
true: support Infra compensation

true: support Iris adjust

true: support auto Iris adjust

Unit is Kbps.
Maximum value of video stream bitrates, 16bpp, not in
binning mode.

LimitedAutoExposure

bool

true: support auto exposure with time limit.

MaxExposureTime

MaxExposureTime1

double

double

upper limit of exposure time, unit: ms

upper limit of exposure time, unit: ms

General APIs 89

Field in response

Value type Description

MaxHeight

MaxWidth

MinExposureTime

MinExposureTime1

Mirror

NightOptions

ReferenceLevel

Rotate90

SetColor

integer

integer

double

double

bool

bool

bool

bool

bool

SignalFormats

string

SyncChipChannels

bool

Maximum video height

Maximum video width

lower limit of exposure time, unit: ms

lower limit of exposure time, unit: ms

true: support picture mirror.

true: support night options.

true: support reference level.
true: support clockwise/anticlockwise 90°rotate
true: support color set.

It's a string contains supported video input signal formats
for this channel. Signal formats are separated by comma.
Range is {Inside, BT656, 720p, 1080p, 1080i, 1080sF,
1_3M}

Inside — inside input.
1_3M — 1280\*960
True: channels in same chip should be synchronized.
Synchronized means video resolution of these channels
should be the same.

TitleCount

UpScaling

integer

bool

Maximum count of blending titles.

true: support up scaling.

WhiteBalance

integer

Range is {0, 1, 2, 3}
0: don't support white balance.
1: support auto white balance
2: support auto and pre defined white balance.
3: support auto, pre defined and user defined white
balance

4.5.13 Get Coordinates of Current Window

Table 4-13

Syntax

http://<server>/cgi-bin/devVideoInput.cgi?action=getCurrentWindow&channel=<Chann
elNo>

Method

GET

Description

Get the coordinates of the current window.

Example

http://192.168.1.108/cgi-bin/devVideoInput.cgi?action=getCurrentWindow&channel=1

Success
Return

Comment

rect[0]=500
rect[1]=500
rect[2]=5000
rect[3]=5000

Parameters in URL:
ChannelNo: integer, video channel index which starts from 1.
Parameters in Response:
rect[n] : relative coordinates, range is 0-8192.{0,0,0,0} top-left,

General APIs 90

{8192,0,0,0} top-right, {0,8192,0,0} bottom-left, {8192,8192,0,0} bottom-right

4.5.14 Set Coordinates of Current Window

Table 4-14

Syntax

http://<server>/cgi-bin/devVideoInput.cgi?action=setCurrentWindow&channel=<Chann
elNo>&rect[0]=<rect0>&rect[1]=<rect1>&rect[2]=<rect2>&rect[3]=<rect3>

Method

GET

Description

Set the coordinates of the current window.

Example

Success
Return

Comment

http://192.168.1.108/cgi-bin/devVideoInput.cgi?action=setCurrentWindow&channel=1&
rect[0]=0&rect[1]=0&rect[2]=5000&rect[3]=5000

OK

Parameters in URL:
ChannelNo: integer, video channel index which starts from 1.
rect0 & rect1 & rect2 & rect3: relative coordinates, range is 0-8192.{0,0,0,0} top-left,
{8192,0,0,0} top-right, {0,8192,0,0} bottom-left, {8192,8192,0,0} bottom-right

4.5.15 [Config] Video Out

 Get video out config

Table 4-15

Syntax

Method

http://<server>/cgi-bin/configManager.cgi?action=getConfig&name=VideoOut

GET

Description

Get video out config.

Example

http://192.168.1.108/cgi-bin/configManager.cgi?action=getConfig&name=VideoOut

Success
Return

head.Margin[0]=0
head.Margin[1]=0
head.Margin[2]=0
head.Margin[3]=0
head.Color.Brightness=50
head.Color. Contrast =50
head.Color. Satuation =50
head.Color. Hue =50
head.Mode. Width =800
head.Mode. Height=600
head.Mode. BPP =16
head.Mode. Format ="Auto"
head.Mode. RefreshRate =60
…

Comment

Parameters in Response:
head = table.VideoOut[ChannelNo].
ChannelNo: integer, array index starts from 0, which means video channel (equals to
video channel index -1, and so 0 means channel 1).

General APIs 91

 Set video out config

Table 4-16

Syntax

http://<server>/cgi-bin/configManager.cgi?action=setConfig&<paramName>=<paramV
alue>[&<paramName>=<paramValue>…]

Method

GET

Description

Set video out config.

Example

Success
Return

Comment

http://192.168.1.108/cgi-bin/configManager.cgi?action=setConfig&table.VideoOut[1].Co
lor.Brightness=50

OK

Parameters in URL:
In table below,
head = table.VideoOut[ChannelNo].
ChannelNo: integer, array index starts from 0, which means video channel (equals to
video channel index -1, and so 0 means channel 1).

Appendix:

ParamName

head. Margin[0]
head. Margin[1]
head. Margin[2]
head. Margin[3]

ParamValue type Description

integer

Margin.

head. Color.Brightness

head. Color.Contrast =50

head.Color.Satuation =50

head. Color.Hue =50

head. Mode.Width =800
head. Mode.Height=600

integer

integer

integer

integer

integer

Brightness.

Contrast.

Satuation.

Hue.

Resolution.

head. Mode.BPP =16

integer

Bits per pixel.

head.Mode.Format="Auto"

string

range

is
The
"SPOT","SDI", "HDMI/VGA"}.

{"Auto","TV","VGA","DVI","HDMI",

head.Mode.RefreshRate=60

integer

Refresh rate.

4.5.16 [Config] Smart Encode

 Get Smart Encode config

Table 4-17

Syntax

Method

http://<server>/cgi-bin/configManager.cgi?action=getConfig&name=SmartEncode

GET

Description

Get smart encode config.

Example

Success
Return

http://192.168.1.108/cgi-bin/configManager.cgi?action=getConfig&name=SmartEncode

head.Enable=false
head.Extra[0]=false

General APIs 92

Comment

Parameters in Response:
head = table.SmartEncode[ChannelNo].
ChannelNo: integer, array index starts from 0, which means video channel (equals to
video channel index -1, and so 0 means channel 1).

 Set Smart Encode config

Syntax

http://<server>/cgi-bin/configManager.cgi?action=setConfig&<paramName>=<paramV
alue>[&<paramName>=<paramValue>…]

Table 4-18

Method

GET

Description

Set smart encode config.

Example

Success
Return

Comment

Appendix:

ParamName

head.Enbale

head.Extra[0]

http://192.168.1.108/cgi-bin/configManager.cgi?action=setConfig&SmartEncode[0].Ena
ble=true

OK

Parameters in URL:
In table below,
head = SmartEncode[ChannelNo].
ChannelNo: integer, array index starts from 0, which means video channel(equals to
video channel index -1, and so 0 means channel 1).

ParamValue type Description

bool

bool

Open or close the smart encode of the main stream.

Open or close the smart encode of the extra stream.

4.5.17 Get Decoder Caps

URL

Method

http://<server>/cgi-bin/DevVideoDec.cgi?action=getCaps

GET

Description

Get capability of decoder

[ Request Params ] (None )

[ Response Params ] (key=value format)

Name

Video

Type

object

R/O Param Description

R

The video caps

+StreamType

array<string> R

+LadenBitrate

int

R

[ Example ]

The stream types that the device supports, ex : h264, h265
etc.

The maximum decoding capability that the device supports
(w _ h _ FPS * 16)/1024, uint: kbps, ex : 7680*4320*30*8/1024
= 7776000

Request

GET http://192.168.1.108/cgi-bin/DevVideoDec.cgi?action=getCaps

Response

Video.StreamType[0]=h264
Video.StreamType[1]=h265
Video.LadenBitrate=7776000

General APIs 93

4.5.18 [Config] PrivacyMasking

 Get privacy masking config

Syntax

Method

http://<server>/cgi-bin/configManager.cgi?action=getConfig&name=PrivacyMasking

GET

Description

Get privacy masking setting

[ Request Params ] (None )

[ Response Params ] (key=value format)

R/O

Param Description

Name

table

Type

object

+PrivacyMasking

Array<Array<object>

>

++Enable

bool

++Postion

Array<double>

++ShapeType

string

++Rect

Array<int>

R

R

R

O

O

O

++Polygon

Array<Array<int>>

O

++Color

Array<int>

++Mosaic

int

O

O

Config info table.

PrivacyMasking config, each channel has several
masking region

Enable/Disable

Size is 3
Postion[0] is horizontal angle, range is [-1—1]
Postion[1] is vertical angel, range is [-1—1]
Postion[2] is zoom, range is [ 0—1]
Shape type,can be: “Rect”, “Polygon”

It is valid if ShapeType is Rect , top left and bottom
right point, each point has x and y value, oordinate
remap to 0 — 8192.
It is valid if ShapeType is Polygon
the first array is point list, minimum item is 3, the
second array is point, must be two int, means x and
y value, coordinate remap to 0 — 8192.
Mask color, RGBA color, 4 integer range is 0-255

Mosaic type, Range is {0, 8, 16, 24, 32}
0: no mosaic
8: mosaic size 8*8
16: mosaic size 16*16
24: mosaic size 24*24
32: mosaic size 32*32

++ViewAngle

double

O

View angle, range is [0.0, 360.0], unit: degree

[ Example ]

Request

http://192.168.1.108/cgi-bin/configManager.cgi?action=getConfig&name=PrivacyMaskin
g

General APIs 94

Response

table.PrivacyMasking[0][0].Enable=true
table.PrivacyMasking[0][0].Postion[0]=0.0
table.PrivacyMasking[0][0].Postion[1]=0.0
table.PrivacyMasking[0][0].Postion[2]=1.0
table.PrivacyMasking[0][0].ShapeType=Rect
table.PrivacyMasking[0][0].Rect[0]=0
table.PrivacyMasking[0][0].Rect[1]=0
table.PrivacyMasking[0][0].Rect[2]=50
table.PrivacyMasking[0][0].Rect[3]=100
table.PrivacyMasking[0][0].Color[0]=128
table.PrivacyMasking[0][0].Color[1]=128
table.PrivacyMasking[0][0].Color[2]=128
table.PrivacyMasking[0][0].Color[3]=255
table.PrivacyMasking[0][0].Mosaic=8
table.PrivacyMasking[0][0].ViewAngle=30.0
table.PrivacyMasking[0][1].Enable=true
…

 Set privacy masking config

Syntax

Method

http://<server>/cgi-bin/configManager.cgi?action=setConfig

GET

Description Set privacy masking setting

[ Request Params ] (key=value format )

Name

Type

R/O Param Description

PrivacyMasking

Array<Array<object>> R

privacy masking config, each channel has several
masking region

+Enable

bool

R

Enable/Disable

+Postion

Array<double>

+ShapeType

string

+Rect

Array<int>

+Polygon

Array<Array<int>>

+Color

Array<int>

+Mosaic

int

O

O

O

O

O

O

Size is 3
Postion[0] is horizontal angle, range is [-1—1]
Postion[1] is vertical angel, range is [-1—1]
Postion[2] is zoom, range is [ 0—1]
Shape type,can be: “Rect”, “Polygon”

It is valid if ShapeType is Rect , top left and bottom
right point, each point has x and y value, oordinate
remap to 0 — 8192.
It is valid if ShapeType is Polygon
the first array is point list, minimum item is 3, the
second array is point, must be two int, means x
and y value, coordinate remap to 0 — 8192.
Mask color, RGBA color, 4 integer range is 0-255

Mosaic type, Range is {0, 8, 16, 24, 32}
0: no mosaic
8: mosaic size 8*8
16: mosaic size 16*16
24: mosaic size 24*24
32: mosaic size 32*32

+ViewAngle

double

O

View angle, range is [0.0, 360.0], unit: degree

General APIs 95

[ Response Params ] ( OK )

[ Example ]

Request

http://192.168.1.108/cgi-bin/configManager.cgi?action=setConfig&PrivacyMasking[0][0].En
able=true&PrivacyMasking[0][0].Postion[0]=0.0&PrivacyMasking[0][0].Postion[1]=0.0&Priv
acyMasking[0][0].Postion[2]=1.0&PrivacyMasking[0][0].ShapeType=Rect&PrivacyMasking
[0][0].Rect[0]=0&PrivacyMasking[0][0].Rect[1]=0&PrivacyMasking[0][0].Rect[2]=50&Privac
yMasking[0][0].Rect[3]=100&PrivacyMasking[0][0].Mosaic=8&PrivacyMasking[0][0].ViewA
ngle=30.0

Response OK

4.5.19 Get Privacy Masking

Syntax

Method

http://<server>/cgi-bin/PrivacyMasking.cgi?action=getPrivacyMasking

GET

Description

Get privacy masking

[ Request Params ] (key=value format at URL)

Name

channel

offset

limit

Type

int

int

int

R/O Param Description

R

R

R

video channel index which starts from 1

Offset in the result record set, range is [0, Total – 1].

Count of result to get.

[ Response Params ] (key=value format)

Name

total

Type

int

PrivacyMasking Array<object >

+Index

+Name

+Enable

int

string

int

+ShapeType

string

+Rect

Array<int>

+Polygon

Array<Array<int>>

+Color

Array<int>

+Mosaic

int

R/O Param Description

R

R

R

O

R

O

O

O

O

O

Count of result

PrivacyMasking config

Index of PrivacyMasking which starts from 0

PrivacyMasking name

1: enable; 0: disable

Shape type,can be: “Rect”, “Polygon”

It is valid if ShapeType is Rect , top left and bottom
right point, each point has x and y value, oordinate
remap to 0 — 8192.
It is valid if ShapeType is Polygon
the first array is point list, minimum item is 3, the
second array is point, must be two int, means x
and y value, coordinate remap to 0 — 8192.
Mask color, RGBA color, 4 integer range is 0-255

Mosaic type, Range is {0, 8, 16, 24, 32}
0: no mosaic
8: mosaic size 8*8
16: mosaic size 16*16
24: mosaic size 24*24
32: mosaic size 32*32

[ Example ]

Request

http://192.168.1.108/cgi-bin/PrivacyMasking.cgi?action=getPrivacyMasking&channel=1&
offset=2&limit =5

General APIs 96

Response

total=5
PrivacyMasking[0].Index=0
PrivacyMasking[0].Name=Privacy Masking1
PrivacyMasking[0].Enable=1
PrivacyMasking[0].ShapeType=Polygon
PrivacyMasking[0].Polygon[0][0]= 0
PrivacyMasking[0].Polygon[0][1]=0
PrivacyMasking[0].Polygon[1][0]=128
PrivacyMasking[0].Polygon[1][1]=128
PrivacyMasking[0].Polygon[2][0]=256
PrivacyMasking[0].Polygon[2][1]=200
…
PrivacyMasking[0].Color[0]=128,
PrivacyMasking[0].Color[1]=128,
PrivacyMasking[0].Color[2]=128,
PrivacyMasking[0].Color[3]=255,
PrivacyMasking[0].Mosaic=8,
PrivacyMasking[1].Index =1,
PrivacyMasking[1].Enable=1,
…

4.5.20 Set Privacy Masking

Syntax

Method

http://<server>/cgi-bin/PrivacyMasking.cgi?action=setPrivacyMasking

GET

Description Set privacy masking

[ Request Params ] (key=value format at URL)

R/O Param Description

Name

channel

Type

int

PrivacyMasking

object

+Index

+Name

+Enable

+ShapeType

int

string

int

string

+Rect

Array<int>

R

R

R

O

R

R

O

+Polygon

Array<Array<int>>

O

+Color

Array<int>

O

video channel index which starts from 1

Privacy masking config

Index of PrivacyMasking which starts from 0

PrivacyMasking name

1: enable; 0: disable

Shape type,can be: “Rect”, “Polygon”

It is valid if ShapeType is Rect , top left and
bottom right point, each point has x and y value,
oordinate remap to 0 — 8192.
mandatory when ShapeType is "Rect"

It is valid if ShapeType is Polygon
the first array is point list, minimum item is 3, the
second array is point, must be two int, means x
and y value, coordinate remap to 0 — 8192.
mandatory when ShapeType is "Polygon"

Mask color, RGBA color, 4 integer range is 0-255.
mandatory when Mosaic is 0

General APIs 97

+Mosaic

int

R

Mosaic type, Range is {0, 8, 16, 24, 32}
0: no mosaic
8: mosaic size 8*8
16: mosaic size 16*16
24: mosaic size 24*24
32: mosaic size 32*32

[ Response Params ] ( OK )

[ Example ]

Request

http://192.168.1.108/cgi-bin/PrivacyMasking.cgi?action=setPrivacyMasking&channel=2&
PrivacyMasking.Index=3&PrivacyMasking.Name=Privacy%20Masking1&PrivacyMasking.
Enable=1&PrivacyMasking.ShapeType=Rect&PrivacyMasking.Rect[0]=0&PrivacyMaskin
g.Rect[1]=0&PrivacyMasking.Rect[2]=50&PrivacyMasking.Rect[3]=100&PrivacyMasking.
Mosaic=8

Response OK

4.5.21 Goto Privacy Masking

Syntax

Method

http://<server>/cgi-bin/PrivacyMasking.cgi?action=gotoPrivacyMasking

GET

Description

Goto privacy masking

[ Request Params ] (key=value format at URL)

Name

channel

index

Type

R/O Param Description

int

int

R

R

video channel index which starts from 1

Index of PrivacyMasking which starts from 0

[ Response Params ] ( OK )

[ Example ]

Request

http://192.168.1.108/cgi-bin/PrivacyMasking.cgi?action=gotoPrivacyMasking&channel=
2&index=3

Response

OK

4.5.22 Delete Privacy Masking

Syntax

Method

http://<server>/cgi-bin/PrivacyMasking.cgi?action=deletePrivacyMasking

GET

Description

Delete privacy masking

[ Request Params ] (key=value format at URL)

Name

channel

index

Type

R/O Param Description

int

int

R

R

video channel index which starts from 1

Index of PrivacyMasking which starts from 0

[ Response Params ] ( OK )

[ Example ]

Request

http://192.168.1.108/cgi-bin/PrivacyMasking.cgi?action=deletePrivacyMasking&channel
=2&index=3

Response

OK

General APIs 98

4.5.23 Clear Privacy Masking

Syntax

Method

http://<server>/cgi-bin/PrivacyMasking.cgi?action=clearPrivacyMasking

GET

Description Clear privacy masking

[ Request Params ] (key=value format at URL)

Name

channel

Type

int

[ Response Params ] ( OK )

[ Example ]

R/O Param Description

R

video channel index which starts from 1

Request

http://192.168.1.108/cgi-bin/PrivacyMasking.cgi?action=clearPrivacyMasking&channel=2

Response

OK

4.5.24 Get Privacy Masking Rect

Syntax

Method

http://<server>/cgi-bin/PrivacyMasking.cgi?action=getRealRect

GET

Description Get privacy masking rect

[ Request Params ] (key=value format at URL )

Name

channel

index

Type

R/O Param Description

int

int

R

R

video channel index which starts from 1

Index of PrivacyMasking which starts from 0

[ Response Params ] (key=value format )

Name

Rect

[ Example ]

Type

R/O Param Description

Array<int> R

Rect, top left and bottom right point, each point has x and y
value, oordinate remap to 0 — 8192.

Request

http://192.168.1.108/cgi-bin/PrivacyMasking.cgi?action=getRealRect&channel=2&index=1

Response

Rect[0]=0
Rect[1]=0
Rect[2]=50
Rect[3]=100

4.5.25 [Config] Motion Detection Settings

 Get motion detect config

Table 4-19

Syntax

Method

Description

Example

Success
Return

http://<server>/cgi-bin/configManager.cgi?action=getConfig&name=MotionDetect

GET

Motion detect config of a video channel contains Enable, MotionDetectWindow and
EventHandler.

http://192.168.1.108/cgi-bin/configManager.cgi?action=getConfig&name=MotionDetect

table.MotionDetect[0].Enable=false
table.MotionDetect[0].EventHandler.AlarmOut=1

General APIs 99

table.MotionDetect[0].EventHandler.AlarmOutChannels[0]=0
table.MotionDetect[0].EventHandler.AlarmOutEnable=true
table.MotionDetect[0].EventHandler.AlarmOutLatch=10
table.MotionDetect[0].EventHandler.BeepEnable=false
table.MotionDetect[0].EventHandler.Dejitter=5
table.MotionDetect[0].EventHandler.Delay=0
table.MotionDetect[0].EventHandler.ExAlarmOut=1
table.MotionDetect[0].EventHandler.ExAlarmOutChannels[0]=0
table.MotionDetect[0].EventHandler.ExAlarmOutEnable=false
table.MotionDetect[0].EventHandler.FlashEnable=false
table.MotionDetect[0].EventHandler.FlashLatch=10
table.MotionDetect[0].EventHandler.LogEnable=true
table.MotionDetect[0].EventHandler.MailEnable=false
table.MotionDetect[0].EventHandler.Matrix=1
table.MotionDetect[0].EventHandler.MatrixChannels[0]=0
table.MotionDetect[0].EventHandler.MatrixEnable=false
table.MotionDetect[0].EventHandler.MessageEnable=false
table.MotionDetect[0].EventHandler.PtzLink[0][0]=None
table.MotionDetect[0].EventHandler.PtzLink[0][1]=1
table.MotionDetect[0].EventHandler.PtzLinkEnable=false
table.MotionDetect[0].EventHandler.Record=1
table.MotionDetect[0].EventHandler.RecordChannels[0]=0
table.MotionDetect[0].EventHandler.RecordEnable=true
table.MotionDetect[0].EventHandler.RecordLatch=10
table.MotionDetect[0].EventHandler.Snapshot=1
table.MotionDetect[0].EventHandler.SnapshotChannels[0]=0
table.MotionDetect[0].EventHandler.SnapshotEnable=false
table.MotionDetect[0].EventHandler.TimeSection[0][0]=1 00:00:00-23:59:59
table.MotionDetect[0].EventHandler.TimeSection[0][1]=0 00:00:00-23:59:59
table.MotionDetect[0].EventHandler.TimeSection[0][2]=0 00:00:00-23:59:59
table.MotionDetect[0].EventHandler.TimeSection[0][3]=0 00:00:00-23:59:59
table.MotionDetect[0].EventHandler.TimeSection[0][4]=0 00:00:00-23:59:59
table.MotionDetect[0].EventHandler.TimeSection[0][5]=0 00:00:00-23:59:59
table.MotionDetect[0].EventHandler.TimeSection[1][0]=1 00:00:00-23:59:59
table.MotionDetect[0].EventHandler.TimeSection[1][1]=0 00:00:00-23:59:59
table.MotionDetect[0].EventHandler.TimeSection[1][2]=0 00:00:00-23:59:59
table.MotionDetect[0].EventHandler.TimeSection[1][3]=0 00:00:00-23:59:59
table.MotionDetect[0].EventHandler.TimeSection[1][4]=0 00:00:00-23:59:59
table.MotionDetect[0].EventHandler.TimeSection[1][5]=0 00:00:00-23:59:59
table.MotionDetect[0].EventHandler.TimeSection[2][0]=1 00:00:00-23:59:59
table.MotionDetect[0].EventHandler.TimeSection[2][1]=0 00:00:00-23:59:59
table.MotionDetect[0].EventHandler.TimeSection[2][2]=0 00:00:00-23:59:59
table.MotionDetect[0].EventHandler.TimeSection[2][3]=0 00:00:00-23:59:59
table.MotionDetect[0].EventHandler.TimeSection[2][4]=0 00:00:00-23:59:59
table.MotionDetect[0].EventHandler.TimeSection[2][5]=0 00:00:00-23:59:59
table.MotionDetect[0].EventHandler.TimeSection[3][0]=1 00:00:00-23:59:59
table.MotionDetect[0].EventHandler.TimeSection[3][1]=0 00:00:00-23:59:59

General APIs 100

table.MotionDetect[0].EventHandler.TimeSection[3][2]=0 00:00:00-23:59:59
table.MotionDetect[0].EventHandler.TimeSection[3][3]=0 00:00:00-23:59:59
table.MotionDetect[0].EventHandler.TimeSection[3][4]=0 00:00:00-23:59:59
table.MotionDetect[0].EventHandler.TimeSection[3][5]=0 00:00:00-23:59:59
table.MotionDetect[0].EventHandler.TimeSection[4][0]=1 00:00:00-23:59:59
table.MotionDetect[0].EventHandler.TimeSection[4][1]=0 00:00:00-23:59:59
table.MotionDetect[0].EventHandler.TimeSection[4][2]=0 00:00:00-23:59:59
table.MotionDetect[0].EventHandler.TimeSection[4][3]=0 00:00:00-23:59:59
table.MotionDetect[0].EventHandler.TimeSection[4][4]=0 00:00:00-23:59:59
table.MotionDetect[0].EventHandler.TimeSection[4][5]=0 00:00:00-23:59:59
table.MotionDetect[0].EventHandler.TimeSection[5][0]=1 00:00:00-23:59:59
table.MotionDetect[0].EventHandler.TimeSection[5][1]=0 00:00:00-23:59:59
table.MotionDetect[0].EventHandler.TimeSection[5][2]=0 00:00:00-23:59:59
table.MotionDetect[0].EventHandler.TimeSection[5][3]=0 00:00:00-23:59:59
table.MotionDetect[0].EventHandler.TimeSection[5][4]=0 00:00:00-23:59:59
table.MotionDetect[0].EventHandler.TimeSection[5][5]=0 00:00:00-23:59:59
table.MotionDetect[0].EventHandler.TimeSection[6][0]=1 00:00:00-23:59:59
table.MotionDetect[0].EventHandler.TimeSection[6][1]=0 00:00:00-23:59:59
table.MotionDetect[0].EventHandler.TimeSection[6][2]=0 00:00:00-23:59:59
table.MotionDetect[0].EventHandler.TimeSection[6][3]=0 00:00:00-23:59:59
table.MotionDetect[0].EventHandler.TimeSection[6][4]=0 00:00:00-23:59:59
table.MotionDetect[0].EventHandler.TimeSection[6][5]=0 00:00:00-23:59:59
table.MotionDetect[0].EventHandler.TipEnable=false
table.MotionDetect[0].EventHandler.Tour=1
table.MotionDetect[0].EventHandler.TourChannels[0]=0
table.MotionDetect[0].EventHandler.TourEnable=false
table.MotionDetect[0].EventHandler.Voice.AudioFileName=
table.MotionDetect[0].EventHandler.VoiceEnable=false
table.MotionDetect[0].MotionDetectWindow[0].Id=0
table.MotionDetect[0].MotionDetectWindow[0].Name=Region1
table.MotionDetect[0].MotionDetectWindow[0].Region[0]=4194303
table.MotionDetect[0].MotionDetectWindow[0].Region[1]=4194303
table.MotionDetect[0].MotionDetectWindow[0].Region[2]=4194303
table.MotionDetect[0].MotionDetectWindow[0].Region[3]=4194303
table.MotionDetect[0].MotionDetectWindow[0].Region[4]=4194303
table.MotionDetect[0].MotionDetectWindow[0].Region[5]=4194303
table.MotionDetect[0].MotionDetectWindow[0].Region[6]=4194303
table.MotionDetect[0].MotionDetectWindow[0].Region[7]=4194303
table.MotionDetect[0].MotionDetectWindow[0].Region[8]=4194303
table.MotionDetect[0].MotionDetectWindow[0].Region[9]=4194303
table.MotionDetect[0].MotionDetectWindow[0].Region[10]=4194303
table.MotionDetect[0].MotionDetectWindow[0].Region[11]=4194303
table.MotionDetect[0].MotionDetectWindow[0].Region[12]=4194303
table.MotionDetect[0].MotionDetectWindow[0].Region[13]=4194303
table.MotionDetect[0].MotionDetectWindow[0].Region[14]=4194303
table.MotionDetect[0].MotionDetectWindow[0].Region[15]=4194303
table.MotionDetect[0].MotionDetectWindow[0].Region[16]=4194303

General APIs 101

table.MotionDetect[0].MotionDetectWindow[0].Region[17]=4194303
table.MotionDetect[0].MotionDetectWindow[0].Sensitive=60
table.MotionDetect[0].MotionDetectWindow[0].Threshold=5
table.MotionDetect[0].MotionDetectWindow[0].Window[0]=0
table.MotionDetect[0].MotionDetectWindow[0].Window[1]=0
table.MotionDetect[0].MotionDetectWindow[0].Window[2]=8191
table.MotionDetect[0].MotionDetectWindow[0].Window[3]=8191
table.MotionDetect[0].MotionDetectWindow[1].Id=1
table.MotionDetect[0].MotionDetectWindow[1].Name=Region2
table.MotionDetect[0].MotionDetectWindow[1].Region[0]=0
table.MotionDetect[0].MotionDetectWindow[1].Region[1]=0
table.MotionDetect[0].MotionDetectWindow[1].Region[2]=0
table.MotionDetect[0].MotionDetectWindow[1].Region[3]=0
table.MotionDetect[0].MotionDetectWindow[1].Region[4]=0
table.MotionDetect[0].MotionDetectWindow[1].Region[5]=0
table.MotionDetect[0].MotionDetectWindow[1].Region[6]=0
table.MotionDetect[0].MotionDetectWindow[1].Region[7]=0
table.MotionDetect[0].MotionDetectWindow[1].Region[8]=0
table.MotionDetect[0].MotionDetectWindow[1].Region[9]=0
table.MotionDetect[0].MotionDetectWindow[1].Region[10]=0
table.MotionDetect[0].MotionDetectWindow[1].Region[11]=0
table.MotionDetect[0].MotionDetectWindow[1].Region[12]=0
table.MotionDetect[0].MotionDetectWindow[1].Region[13]=0
table.MotionDetect[0].MotionDetectWindow[1].Region[14]=0
table.MotionDetect[0].MotionDetectWindow[1].Region[15]=0
table.MotionDetect[0].MotionDetectWindow[1].Region[16]=0
table.MotionDetect[0].MotionDetectWindow[1].Region[17]=0
table.MotionDetect[0].MotionDetectWindow[1].Sensitive=60
table.MotionDetect[0].MotionDetectWindow[1].Threshold=5
table.MotionDetect[0].MotionDetectWindow[1].Window[0]=0
table.MotionDetect[0].MotionDetectWindow[1].Window[1]=0
table.MotionDetect[0].MotionDetectWindow[1].Window[2]=0
table.MotionDetect[0].MotionDetectWindow[1].Window[3]=0
table.MotionDetect[0].MotionDetectWindow[2].Id=2
table.MotionDetect[0].MotionDetectWindow[2].Name=Region3
table.MotionDetect[0].MotionDetectWindow[2].Region[0]=0
table.MotionDetect[0].MotionDetectWindow[2].Region[1]=0
table.MotionDetect[0].MotionDetectWindow[2].Region[2]=0
table.MotionDetect[0].MotionDetectWindow[2].Region[3]=0
table.MotionDetect[0].MotionDetectWindow[2].Region[4]=0
table.MotionDetect[0].MotionDetectWindow[2].Region[5]=0
table.MotionDetect[0].MotionDetectWindow[2].Region[6]=0
table.MotionDetect[0].MotionDetectWindow[2].Region[7]=0
table.MotionDetect[0].MotionDetectWindow[2].Region[8]=0
table.MotionDetect[0].MotionDetectWindow[2].Region[9]=0
table.MotionDetect[0].MotionDetectWindow[2].Region[10]=0
table.MotionDetect[0].MotionDetectWindow[2].Region[11]=0

General APIs 102

table.MotionDetect[0].MotionDetectWindow[2].Region[12]=0
table.MotionDetect[0].MotionDetectWindow[2].Region[13]=0
table.MotionDetect[0].MotionDetectWindow[2].Region[14]=0
table.MotionDetect[0].MotionDetectWindow[2].Region[15]=0
table.MotionDetect[0].MotionDetectWindow[2].Region[16]=0
table.MotionDetect[0].MotionDetectWindow[2].Region[17]=0
table.MotionDetect[0].MotionDetectWindow[2].Sensitive=60
table.MotionDetect[0].MotionDetectWindow[2].Threshold=5
table.MotionDetect[0].MotionDetectWindow[2].Window[0]=0
table.MotionDetect[0].MotionDetectWindow[2].Window[1]=0
table.MotionDetect[0].MotionDetectWindow[2].Window[2]=0
table.MotionDetect[0].MotionDetectWindow[2].Window[3]=0
table.MotionDetect[0].MotionDetectWindow[3].Id=3
table.MotionDetect[0].MotionDetectWindow[3].Name=Region4
table.MotionDetect[0].MotionDetectWindow[3].Region[0]=0
table.MotionDetect[0].MotionDetectWindow[3].Region[1]=0
table.MotionDetect[0].MotionDetectWindow[3].Region[2]=0
table.MotionDetect[0].MotionDetectWindow[3].Region[3]=0
table.MotionDetect[0].MotionDetectWindow[3].Region[4]=0
table.MotionDetect[0].MotionDetectWindow[3].Region[5]=0
table.MotionDetect[0].MotionDetectWindow[3].Region[6]=0
table.MotionDetect[0].MotionDetectWindow[3].Region[7]=0
table.MotionDetect[0].MotionDetectWindow[3].Region[8]=0
table.MotionDetect[0].MotionDetectWindow[3].Region[9]=0
table.MotionDetect[0].MotionDetectWindow[3].Region[10]=0
table.MotionDetect[0].MotionDetectWindow[3].Region[11]=0
table.MotionDetect[0].MotionDetectWindow[3].Region[12]=0
table.MotionDetect[0].MotionDetectWindow[3].Region[13]=0
table.MotionDetect[0].MotionDetectWindow[3].Region[14]=0
table.MotionDetect[0].MotionDetectWindow[3].Region[15]=0
table.MotionDetect[0].MotionDetectWindow[3].Region[16]=0
table.MotionDetect[0].MotionDetectWindow[3].Region[17]=0
table.MotionDetect[0].MotionDetectWindow[3].Sensitive=60
table.MotionDetect[0].MotionDetectWindow[3].Threshold=5
table.MotionDetect[0].MotionDetectWindow[3].Window[0]=0
table.MotionDetect[0].MotionDetectWindow[3].Window[1]=0
table.MotionDetect[0].MotionDetectWindow[3].Window[2]=0
table.MotionDetect[0].MotionDetectWindow[3].Window[3]=0
table.MotionDetect[0].OsdTwinkleEnable=false
table.MotionDetect[0].PirMotionLevel=3
—

Comment

 Set motion detect config

Table 4-20

Syntax

http://<server>/cgi-bin/configManager.cgi?action=setConfig&<paramName>=<paramV
alue>[&<paramName>=<paramValue>…]

General APIs 103

Method

GET

Description

Set motion detection config.

Enable motion detection:
http://192.168.1.108/cgi-bin/configManager.cgi?action=setConfig&MotionDetect[0].Ena
ble=true

Example

Set motion detection regions:
http://192.168.1.108/cgi-bin/configManager.cgi?action=setConfig&MotionDetect[0].Moti
onDetectWindow[0].Region[0]=1&MotionDetect[0].MotionDetectWindow[0].Region[1]=
1&MotionDetect[0].MotionDetectWindow[0].Region[2]=1&MotionDetect[0].MotionDetec
tWindow[0].Region[3]=1&MotionDetect[0].MotionDetectWindow[0].Region[4]=1&Motion
Detect[0].DetectVersion=V3.0

Success
Return

OK

In table below,
head = MotionDetect[ChannelNo]
ChannelNo: integer, array index starts from 0, which means video channel(equals to
video channel index -1, and so 0 means channel 1).
LineNum
Index of region, region is divided into lines and each line has several blocks, a line is
described by a 32 bit integer, a bit for a block.
0=Line 1
1=Line 2
…
WinNum
Index of detect window, there are 4 detect windows at present. Each window is divided
into 18 lines and 22 blocks per line.

Notice: When setting
"MotionDetect[ChannelNo].MotionDetectWindow[WinNum].Region", you need to
contain the parameter "MotionDetect[ChannelNo].DetectVersion=V3.0" along.

ParamValue type Description

bool

Enable/Disable motion detect feature in a channel.

Comment

Appendix:

ParamName

head.Enable

head.PtzManualEnable bool

head.OsdTwinkleEnabl
e

head.Row

head.Col

head.Level

bool

integer

integer

integer

Enable/Disable manual control Ptz, only for Hahua
devices

Osd Twinkle Enable
default : false

motion detect row number

motion detect colum number

sensitive ,range 1-6

head.TimeDivide.
TimeSchedule

array<array<strin
g>>

TimeSchedule

head.TimeDivide.Level

integer

sensitive in timesection, different with global sensitive.

head.DetectVersion

string

detect version

General APIs 104

ParamName

ParamValue type Description

head.PirMotionEnable

bool

Customized Pir Motion Enable

head.PirMotionLevel

integer

Customized Pir Motion sensitive level

head.VolumeRatio

head.SubRatio

integer

integer

Area occupancy ratio

SubRatio

head.Region

array<integer>

Region

head.EventHandler

—

Setting
SetEventHandler.

of

EventHandler

is

described

in

integer

It is the Id of a detect window.

string

It is the name of a detect window.

head.MotionDetectWin
dow [WinNum].Id

head.MotionDetectWin
dow [WinNum].Name

head.MotionDetectWin
dow[WinNum].Sensitiv
e

head.MotionDetectWin
dow[WinNum].Threshol
d

integer

integer

head.MotionDetectWin
dow[WinNum].Region[
LineNum]

integer

Range is [0—100].
Sensitivity of motion detection.
It presents more sensitive if the value is larger.
Range is [0—100].
It presents the threshold value when trigger motion
detect.

It is similar with head.Region [LineNum].
Currently, a region is divided into 18 lines and 22 blocks
per line.
A bit describes a block in the line.
Bit = 1: motion in this block is monitored.
Example:
MotionDetect [0].Region [0] = 4194303 (0x3FFFFF): the
22 blocks in channel 0 line 0 is monitored.
MotionDetect [0].Region [1] =0: the 22 blocks in channel
0 line 1 is not monitored.
MotionDetect [0].Region [17] = 3: the left two blocks in
the last line of channel 0 is monitored.

4.5.26 [Config] LAEConfig

 Get LAEConfig setting

Syntax

Method

http://<server>/cgi-bin/configManager.cgi?action=getConfig&name=LAEConfig

GET

Description Get LAE Configs.

Example

http://192.168.1.108/cgi-bin/configManager.cgi?action=getConfig&name=LAEConfig

Success
Return

table.LAEConfig.Enable=true
table.LAEConfig.ManulEn=1
table.LAEConfig.YSIGMA =1
table.LAEConfig.Dethr =1
table.LAEConfig.STS =1
table.LAEConfig.GauFilter0=1
table.LAEConfig.GauFilter1=1

General APIs 105

table.LAEConfig.GauFilter2=1
table.LAEConfig.UVGauFilter0=1
table.LAEConfig.UVGauFilter1=1
table.LAEConfig.UVGauFilter2=1
table.LAEConfig.UVSigma =1
table.LAEConfig.EEGauFilter0=1
table.LAEConfig.EEGauFilter1=1
table.LAEConfig.EEGauFilter2=1
table.LAEConfig.EEratio =1
table.LAEConfig.GEnable =1
table.LAEConfig.GainLevel =1
table.LAEConfig.DebugPin =1

Comment

 Set LAEConfig setting

Syntax

http://<server>/cgi-bin/configManager.cgi?action=setConfig&<paramName>=<paramVal
ue>[&<paramName>=<paramValue>…]

Method

GET

Description Set LAE Configs.

Example

Success
Return

Comment

Appendix:

ParamName

http://192.168.1.108/cgi-bin/configManager.cgi?action=setConfig&LAEConfig.Enable=tru
e&LAEConfig.ManulEn=1

OK

ParamValue type Description

table.LAEConfig.Enable

bool

table.LAEConfig.ManulEn

integer

table.LAEConfig.YSIGMA

integer

table.LAEConfig.Dethr

table.LAEConfig.STS

table.LAEConfig.GauFilter0

table.LAEConfig.GauFilter1

table.LAEConfig.GauFilter2

table.LAEConfig.UVGauFilter0

integer

integer

integer

integer

integer

integer

turn on/off LAE fuction
The following parameters will take effacts when
it’s on

whether use manual mode, 1 for manual mode,
0 for alternative plan

absolute strength of Y channel Grinding,
The smaller the stronger(fuzzier)

relative strength of Y channel Grinding,
The smaller the stronger(fuzzier)

Y channel STS

Y channel pre filter0, meet the conditions:
GauFilter0 _ 2 + GauFilter1 _ 2 + GauFilter2 =
256

Y channel pre filter1

Y channel pre filter2

UV channel pre filter0, meet the conditions:
GauFilter0 _ 2 + GauFilter1 _ 2 + GauFilter2 =
256

table.LAEConfig.UVGauFilter1

integer

table.LAEConfig.UVGauFilter2

integer

UV channel pre filter1

UV channel pre filter2

General APIs 106

ParamName

ParamValue type Description

table.LAEConfig.UVSigma

table.LAEConfig.EEGauFilter0

integer

integer

absolute strength of UV channel Grinding,
The smaller the stronger

EE pre filter0, meet the conditions: GauFilter0 _
2 + GauFilter1 _ 2 + GauFilter2 = 256

table.LAEConfig.EEGauFilter1

integer

EE pre filter1, extracts low-frequenc

table.LAEConfig.EEGauFilter2

integer

EE pre filter2

table.LAEConfig.EEratio

table.LAEConfig.GEnable

table.LAEConfig.GainLevel

table.LAEConfig.DebugPin

integer

integer

integer

integer

strength of enhancement,
stronger

the bigger

the

Brightening switch, default false

it is used to choose paramas, as an alternative

debug option

4.5.27 Enable/Disable all privacy masking covers

Syntax

Method

http://<server>/cgi-bin/PrivacyMasking.cgi?action=setPrivacyMaskingEnable

GET

Description

Enable/Disable all privacy masking covers

[ Request Params ] (key=value format at URL )

Name

channel

Enable

Type

int

bool

[ Response Params ] ( OK )

R/O Param Description

R

R

video channel index which starts from 1

true: Enable, false: Disable

[ Example ]

Request

http://192.168.1.108/cgi-bin/PrivacyMasking.cgi?action=setPrivacyMaskingEnable&ch
annel=2&Enable=true

Response

OK

4.5.28 Get enable/disable state of all privacy masking covers

Syntax

Method

http://<server>/cgi-bin/PrivacyMasking.cgi?action=getPrivacyMaskingEnable

GET

Description

Get enable/disable state of all privacy masking covers

[ Request Params ] (key=value format at URL )

Name

channel

Type

int

R/O Param Description

R

video channel index which starts from 1

[ Response Params ] (key=value format)

Name

Enable

[ Example ]

Request

Type

bool

R/O

Param Description

R

true: Enable, false: Disable

http://192.168.1.108/cgi-bin/PrivacyMasking.cgi?action=getPrivacyMaskingEnable&ch
annel=2

Response

Enable=false

General APIs 107

4.6 System

4.6.1 [Config] General

 Get general config

Table 4-21

Syntax

Method

http://<server>/cgi-bin/configManager.cgi?action=getConfig&name=General

GET

Description

Get general config.

Example

http://192.168.1.108/cgi-bin/configManager.cgi?action=getConfig&name=General

table.General.LocalNo=8,
table.General.MachineID=20832748927,
table.General.MachineName=Device001,
table.General.MachineAddress=XXXDistrict.YYYRoad
table.General.MachineGroup=ZZZGroup
table.General.LockLoginEnable=true,
table.General.CheckDuration=30,
table.General.LockLoginTimes=3,
table.General.LoginFailLockTime=1800,
table.General.MaxOnlineTime=1800,
table.General.LocalPolicy.LockLoginEnable=true,
table.General.LocalPolicy.CheckDuration=30,
table.General.LocalPolicy.LockLoginTimes=3,
table.General.LocalPolicy.LoginFailLockTime=1800
table.General.ActivationTime=2000-01-01 00:00:00
—

Success
Return

Comment

 Set general config

Table 4-22

Syntax

http://<server>/cgi-bin/configManager.cgi?action=setConfig&<paramName>=<paramV
alue>[&<paramName>=<paramValue>…]

Method

GET

Description

Set general config.

Example

Success
Return

Comment

Appendix:

ParamName

http://192.168.1.108/cgi-bin/configManager.cgi?action=setConfig&General.MachineNa
me=MyIPC

OK

—

ParamValue type

Description

General.MachineName

General.LocalNo

string

integer

Device name or serial number.

Local number for remote controller

General APIs 108

ParamName

ParamValue type

Description

General.MachineAddress

General.MachineGroup

string

string

Address machine places in

Group machine belongs to

4.6.2 Get Current Time

Table 4-23

Syntax

Method

http://<server>/cgi-bin/global.cgi?action=getCurrentTime

GET

Description

Get current time.

Example

Success
Return

Comment

http://192.168.1.108/cgi-bin/global.cgi?action=getCurrentTime

result = 2011-7-3 21:02:32

The time format is "Y-M-D H-m-S". It's not be effected by Locales. TimeFormat in
SetLocalesConfig.

4.6.3 Set Current Time

Table 4-24

Syntax

Method

http://<server>/cgi-bin/global.cgi?action=setCurrentTime&time=2011-7-3%2021:02:32

GET

Description

Set current time.

Example

Success
Return

Comment

http://192.168.1.108/cgi-bin/global.cgi?action=setCurrentTime&time=2016-01-01%202
1:02:32

OK

The time format is "Y-M-D H-m-S". It's not be effected by Locales. TimeFormat in
SetLocalesConfig.

4.6.4 [Config] Locales

 Get locales config

Table 4-25

Syntax

Method

http://<server>/cgi-bin/configManager.cgi?action=getConfig&name=Locales

GET

Description

Get locales config

Example

http://192.168.1.108/cgi-bin/configManager.cgi?action=getConfig&name=Locales

Success
Return

table.Locales.DSTEnable=false
table.Locales.DSTEnd.Day=1
table.Locales.DSTEnd.Hour=0
table.Locales.DSTEnd.Minute=0
table.Locales.DSTEnd.Month=1
table.Locales.DSTEnd.Week=2

General APIs 109

table.Locales.DSTEnd.Year=2011
table.Locales.DSTStart.Day=0
table.Locales.DSTStart.Hour=0
table.Locales.DSTStart.Minute=0
table.Locales.DSTStart.Month=1
table.Locales.DSTStart.Week=1
table.Locales.DSTStart.Year=2011
table.Locales.TimeFormat=yyyy-MM-dd HH:mm:ss
—

Comment

 Set locales config

Table 4-26

Syntax

http://<server>/cgi-bin/configManager.cgi?action=setConfig&<paramName>=<paramV
alue>[&<paramName>=<paramValue>…]

Method

GET

Description

Set Locales config.

http://192.168.1.108/cgi-bin/configManager.cgi?action=setConfig&Locales.DSTEnable
=false

OK

—

Example

Success
Return

Comment

Appendix:

ParamName

ParamValue type

Description

Locales.DSTEnable

bool

Locales.DSTEnd.Day

integer

Locales.DSTEnd.Hour

Locales.DSTEnd.Minute

Locales.DSTEnd.Month

integer

integer

integer

Locales.DSTEnd.Week

Integer

Enable/Disable DST (daylight saving time)
Range is [0—6] or [1—31]
[0—6]: week day, 0 = Sunday, 6 = Saturday
[1—31]: month day
If Locales.DSTEnd.Week is 0, use month day,
otherwise, use week day.
Range is [0—23]
Range is [0—59]
Range is [1—12]
Range is {1, 2, 3, 4, -1, 0}.
0 = Use month day
[1, 2, 3, 4, -1]: use week day.
1 = first week, 2 = second, 3 = third, 4 = fourth, -1 =
last.

Locales.DSTEnd.Year

Integer

Range is [2000-2038]

Locales.DSTStart.Day

Locales.DSTStart.Hour

Locales.DSTStart.Minute

Locales.DSTStart.Month

Locales.DSTStart.Week

Locales.DSTStart.Year

Integer

Range is the same with items in Locales.DSTEnd.
Locales.DSTStart table and Locales.DSTEnd table
define the time range of DST.

General APIs 110

ParamName

ParamValue type

Description

Locales.TimeFormat

string

Defines time format displayed in video time title.
String form is: year-month-day hour:mm:ss.
Position of year, month and day can be exchanged.

Range of year is {yy, yyyy}
yy = year without century, yyyy = year with century.
Range of month is {M, MM, MMMM}
M = 1 for January, MM = 01 for January, MMMM =
Jan for January
Range of day is {d, dd}
d = 1 for first day, dd = 01 for first day
Range of hour is {H, HH, h, hh}
H = 1 for 1:00, HH = 01 for 1:00, range is 0-23
h = 1 for 1:00, hh = 01 for 1:00, time range is 1-12

Example:
yyyy-MM-dd HH:mm:ss or
MM-dd-yyyy HH:mm:ss or
dd-M-yy hh:mm:ss

4.6.5 [Config] Holiday Management

 Get holiday config

Table 4-27

Syntax

Method

http://<server>/cgi-bin/configManager.cgi?action=getConfig&name=Holiday

GET

Description

Get holiday config for record or snap.

Example

http://192.168.1.108/cgi-bin/configManager.cgi?action=getConfig&name=Holiday

table.Holiday.MonthMask[0]=3
table.Holiday.MonthMask[1]=0
table.Holiday.MonthMask[2]=0
table.Holiday.MonthMask[3]=0
table.Holiday.MonthMask[4]=0
table.Holiday.MonthMask[5]=0
table.Holiday.MonthMask[6]=0
table.Holiday.MonthMask[7]=0
table.Holiday.MonthMask[8]=0
table.Holiday.MonthMask[9]=1610612739
table.Holiday.MonthMask[10]=0
table.Holiday.MonthMask[11]=0
—

Success
Return

Comment

 Set holiday config

Table 4-28

General APIs 111

Syntax

http://<server>/cgi-bin/configManager.cgi?action=setConfig&<paramName>=<paramV
alue>[&<paramName>=<paramValue>…]

Method

GET

Description

Set holiday config.

Example

Success
Return

Comment

Appendix:

ParamName

http://192.168.1.108/cgi-bin/configManager.cgi?action=setConfig&Holiday.MonthMask[
0]=3

OK

Parameters in URL:
In table below,
monthIndex presents the index of a month. 0 presents January, 1 presents February,
11 presents December.

ParamValue type Description

Holiday.MonthMask[monthIndex]

integer

4.6.6 Get Language Capability

It is the mask of a month.Every bit present a
day. For example, 0x0001 presents the first
day of a month is holiday. 0x0002 presents the
second day of a month is holiday, 0x0003
presents the first day and second day of a
month is holiday.

Table 4-29

Syntax

Method

http://<server>/cgi-bin/magicBox.cgi?action=getLanguageCaps

GET

Description

Get the list of supported languages.

Example

Success
Return

Comment

http://192.168.1.108/cgi-bin/magicBox.cgi?action=getLanguageCaps

Languages=SimpChinese,English,French

response is a string contains languages with comma separated.
Languages include { English, SimpChinese, TradChinese, Italian, Spanish, Japanese,
Russian, French, German }

4.6.7 [Config] Language

 Get language config

Table 4-30

Syntax

Method

http://<server>/cgi-bin/configManager.cgi?action=getConfig&name=Language

GET

Description

Get system language config.

Example

Success

http://192.168.1.108/cgi-bin/configManager.cgi?action=getConfig&name=Language

table.Language=SimpChinese

General APIs 112

Return

Comment

—

 Set language config

Table 4-31

Syntax

http://<server>/cgi-bin/configManager.cgi?action=setConfig&<paramName>=<paramV
alue>[&<paramName>=<paramValue>…]

Method

GET

Description

Set system language config.

Example

Success
Return

http://192.168.1.108/cgi-bin/configManager.cgi?action=setConfig&Language=SimpChi
nese

OK

Comment

NOTE: After changing language setting, system will automatically reboot!

Appendix:

ParamName

ParamValue type

Description

Language

string

4.6.8 Get Device Type

language
The
GetLanguageCaps

range

is get

from

interface

in

Get the device type displayed (instead of the real type).

http://<server>/cgi-bin/magicBox.cgi?action=getDeviceType
GET

Request URL
Method
Request Params ( none )
Request Example
http://192.168.1.108/cgi-bin/magicBox.cgi?action=getDeviceType

Response Params ( key=value format in body )
Name
type
Response Example
type=DVR

Type
string

R/O
R

Description
The displayed device model

Sample
DVR

4.6.9 Get Hardware Version

Get the device hardware version information.

http://<server>/cgi-bin/magicBox.cgi?action=getHardwareVersion
GET

Request URL
Method
Request Params ( none )
Request Example
http://192.168.1.108/cgi-bin/magicBox.cgi?action=getHardwareVersion

General APIs 113

Response Params ( key=value format in body )
Name
version

R/O Description
R

Type
string

The hardware version in the format of xx.xx.
Use two numbers to respectively represent the
main and sub versions.
If the beginning number of the main version is 0,
it should be omitted.

Sample
1.00

Response Example
version=1.00

4.6.10 Get Serial Number of Device

Get the serial number of the device.

http://<server>/cgi-bin/magicBox.cgi?action=getSerialNo
GET

Request URL
Method
Request Params ( none )
Request Example
http://192.168.1.108/cgi-bin/magicBox.cgi?action=getSerialNo

Response Params ( key=value format in body )
Name
sn
Response Example
sn=YZC0GZ05100020

Type
string

R/O
R

Description
The device serial number

Sample
YZC0GZ05100020

4.6.11 Get Machine Name

Get the device machine name.

http://<server>/cgi-bin/magicBox.cgi?action=getMachineName
GET

Request URL
Method
Request Params ( none )
Request Example
http://192.168.1.108/cgi-bin/magicBox.cgi?action=getMachineName

Response Params ( key=value format in body )
Name
name
Response Example
name=my machine

Type
string

R/O
O

Description
The device name

4.6.12 Get System Information1

Get the system information of the device ( No longer maintained ).

Request URL
Method

http://<server>/cgi-bin/magicBox.cgi?action=getSystemInfo
GET

Sample
my machine

General APIs 114

Request Params ( none )
Request Example
http://192.168.1.108/cgi-bin/magicBox.cgi?action=getSystemInfo

Type
string
int
string

Response Params ( key=value format in body )
Name
serialNumber
deviceType
processor
Response Example
serialNumber=PA1FQ15900207
deviceType=27
processor=ST7108

R/O
O
O
O

Description
Device serial number
Device model
Processor model

Sample
PA1FQ15900207
27
ST7108

4.6.13 Get System Information2

Get the system information of the device.

http://<server>/cgi-bin/magicBox.cgi?action=getSystemInfoNew
GET

Request URL
Method
Request Params ( none )
Request Example
http://192.168.1.108/cgi-bin/magicBox.cgi?action=getSystemInfoNew

Response Params ( key=value format in body )
Name
info
+SyncTime

R/O Description
O
O

Type
object
object

++Strategy

enumchar[16] R

System information
For devices without RTC or when the
RTC of the device is out of battery, you
might also need to synchronize the time.
Time synchronization strategy
enumchar[16]{
“None”
“PerLogin”: Synchronizes the time each
time you log in
}
security code
0-9 and capitalized A–Z
The total running time of the device.
Unit: s
The number of cameras

O
O Whether card swiping is supported:

Sample

PerLogin

123456

12456

1
true

+2DCode

char[32]

+TotalRunTime

uint64

+cameraNum
+cardReader

uint8
bool

O

O

+flashID

uint8[8]

O

true: supported
false: not supported
flash ID

[200,209,128,149,
64,127,127,200]

General APIs 115

+hasRTC

bool

O Whether the RTC chip is included (for

true

recording the system time).
If the filed does not exist, the value is
true and the RTC is included by default.
RTC included: true
No RTC: false

Response Example
info.SyncTime.Strategy=“PerLogin”,
info.2DCode=“123456”,
info.TotalRunTime=123456
info.cameraNum=0
info.cardReader=false
info.flashID[0]=200
info.flashID[1]=209
info.flashID[2]=128
info.flashID[3]=149
info.flashID[4]=64
info.flashID[5]=127
info.flashID[6]=127
info.flashID[7]=200
info.hasRTC=true

4.6.14 Get Vendor Information

Table 4-32

Syntax

Method

http://<server>/cgi-bin/magicBox.cgi?action=getVendor

GET

Description

Get the vendor information.

Example

Success
Return

http://192.168.1.108/cgi-bin/magicBox.cgi?action=getVendor

vendor=TTT

Comment

—

4.6.15 Get Software Information

Table 4-33

Syntax

Method

http://<server>/cgi-bin/magicBox.cgi?action=getSoftwareVersion

GET

Description

Get the software information.

Example

Success
Return

http://192.168.1.108/cgi-bin/magicBox.cgi?action=getSoftwareVersion

version=2.212.0000.0.R,build:2013-11-14

Comment

—

General APIs 116

4.6.16 Get Version of Onvif

Table 4-34

Syntax

Method

http://<server>/cgi-bin/IntervideoManager.cgi?action=getVersion&Name=Onvif

GET

Description

Get onvif version.

Example

Success
Return

http://192.168.1.108/cgi-bin/IntervideoManager.cgi?action=getVersion&Name=Onvif

version=2.4.2

Comment

—

4.6.17 Get Version of HTTP API

Table 4-35

Syntax

Method

http://<server>/cgi-bin/IntervideoManager.cgi?action=getVersion&Name=CGI

GET

Description

Get CGI version.

Example

Success
Return

http://192.168.1.108/cgi-bin/IntervideoManager.cgi?action=getVersion&Name=CGI

version=2.0.0

Comment

—

4.6.18 Get Device Class

Get the class information of the device.

http://<server>/cgi-bin/magicBox.cgi?action=getDeviceClass
GET

Request URL
Method
Request Params ( none )
Request Example
http://192.168.1.108/cgi-bin/magicBox.cgi?action=getDeviceClass

Response Params ( key=value format in body )
Name
class
Response Example
class=HDVR

Type
string

R/O
R

Description
The class information of the device.

Sample
HDVR

4.6.19 [Config] Auto Maintain

 Get auto maintain config

Syntax

http://<server>/cgi-bin/configManager.cgi?action=getConfig&name=AutoMaintain

Table 4-36

General APIs 117

Method

GET

Description

Get Auto Maintain config.

Example

http://192.168.1.108/cgi-bin/configManager.cgi?action=getConfig&name=AutoMaintain

table.AutoMaintain.AutoRebootDay=3
table.AutoMaintain.AutoRebootHour=0
table.AutoMaintain.AutoRebootMinute=0
table.AutoMaintain.AutoShutdownDay=1
table.AutoMaintain.AutoShutdownHour=0
table.AutoMaintain.AutoShutdownMinute=0
table.AutoMaintain.AutoStartUpDay=1
table.AutoMaintain.AutoStartUpHour=2
table.AutoMaintain.AutoStartUpMinute=0
—

Success
Return

Comment

 Set auto maintain config

Table 4-37

Syntax

http://<server>/cgi-bin/configManager.cgi?action=setConfig&<paramName>=<paramV
alue>[&<paramName>=<paramValue>…]

Method

GET

Description

Set auto maintain config.

Example

Success
Return

Comment

Appendix:

ParamName

http://192.168.1.108/cgi-bin/configManager.cgi?action=setConfig&AutoMaintain.AutoR
ebootDay=7

OK

—

ParamValue type Description

AutoMaintain.AutoRebootDay

integer

AutoMaintain.AutoRebootHour

integer

AutoMaintain.AutoRebootMinute

integer

AutoMaintain.AutoShutdownDay

AutoMaintain.AutoShutdownHour

integer

AutoMaintain.AutoShutdownMinute

AutoMaintain.AutoStartUpDay

AutoMaintain.AutoStartUpHour

integer

AutoMaintain.AutoStartUpMinute

Range is [-1—7].
Auto restart day.
-1 = never auto restart
0—6 = Sunday—Saturday
7 = restart every day
Range is [0—23].
Auto restart hour
Range is [0—59].
Auto restart minute

auto reboot time
Range
AutoOpenHour and AutoOpenMinute.

is

same with AutoOpenDay,

Auto shutdown time.
Range
is
AutoOpenHour, and AutoOpenMinute.

same with AutoOpenDay,

General APIs 118

4.6.20 Reboot

Table 4-38

Syntax

Method

http://<server>/cgi-bin/magicBox.cgi?action=reboot[&delay=<paramValue>]

GET

Description

Reboot the device.

Example

Success
Return

http://192.168.1.108/cgi-bin/magicBox.cgi?action=reboot

OK

Comment

If successful, response OK. If fail, response Error.

4.6.21 Shutdown

Table 4-39

Syntax

Method

http://<server>/cgi-bin/magicBox.cgi?action=shutdown

GET

Description

Shutdown the device.

Example

Success
Return

http://192.168.1.108/cgi-bin/magicBox.cgi?action=shutdown

OK

Comment

If successful, response OK. If fail, response Error.

4.6.22 Factory Reset

Table 4-40

Syntax

Method

http://<server>/cgi-bin/magicBox.cgi?action=resetSystemEx[&type=<type>]

GET

Description

Reset the configuration for the device to the factory default.

Example

Success
Return

Comment

http://192.168.1.108/cgi-bin/magicBox.cgi?action=resetSystemEx&type=0

OK

Parameters in URL:
Type: integer, it can be 0 or1.
0 means all parameters are set to their factory default value;
1 means all parameters are set to their factory default value expect the specific
parameters;
The specific parameters of different device types are different. But it always contains the
network settings and user settings. After resetting, the device is reachable on the same
ip address as used before the reset.
When the Type parameter is not present in the URL, the default value of the Type is 0.

General APIs 119

4.6.23 Get Tracing Code of Device

Table 4-41

Syntax

Method

http://<server>/cgi-bin/magicBox.cgi?action=getTracingCode

GET

Description

Get the tracing code of the device.

Example

Success
Return

Comment

http://192.168.1.108/cgi-bin/magicBox.cgi?action=getTracingCode

tc=0001...1101

Only system default admin can get it.
tc is a 64bit binary string.

4.6.24 Add Camera to Specified Channel

Request URL

http://<server>/cgi-bin/LogicDeviceManager.cgi?action=addCameraByGroup

Method

POST

Request Params ( Json format in body )

Parameter

Type

Required Description

Example

+group

object[] Yes

Add device groups in batches
It is an array with the same elements as
addCameraByDevice.

++DeviceInfo

object

Yes

Device details

+++RtspPort

int

No

+++HttpPort

int

No

+++Port

int

No

RTSP port: Required when
ProtocolType is not Private, 554 by
default.

HTTP port: Required when
ProtocolType is not Private, 80 by
default.

TCP port: Required when ProtocolType
is Private, 37777 by default.

+++UserName

char[32] Yes

Username

554

80

37777

admin

+++Password

char[32] Yes

Password, plain text

pass123456

+++ProtocolTy
pe

char[12
8]

Yes

Protocol Type
"Private","Dahua2","Dahua3","General"
,"Onvif","GB28181","Ehome"

"Private"

+++Address

char[16] Yes

Device address

172.11.1.161

++cameras

object[] Yes

Video source information

+++uniqueCha
nnel

Example

int

Yes

Unique channel number, starting from 1 1

{
"group":[{
"DeviceInfo":{
"UserName":"admin",
"Password":"pass123456",

General APIs 120

"ProtocolType":"Private",
"Port":37777,
"Address":"172.11.1.161"

},

        "cameras":[{
                "uniqueChannel":1
        }]
    }]

}

Response Params ( JSON format in body )

Name

group

+deviceID

+cameras

++uniqueChan
nel

Type

object[]

char[128]

object[]

uint

++failedCode

uint

R/O Description

Example

O

O

O

O

O

device group info

device ID

camera info

unique channel

error code.
0: succeed
1: the specific channel does not
support configuration

"uuid:4848"

1

1

Response Example

{
"group": [{
"deviceID": "uuid:4848",
"cameras": [{
"uniqueChannel": 1,
"failedCode": 1
},…{}]
},…{}]
}

4.6.25 Acquiring All Available Resources

Customer requests to obtain camera information, such as MAC address and SN, through CGI

commands.

Request URL

http://<server>/cgi-bin/LogicDeviceManager.cgi?action=getCameraAll

Method

GET

Request Params ( JSON format in body )

Name

Type

R/O

Description

Example

Request Example

{}

Response Params ( JSON format in body )

Name

Type

R/O

Description

Example

General APIs 121

camera

+ControlID

object[]

char[128]

R

O

+Name

+Enable

char[128]

bool

O

O

+DeviceInfo

DeviceInfo

O

++Enable

++EncryptStrea
m

bool

int

O

O

camera info

Control number.
Keyboard users can use the
number to locate channels to
improve operation efficiency.
Control number “0” is not available,
which is reserved for special use.

Name

Enable only when using DeviceID
to add/delete devices. Do not
enable it through DeviceInfo.
true: Meaning trying to connect the
device, but not necessarily
successful. You can acquire the
connection status through
getCameraState.
false: Do not connect the device.
From user's point of view, it is the
same as that the device is not
added.
This Enable field is only used for
the case of adding a device
through DeviceID. We keep this
field for compatibility and
recommend using the Enable in
DeviceInfo.
When acquiring the field, this
Enable and the Enable in
DeviceInfo are returned at the
same time.
When sending the field, you can
only select one between this
Enable and the Enable in
DeviceInfo. We recommend
sending the Enable in DeviceInfo.

Device details.
Use the Enable in the structure to
add/delete devices.
True: Add devices.
False: delete devices from the
channel.
A device can be added only when
"DeviceID" is " " and Info is not
NULL.

The device is enabled or not.

Device stream encryption
algorithm (custom field for NVR).

"5001"

“XXX Road”

true

true

0

General APIs 122

++Address

char[16]

++Port

int

++usePreSecret

enumint8

O

O

O

++UserName

++Password

char[32]

char[32]

++ProtocolType

enumchar[32
]

O

O

O

"10.6.5.10"

37777

1

"admin"

"admin"

"Private"

(If other encryption algorithms are
used, refer to the encryption type
definition in stream format code
0x95).
0: No encryption by default.

Device IP address or domain
name.

Port number.

Select whether to use NVR preset
password to add cameras (the
naming remains the same globally,
so the case is not uniform here).
enumint8{
0: Use UserName/Password to
connect devices (default).
1: When using a preset password
to connect devices,
UserName/Password is not
required.
2: When using camera login
password to connect devices,
UserName/Password is not
required.
}

Username

Password in plain text.

The protocol type of the connected
device. For the value range, see
the ProtocolType field of the
RemoteDevice configuration.
enumchar[32]{
"Private"
"Dahua2"
"Dahua3"
"General"
"Onvif"
"Ehome"
“ICC”: The special protocol for the
central Intelligence platform. It has
not been reviewed, therefore it is
not allowed to add the protocol
type in this way in the future.
"DahuaDSS": The special protocol
for the central Intelligence
platform. It has not been reviewed,
therefore it is not allowed to add
the protocol type in this way in the

General APIs 123

++VideoInput++
Channels

++AudioInput++
Channels

uint

uint

++DeviceClass

char[64]

++DeviceType

char[64]

++HttpPort

++HttpsPort

++RtspPort

++Name

++MachineAddre
ss

int

int

int

char[64]

char[256]

++SerialNo

char[48]

++VendorAbbr

char[32]

++HardID

++SoftwareVersi
on

char[64]

char[64]

++ActivationTime char[24]

O

O

O

O

O

O

O

O

O

O

O

O

O

O

++NodeType

char[32]

O

++Mac

++OEMVendor

char[]

char[]

O

O

future.
}

Total number of video input
channels, including analog and
digital channels

Total number of audio input
channels

16

４

Device type

Device model

HTTP port number

HTTPS port number

RTSP port number

Device name

Device deployment location

Device serial number

"IPC"

"IPC-HF3300"

80

443

554

"IPC1"

“XXX District, YYY
Road”

"Device12345678"

Vendor abbreviation (optional)
Vendor type: VVV (for example).

"VVV"

Hardware ID (optional)

"454"

"2.420.0000006.0.R.
150311"

"2000-01-01
00:00:00"

Software version (optional)

The date when starting using the
device.
Date format: "yyyy-MM-dd
HH:mm:ss”
“Year–Month–Day Hour: Minute:
Second"
Range {"2000-01-01 00:00:00",
/_Minimum date_/
"2099-01-01 00:00:00",/_Maximum
date_/}

Device node type (main or sub
node). It is used when adding
storage node
(DataNodeManager.addDataNode
) in N + M cluster mode.

MAC address

"08:00:20:0A:8C:6D"

"XXX"

OEM vendor type.
During cloud update, for some
vendors, the Vendor field is
displayed as OEM, and
OEMVendor is added to indicate
the actual vendor information.
OEMVendor is the same as
Vendor by default. If OEMVendor
is defined in the product definition,

General APIs 124

+DeviceID

char[128]

O

+Type

enumchar[32
]

O

+VideoStream

enumchar[32
]

O

+Channel

uint

+UniqueChannel

int

O

O

"dev123"

"Remote"

"Main"

0

0

refer to the the product definition.

Device ID
When DeviceID is not " ", ignore
DeviceInfo and use the existing
DeviceID information in the
RemoteDevice configuration.

Input channel type.
enumchar[32]{
"Local": Local channel (physical
channel).
"Remote": Remote channel.
"Reserved32": Reserve 32
channels (compatible with the
device protocol of the second
generation).
"Output": Output channel.
"Matrix”: Analog matrix channel.
"Compose": Composite channel.
"Cascade": Optical fiber cascading
channel.
}

Video stream.
enumchar[32]{
"Main": Main stream
"Extra1": Sub stream 1
"Extra2": Sub stream 2
"Extra3": Sub stream 3
"Auto": Automatically selects the
appropriate stream.
"Preview": Preview raw data
stream.
"None": No video stream (pure
audio stream).
}

Channel number of the remote
device (optional).
DeviceID is unique.

Unique channel number of uniform
device number (required).
You can obtain video/audio
streams by specifying the channel
number with 0x11/0xF4
second-generation protocol.
Notes: When implementing any
addressing function of
DeviceID+Channel,
LogicDeviceManager.getCameraA

General APIs 125

ll() must be implemented, and the
device must support
“DeviceID=Unique” unified
numbering method for input
channels.
For setCamera(), uniqueChannel
equals -1 means that the device
automatically assigns a channel
number.

Indicates the data node to which
the global channel is currently
allocated (N+0 cluster).
Counted from 0. If it is -1 or when
the field does not exist, it means
that it is not allocated currently.

Indicates the local channel of data
node to which the global channel is
currently allocated (N+0 cluster).
Counted from 0. If it is -1 or when
the field does not exist, it means
that it is not currently allocated.

Auto reset.
Compatible process:
If this parameter is not configured,
the default value is false and the
channel cannot be reset
automatically.
when there is no client to access
the video stream (streaming
client access count changes from
non-zero to zero), if
AutoReset=true, the device will
actively enable the channel to be
idle (that is, the video source
attribute Enable=false ).

Current video standard
enumchar[32]{
"PAL"
"NTSC"
"SECAM"
}

Device label
enumchar[32]{
"Indoor": Indoor
"Outdoor": Outdoor
}

1

2

false

"PAL"

"Indoor"

+DataNodeId

int

O

+DataNodeChan
nel

int

O

+AutoReset

bool

O

+VideoStandard

enumchar[32
]

O

+Label

enumchar[32
]

O

+ImageInfo

object

O

Device snapshot

General APIs 126

When adding a device, take a
snapshot and save it to local
computer.

Image path

Password generation method
enumchar[32]{
"UserInput": Entered by users.
"Auto": Automatically generated.
}

"/var/local/ch1.jpg"

"UserInput"

++FilePath

char[256]

+PasswordGenT
ype

enumchar[32
]

R

O

Response Example

{

"camera":[{

"ControlID": "5001",
"Name": "XXX Road",
"Enable": true,
"DeviceInfo":{

"Enable": true,
"EncryptStream": 0,
"Address": "10.6.5.10",
"Port": 37777,
"usePreSecret": 1,
"UserName": "admin",
"Password": "admin",
"ProtocolType": "Private",
"VideoInputChannels": 16,
"AudioInputChannels": 4,
"DeviceClass": "IPC",
"DeviceType": "IPC-HF3300",
"HttpPort": 80,
"HttpsPort": 443,
"RtspPort": 554,
"Name": "IPC1",
"MachineAddress": “XXX District, YYY Road”
"SerialNo": "Device12345678",
"VendorAbbr": "VVV",
"HardID": "454",
"SoftwareVersion": "2.420.0000006.0.R.150311",
"ActivationTime": "2000-01-01 00:00:00",
"NodeType": ",
"Mac": "08:00:20:0A:8C:6D",
"OEMVendor": "XXX"

}
"DeviceID": "dev123",
"Type": "Remote",
"VideoStream": "Main",
"Channel": 0,
"UniqueChannel": 0,

General APIs 127

"DataNodeId": 1,
"DataNodeChannel": 2,
"AutoReset": false,
"VideoStandard": "PAL",
"Label": "Indoor",
"ImageInfo": {

"FilePath": "/var/local/ch1.jpg"

},
"PasswordGenType": "UserInput"

},…{}]

}

4.6.26 Subscribing for Device Online/Offline Status

Subscribe to the online and offline status of the device.

Request URL

http://<server>/cgi-bin/api/LogicDeviceManager/attachCameraState

Method

POST

Request Params (JSON format in body)

Name

channel

Type

int[]

R

R/O Description

Example

[1, 2]

10

Observed unique channel number.
"-1" means all unique channels. If
one of the array elements is "-1", it
will observe all channels.

Send heartbeat interval, range is [1,
60],unit is second. If the URL
contains this parameter, and the
value is 5, it means every 5 seconds
the device should send the heartbeat
message to the client, the heartbeat
message is an string "Heartbeat". If
this parameter is not present, its
default value is 60.

heartbeat

int32

O

Request Example

{

}

"type": [1, 2],
"heartbeat": 10

Response Params (multipart in body)

Name

state

+channel

Type

object

int32

R/O Description

Example

R

R

The new status of the camera

Unique channel number (the
channel number with changed
status)

1

+connectionState

enumchar[12] R

Connection status
enumchar[12]{

“Connected”

General APIs 128

"Connecting"
"Connected"
"Unconnect": Not connected
"Empty": The channel is not
configured and there is no
information.
"Disable": The channel is
configured but disabled (the
protocol cannot be reflected,
and delete it first).
"Changed": The information of
the device connected to the
channel is changed.
"Hibernation"
}

Response Example

HTTP/1.1 200 OK
Content-Type: multipart/x-mixed-replace; boundary=<boundary>
Connection: close

--<boundary>
Content-Type: application/json
Content-Length: <data length>

{

"channel" : 1,
"connectionState" : "Connected"

}
--<boundary>
Content-Type: text/plain
Content-Length: 11

Heartbeat
--<boundary>
…

4.6.27 Get Complete Machine Version

get complete machine version
Request URL http://<server>/cgi-bin/api/MagicBox/getCompleteMachineVersion
Method

POST

Request Params ( JSON format in body )

Name

Type

R/O Description

Example

Request Example

General APIs 129

Response Params ( JSON format in body )

Name
CompleteMac
hineVersion

Type
char[32]

R/O Description
R

complete machine
version

Example
"S2"

Response Example
{
"CompleteMachineVersion": "S2"
}

4.6.28 Connection test

network connection test of devices and http servers

Request URL http://<server>/cgi-bin/api/tcpConnect/tcpTest
Method

POST

Request Params ( JSON format in body )
Name
Ip

Type
char[40]

R/O Description
R

Http server IP

Example
"10.34.9.21"

Port

int32

R

The port number of the
http server

80

Request Example
{
"Ip": "10.34.9.21",
"Port": 80
}

Response Params ( JSON format in body )

R/O Description
R

Whether the connection
is successful

Example
true

Name
Connect

Type
bool

Response Example
{
"Connect": true
}

4.6.29 Getting Online Status of the Channel

POST

Request URL http://<server>/cgi-bin/api/LogicDeviceManager/getCameraState
Method
Request Params ( JSON format in body )
Name
uniqueChanne
ls

R/O Description
R

Unique channel number
If the array is 1, the corresponding
value is -1, and it means to get all

Type
Int[]

Example
[-1]

General APIs 130

the channels.

Request Example
{
"uniqueChannels": [-1]
}

Response Params ( JSON format in body )
Name
states

- channel
  ++connection
  State

R/O Description
Type
Online status
R
object[]
Channel number
uint
R
Connect status
enumchar[12] R
enumchar[12]{
"Connecting": connecting.
"Connected": successfully connected
"Unconnect": configured but not
connect
"Empty”: The channel is not
configured or configured into ""
"Disable": The channel is configured
but disabled.
"UnInited": the front-end devices are
not initialized.
"Hibernation": hibernate
}
Represents whether the current
channel can get capacity from the
front-end devices.
Reason for failed to connect
When the connection status is
unconnected, it is valid.
"LoginConnectFailed", failed to
connect to the internet when login.
"ErrorHasNotInit", failed to login for
the device is not initialized and there
are no users.
"UserOrPwdNotValid", failed to login
for entering the wrong user name or
the wrong password.
"LoginConnectTimeout", login
connection timeout.
"LoginFailure", failed to login for
unknown reason.

char[128]

bool

O

O

++capsState

++errorMessa
ge

Response Example
{

"states" : [ {
"channel" : 0,
"connectionState" : "Connecting",

Example

0
"Connected"

true

"LoginConnectFailed"

General APIs 131

"capsState": true,
"errorMessage": "LoginConnectFailed"
}, …, {}]
}

4.6.30 Getting the Recording Status of the Channel

POST

Request URL http://<server>/cgi-bin/api/recordManager/getStateAll
Method
Request Params ( JSON format in body )
Name
Request Example
{}

R/O Description

Type

Example

Response Params ( JSON format in body )
Name
state

Type
object[]

R/O Description
R

- Main
  ++ State

object
uint

+Extra1

object

R
R

O

+Extra2

object

O

+Extra3

object

O

Response Example
{

"state" : [ {

                        "Main" : {
                                "State" : 1
                        },
                        "Extra1" : {},
                        "Extra2" : {},

Recording status. The array index
represents the corresponding
channel.
Main stream
Whether the main stream is
recording, and if yes, Flag has
meaning.
If the recording can be performed in
sub streams, then it may exist
information such as the recording
status of the sub streams, and it is
the same with field “Main”.
If the recording can be performed in
sub streams, then it may exist
information such as the recording
status of the sub streams, and it is
the same with field “Main”.
If the recording can be performed in
sub streams, then it may exist
information such as the recording
status of the sub streams, and it is
the same with field “Main”.

Example

1

General APIs 132

"Extra3" : {}
}, …, {}]
}

4.7 User management

4.7.1 Get Information of a Particular User

Table 4-42

Syntax

Method

http://<server>/cgi-bin/userManager.cgi?action=getUserInfo&name=<userName>

GET

Description

Get user information with name userName.

Example

http://192.168.1.108/cgi-bin/userManager.cgi?action=getUserInfo&name=admin

user.Name=admin
user.Memo=admin 's account
user.Group=admin
user.Reserved=true
user.Sharable=true
user.PwdValidPeriod=30
user. AuthList=<authList>
—

Success
Return

Comment

4.7.2 Get Information of All Users

Table 4-43

Syntax

Method

http://<server>/cgi-bin/userManager.cgi?action=getUserInfoAll

GET

Description

Get information of all users.

Example

http://192.168.1.108/cgi-bin/userManager.cgi?action=getUserInfoAll

users[0].Group=admin
users[0].Id=1
users[0].Memo=admin 's account
users[0].Name=admin
users[0].Reserved=true
users[0].Sharable=true
users[0].PwdValidPeriod=30
users[0]. AuthList=<authList>
users[1].Group=admin
…
—

Success
Return

Comment

General APIs 133

4.7.3 Get Information of All Active Users

Table 4-44

Syntax

Method

http://<server>/cgi-bin/userManager.cgi?action=getActiveUserInfoAll

GET

Description

Get active users.

Example

http://192.168.1.108/cgi-bin/userManager.cgi?action=getActiveUserInfoAll

Success
Return

Comment

users[0].name=admin
users[0].ip=10.43.2.16
users[0].group=admin
users[0].clienttype=web3.0
users[0].logintime=2011-11-08 09:51:03
—

4.7.4 Get Information of a Particular Group

Table 4-45

Syntax

Method

http://<server>/cgi-bin/userManager.cgi?action=getGroupInfo&name=<groupName>

GET

Description

Get group setting with name groupName.

Example

http://192.168.1.108/cgi-bin/userManager.cgi?action=getGroupInfo&name=admin

Success
Return

group.Name=admin
group.Memo=administrator group
group.AuthorityList=<authList>

Comment

Parameters in URL:
The device has one or two default user groups: "admin"or "admin"and "user". The
"admin"group has all the authorities of operating the device. The "user"group only has
monitoring and replaying authorities.
groupName: name of the group.
If the group named groupName does not exist, the device returns Error.

4.7.5 Get Information of All Groups

Table 4-46

Syntax

Method

http://<server>/cgi-bin/userManager.cgi?action=getGroupInfoAll

GET

Description

Get information of all groups.

Example

http://192.168.1.108/cgi-bin/userManager.cgi?action=getGroupInfoAll

Success
Return

group[0].Id=1
group[0].Name=admin
group[0].Memo=administrator group
group[0].AuthorityList=<authList>
group[0].AuthorityDetail.Bypass[0]=1

General APIs 134

group[0].AuthorityDetail.Bypass[1]=2
group[0].AuthorityDetail.Bypass[2]=3
…
group[0].AuthorityDetail.AccessControl[0]=1
group[0].AuthorityDetail.AccessControl[1]=3
group[0].AuthorityDetail.AccessControl[2]=5
…
group[1].Id=1
group[1].Name=user
group[1].Memo=user group
group[1].AuthorityList=<authList>
group[1]….
…
—

Comment

4.7.6 Add a New User

Access Control products are not supported.

Table 4-47

Syntax

http://<server>/cgi-bin/userManager.cgi?action=addUser&user.Name=<userName>&u
ser.Password=<userPassword>&user.Group=<userGroup>&user.Sharable=<userSh
arable>[&user.Memo=<userMemo>&user.Reserved=<userReserved>]

Method

GET

Description

Add a user.

Example

Success
Return

Comment

http://192.168.1.108/cgi-bin/userManager.cgi?action=addUser&user.Name=George&us
er.Password=123456&user.Group=user&user.Sharable=true&user.Reserved=false

OK

Parameters in URL:
userGroup: string, the range is "admin"and "user". In different group, the user has
different authorities.
userSharable: bool, true means allow multi-point login.
userReserved: bool, true means this user can't be deleted.

4.7.7 Delete a User

Access Control products are not supported.

Table 4-48

Syntax

Method

http://<server>/cgi-bin/userManager.cgi?action=deleteUser&name=<userName>

GET

Description

Delete user with name username.

Example

Success
Return

http://192.168.1.108/cgi-bin/userManager.cgi?action=deleteUser&name=George

OK

General APIs 135

Comment

—

4.7.8 Modify User Information

Access Control products are not supported.

Table 4-49

Syntax

http://<server>/cgi-bin/userManager.cgi?action=modifyUser&name=<UserName>&user
.Memo=<userMemo>&user.Group=<userGroup>&user.Reserved=<userReserved>&us
er.Sharable=<userSharable>

Method

GET

Description

Modify user info.

Example

Success
Return

http://192.168.1.108/cgi-bin/userManager.cgi?action=modifyUser&name=George&user
.Group=admin

OK

Comment

User is identified by <UserName>, other params are the same with AddUser.

4.7.9 Modify User's Password

Access Control products are not supported.

Syntax

http://<server>/cgi-bin/userManager.cgi?action=modifyPassword&name=<username>
&pwd=<newPwd>&pwdOld=<oldPwd>

Table 4-50

Method

GET

Description

Modify user password.

Example

Success
Return

http://192.168.1.108/cgi-bin/userManager.cgi?action=modifyPassword&name=George
&pwd=abcdef&pwdOld=123456

OK

Comment

Old password oldPwd should be supplied, new password is newPwd.

4.7.10 Manager Modify Common User's Password

Access Control products are not supported.

Table 4-51

Syntax

http://<server>/cgi-bin/userManager.cgi?action=modifyPasswordByManager&userNam
e=<username>&pwd=<newPwd>&managerName=<managerName>&managerPwd=
<managerPwd>&accountType=<accountType>

Method

GET

Description

Manager Modify common user's password.

Example

http://192.168.1.108/cgi-bin/userManager.cgi?action=modifyPasswordByManager&use
rName=Geoge&pwd=123456&managerName=admin&managerPwd=abc123&account

General APIs 136

Success
Return

Comment

Type=0

OK

the name of common user to be modified is username
new password is newPwd
manager name is only admin
manager password is managerPwd, that is password of admin
accountType support 0 is common account, 1 is Onvif account

4.7.11 [Config] Set User Login Authentication Policy

Table 4-52

Syntax

http://<server>/cgi-bin/configManager.cgi?action=setConfig&<paramName>=<paramV
alue>[&<paramName>=<paramValue>…]

Method

GET

Description

Set User Login Authenticate Policy

Example

Success
Return

Comment

http://192.168.1.108/cgi-bin/configManager.cgi?action=setConfig&LoginAuthCtrl.PriSvr
Policy=2

OK

LoginAuthCtrl.PriSvrPolicy : login policy setting for Private Protocol.
1 - safe mode, only support digest authentication. (Recommended.);
2 - compatible mode for traditional devices;

4.7.12 Export all the user info

Export all the user info in Excel format
Request URL http://<server>/cgi-bin/api/userManager/accountFileExport
Method
Request Params ( JSON format in body )
Name
FileType

R/O Description
是

Example
1

Type
uint32

POST

file type；
1：account file
2：template file

Request Example
{
"FileType": 1
}

Response Params (binary in body )
Name
Type
Response Example
HTTP/1.1 200 OK
Server: Device/1.0
Content-Type: application/octet-stream

R/O Description

Example

General APIs 137

Content-Length: <length>

< binary data>

4.8 Network

4.8.1 Get Network Interfaces

Table 4-53

Syntax

Method

http://<server>/cgi-bin/netApp.cgi?action=getInterfaces

GET

Description

Get all of the system network interfaces.

Example

http://192.168.1.108/cgi-bin/netApp.cgi?action=getInterfaces

Success
Return

netInterface[0].Name=eth0
netInterface[0].Type=Normal
netInterface[0].Valid=true
…
netInterface[1].Name=3g
netInterface[1].Type=Auto,WCDMA,TD-SCDMA,TD-LTE,FDD-LTE
netInterface[1].Valid=true
…

result item value:
Name: network interface name.
"eth0" - wired network interface
"eth2" - wireless network interface
"3G" - 3G network interface
"bond0" - bond network interface
"bond1" - bond network interface
Not listed in detail

Comment

Type: Network types that support settings
"Normal" — wired network
"Wireless" — wireless network
"Auto", "TD-SCDMA", "WCDMA", "CDMA1x", "EDGE", "EVDO", "TD-LTE", "FDD-LTE",
"NR" — 3G network types.

Valid: network interface is valid if netInterface[n].Valid is true.

4.8.2 Get Client Access Filter

Syntax

Method

http://<server>/cgi-bin/configManager.cgi?action=getConfig&name=AccessFilter

GET

Table 4-54

General APIs 138

Description

Get access filter config.

Example

Success
Return

Comment

Appendix:

ParamName

http://192.168.1.108/cgi-bin/configManager.cgi?action=getConfig&name=AccessFilter

table.AccessFilter.Enable=false
table.AccessFilter.TrustList[0]=10.6.10.23
table.AccessFilter.TrustList[1]=10.6.10.62
table.AccessFilter.Type=TrustList

Parameters in Response:
Type: Range is {TrustList, BannedList}. If Trustlist is supported, Bannedlist is not
supported.
More information in Appendix.

ParamValue type

Description

AccessFilter.BannedList[index]

AccessFilter.TrustList[index]

AccessFilter.Enable

string

string

bool

AccessFilter.Type

string

Banned IP address list

Trusted IP address list

Enable/Disable access filter function

Range is {TrustList, BannedList},
TrustList: Trust list is used, banned list
is not used.
BannedList: Banned list is used, trust
list is not used.

4.8.3 [Config] Network Basic Config

 Get network config

Table 4-55

Syntax

Method

Description

http://<server>/cgi-bin/configManager.cgi?action=getConfig&name=Network

GET

Get network basic config. The basic config contains basic network parameters (default
interface, domain name, host name), and configuration of each network interface.

Example

http://192.168.1.108/cgi-bin/configManager.cgi?action=getConfig&name=Network

Success
Return

table.Network.DefaultInterface=eth0
table.Network.Domain=ttt
table.Network.Hostname=hhh
table.Network.interface.DefaultGateway=10.7.0.1
table.Network.interface.DhcpEnable=false
table.Network.interface.DnsServers[0]=221.123.33.228
table.Network.interface.DnsServers[1]=221.12.1.228
table.Network.interface.IPAddress=10.7.2.3
table.Network.interface.MTU=1500
table.Network.interface.PhysicalAddress=00:10:5c:f2:1c:b4
table.Network.interface.SubnetMask=255.255.0.0

Comment

interface in response is network interface name, such as eth0, eth2…

 Set network config

General APIs 139

Table 4-56

Syntax

http://<server>/cgi-bin/configManager.cgi?action=setConfig&<paramName>=<paramV
alue>[&<paramName>=<paramValue>…]

Method

GET

Description

Set network basic config.

Example

Success
Return

http://192.168.1.108/cgi-bin/configManager.cgi?action=setConfig&NetWork.Domain=ttt
&NetWork.eth0.DhcpEnable=true

OK

Comment

interface in below ParamName is network interface name, such as eth0 and eth2

Appendix:

ParamName

ParamValue type Description

Network.DefaultInterface

string

Network.Domain

Network.Hostname

Network.interface.DefaultGateway

Network.interface.DhcpEnable

Network.interface.DnsServers[0]

Network.interface.DnsServers[1]

Network.interface.IPAddress

string

string

string

bool

string

string

string

Set default network
multiple interfaces exist.
Range of
GetInterfaces.

interfaces

interface when

is depends on

Domain name.

Hostname and Domain compose a
network address.

IP address.

Enable/Disable DHCP.

IP address of first DNS server.

IP address of second DNS server.

Interface IP address.

Network.interface.MTU

integer

Interface MTU.

Network.interface.PhysicalAddress

string

Network.interface.SubnetMask

string

Network.interface.EnableDhcpReserv
edIP

bool

4.8.4 [Config] PPPoE

 Get PPPoE config

MAC address of interface.
HEX string in the form of:
xx:xx:xx:xx:xx:xx.
Range of x is [0-9, a-f, A-F]
Example:
00:10:5c:f2:1c:b4
00:10:5C:F2:1C:B5

Network mask string:
In the form of x.x.x.x, range of x is [0-255]
Example:
255.255.255.0

Enable/Disable
when dhcp failed, it will continue sending
dhcp request, if it was enabled.

General APIs 140

Table 4-57

Syntax

Method

http://<server>/cgi-bin/configManager.cgi?action=getConfig&name=PPPoE

GET

Description

Get PPPoE config.

Example

http://192.168.1.108/cgi-bin/configManager.cgi?action=getConfig&name=PPPoE

table.PPPoE.Enable=true,
table.PPPoE.AuthType[0]=PAP,
table.PPPoE.UserName=hz150260,
table.PPPoE.Password=Dont Know,
table.PPPoE.Mode=Default,
table.PPPoE.Eth=eth0,
table.PPPoE.DefaultPPPoEInterface=ppp0,
table.PPPoE.PPPOE1.Enable=true,
table.PPPoE.PPPOE1.AuthType[0]=PAP,
table.PPPoE.PPPOE1.UserName=hz150260,
table.PPPoE.PPPOE1.Password=Don’t Know,
table.PPPoE.PPPOE1.Mode=Custom,
table.PPPoE.PPPOE1.Eth=eth1
—

Success
Return

Comment

 Set PPPoE config

Table 4-58

Syntax

http://<server>/cgi-bin/configManager.cgi?action=setConfig&<paramName>=<paramV
alue>[&<paramName>=<paramValue>…]

Method

GET

Description

Set PPPoE config.

Example

Success
Return

Comment

http://192.168.1.108/cgi-bin/configManager.cgi?action=setConfig&PPPoE.UserName=
user1&PPPoE.Password=123456

OK

—

Appendix:

ParamName

PPPoE.Enable

PPPoE.UserName

PPPoE.Password

ParamValue type

Description

bool

string

string

Enable/Disable PPPoE.

PPPoE user name.

PPPoE user password.

4.8.5 [Config] DDNS

 Get DDNS config

Syntax

http://<server>/cgi-bin/configManager.cgi?action=getConfig&name=DDNS

Table 4-59

General APIs 141

Method

GET

Description

Get DDNS config.

Example

Success
Return

http://192.168.1.108/cgi-bin/configManager.cgi?action=getConfig&name=DDNS

table.DDNS[index].Address=www.ttt.com
table.DDNS[index].Enable=true
table.DDNS[index].HostName=www.ttt.com
table.DDNS[index].KeepAlive=10
table.DDNS[index].Password=none
table.DDNS[index].Port=5050
table.DDNS[index].Protocol= Quick DDNS
table.DDNS[index].UserName=user1
table.DDNS[index].DefaultHostName.Enable=false
table.DDNS[index].DefaultHostName.HostName=9002A9D77133.ttt.com

Comment

index in response is the DDNS protocol table index, start from 0.
The meaning of parameters can refer to SetDDNSConfig chapter.

 Set DDNS config

Syntax

http://<server>/cgi-bin/configManager.cgi?action=setConfig&<paramName>=<paramV
alue>[&<paramName>=<paramValue>…]

Table 4-60

Method

GET

Description

Set DDNS config.

Example

Success
Return

http://192.168.1.108/cgi-bin/configManager.cgi?action=setConfig&DDNS[0].Address=w
ww.ttt.com&DDNS[0].Enable=true

OK

Comment

index in below ParamName is the DDNS protocol table index, start from 0.

Appendix:

ParamName

ParamValue type

Description

DDNS[index].Address

string

DDNS server IP address or name.

DDNS[index].Enable

bool

DDNS[index].HostName

String

DDNS[index].KeepAlive

integer

DDNS[index].Password

string

DDNS[index].Port

integer

Multiple DDNS hostname can be configured,
but Only one hostname can be enabled,
others should not be enabled.

Hostname of this device.
Range is [1—65535].
Unit is minutes.

DDNS user password
Range is [1—65535].
Port of DDNS server

General APIs 142

ParamName

ParamValue type

Description

DDNS[index].Protocol

string

DDNS protocol type.
Range is {
"PRIVATE DDNS": private ddns version 1
"Private DDNS": private ddns version 2
"CN99 DDNS"
"NO-IP DDNS"
"Dyndns DDNS"
"LUPUS DDNS"
"Oray DDNS"
"CP Plus DDNS"
"Ipplus DDNS"
"Q-See DDNS"
"SYSDNS DDNS"
"Videotrend DDNS"
"CEPSA DDNS"
"G4IP DDNS"
"HOSS DDNS"
"Intelbras DDNS"
"HSY DDNS"
"Flir DDNS"
"Private P2P DDNS": private ddns for P2P
"Mivigilante DDNS"
"ByDemes DDNS"
"DYNDNS OLD DDNS": old dyndns for storate
device
"WATASHI DDNS"
"CNB DDNS"
"Peoplefu DDNS"
"MINT DDNS"
"SPECO DDNS"
"SHANY DDNS"
"WITHCCTV DDNS":
"SONIC DDNS"
"KBVISION DDNS"
"BOSCH DDNS"
}.

DDNS[index].UserName

string

DDNS user name

DDNS[index].DefaultHostName
.Enable

bool

DDNS[index].DefaultHostName
.HostName

string

Only protocol is in range {"Private DDNS",
"DHDDNS", "QUICK DDNS"}, it effects.
true : use the DefaultHostName.HostName
false: use the HostName

The default hostname. It cannot be modified.

General APIs 143

4.8.6 [Config] Email

 Get email config

Table 4-61

Syntax

Method

http://<server>/cgi-bin/configManager.cgi?action=getConfig&name=Email

GET

Description

Get Email config.

Example

http://192.168.1.108/cgi-bin/configManager.cgi?action=getConfig&name=Email

table.Email.Address=www.ttt.com
table.Email.Anonymous=true
table.Email.AttachEnable=true
table.Email.Enable=true
table.Email.HealthReport.Enable=false
table.Email.HealthReport.Interval=61
table.Email.Password=123456
table.Email.Port=26
table.Email.Receivers[0]=x@tttt.com
table.Email.Receivers[1]=y@ttt.com
table.Email.Receivers[2]=z@ttt.com
table.Email.SendAddress=x@ttt.com
table.Email.SslEnable=false
table.Email.TlsEnable=false
table.Email.Authentication=false
table.Email.OnlyAttachment=false
table.Email.SendInterv=10
table.Email.Title=DVRMessage
table.Email.UserName=anonymity
—

Success
Return

Comment

 Set email config

Table 4-62

Syntax

http://<server>/cgi-bin/configManager.cgi?action=setConfig&<paramName>=<paramV
alue>[&<paramName>=<paramValue>…]

Method

GET

Description

Set Email config.

Example

Success
Return

Comment

Appendix:

ParamName

Email.Address

http://192.168.1.108/cgi-bin/configManager.cgi?action=setConfig&Email.Address=mail.
ttt.com&Email.Anonymous=false

OK

—

ParamValue type Description

string

SMTP server IP address or name.

General APIs 144

ParamName

ParamValue type Description

Email.Anonymous

Email.AttachEnable

Email.AttachmentEnable

Email.Enable

bool

bool

bool

bool

Enable/Disable anonymous email.

Enable/Disable email attachment

Enable/Disable email attachment

Enable/Disable email function

Email.HealthReport.Enable bool

Enable/Disable report device status by email.

Email.HealthReport.Interval

integer

Email.Password

Email.Port

Email.Receivers[0]

Email.Receivers[1]

Email.Receivers[2]

Email.SendAddress

Email.SslEnable

Email.Title

Email.UserName

string

integer

string

string

string

string

bool

string

string

4.8.7 [Config] WLan

 Get WLan config

Range is [30-1440].
Unit is minutes

User password of email account.

Range is [1-65535]

Email addresses of 3 receivers.

Sender email address.

True: enable SSL email.

Title of email.

User name of email account.

Table 4-63

Syntax

Method

http://<server>/cgi-bin/configManager.cgi?action=getConfig&name=WLan

GET

Description

Get Wlan config.

Example

http://192.168.1.108/cgi-bin/configManager.cgi?action=getConfig&name=WLan

table.WLan.eth2.Enable=true
table.WLan.eth2.Encryption=off
table.WLan.eth2.KeyFlag=false
table.WLan.eth2.KeyID=0
table.WLan.eth2.KeyType=Hex
table.WLan.eth2.Keys[0]=password1
table.WLan.eth2.Keys[1]=password2
table.WLan.eth2.Keys[2]=password3
table.WLan.eth2.Keys[3]=password4
table.WLan.eth2.LinkMode=Auto
table.WLan.eth2.SSID=ttt
—

Success
Return

Comment

 Set WLan config

Table 4-64

Syntax

http://<server>/cgi-bin/configManager.cgi?action=setConfig&<paramName>=<paramV
alue>[&<paramName>=<paramValue>…]

Method

GET

General APIs 145

Description

Set WLan config.

Example

Success
Return

http://192.168.1.108/cgi-bin/configManager.cgi?action=setConfig&WLan.eth2.Enable=t
rue&WLan.eth2.KeyType=Hex

OK

Comment

In below ParamName, interface is name of wireless interface.

Appendix:

ParamName

ParamValue type Description

WLan.interface.Enable

bool

True: Enable WLan on this interface.

WLan.interface.Encryption string

WLan.interface.KeyFlag

bool

WLan.interface.KeyID

integer

WLan.interface.KeyType

WLan.interface.Keys[0]

WLan.interface.Keys[1]

WLan.interface.Keys[2]

string

string

string

string

WLan.interface.Keys[3]

string

WLan.interface.LinkMode

string

{Off, On, WEP64Bits, WEP128Bits,

is

Range
WPA-PSK-TKIP, WPA-PSK-CCMP}
Encryption mode.

true: key is configured.
Range is [0—3]
Indicates which key is used.
0: WLan.interface.Keys[0] is used.

Range is {Hex, ASCII]

For ASCII key type: 64bits encryption key length is 5,
128bits encryption key length is 13, consists of [0—9,
a—z, A—Z]
For HEX key type: 64bits encryption key length is 10,
128bits encryption key length is 26, consists of [0—9,
a—z, A—Z]
Range is {Auto, Ad-hoc, and Infrastructure}.
Auto – select suitable mode automatically.
Ad-hoc – Device with wireless network adapter can
connect to each other without Access Point.
Infrastructure – Integrate wire and wireless LAN
together to share network resource, access point is
need in this mode.

WLan.interface.SSID

string

SSID.

4.8.8 Scan Wlan Devices

Table 4-65

Syntax

http://<server>/cgi-bin/wlan.cgi?action=scanWlanDevices&<paramName>=<paramVal
ue>[&<paramName>=<paramValue>…]

Method

GET

Description

Search Wi-Fi device information.

Example

Success
Return

http://192.168.1.108/cgi-bin/wlan.cgi?action=scanWlanDevices&SSID=xia_yuguo
13098 Internet

found=1
wlanDevice[0].ApConnected=0
wlanDevice[0].ApMaxBitRate=54000000

General APIs 146

wlanDevice[0].ApNetWorkType=255
wlanDevice[0].AuthMode=7
wlanDevice[0].BSSID=28:2c:b2:5c:de:36
wlanDevice[0].EncrAlgr=3
wlanDevice[0].LinkMode=0
wlanDevice[0].LinkQuality=31
wlanDevice[0].RSSIQuality=0
wlanDevice[0].SSID=xia_yuguo 13098 Internet
—

Comment

Appendix:

ParamName ParamValue type

Description

SSID

string

Specified SSID, if not include any SSID, all Wi-Fi information
will be searched and displayed.

4.8.9 [Config] UPnP

 Get UPnP config

Table 4-66

Syntax

Method

http://<server>/cgi-bin/configManager.cgi?action=getConfig&name=UPnP

GET

Description

Get UPnP config.

Example

Success
Return

http://192.168.1.108/cgi-bin/configManager.cgi?action=getConfig&name=UPnP

table.UPnP.Enable=true
table.UPnP.MapTable[index].Enable=true
table.UPnP.MapTable[index].InnerPort=80
table.UPnP.MapTable[index].OuterPort=8080
table.UPnP.MapTable[index].Protocol=TCP
table.UPnP.MapTable[index].ServiceName=HTTP

Comment

index in response is the UPNP map table index, start from 0.

 Set UPnP config

Syntax

http://<server>/cgi-bin/configManager.cgi?action=setConfig&<paramName>=<paramV
alue>[&<paramName>=<paramValue>…]

Table 4-67

Method

GET

Description

Set UPnP config.

Example

Success
Return

http://192.168.1.108/cgi-bin/configManager.cgi?action=setConfig&UPnP.Enable=true&
UPnP.MapTable[0].Protocol=TCP

OK

Comment

index in below ParamName is UPNP map table index, range is [0-255]

Appendix:

General APIs 147

ParamValue type

Description

ParamName

UPnP.Enable

UPnP.MapTable[index].Enable

bool

bool

UPnP.MapTable[index].InnerPort

integer

UPnP.MapTable[index].OuterPort

integer

Enable/Disable UPNP feature.

Enable/Disable this UPNP map.
Range is [1—65535].
Inner port number
Range is [1—65535].
Outer port number.

UPnP.MapTable[index].Protocol

string

Range is {TCP, UDP]

UPnP.MapTable[index].ServiceName string

User defined UPnP service name.

4.8.10 Get UPnP Status

Table 4-68

Syntax

Method

http://<server>/cgi-bin/netApp.cgi?action=getUPnPStatus

GET

Description

Get UPnP Status.

Example

http://192.168.1.108/cgi-bin/netApp.cgi?action=getUPnPStatus

status.InnerAddress=0.0.0.0
status.OuterAddress=0.0.0.0
status.PortMapStatus[0]=Failed
status.PortMapStatus[1]=Failed
status.PortMapStatus[2]=Failed
status.PortMapStatus[3]=Failed
status.Status=Unknown
status.Working=false
—

Success
Return

Comment

4.8.11 [Config] NTP

 Get NTP config

Table 4-69

Syntax

Method

http://<server>/cgi-bin/configManager.cgi?action=getConfig&name=NTP

GET

Description

Get NTP config

Example

http://192.168.1.108/cgi-bin/configManager.cgi?action=getConfig&name=NTP

Success
Return

table.NTP.Address=clock.isc.org
table.NTP.Enable=false
table.NTP.Port=38
table.NTP.TimeZone=9
table.NTP.UpdatePeriod=31
table.NTP.ServerList[0].Enable=true,
table.NTP.ServerList[0].Address=192.168.1.108,
table.NTP.ServerList[0].Port=123
table.NTP.Tolerance=5,

General APIs 148

Comment

table.NTP.TimeZoneDesc=GMT
—

 Set NTP config

Syntax

http://<server>/cgi-bin/configManager.cgi?action=setConfig&<paramName>=<param
Value>[&<paramName>=<paramValue>…]

Table 4-70

Method

GET

Description

Set NTP config.

Example

Success
Return

Comment

http://192.168.1.108/cgi-bin/configManager.cgi?action=setConfig&NTP.Address=time.tt
t.com&NTP.Enable=true

OK

—

4.8.12 [Config] RTSP

 Get RTSP config

Table 4-71

Syntax

Method

http://<server>/cgi-bin/configManager.cgi?action=getConfig&name=RTSP

GET

Description

Get RTSP config.

Example

http://192.168.1.108/cgi-bin/configManager.cgi?action=getConfig&name=RTSP

Success
Return

Comment

table.RTSP.Enable=true
table.RTSP.Port=554
table.RTSP.RTP.EndPort=40000
table.RTSP.RTP.StartPort=20000
—

 Set RTSP config

Syntax

http://<server>/cgi-bin/configManager.cgi?action=setConfig&<paramName>=<param
Value>[&<paramName>=<paramValue>…]

Table 4-72

Method

GET

Description

Set RTSP config.

http://192.168.1.108/cgi-bin/configManager.cgi?action=setConfig&RTSP.Enable=true&
RTSP.Port=554

OK

—

Example

Success
Return

Comment

Appendix:

ParamName

ParamValue type

Description

General APIs 149

ParamName

RTSP.Enable

RTSP.Port

RTSP.RTP.StartPort

RTSP.RTP.EndPort

ParamValue type

Description

bool

integer

integer

integer

Enable/Disable RTSP.

RTSP port.

RTP start port.

RTP end port.

4.8.13 [Config] Alarm Server

 Get alarm server config

Table 4-73

Syntax

Method

http://<server>/cgi-bin/configManager.cgi?action=getConfig&name=AlarmServer

GET

Description

Get alarm server config.

Example

http://192.168.1.108/cgi-bin/configManager.cgi?action=getConfig&name=AlarmServer

table.AlarmServer.Address=10.7.8.9
table.AlarmServer.Enable=false
table.AlarmServer.Password=
table.AlarmServer.Port=8888
table.AlarmServer.Protocol=ttt
table.AlarmServer.ReportTime=02:00:00
table.AlarmServer.ReportWeekDay=2
table.AlarmServer.UserName=admin
—

Success
Return

Comment

 Set alarm server config

Table 4-74

Syntax

http://<server>/cgi-bin/configManager.cgi?action=setConfig&<paramName>=<param
Value>[&<paramName>=<paramValue>…]

Method

GET

Description

Set Alarm Server config.

http://192.168.1.108/cgi-bin/configManager.cgi?action=setConfig&AlarmServer.Addres
s=as.ttt.com&AlarmServer.Enable=false

OK

—

Example

Success
Return

Comment

Appendix:

ParamName

ParamValue type

Description

AlarmServer.Address

string

AlarmServer.Enable

bool

AlarmServer.Port

integer

Alarm server IP address or name.

Enable/Disable Alarm server.
Range is [1—65535].
Port of Alarm server.

General APIs 150

4.8.14 [Config] Onvif Service Authorization

 Get config of Onvif service authorization

Table 4-75

Syntax

Method

http://<server>/cgi-bin/configManager.cgi?action=getConfig&name=UserGlobal

GET

Description

Get user global config.

Example

Success
Return

Comment

http://192.168.1.108/cgi-bin/configManager.cgi?action=getConfig&name=UserGlobal

table.UserGlobal.OnvifLoginCheck=false

If "OnvifLoginCheck" is false, you can get Onvif service directly; if true, you should enter
your ID/username and password.

 Set config of Onvif service authorization

Table 4-76

Syntax

http://<server>/cgi-bin/configManager.cgi?action=setConfig&UserGlobal.OnvifLoginCh
eck=<flag>

Method

GET

Description

Enable onvif login check or not.

Example

Success
Return

Comment

http://192.168.1.108/cgi-bin/configManager.cgi?action=setConfig&UserGlobal.OnvifLog
inCheck=true

OK

Parameters in URL:
flag : range is {true, false}.

4.8.15 [Config] SSHD Config

 Get SSHD config

Table 4-77

Syntax

Method

http://<server>/cgi-bin/configManager.cgi?action=getConfig&&name=SSHD

GET

Description Get SSHD Config

Example

http://<server>/192.168.1.108/configManager.cgi?action=getConfig&&name=SSHD

Success
Return
Comment —

table.SSHD.Enable=true
table.SSHD.Port=22

 Set SSHD config

Syntax

http://<server>/cgi-bin/configManager.cgi?action=setConfig&<paramName>=<paramVal

Table 4-78

General APIs 151

ue>[&<paramName>=<paramValue>...]

Method

GET

Description Set SSHD Config

http://192.168.1.108/cgi-bin/configManager.cgi?action=setConfig&SSHD.Enable=true&S
SHD.Port=22
OK

Example

Success
Return
Comment —

4.8.16 [Config] Cellular Network Traffic Packages

Parameters:

Config Data Params

Name
CellularFlux

+3G

Type
object

object

O

R/O Description
O

Configure cellular network traffic packages.

Example

Connect cellular network.
Supports 4 cellular modules. Single
module: 3G; multiple modules: 3G, 3G1,
3G2, and 3G3.
Notes: Considering the compatibility, the
3G naming is reserved, which can actually
represent 4G and 5G network adapters.

Configure the traffic package of the first
SIM card. If there is a second one, it will be
named SIM2, and the third one will be
named SIM3.

++SIM1

object

O

+++Enable

+++MonthFlux
++++FluxUp

bool

object
uint32

O

O
O

Enable traffic strategy.

Configure monthly traffic.
The upper limit of traffic usage

++++FluxUpUnit

char[32] O

++++FluxWarn
++++FluxWarnUni
t

uint32
O
char[32] O

++++FluxStartDay uint32

O

The upper limit unit of traffic usage. GB and
MB are available.

The upper limit of traffic reminders
The upper limit unit of traffic reminders. GB
and MB are available.

The digit indicates what day the package
starts every month.

1

false

299

"GB"

99
"GB"

Please refer to "4.2.1 Get and Set Configure" for configuration getting and setting. Specific
examples are as follows :

Get Config Request Example
http://192.168.1.108/cgi-bin/configManager.cgi?action=getConfig&name=CellularFlux

Get Config Response Example
table.CellularFlux.3G.SIM1.Enable=true
table.CellularFlux.3G.SIM1.MonthFlux.FluxStartDay=1
table.CellularFlux.3G.SIM1.MonthFlux.FluxUp=299
table.CellularFlux.3G.SIM1.MonthFlux.FluxUpUnit=GB

General APIs 152

table.CellularFlux.3G.SIM1.MonthFlux.FluxWarn=99
table.CellularFlux.3G.SIM1.MonthFlux.FluxWarnUnit=GB

Set Config Request Example
http://192.168.1.108/cgi-bin/configManager.cgi?action=setConfig&CellularFlux.3G.SIM1.Enable=true&C
ellularFlux.3G.SIM1.MonthFlux.FluxStartDay=1&CellularFlux.3G.SIM1.MonthFlux.FluxUp=299&Cellular
Flux.3G.SIM1.MonthFlux.FluxUpUnit=GB&CellularFlux.3G.SIM1.MonthFlux.FluxWarn=99&CellularFlux.
3G.SIM1.MonthFlux.FluxWarnUnit=GB

Set Config Response Example
OK

4.8.17 Obtaining the Traffic Information of Current Month

Acquiring the traffic information of current month

Request URL

http://<server>/cgi-bin/api/DataFlux/getFlux

Method

POST

Request Params ( JSON format in body )

Name

card

Type

char[32]

R

R/O

Description

The key value of the
first-level node under
Wireless. For earlier
devices, it represents
the SIM card number;
For new devices, it
represents the module
name. The specific
values are:
enumchar[32]{
3G
3G1
3G2
3G3
}
Single card/module: 3G;
Multiple cards/modules:
3G, 3G1, 3G2, and
3G3.

SIM card name. The
first SIM card is SIM1,
the second SIM2, and
the third SIM3.

IC card identification
code (namely SIM card
number). It consists of
20 digits.

Example

"3G"

"SIM1"

General APIs 153

SimName

char[32]

O

ICCID

char[24]

O

Request Example

{

"card": "3G",
"SimName": "SIM1",
"ICCID": "898607E2112251029357"
}

Response Params ( JSON format in body )

Name

info

+LastMonthTotal
Flux

Type

object

uint

+totalFlux

uint

+SendFlux

uint

+RecvFlux

uint

+Time

string
YYYY-MM-DD
hh:mm:ss

+Record

object[]

++Date

string

++DaySendFlux

uint

++DayRecvFlux

uint

++DayTotalFlux

uint64

++MonthTotalFlu
x

uint64

Response Example

R/O

Description

Example

R

R

R

R

R

R

R

R

R

R

O

O

Traffic information.

The total traffic of the
last month. Unit: 0.1 kb.

Total traffic = uplink
traffic + downlink traffic.
Unit: 0.1 kb.

Uplink traffic. Unit: 0.1
kb.

Downlink traffic. Unit:
0.1 kb.

Total traffic write time.

8000

8000

3000

5000

"2014-01-01 14:01:01
"

Traffic records in the
last seven days.

Date.

"2014-01-01"

Uplink traffic of the day.
Unit: 0.1 kb.

Downlink traffic of the
day. Unit: 0.1 kb.

The total traffic of the
day. Unit: Byte.

The total traffic of the
month. Unit: Byte.

3000

3000

8000

8000

{
"info": {
LastMonthTotalFlux" : 8000,
"totalFlux" : 8000,
"SendFlux": 3000,
"RecvFlux": 5000,
"Time": "2014-01-01 14:01:01",
"Record" : [{
"Date": "2014-01-01",
"DaySendFlux" : 3000,
"DayRecvFlux" : 3000,
"DayTotalFlux" : 8000,

"MonthTotalFlux" : 8000

            }, …, {}]        }

General APIs 154

}

4.8.18 Searching for History Traffic Statistics According to Specified

Conditions

Searching for history traffic statistics by specified conditions.

Request URL

http://<server>/cgi-bin/api/DataFlux/queryHistoryFlux

Method

POST

Request Params ( JSON format in body )

R/O

Description

Example

Name

condition

+Card

Type

object

char[32]

R

R

Search condition

The key value of the
first-level node under
Wireless. For earlier
devices, it represents
the SIM card number;
For new devices, it
represents the module
name. The specific
values are:
enumchar[32]{
3G
3G1
3G2
3G3
}
Single card/module: 3G;
Multiple cards/modules:
3G, 3G1, 3G2, and
3G3.

SIM card name. The
first SIM card is SIM1,
the second SIM2, and
the third SIM3.

IC card identification
code (namely SIM card
number). It consists of
20 digits.

Search modes:
enumchar[32]{
month: Search by
month
day: Search by day
hour: Search by hour
}

"3G"

"SIM1"

"89860116836014532
534"

"day"

General APIs 155

+SimName

char[32]

O

+ICCID

char[24]

O

Mode

char[32]

R

+StartTime

char[20]

+EndTime

char[20]

O

O

Start time of statistics

End time of statistics

"2021-01-01
00:00:00"

"2021-04-01
00:00:00"

Request Example

{
"condition": {
"Card": "3G",
"Mode": "month",
"StartTime": "2022-08-01 00:00:00",
"EndTime": "2022-09-30 23:59:59",
"SimName": "SIM1",
"ICCID": "898607E2112251029357"
}
}

Response Params ( JSON format in body )

Name

info

+TotalFlux

Type

object

uint64

+SendFlux

uint64

+RecvFlux

uint64

+Time

string
YYYY-MM-DD
hh::mm:ss

+Record

object[]

++Date

string
YYYY-MM-DD

++SendFlux

uint64

++RecvFlux

uint64

++TotalFlux

uint64

++StartTime

string

R/O

Description

Example

O

R

R

R

Search results

Total traffic = uplink
traffic + downlink traffic.
Unit: 0.1 Byte.

The total uplink traffic in
the statistical time
interval. Unit: Byte.

The total downlink
traffic in the statistical
time interval. Unit: Byte.

1299700

70305

1229395

R

Data update time.

"2021-03-31 00:00:00
"

R

R

R

R

O

O

Traffic statistic records.
maximum 31 entries for
variable length array.

Year/month/day.

"2014-01-01"

Uplink traffic of the
year/month/day. Unit:
Byte.

Uplink traffic of the
year/month/day. Unit:
Byte.

The total traffic in the
current statistical
period. Unit: Byte.

70305

1229395

8000

"2010-05-25 00:00:00

General APIs 156

YYYY-MM-DD
hh:mm:ss

Start time of this entry.

"

Response Example

{
"info": {

"TotalFlux": 1299700,

              "SendFlux": 70305,
              "RecvFlux": 1229395,
              "Time": "2021-03-31 00:00:00",
                "Record": [
                        {

"Date": "2021-03-31",
"StartTime": "2022-09-01 00:00:00",

                              "SendFlux": 70305,
                              "RecvFlux": 1229395,

"TotalFlux": 0

                        },…{} ]
        }

}

4.9 Event

4.9.1 [DataType] Event Handler

 Get event handler config

Table 4-79

Syntax

Method

http://<server>/cgi-bin/configManager.cgi?action=getConfig&name=<handlerName>

GET

Description

Get event handler settings.

Example

http://192.168.1.108/cgi-bin/configManager.cgi?action=getConfig&name=Alarm[0].Eve
ntHandler

Success
Return

handlerName.EventHandler.AlarmOutChannels[0]=1
handlerName.EventHandler.AlarmOutChannels[1]=1
…
handlerName.EventHandler.AlarmOutEnable=false
handlerName.EventHandler.AlarmOutLatch=10
handlerName.EventHandler.BeepEnable=true
handlerName.EventHandler.Dejitter=0
handlerName.EventHandler.Delay=30
handlerName.EventHandler.LogEnable=true
handlerName.EventHandler.MailEnable=true
handlerName.EventHandler.PtzLink[0][0]=None
handlerName.EventHandler.PtzLink[0][1]=0

General APIs 157

handlerName.EventHandler.PtzLink[1][0]=None
handlerName.EventHandler.PtzLink[1][1]=0
…
handlerName.EventHandler.PtzLinkEnable=false
handlerName.EventHandler.RecordChannels[0]=1
handlerName.EventHandler.RecordChannels[1]=2
…
handlerName.EventHandler.RecordEnable=true
handlerName.EventHandler.RecordLatch=10
handlerName.EventHandler.SnapshotChannels[0]=1
handlerName.EventHandler.SnapshotChannels[1]=1
…
handlerName.EventHandler.SnapshotEnable=false
handlerName.EventHandler.SnapshotPeriod=3
handlerName.EventHandler.SnapshotTimes=0
handlerName.EventHandler.TimeSection[0][0]=1 01:00:00-24:00:00
handlerName.EventHandler.TimeSection[0][1]=1 01:00:00-24:00:00…
…
handlerName.EventHandler.TimeSection[6][5]=1 01:00:00-24:00:00
handlerName.EventHandler.TipEnable=true
handlerName.EventHandler.ExAlarmOutEnable=true
handlerName.EventHandler.Enable=true,
handlerName.EventHandler.FilckerLightType=WhiteLight,
handlerName.EventHandler.LightLinkType=Filcker,
handlerName.EventHandler.FilckerIntevalTime=5,
handlerName.EventHandler.FilckerTimes=5,
handlerName.EventHandler.LightDuration=10,
handlerName.EventHandler.WhiteLightTimeSection=,
handlerName.EventHandler.LightBright=50
handlerName.ExAlarmOutChannels[0] =2
handlerName.ExAlarmOutChannels[1]=3
…

Comment

Parameters in URL:
handlerName can be one of below four formats:
Alarm[ChannelNo].EventHandler
MotionDetect[ChannelNo].EventHandler
BlindDetect[ChannelNo].EventHandler
LossDetect[ChannelNo].EventHandler

 Set event handler config

Table 4-80

Syntax

http://<server>/cgi-bin/configManager.cgi?action=setConfig&<paramName>=<paramV
alue>[&<paramName>=<paramValue>…]

Method

GET

Description

Modify event handler settings.

Example

http://192.168.1.108/cgi-bin/configManager.cgi?action=setConfig&Alarm[0].EventHandl

General APIs 158

er.AlarmOutChannels[0]=1&Alarm[0].EventHandler.AlarmOutEnable=true

Success
Return

OK

Comment

In below paramName, Meaning of handlerName is the same with GetEventHandler.

Appendix:

paramName

paramValue type Description

handlerName.EventHandler.AlarmOutChann
els[ch]

integer

handlerName.EventHandler.AlarmOutEnable bool

handlerName.EventHandler.AlarmOutLatch

Integer

handlerName.EventHandler.BeepEnable

bool

handlerName.EventHandler.Dejitter

integer

handlerName.EventHandler.Delay

integer

handlerName.EventHandler.LogEnable

handlerName.EventHandler.MailEnable

bool

bool

handlerName.EventHandler.PtzLink[ch][0]

string

handlerName.EventHandler.PtzLink[ch][1]

integer

ch is alarm out channel index
which starts from 0. Range is {0,
1},
0 — do not output alarm at alarm
out channel ch
1 — output alarm at alarm out
channel ch

out

alarm

Enable/Disable
function.
Range is [10—300].
Unit is seconds, indicates the time
to output alarm after input alarm
is cleared.

Enable/Disable beep.
Range is [0—255].
Alarm signal dejitter seconds.
Alarm signal change during this
period is ignored.
Range is [0—300].
Delay seconds before setting take
effect.

Enable/Disable log for alarm.

Enable/Disable mail send
alarm.

for

Range is {None, Preset, Tour,
Pattern}
This is PTZ action linked with
events.
ch is PTZ channel index which
starts from 0.

of

the parameter

is
This
PtzLink[ch][0],
If PtzLink[ch]][0] is
Preset: this is preset point.
Tour: this is tour path number.
Pattern: this is pattern number.

handlerName.EventHandler.PtzLinkEnable

Bool

Enable/Disable PTZ link.

handlerName.EventHandler.RecordChannels array<integer>

record channel list

handlerName.EventHandler.RecordEnable

bool

Enable/Disable record function.

General APIs 159

paramName

paramValue type Description

handlerName.EventHandler.RecordLatch

integer

Range is [10—300].
Unit is seconds, indicates the time
to record after input alarm is
cleared.

handlerName.EventHandler.SnapshotChann
els

array<integer>

snapshot channel list

handlerName.EventHandler.SnapshotEnable bool

handlerName.EventHandler.SnapshotPeriod

integer

handlerName.EventHandler.SnapshotTimes

integer

handlerName.EventHandler.TimeSection[wd]
[ts]

String

handlerName.EventHandler.TipEnable

bool

handlerName.EventHandler.ExAlarmOutEna
ble

handlerName.EventHandler.LightingLink.Ena
ble

handlerName.EventHandler.LightingLink.Filc
kerLightType

handlerName.EventHandler.LightingLink.Ligh
tLinkType

bool

bool

String

string

snapshot

Enable/Disable
function.
Range is [0—255].
Frames between snapshots.
0 means continuously snapshot
for every frame.
Range is [0—65535]
Snapshot times before stop, 0
means don't stop snapshot.

It's an effective time period for
eventHanlder everyday.
wd (week day) range is [0—6]
(Sunday—Saturday)
ts (time section) range is [0-23],
it's index of time section table.

mask

Format:
hh:mm:ss-hh:mm:ss
Mask: {0,1}, hh: [0—24], mm: [00
—59], ss: [00—59]
Mask 0: this time section is not
used.
Mask 1: this time section is used.

Example:
TimeSection[1][0]=1
12:00:00-18:00:00
Means EventHandler is effective
between 12:00:00 and 18:00:00
at Monday.

Enable/Disable
box tip.

local message

Enable/Disable extend alarm out
ability

Enable/Disable LightingLink

Filcker Light Type
range : ”WhiteLight”

range : [“Filcker”, “KeepLighting”]

General APIs 160

paramName

paramValue type Description

handlerName.EventHandler.LightingLink.Filc
kerIntevalTime

float

Filcker Inteval Time
unit: 0.1s

handlerName.EventHandler.LightingLink.Filc
kerTimes

integer

Filcker Times

handlerName.EventHandler.LightingLink.Ligh
tDuration

integer

Light Duration
unit: s

handlerName.EventHandler.LightingLink.Whi
teLightTimeSection

array<array<string

> >

handlerName.EventHandler.LightingLink.Ligh
tBright

integer

brightness

handlerName.ExAlarmOutChannels[ch]

integer

extend alarm out channels

4.9.2 [Config] Alarm Event

 Get alarm config

Table 4-81

Syntax

Method

http://<server>/cgi-bin/configManager.cgi?action=getConfig&name=Alarm

GET

Description

Get alarm config.

Example

http://192.168.1.108/cgi-bin/configManager.cgi?action=getConfig&name=Alarm

table.Alarm[0].Enable=false
table.Alarm[0].EventHandler….(output of EventHandler is described in
GetEventHandler)
table.Alarm[0].Name=Door1
table.Alarm[0].SensorType=NC
table.Alarm[1]….
…
—

Success
Return

Comment

 Set alarm config

Syntax

http://<server>/cgi-bin/configManager.cgi?action=setConfig&<paramName>=<paramVal
ue>[&<paramName>=<paramValue>…]

Table 4-82

Method

GET

Description Set alarm config.

Example

http://192.168.1.108/cgi-bin/configManager.cgi?action=setConfig&Alarm[0].Enable=true

Success
Return

OK

In below ParamName, input is external alarm input channel which starts from 0.
EventHandler defines parameter of relevant actions when alarm or event happens. It's
also used in following sections about events.

Comment

Appendix:

General APIs 161

ParamName

ParamValue type

Description

Alarm[input].Enable

bool

Enable/Disable alarm from a input channel

Alarm[input].EventHandler —

Setting of EventHandler
SetEventHandler.

is described

in

Alarm[input].Name

string

Name of alarm input channel.

Alarm[input].SensorType

string

4.9.3 [Config] Alarm Out

 Get alarm out config

Range is {NC, NO].
NC: normal close
NO: normal open

Table 4-83

Syntax

Method

http://<server>/cgi-bin/configManager.cgi?action=getConfig&name=AlarmOut

GET

Description

Get alarm out config.

Example

Success
Return

Comment

http://192.168.1.108/cgi-bin/configManager.cgi?action=getConfig&name=AlarmOut

table.AlarmOut[alarmOutChannel].Mode=0
table.AlarmOut[alarmOutChannel].Name=Beep

Parameters in Response:
alarmOutChannel: the alarm out channel index which starts from 0.

 Set alarm out config

Syntax

http://<server>/cgi-bin/configManager.cgi?action=setConfig&<paramName>=<paramV
alue>[&<paramName>=<paramValue>…]

Table 4-84

Method

GET

Description

Set alarm out config.

Example

Success
Return

http://192.168.1.108/cgi-bin/configManager.cgi?action=setConfig&AlarmOut[0].Mode=0
&AlarmOut[0].Name=port1

OK

Comment

port in below ParamName is alarm out port index, start form 0.

Appendix:

ParamName

ParamValue type Description

AlarmOut[port].Mode

integer

AlarmOut[port].Name

string

Range is {0, 1, 2}
0: automatically alarm
1: force alarm
2: close alarm

Alarm out port name.

General APIs 162

4.9.4 Get Alarm Input Channels

Table 4-85

Syntax

Method

http://<server>/cgi-bin/alarm.cgi?action=getInSlots

GET

Description

Get alarm input channel number.

Example

Success
Return

http://192.168.1.108/cgi-bin/alarm.cgi?action=getInSlots

result=2

Comment

—

4.9.5 Get Alarm Output Channels

Table 4-86

Syntax

Method

http://<server>/cgi-bin/alarm.cgi?action=getOutSlots

GET

Description

Get alarm output channel number.

Example

Success
Return

http://192.168.1.108/cgi-bin/alarm.cgi?action=getOutSlots

result=1

Comment

—

4.9.6 Get States of Alarm Input Channels

Table 4-87

Syntax

Method

http://<server>/cgi-bin/alarm.cgi?action=getInState

GET

Description

Get alarm input state for all channels.

Example

Success
Return

Comment

http://192.168.1.108/cgi-bin/alarm.cgi?action=getInState

result=3

A bit in the response result indicates a channel alarm states, result 3 means alarm
channel 1 and channel 2 have alarm now.

4.9.7 Get States of Alarm Output Channels

Table 4-88

Syntax

Method

http://<server>/cgi-bin/alarm.cgi?action=getOutState

GET

Description

Get alarm output state for all channels.

Example

Success

http://192.168.1.108/cgi-bin/alarm.cgi?action=getOutState

result=0

General APIs 163

Return

Comment

A bit in the response result indicates a channel, result 1 means alarm is present.

4.9.8 [Config] Video Blind Event

 Get video blind detect config

Table 4-89

Syntax

Method

http://<server>/cgi-bin/configManager.cgi?action=getConfig&name=BlindDetect

GET

Description

Get blind detect config.

Example

http://192.168.1.108/cgi-bin/configManager.cgi?action=getConfig&name=BlindDetect

Success
Return

Comment

head.Enable=false
head.EventHandler= (output of EventHandler is described in GetEventHandler)
head.Level=3

Parameters in Response:
head=table.BlindDetect[ChannelNo]
ChannelNo: integer, array index starts from 0, which means video channel (equals to
video channel index -1, and so 0 means channel 1).

 Set video blind detect config

Syntax

http://<server>/cgi-bin/configManager.cgi?action=setConfig&<paramName>=<paramV
alue>[&<paramName>=<paramValue>…]

Table 4-90

Method

GET

Description

Set blind detect config.

Example

Success
Return

Comment

http://192.168.1.108/cgi-bin/configManager.cgi?action=setConfig&BlindDetect[0].Enabl
e=true

OK

Parameters in URL:
In table below,
head=BlindDetect[ChannelNo]
ChannelNo: integer, array index starts from 0, which means video channel (equals to
video channel index -1, and so 0 means channel 1).

ParamValue type

Description

Appendix:

ParamName

head.Enable

head.EventHandler

bool

—

head.Level

integer

Enable/Disable blind detect feature.

is

described

in

of EventHandler

Setting
SetEventHandler.
Range is [1—6].
Sensitivity of blind detection.
1: lowest sensitivity.
6: highest sensitivity.

General APIs 164

4.9.9 [Config] Video Loss Event

 Get video loss detect config

Table 4-91

Syntax

Method

http://<server>/cgi-bin/configManager.cgi?action=getConfig&name=LossDetect

GET

Description

Get video loss detect config.

Example

Success
Return

Comment

http://192.168.1.108/cgi-bin/configManager.cgi?action=getConfig&name=LossDetect

head. Enable=false
head. EventHandler= (output of EventHandler is described in GetEventHandler)

Parameters in Response:
head=table.LossDetect [ChannelNo]
ChannelNo: integer, array index starts from 0, which means video channel (equals to
video channel index -1, and so 0 means channel 1).

 Set video loss detect config

Table 4-92

Syntax

http://<server>/cgi-bin/configManager.cgi?action=setConfig&<paramName>=<paramV
alue>[&<paramName>=<paramValue>…]

Method

GET

Description

Set video loss detection config.

Example

Success
Return

Comment

http://192.168.1.108/cgi-bin/configManager.cgi?action=setConfig&LossDetect[0].Enabl
e=true

OK

Parameters in URL:
In table below,
head=LossDetect [ChannelNo]
ChannelNo: integer, array index starts from 0, which means video channel(equals to
video channel index -1, and so 0 means channel 1).

Appendix:

ParamName

head.Enable

head.EventHandler

ParamValue type Description

bool

—

Enable/Disable loss detect feature.

Setting of EventHandler
SetEventHandler.

is described

in

4.9.10 [Config] Login Failure Event

 Get login failure event config

Table 4-93

Syntax

http://<server>/cgi-bin/configManager.cgi?action=getConfig&name=LoginFailureAlarm

General APIs 165

Method

GET

Description

Get login failure alarm config.

Example

Success
Return

Comment

http://192.168.1.108/cgi-bin/configManager.cgi?action=getConfig&name=LoginFailureA
larm

head.Enable=false
head.EventHandler= (output of EventHandler is described in GetEventHandler)

Parameters in Response:
head=table.LoginFailureAlarm

 Set login failure alarm config

Table 4-94

Syntax

http://<server>/cgi-bin/configManager.cgi?action=setConfig&<paramName>=<paramV
alue>[&<paramName>=<paramValue>…]

Method

GET

Description

Set login failure alarm config.

http://192.168.1.108/cgi-bin/configManager.cgi?action=setConfig&LoginFailureAlarm.E
nable=true

OK

Parameters in URL:
In table below,
head=LoginFailureAlarm

Example

Success
Return

Comment

Appendix:

ParamName

ParamValue type Description

head.Enable

bool

head.EventHandler

—

Enable/Disable to notify LoginFailure event. Now this
event can be linked with send email and alarm out. The
max try login times can be configured in chapter
SetGeneralConfig.

Setting
SetEventHandler.

of

EventHandler

is

described

in

4.9.11 [Config] Storage Not Exist Event

 Get storage not exist event config

Table 4-95

Syntax

Method

http://<server>/cgi-bin/configManager.cgi?action=getConfig&name=StorageNotExist

GET

Description

Get storage not exist event config.

Example

Success
Return

http://192.168.1.108/cgi-bin/configManager.cgi?action=getConfig&name=StorageNotE
xist

table.StorageNotExist.Enable=false
table.StorageNotExist.EventHandler=
GetEventHandler)

(output of EventHandler

is described

in

General APIs 166

Comment

—

 Set storage not exist event config

Table 4-96

Syntax

http://<server>/cgi-bin/configManager.cgi?action=setConfig&<paramName>=<paramV
alue>[&<paramName>=<paramValue>…]

Method

GET

Description

Set storage not exist event config.

Example

Success
Return

Comment

Appendix:

ParamName

http://192.168.1.108/cgi-bin/configManager.cgi?action=setConfig&StorageNotExist.Ena
ble=true

OK

—

ParamValue type Description

StorageNotExist.Enable

bool

Enable/Disable loss detect feature.

StorageNotExist.EventHandler —

Setting of EventHandler
SetEventHandler.

is described

in

4.9.12 [Config] Storage Access Failure Event

 Get storage access failure event config

Table 4-97

Syntax

Method

http://<server>/cgi-bin/configManager.cgi?action=getConfig&name=StorageFailure

GET

Description

Get storage failure event config.

Example

Success
Return

Comment

http://192.168.1.108/cgi-bin/configManager.cgi?action=getConfig&name=StorageFailur
e

table.StorageFailure.Enable=false
table.StorageFailure.EventHandler=
GetEventHandler)
—

(output of EventHandler

is described

in

 Set storage access failure event config

Table 4-98

Syntax

http://<server>/cgi-bin/configManager.cgi?action=setConfig&<paramName>=<paramV
alue>[&<paramName>=<paramValue>…]

Method

GET

Description

Set storage failure event config.

Example

http://192.168.1.108/cgi-bin/configManager.cgi?action=setConfig&StorageFailure.Enab
le=true

General APIs 167

Success
Return

Comment

OK

—

Appendix:

ParamName

ParamValue type Description

StorageFailure.Enable

bool

Enable/Disable loss detect feature.

StorageFailure.EventHandler —

Setting of EventHandler is described in
SetEventHandler.

4.9.13 [Config] Storage Low Space Event

 Get storage low space event config

Table 4-99

Syntax

Method

http://<server>/cgi-bin/configManager.cgi?action=getConfig&name=StorageLowSpace

GET

Description

Get storage low space event config.

Example

Success
Return

Comment

http://192.168.1.108/cgi-bin/configManager.cgi?action=getConfig&name=StorageLowS
pace

table.StorageLowSpace.Enable=false
table.StorageLowSpace.EventHandler= (output of EventHandler
GetEventHandler)
—

is described

in

 Set storage low space event config

Table 4-100

Syntax

http://<server>/cgi-bin/configManager.cgi?action=setConfig&<paramName>=<paramV
alue>[&<paramName>=<paramValue>…]

Method

GET

Description

Set storage low space event config.

Example

Success
Return

Comment

Appendix:

ParamName

http://192.168.1.108/cgi-bin/configManager.cgi?action=setConfig&StorageLowSpace.E
nable=true

OK

—

ParamValue type

Description

StorageLowSpace.Enable

bool

Enable/Disable loss detect feature.

StorageLowSpace.EventHandler —

Setting of EventHandler
SetEventHandler.

is described

in

General APIs 168

4.9.14 [Config] Net Abort Event

 Get net abort event config

Table 4-101

Syntax

Method

http://<server>/cgi-bin/configManager.cgi?action=getConfig&name=NetAbort

GET

Description

Get net abort event config.

Example

http://192.168.1.108/cgi-bin/configManager.cgi?action=getConfig&name=NetAbort

Success
Return

Comment

table.NetAbort.Enable=false
table.NetAbort.EventHandler=
GetEventHandler)
—

 Set net abort event config

(output

of EventHandler

is

described

in

Table 4-102

Syntax

http://<server>/cgi-bin/configManager.cgi?action=setConfig&<paramName>=<paramV
alue>[&<paramName>=<paramValue>…]

Method

GET

Description

Set net abort event config.

http://192.168.1.108/cgi-bin/configManager.cgi?action=setConfig&NetAbort.Enable=tru
e

OK

—

Example

Success
Return

Comment

Appendix:

ParamName

ParamValue type Description

NetAbort.Enable

bool

Enable/Disable loss detect feature.

NetAbort.EventHandler

—

Setting
SetEventHandler.

of EventHandler

is

described

in

4.9.15 [Config] IP Conflict Event

 Get IP conflict event config

Table 4-103

Syntax

Method

http://<server>/cgi-bin/configManager.cgi?action=getConfig&name=IPConflict

GET

Description

Get IP conflict event config.

Example

Success
Return

http://192.168.1.108/cgi-bin/configManager.cgi?action=getConfig&name=IPConflict

table.IPConflict.Enable=false
table.IPConflict.EventHandler= (output of EventHandler is described in
GetEventHandler)

General APIs 169

Comment

—

 Set IP conflict event config

Table 4-104

Syntax

http://<server>/cgi-bin/configManager.cgi?action=setConfig&<paramName>=<paramV
alue>[&<paramName>=<paramValue>…]

Method

GET

Description

Set IP Conflict event config.

Example

Success
Return

http://192.168.1.108/cgi-bin/configManager.cgi?action=setConfig&IPConflict.Enable=tr
ue

OK

Comment

—

Appendix:

ParamName

ParamValue type Description

IPConflict.Enable

bool

Enable/Disable loss detect feature.

IPConflict.EventHandler —

Setting
SetEventHandler.

of EventHandler

is

described

in

4.9.16 Get Channels Event Happened

Table 4-105

Syntax

http://<server>/cgi-bin/eventManager.cgi?action=getEventIndexes&code=<eventCode

>

Method

GET

Description

Get channels indexes that event of code eventCode happens.
Not all events support this command. Do not recommend to use it, use Attach command
instead.

Example

http://192.168.1.108/cgi-bin/eventManager.cgi?action=getEventIndexes&code=AlarmL
ocal

Success
Return

Comment

channels[0]=0
channels[1]=2
channels[2]=3
…
(This response means event happened on channel 0, channel 2 and channel 3 while
video channel index starts from 0)

Parameters in URL:
eventCode includes:
VideoMotion: motion detection event
VideoLoss: video loss detection event
VideoBlind: video blind detection event.
AlarmLocal: alarm detection event.
StorageNotExist: storage not exist event.
StorageFailure: storage failure event.

General APIs 170

StorageLowSpace: storage low space event.
AlarmOutput: alarm output event.

4.9.17 Subscribe to Event Message

Subscribe to event messages. For details on the event name and parameters, see the
corresponding [Event] sections.

Example
[ AlarmLocal, Vi
deoMotion, Vide
oLoss, VideoBli
nd, FaceDetecti
on ]

http://<server>/cgi-bin/eventManager.cgi?action=attach
GET

Request URL
Method
Request Params ( key=value format in URL )
Name
codes

Type
string R

R/O Description

Event code, can be a list of event codes or "
All" to cover all event codes.
Here are some frequently used event codes:
VideoMotion: motion detection event
SmartMotionHuman: human smart motion dete
ction
SmartMotionVehicle: Vehicle smart motion dete
ction
VideoLoss: video loss detection event
VideoBlind: video blind detection event.
AlarmLocal: alarm detection event.
StorageNotExist: storage not exist event.
StorageFailure: storage failure event.
StorageLowSpace: storage low space event.
AlarmOutput: alarm output event.
AudioMutation: intensity change
AudioAnomaly: input abnormal
CrossLineDetection: tripwire event
CrossRegionDetection: intrusion event
LeftDetection: abandoned object detection
TakenAwayDetection: missing object detection
VideoAbnormalDetection: scene change event
FaceDetection: face detect event
VideoUnFocus: defocus detect event
WanderDetection: loitering detection event
RioterDetection: People Gathering event
ParkingDetection: parking detection event
MoveDetection: fast moving event
HeatImagingTemper: temperature alarm event
CrowdDetection: crowd density overrun event
FireWarning: fire warning event
FireWarningInfo: fire warning specific data info
ObjectPlacementDetection: placement object d
etection
ObjectRemovalDetection: removal object detect
ion

General APIs 171

keepalive

int

O

heartbeat

int

O

AccessControl: Access control event
……
Client keep-alive. If this parameter exists, the
client will send keep-alive data to the device
at an interval in seconds; the value range is
[1–60].
The keep-alive data can be "keep alive" in th
e form of string.
Note: It is recommended to use the Heartbeat
parameter instead of the keepalive paramete
r.
Server keep-alive; integer; Unit: s;
The value range is [1–60].
For example, if the parameter exists in the U
RL and the value is 5, the device will send "
heartbeat" to the client as a keep-alive messa
ge.
Note: The keep-alive message must be sent
before the keepalive parameter expires.

20

5

Request Example
http://192.168.1.108/cgi-bin/eventManager.cgi?action=attach&codes=[AlarmLocal%2CVideoMotion%2
CVideoLoss%2CVideoBlind%2CFaceDetection]

Type
string
string

Response Params ( multipart , key=value format in body , Heartbeat in body )
R/O Description
Name
Event code
R
Code
Event action
R
action
Values: Start/Stop/pulse
Number; meaningless sometimes.
Event data; json message body.
For detailed message bodies, see the
corresponding section.

int
object

index
data

R
O

Response Example
HTTP/1.1 200 OK
Cache-Control: no-cache
Pragma: no-cache
Expires: Thu, 01 Dec 2099 16:00:00 GMT
Connection: close
Content-Type: multipart/x-mixed-replace; boundary=myboundary

--myboundary
Content-Type: text/plain
Content-Length: 39

Code=VideoMotion;action=Start;index=0

Example
VideoBlind
Start

0
““

General APIs 172

--myboundary
Content-Type: text/plain
Content-Length: 38

Code=FaceDetection;action=Start;index=0;data={
“Faces”: [ { “BoundingBox”: [2992,136,6960,8192],
“Sex”: “Man”,
“Age”: 40,
“Feature”: [ “WearGlasses”, “Smile”],
“Eye”: 2,
“Mouth”: 1,
“Mask”: 1,
“Beard”: 2
}, {…}, … ]
}

--myboundary
Content-Type: text/plain
Content-Length: 9

Heartbeat

--myboundary
……

4.9.18 Get Capability of Event Management

Table 4-106

Syntax

Method

http://<server>/cgi-bin/eventManager.cgi?action=getCaps

GET

Description

Get event manager capabilities.

Example

http://192.168.1.108/cgi-bin/eventManager.cgi?action=getCaps

Success
Return

caps.AlarmOutEnable=true
caps.BeepEnable=true
caps.DejitterEnable=true
caps.MMSEnable=true
caps.MailEnable=true
caps.MonitorTourEnable=true
caps.PtzLinkEnable=true
caps.RecordEnable=true
caps.SnapshotEnable=true
caps.TimeSectionEnable=true
caps.TipEnable=true
caps.RecordCloudEnable=true,
caps.SnapshotCloudEnable=false,
caps.SnapshotTimes[0]=3,

General APIs 173

caps.SnapshotTimes[1]=10,
caps.SupportAlarmBell=false,
caps.SupportAccessControl=false,
caps.SipCallEnable=false,
caps.SupportAlarmServer=false,
caps.SupportPtzLinkDelay=false,
caps.SupportPSTNAlarmServer=false,
caps.SupportICR=false,
caps.BeepTime=false,
caps.DejitterRange.Min=0,
caps.DejitterRange.Max=60
caps.AlarmOutLatch[0]=1,
caps.AlarmOutLatch[1]=300,
caps.RecordLatch[0]=0,
caps.RecordLatch[1]=300,
caps.VoiceEnable=true,
caps.VoiceLinkTimeRange[0]=10,
caps.VoiceLinkTimeRange[1]=30,
caps.VoicePlayTimesRange[0]=1,
caps.VoicePlayTimesRange[1]=10,
caps.VoiceLinkFileOptional=true,
caps.LogEnable=true,
caps.SupportLightControl=false,
caps.LinkLightBrightRange[0]=0,
caps.LinkLightBrightRange[1]=100,
caps.SupportVideoMatrix=false,
caps.LinkDetailCameraEnable=false,
caps.SupportDisableLinkage[0]=0
caps.SupportDisableLinkage[1]=0
caps.SupportDisableLinkage[2]=0
caps.SupportDisableLinkage[3]=0
caps.SupportHTTPUpload.PictureHttpUploadEnable=false
caps.SupportHTTPUpload.EventHttpUploadEnable=false
—

Comment

4.9.19 [Config] Net Alarm Event

Net alarm event configuration parameters:

Config Data Params
Name

Type

R/O Description

Example

NetAlarm

object[]

R

+Enable
+DefenceAreaTy
pe

bool

string

O

O

Network alarm; one-dimensional array.
The array index represents the
corresponding channel which starts
from 0.
Enable alarm input (bypass switch)
Type of the protection zone
enumchar[32]{

true
“Intime”

General APIs 174

"Intime": Real-time protection zone
"Delay": Time-delay protection zone
"Fullday": 24-hour protection zone
Get the capability set to judge the
protection zone type.
}
Delay disarming time
Unit: s
Get the maximum delay time from the
capability set.
Effective when EnableAlways
is
selected or when the EnableControl is
set to Normal.
Others:
Effective only when the protection
zone type is Delay.
Delay arming time
Unit: s
Get the maximum delay time from the
capability set.
Effective when the protection zone
type is Delay.
Alarm Channel Name
The sensor is solid on or off.
enumchar[32]{
"NC"
"NO"
}
Alarm linkage
For
linkage
SetEventHandler.

configurations,

see

30

30

“Door”
NC

+DisableDelay

integer

O

+EnableDelay

integer

O

+Name

string

O

+SensorType

string

O

+EventHandler

object

O

Please refer to "4.2.1 Get and Set Configure" for configuration getting and setting. Specific
examples are as follows :

Get Config Request Example
http://192.168.1.108/cgi-bin/configManager.cgi?action=getConfig&name=NetAlarm
Get Config Response Example
table.NetAlarm[0].Enable=false
table.NetAlarm[0].Name=channel1
table.NetAlarm[0].SensorType=NO
table.NetAlarm[0].EventHandler= (output of EventHandler is described in GetEventHandler)

Set Config Request Example
http://192.168.1.108/cgi-bin/configManager.cgi?action=setConfig&NetAlarm[0].Enable=true

Set Config Response Example
OK

General APIs 175

4.9.20 Set Net Alarm State

Set the network alarm status.

http://<server>/cgi-bin/netAlarm.cgi?action=setState
GET

Request URL
Method
Request Params ( key=value format in URL )
Type
Name
int
channel

R/O Description
R

alarm

name
trigger

bool

string
string

R

O
O

desc

string

O

Channel number; access control number;
starting from 1
Alarm status; bool;
"true" means the alarm is enabled
Alarm name; string; less than 32 characters
Alarm triggering source; string; less than 32
characters. For example, Infrared,
WaterSensor Manual and more
Alarm description; string; less than 128
characters

Sample
1

true

101
Remote

Zone8

Request Example
http://192.168.1.108/cgi-bin/netAlarm.cgi?action=setState&channel=1&alarm=true&name=somke&trigg
er=SmokingSensor&desc=Zone8

Response Params ( OK in body )
Response Example
OK

4.9.21 Get Supported Events

Get the event list which the device supports.

http://<server>/cgi-bin/eventManager.cgi?action=getExposureEvents
GET

Request URL
Method
Request Params ( none )
Request Example
http://192.168.1.108/cgi-bin/eventManager.cgi?action=getExposureEvents

Response Params ( key=value format in body )
Name
events

Type
string[]

R/O
R

Description
Supported event list;
one-dimensional array

Response Example
events[0]=VideoMotion
events[1]=AlarmLocal
events[2]=FaceDetection
events[3]=VideoMotion
…

Sample
[VideoMotion, AlarmLocal,
FaceDetection, VideoMotion,…]

General APIs 176

4.10 Record

4.10.1 Get Capability of Recording

Table 4-107

Syntax

Method

http://<server>/cgi-bin/recordManager.cgi?action=getCaps

GET

Description

Get record manager capabilities.

Example

http://192.168.1.108/cgi-bin/recordManager.cgi?action=getCaps

caps.MaxPreRecordTime=30
caps.PacketLengthRange[0]=1
caps.PacketLengthRange[1]=60
caps.PacketSizeRange[0]=131072
caps.PacketSizeRange[1]=2097152
caps.SupportExtraRecordMode=true
caps.SupportHoliday=true
caps.SupportPacketType[0]=Time
caps.SupportPacketType[1]=Size
caps.SupportResumeTransmit=false
—

Success
Return

Comment

4.10.2 [Config] Record Config

 Get record config

Table 4-108

Syntax

Method

http://<server>/cgi-bin/configManager.cgi?action=getConfig&name=Record

GET

Description

Get record config.

Example

http://192.168.1.108/cgi-bin/configManager.cgi?action=getConfig&name=Record

Success
Return

Comment

table.Record[channel].PreRecord=6
table.Record[channel].TimeSection[weekday][0]=65535 00:00:00-24:00:00
table.Record[channel].TimeSection[weekday][1]=0 02:00:00-24:00:00
table.Record[channel].TimeSection[weekday][2]=0 03:00:00-24:00:00
table.Record[channel].TimeSection[weekday][3]=0 04:00:00-24:00:00
table.Record[channel].TimeSection[weekday][4]=0 05:00:00-24:00:00
table.Record[channel].TimeSection[weekday][5]=0 06:00:00-24:00:00

Parameters in Response:
channel: integer, array index starts from 0, which means video channel(equals to video
channel index -1, and so 0 means channel 1).
weekday: range is [0-6] (Sunday - Saturday).
Record config contains pre record time and record time sections of every day.

 Set record config

General APIs 177

Syntax

http://<server>/cgi-bin/configManager.cgi?action=setConfig&<paramName>=<paramV
alue>[&<paramName>=<paramValue>…]

Table 4-109

Method

GET

Description

Set record config.

Example

http://192.168.1.108/cgi-bin/configManager.cgi?action=setConfig&Record[0].TimeSecti
on[0][0]=6 00:00:00-23:59:59
Set record time to every Sunday all day. Record type is motion detection and alarm.
In this example, "6 00:00:00-23:59:59" means motion detection and alarm record all day
(6 = 4 & 2, alarm is 4, motion detection is 2.).

Success
Return

OK

Parameters in URL:
In table below,
ch: integer, array index starts from 0, which means video channel (equals to video
channel index -1, and so 0 means channel 1).
wd: week day index
ts: time section index

Comment

Appendix:

ParamName

ParamValue type

Record[ch].PreRecord

integer

Record[ch].TimeSection[wd][ts] string

Description
Range is [0—300].
Prerecord seconds, 0 means no prerecord.
ch (Channel number) starts form 0
wd (week day) range is [0—7] ,[0-6]:(Sunday -
Saturday),7:Holiday
ts (time section) range is [0—23], time section
table index.

Format: mask hh:mm:ss-hh:mm:ss
Mask: [0—4294967295], hh: [0—24], mm: [0
—59], ss: [0—59]
Mask indicates record type by bits:
Bit0: regular record
Bit1: motion detection record
Bit2: alarm record
Bit3: card record

4.10.3 [Config] Record Mode

 Get record mode config

Syntax

Method

http://<server>/cgi-bin/configManager.cgi?action=getConfig&name=RecordMode

GET

Table 4-110

General APIs 178

Description

Get record mode config.

Example

Success
Return

Comment

http://192.168.1.108/cgi-bin/configManager.cgi?action=getConfig&name=RecordMode

table.RecordMode[Channel].Mode=0

Parameters in Response:
Channel: integer, array index starts from 0, which means video channel (equals to
video channel index -1, and so 0 means channel 1).

 Set record mode config

Syntax

http://<server>/cgi-bin/configManager.cgi?action=setConfig&<paramName>=<paramV
alue>

Table 4-111

Method

GET

Description

Set record mode config.

Example

Success
Return

Comment

Appendix:

ParamName

http://192.168.1.108/cgi-bin/configManager.cgi?action=setConfig&RecordMode[0].Mod
e=0

OK

Parameters in URL:
In table below,
Channel: integer, array index starts from 0, which means video channel (equals to
video channel index -1, and so 0 means channel 1).

ParamValue type

Description

RecordMode[Channel].Mode

integer

4.10.4 [Config] Media Global

 Get media global config

Range is {0, 1, 2 }.
0: automatically record
1: manually record
2: stop record.

Table 4-112

Syntax

Method

http://<server>/cgi-bin/configManager.cgi?action=getConfig&name=MediaGlobal

GET

Description

Get media global config.

Example

http://192.168.1.108/cgi-bin/configManager.cgi?action=getConfig&name=MediaGlobal

Success
Return

table.MediaGlobal.OverWrite=true,
table.MediaGlobal.PacketType=0,
table.MediaGlobal.PacketLength=60,
table.MediaGlobal.PacketSize=1024,
table.MediaGlobal.LogRecord=false,
table.MediaGlobal.LogEncode=false,

General APIs 179

Comment

table.MediaGlobal.SnapFormatAs=MainFormat
—

 Set media global config

Table 4-113

Syntax

http://<server>/cgi-bin/configManager.cgi?action=setConfig&<paramName>=<paramV
alue>

Method

GET

Description

Set media global config.

http://192.168.1.108/cgi-bin/configManager.cgi?action=setConfig&MediaGlobal.SnapF
ormatAs=MainFormat

OK

—

Example

Success
Return

Comment

Appendix:

ParamName

ParamValue type Description

MediaGlobal.SnapFormatAs string

The range is {"MainFormat", "ExtraFormat"}.

4.10.5 Find Media Files

Create a media files finder.

http://<server>/cgi-bin/mediaFileFind.cgi?action=factory.create
GET

Request URL
Method
Request Params ( none )
Request Example
http://192.168.1.108/cgi-bin/mediaFileFind.cgi?action=factory.create

Response Params ( key=value format in body )
Name
result

Type
string

R/O
R

Description
objectId; use it to search
for media files

Sample
08137

Response Example
result=08137

Start to find media files satisfied the conditions with the finder.

http://<server>/cgi-bin/mediaFileFind.cgi?action=findFile
GET

Request URL
Method
Request Params ( key=value format in URL )
Name
object

Type
string

R/O Description
R

Search object of the media files;
Create the object in the previous command,
and then search for the object.
user id
Channel number; starting from 1

Sample
08137

101
1

condition
+Channel

object
int

R
R

General APIs 180

+StartTime

string

+EndTime

string

+Dirs

string[]

R

R

O

+Types

string[]

O

+Flags

string[]

O

+Events

string[]

O

+VideoStream

string

O

Start time

End time

The directory where the recordings are
saved; array; the index starts from 0; optional
values: {"dav", "jpg", "mp4"}
If this parameter does not exist, the system
will search for all directories.
The type of file that is being searched for;
array; the index starts from 0; optional
values: {"dav", "jpg", "mp4"}
If this parameter does not exist, the system
will search for all file types.
Search parameter; array; the index starts
from 0; optional values: {"Timing", "Manual",
"Marker", "Event", "Mosaic", "Cutout"}
If this parameter does not exist, the system
will search for all files.
Events related to the recordings; array; the
index starts from 0; optional values:
{"AlarmLocal", "VideoMotion", "VideoLoss",
"VideoBlind", "Traffic\*", …}
If this parameter does not exist, the system
will search for all files.
Stream type; optional values: {"Main",
"Extra1", "Extra2", "Extra3"}.
If this parameter does not exist, the system
will search for all stream types.

"2010-05-25 12:
05:00"
"2010-05-25 12:
10:00"
["/mnt/dvr/sda0",
"/mnt/dvr/sda1"]

["dav"]

["Timing"]

["AlarmLocal"]

Main

Request Example
http://192.168.1.108/cgi-bin/mediaFileFind.cgi?action=findFile&object=08137&condition.Channel=1&co
ndition.Dirs[0]=/mnt/dvr/sda0&condition.Types[0]=dav&condition.Events[0]=AlarmLocal&condition.Event
s[1]=VideoMotion&condition.StartTime=2014-1-1%2012:00:00&condition.EndTime=2015-1-10%2012:0
0:00&condition.VideoStream=Main

Response Params ( OK in body )
Response Example
OK

Get the media file information found by the finder.

http://<server>/cgi-bin/mediaFileFind.cgi?action=findNextFile
GET

Request URL
Method
Request Params ( key=value format in URL )
Type
Name
string
object

R/O Description
R

The search object of the media files;
Create the object in the previous command,

Sample
08137

General APIs 181

count

int

R

and then search for the object.
Get the number of files that have been found,
and the maximum number is 100.

100

Request Example
http://192.168.1.108/cgi-bin/mediaFileFind.cgi?action=findNextFile&object=08137&count=100

Response Params ( key=value format in body )
Name
found

R/O Description
O

Type
int

items
+Channel

+StartTime
+EndTime
+Type
+Events

object[]
int

string
string
string
string[]

+VideoStream
+FilePath

string
string

O
O

O
O
O
O

O
O

The returned number of files that have
been found.
0 means no file has been found.
List of file information
Channel number; integer; the video
channel number starts from 0.
Start time of the recording
End time of the recording
File type
Type of events that are related to the
recordings
Stream type

File path

Sample
1

1

2011-1-1 12:00:00
2011-1-1 13:00:00
dav
[“AlarmLocal”]

Main
/mnt/dvr/sda0/2010/8/1
1/dav/15:40:50.jpg

The file length within a specified period 792
File length

3600

O
O

int
+Length
int
+Duration
Response Example
found=1
items[0].Channel=1
items[0].StartTime=2011-1-1 12:00:00
items[0].EndTime=2011-1-1 13:00:00
items[0].Type=dav
items[0].Events[0]=AlarmLocal
items[0].VideoStream=Main
items[0].FilePath=/mnt/dvr/sda0/2010/8/11/dav/15:40:50.jpg
items[0].Length=790
items[0].Duration=3600

Close the finder.

http://<server>/cgi-bin/mediaFileFind.cgi?action=close
GET

Request URL
Method
Request Params ( key=value format in URL )
Type
Name
string
object

R/O Description
R

The search object of the media files;
Create the object in the previous command,
and then search for the object.

Sample
08137

Request Example
http://192.168.1.108/cgi-bin/mediaFileFind.cgi?action=close&object=08137

General APIs 182

Response Params ( OK in body )
Response Example
OK

Destroy the finder.

http://<server>/cgi-bin/mediaFileFind.cgi?action=destroy
GET

Request URL
Method
Request Params ( key=value format in URL )
Type
Name
string
object

R/O Description
R

The search object of the media files;
Create the object in the previous command,
and then search for the object.

Sample
08137

Request Example
http://192.168.1.108/cgi-bin/mediaFileFind.cgi?action=destroy&object=08137

Response Params ( OK in body )
Response Example
OK

4.10.6 Find media files with FaceDetection info

Create a media files finder.

This API is the same as the API in "4.10.5 Find Media Files".

Start to find media files satisfied the common conditions and FaceDetection condition with

the finder.

Table 4-114

URL

http://<server>/cgi-bin/mediaFileFind.cgi?action=findFile

Method

GET

Description

Start to find media files satisfied the common conditions and FaceDetection conditions
with the finder.

[ Request Params ] ( key=value format at URL )

Name

object

condition

Type

int

object

+Channel

int

+StartTime

+EndTime

+Types

string

string

R/O Param Description

R

R

R

R

R

The finder object id

The search conditions

The video channel to search, video channel index start from
1, use -1 to search all video channel.

Start time to search, ex: "2010-05-25 12:05:00"

End time to search, ex: "2010-06-25 12:05:00"

array<string> O

Search file types, should be "jpg"

+Flags

array<string> O

Search flags, can be : "Timing", "Manual", "Marker", "Event",
"Mosaic", "Cutout"
should include “Event”

General APIs 183

+Events

array<string> R

Search event list, must be one string : "FaceDetection"

array<string> O

Search directory list, if omit, search all. Each dir path max
string length is 259.

+Dirs

+DB

++FaceDetecti
onRecordFilter

object

object

+++ImageType string

+++Sex

+++Age

+++Glasses

+++Mask

+++Beard

string

array<int>

int

int

int

[ Response Params ] ( OK )

[ Example ]

R

R

O

O

O

O

O

O

DB filter object

DB filter for FaceDetection

Picture type, if omit, means search all type.
"GlobalSence" : means big picture of the full sence,
"Small" : means small picture of the people face.

Sex, it can be "Man", "Woman", if omit, search all
Age range, ex：[25, 40]
Glasses Status, 0: all, 1: not wear, 2: wear

Mask Status, 0: all, 1: not wearing mask, 2: wearing mask

Beard Status, 0: all, 1: no beard, 2: has beard

Request

GET
http://192.168.1.108/cgi-bin/mediaFileFind.cgi?action=findFile&object=08137&condition.Ch
annel=1&condition.StartTime=2014-1-1%2012:00:00&condition.EndTime=2015-1-10%201
2:00:00&condition.Types[0]=jpg&condition.Flags[0]=Event&condition.Events[0]=FaceDetect
ion&condition.DB.FaceDetectionRecordFilter.ImageType=GlobalSence&condition.DB.Face
DetectionRecordFilter.Sex=Man&condition.DB.FaceDetectionRecordFilter.Age[0]=25&cond
ition.DB.FaceDetectionRecordFilter.Age[1]=40&condition.DB.FaceDetectionRecordFilter.Gl
asses=1

Respons
e

OK

Get the media file information found by the finder

Table 4-115

URL

Method

http://<server>/cgi-bin/mediaFileFind.cgi?action=findNextFile

GET

Description

Get the media file information found by the finder.

[ Request Params ] ( key=value format at URL )

Name

object

count

Type

int

int

R/O Param Description

R

R

The finder object id

Record num to get, should less than 100.

[ Response Params ] ( key=value format )

Name

found

items

+Channel

+StartTime

+EndTime

+Type

+Events

Type

int

R/O Param Description

R

Record num that found.

array<object> R

Result record items.

int

string

string

string

O

R

R

O

The video channel index start from 0,

Start time to search, ex: "2010-05-25 12:05:00"

End time to search, ex: "2010-06-25 12:05:00"

File type, should be: "jpg"

array<string> O

Events with this record

General APIs 184

+FilePath

string

+CutLength

+Length

int

int

O

O

O

File path, string max length is 259

File length that cut between start time and end time

File length of the whole file

+SummaryNew array<object> R

DB record object

++Key

++Value

string

object

+++ImageType string

+++TimeStamp object

++++UTC

++++UTCMS

int

int

+++Sex

+++Age

+++Glasses

+++Mask

+++Beard

[ Example ]

string

int

int

int

int

R

R

O

O

O

O

O

O

O

O

O

DB record name, should be "FaceDetectionRecord"

DB record value

Picture type. It can be: "GlobalSence" , "Small"

Picture timestamp

UTC seconds

UTC miliseconds

Sex, it can be "Man", "Woman", "Unknown"

Age

Glasses Status, 0: unknown, 1: not wear, 2: wear

Mask Status, 0: unknown, 1: not wearing mask, 2: wearing
mask

Beard Status, 0: unknown, 1: no beard, 2: has beard

Request

GET
http://192.168.1.108/cgi-bin/mediaFileFind.cgi?action=findNextFile&object=08137&count=1
00

Respons
e

found=100
items[0].Channel=1
items[0].StartTime=2011-1-1 12:00:00
items[0].EndTime=2011-1-1 13:00:00
items[0].Type=jpg
items[0].Events[0]=FaceDetection
items[0].FilePath=/mnt/dvr/sda0/2010/8/11/dav/15:40:50.jpg
items[0].CutLength=79000
items[0].SummaryNew[0].Key=FaceDetectionRecord
items[0].SummaryNew[0].Value.ImageType=GlobalSence
items[0].SummaryNew[0].Value.TimeStamp.UTC=134652732
items[0].SummaryNew[0].Value.TimeStamp.UTCMS=134
items[0].SummaryNew[0].Value.Sex=Man
items[0].SummaryNew[0].Value.Age=30
items[0].SummaryNew[0].Value.Glasses=1
items[0].SummaryNew[0].Value.Mask=2
items[0].SummaryNew[0].Value.Beard=1
…

Close the finder.

This API is the same as the API in "4.10.5 Find Media Files".

Destroy the finder.

This API is the same as the API in "4.10.5 Find Media Files".

General APIs 185

4.10.7 Find media files with FaceRecognition info

Create a media files finder.

This API is the same as the API in "4.10.5 Find Media Files".

Start to find media files satisfied the common conditions and FaceRecognition conditions

with the finder.

Table 4-116

URL

http://<server>/cgi-bin/mediaFileFind.cgi?action=findFile

Method

GET

Description Start to find media files satisfied the common conditions and FaceRecognition conditions

with the finder.

[ Request Params ] ( key=value format at URL )

Name

object

condition

+Channel

Type

int

object

int

+StartTime

string

+EndTime

string

R/O Param Description

R

R

R

O

O

The finder object id

The search conditions

The video channel to search, video channel index start from
1, use -1 to search all video channel.

Start time to search, ex: "2010-05-25 12:05:00"
Ignored, use StartTime in DB param

End time to search, ex: "2010-06-25 12:05:00"
Ignored, use EndTime in DB param

+Types

+Flags

array<string> O

Search file types, should be "jpg"

array<string> O

Search flags. It can be: "Timing", "Manual", "Marker", "Event",
"Mosaic", "Cutout"
should include “Event”.

+Events

array<string> R

Search event list, must be one string: "FaceRecognition"

+Dirs

+DB

++FaceRecogn
itionRecordFilt
er

+++MachineAd
dress

+++StartTime

+++EndTime

+++Person

++++Name

++++Sex

++++Birthday

++++Country

++++Province

array<string> O

Search directory list, if omit, search all. Each dir path max
string length is 259.

object

object

string

string

string

object

string

string

string

string

string

R

R

O

R

R

O

O

O

O

O

O

DB filter object

DB filter for FaceRecognition

Machine address

Start time to search, ex: "2010-05-25 12:05:00"

End time to search, ex: "2010-06-25 12:05:00"

Search condition of history person and the similar face group
person candidates

Person's name, max string length is 15

Sex, can be "Male", "Female", if omit, search all

Birthday, max string length is 11, ex: 1990-5-1

Country, ISO 3166, string length should be 2

Province, max string length is 63

General APIs 186

++++City

++++Certificate
Type

++++ID

++++GroupID

string

string

string

string

++++Age

array<int>

++++Glasses

++++Mask

++++Beard

int

int

int

O

O

O

O

O

O

O

O

City, max string length is 63

Certificate Type. It can be: "IC', "Passport", "Unknown"

Person ID of CertificateType, max string length is 31

The identity of the Face Group that this Person in. max string
length is 63
Age range, ex：[25, 40]
Glasses Status, 0: all, 1: not wear, 2: wear

Mask Status, 0: all, 1: not wearing mask, 2: wearing mask

Beard Status, 0: all, 1: no beard, 2: has beard

+++GroupID

array<string> O

GroupID list

+++SimilaryRa
nge

array<int>

O

Similary Range, ex: [40, 100]

[ Response Params ] ( OK )

[ Example ]

Request GET

http://192.168.1.108/cgi-bin/mediaFileFind.cgi?action=findFile&object=08137&condition.Ch
annel=1&condition.StartTime=2014-1-1%2012:00:00&condition.EndTime=2015-1-10%201
2:00:00&condition.Types[0]=jpg&condition.Flags[0]=Event&condition.Events[0]=FaceRecog
nition&condition.DB.FaceRecognitionRecordFilter.RegType=RecSuccess&condition.DB.Fa
ceRecognitionRecordFilter.StartTime=2014-1-1%2012:00:00&condition.DB.FaceRecognitio
nRecordFilter.EndTime=2015-1-10%2012:00:00&condition.DB.FaceRecognitionRecordFilte
r.Person.Sex=Male&condition.DB.FaceRecognitionRecordFilter.Person.Country=CN&condi
tion.DB.FaceRecognitionRecordFilter.Person.Age[0]=25&condition.DB.FaceRecognitionRe
cordFilter.Person.Age[1]=40&condition.DB.FaceRecognitionRecordFilter.Person.Glasses=1
&condition.DB.FaceRecognitionRecordFilter.GroupID[0]=10001&condition.DB.FaceRecogn
itionRecordFilter.GroupID[1]=10003&condition.DB.FaceRecognitionRecordFilter.GroupID[2]
=10005&condition.DB.FaceRecognitionRecordFilter.SimilaryRange[0]=40&condition.DB.Fa
ceRecognitionRecordFilter.SimilaryRange[1]=100

Respons
e

OK

Get the media file information found by the finder

Table 4-117

URL

Method

http://<server>/cgi-bin/mediaFileFind.cgi?action=findNextFile

GET

Description

Get the media file information found by the finder

[ Request Params ] ( key=value format at URL )

Name

object

count

Type

int

int

R/O Param Description

R

R

The finder object id

Record num to get, should less than 100.

[ Response Params ] ( key=value format )

Name

found

items

Type

int

R/O Param Description

R

Record num that found.

array<object> R

Result record items.

General APIs 187

+Channel

+StartTime

+EndTime

+Type

+Events

int

string

string

string

O

R

R

O

The video channel index start from 0,

Start time to search, ex: "2010-05-25 12:05:00"

End time to search, ex: "2010-06-25 12:05:00"

File type, should be: "jpg"

array<string> O

Events with this record

+FilePath

string

+CutLength

+Length

int

int

O

O

O

File path, string max length is 259

File length that cut between start time and end time

File length of the whole file

+SummaryNew array<object> R

DB record object

++Key

++Value

string

object

+++RecResult

int

+++MachineAd
dress

+++IsGlobalSc
ene

string

bool

+++ImageInfo

object

++++Length

int

++++FilePath

string

+++Object

++++Sex

++++Age

++++Glasses

++++Eye

++++Mouth

++++Mask

++++Beard

object

string

int

int

int

int

int

int

R

R

O

O

O

O

O

O

O

O

O

O

O

O

O

O

DB record name, should be "FaceRecognitionRecord"

DB record value

Recognition result, 0 means recognition failed, no candidates.
1 means recognition success, has candidates.

Machine address, string max length is 259

Is the global scene picture or not

Big picture info

The length of the picture

The file path of the picture, max string length is 259

The target face info

Sex, it can be "Man", "Woman", "Unknown"

Age

Glasses Status, 0: unknown, 1: not wear, 2: wear

Eye status, 0: not detected, 1: close eye, 2: open eye

Mouth status, 0: not detected, 1: close mouth, 2: open mouth

Mask status, 0: not detected, 1: not wearing mask, 2: wearing
mask

Beard status, 0: not detected, 1: no beard, 2: has beard

+++Candidates array<object> O

The info of candidates face from face group.

++++Similarity

int

++++Person

+++++Name

+++++Sex

object

string

string

+++++Birthday

string

+++++Country

string

+++++Province string

+++++City

string

string

string

int

+++++Certificat
eType

+++++ID

+++++Feature
State

[ Example ]

Request GET

O

O

O

O

O

O

O

O

O

O

O

Similarity

person info

Person Name, max string length is 63

Sex, it can be "Male", "Female", "Unknown"

The person's birthday, ex: "1980-01-01"

Country name, length must be 2, value should be according
to ISO3166

Province name, max string length is 63

City name, max string length is 63

Certificate Type. It can be: "IC', "Passport", "Unknown"

Person ID of CertificateType, max string length is 31

Feature State, 0:Unknown, 1:Failed, 2:OK

General APIs 188

http://192.168.1.108/cgi-bin/mediaFileFind.cgi?action=findNextFile&object=08137&count=1
00

Respons
e

found=100
items[0].Channel=1
items[0].StartTime=2011-1-1 12:00:00
items[0].EndTime=2011-1-1 13:00:00
items[0].Type=jpg
items[0].Events[0]=FaceRecognition
items[0].FilePath =/mnt/dvr/sda0/2010/8/11/dav/15:40:50.jpg
items[0].Length =790
items[0].SummaryNew[0].Key=FaceRecognitionRecord
items[0].SummaryNew[0].Value.RecResult=1
items[0].SummaryNew[0].Value.MachineAddress=AAA
items[0].SummaryNew[0].Value.IsGlobalScene=true
items[0].SummaryNew[0].Value.ImageInfo.Length=123
items[0].SummaryNew[0].Value.ImageInfo.FilePath=/tmp/1.jpg
items[0].SummaryNew[0].Value.Object.Sex=Man
items[0].SummaryNew[0].Value.Object.Age=40
items[0].SummaryNew[0].Value.Object.Glasses=1
items[0].SummaryNew[0].Value.Object.Eye=2
items[0].SummaryNew[0].Value.Object.Mouth=1
items[0].SummaryNew[0].Value.Candidates[0].Similarity=50
items[0].SummaryNew[0].Value.Candidates[0].Person.Name=ZhangSan
items[0].SummaryNew[0].Value.Candidates[0].Person.Birthday=1980-01-01
items[0].SummaryNew[0].Value.Candidates[0].Person.Sex=Male
items[0].SummaryNew[0].Value.Candidates[0].Person.Country=CN
items[0].SummaryNew[0].Value.Candidates[0].Person.Province=XXX
items[0].SummaryNew[0].Value.Candidates[0].Person.City=YYY
items[0].SummaryNew[0].Value.Candidates[0].Person.CertificateType=IC
items[0].SummaryNew[0].Value.Candidates[0].Person.ID=1234567890
items[0].SummaryNew[0].Value.Candidates[0].Person.FeatureState=0
…

Close the finder.

This API is the same as the API in "4.10.5 Find Media Files".

Destroy the finder.

This API is the same as the API in "4.10.5 Find Media Files".

4.10.8 Find media files with HumanTrait info

Create a media files finder.

This API is the same as the API in "4.10.5 Find Media Files".

Start to find media files satisfied the common conditions and HumanTrait conditions with

the finder

General APIs 189

Table 4-118

URL

http://<server>/cgi-bin/mediaFileFind.cgi?action=findFile

Method

GET

Description

Start to find media files satisfied the common conditions and HumanTrait conditions with
the finder.

[ Request Params ] ( key=value format at URL )

Name

object

condition

Type

int

object

+Channel

int

+StartTime

+EndTime

+Types

string

string

R/O Param Description

R

R

R

O

O

The finder object id

The search conditions

The video channel to search, video channel index start from
1, use -1 to search all video channel.

Start time to search, ex: "2010-05-25 12:05:00"

End time to search, ex: "2010-06-25 12:05:00"

array<string> O

Search file types, should be "jpg"

+Flags

array<string> O

Search flags. It can be: "Timing", "Manual", "Marker", "Event",
"Mosaic", "Cutout"
should include “Event”

+Events

array<string> R

Search event list, must be one string: "HumanTrait"

+Dirs

+DB

++HumanTrait
RecordFilter

+++HumanAttri
butes

array<string> O

Search directory list, if omit, search all. Each dir path max
string length is 259.

object

object

object

R

R

R

DB filter object

DB filter for HumanTrait

Human attributes

++++CoatColor array<string> O

++++CoatType array<int>

O

++++Trousers
Color

++++TrousersT
ype

array<string> O

array<int>

++++HasHat

++++HasBag

int

int

++++Sex

++++Age

string

array<int>

++++HairStyle

int

[ Response Params ] ( OK )

[ Example ]

O

O

O

O

O

O

Coat color, refer to CoatColor in 16.1.3.5 [Event] HumanTrait
for available values, max array size is 4

Coat type, refer to CoatType in 16.1.3.5 [Event] HumanTrait
for available values, max array size is 2

Trousers color, refer to TrousersColor in 16.1.3.5 [Event]
HumanTrait for available values, max array size is 4

Trousers type, refer to TrousersType in 16.1.3.5 [Event]
HumanTrait for available values, max array size is 2

Has hat or not, 0: all, 1: not has hat, 2: has hat

Has bag or not, 0: all, 1: not has bag, 2: has bag

Sex, can be "Man", "Woman", if omit, search all
Age range, ex：[25, 40]
Hair style, 0: all, 1: long hair, 2: short hair, 3: ponytail, 4: updo,
5: hiddened

Request

GET
http://192.168.1.108/cgi-bin/mediaFileFind.cgi?action=findFile&object=08137&condition.Ch
annel=1&condition.StartTime=2014-1-1%2012:00:00&condition.EndTime=2015-1-10%201
2:00:00&condition.Types[0]=jpg&condition.Flags[0]=Event&condition.Events[0]=HumanTrai

General APIs 190

t&condition.DB.HumanTraitRecordFilter.HumanAttributes.CoatColor[0]=White&condition.D
B.HumanTraitRecordFilter.HumanAttributes.CoatColor[1]=Yellow&condition.DB.HumanTrait
RecordFilter.HumanAttributes.CoatType=1&condition.DB.HumanTraitRecordFilter.HumanAt
tributes.HasHat=2&condition.DB.HumanTraitRecordFilter.HumanAttributes.Sex=Man&cond
ition.DB.HumanTraitRecordFilter.HumanAttributes.Age[0]=30&condition.DB.HumanTraitRe
cordFilter.HumanAttributes.Age[1]=50&condition.DB.HumanTraitRecordFilter.HumanAttribu
tes.HairStyle=1

Respons
e

OK

Get the media file information found by the finder

Table 4-119

URL

http://<server>/cgi-bin/mediaFileFind.cgi?action=findNextFile

Method

GET

Descripti
on

Get the media file information found by the finder

[ Request Params ] ( key=value format at URL )

Name

object

count

Type

int

int

R/O Param Description

R

R

The finder object id

Record num to get, should less than 100.

[ Response Params ] ( key=value format )

Name

found

items

+Channel

+StartTime

+EndTime

+Type

+Events

Type

int

R/O Param Description

R

Record num that found.

array<object> R

Result record items.

int

string

string

string

O

R

R

O

The video channel index start from 0,

Start time to search, ex: "2010-05-25 12:05:00"

End time to search, ex: "2010-06-25 12:05:00"

File type, should be: "jpg"

array<string> O

Events with this record

+FilePath

string

+CutLength

+Length

int

int

+SummaryNew object

++Key

++Value

+++HumanAttri
butes

string

object

object

++++CoatColor string

++++CoatType

int

++++Trousers
Color

string

++++TrousersT
ype

int

O

O

O

R

R

R

O

O

O

O

O

File path, string max length is 259

File length that cut between start time and end time

File length of the whole file

Face info

DB record name, should be "HumanTraitRecord"

DB record value

Human attributes

Coat color, refer to CoatColor in 16.1.3.5 [Event] HumanTrait
for available values,

Coat type, refer to CoatType in 16.1.3.5 [Event] HumanTrait
for available values,

Trousers color, refer to TrousersColor in 16.1.3.5 [Event]
HumanTrait for available values,

Trousers type, refer to TrousersType in 16.1.3.5 [Event]
HumanTrait for available values,

General APIs 191

++++HasHat

++++HasBag

int

int

++++Sex

++++Age

string

int

++++HairStyle

int

++++HasUmbr
ella

++++Bag

++++Cap

+++FaceAttribu
tes

++++Sex

++++Age

++++Mask

++++Beard

++++Glass

int

int

int

object

string

int

int

int

Int

++++Emotion

string

+++FacePath

string

+++FaceScene
Path

+++HumanPat
h

+++HumanSce
nePath

[ Example ]

string

string

string

O

O

O

O

O

O

O

O

O

O

O

O

O

O

O

O

O

O

O

Has hat or not, 0: unknown, 1: not has hat, 2: has hat

Has bag or not, 0: unknown, 1: not has bag, 2: has bag

Sex, can be "Man", "Woman", "Unknown"

Age

Hair style, 0: unknown, 1: long hair, 2: short hair, 3: ponytail,
4: updo, 5: hiddened

Has umbrella or not, 0: unknown, 1: not has umbrella, 2: has
umbrella

Bag type, 0: unknown, 1: handbag, 2: shoulder bag, 3:
knapsack, 4: draw-bar box

Cap style, 0: unknown, 1: normal cap, 2: helmet

Face attributes

Sex, can be "Man", "Woman", "Unknown"

Age

Mask status, 0: not detected, 1: not wearing mask, 2: wearing
mask

Beard status, 0: not detected, 1: no beard, 2: has beard

Glasses Status, 0: unknown, 1: not wearing, 2: normal
Glasses, 3: sun glasses, 4: black frame glasses

Emotion info. It can be: "Unknown", "Smile", "Anger",
"Sadness", "Disgust", "Fear", "Surprise", "Neutral", "Laugh",
"Happy", "Confused", "Scream", "Lookaside"

Face picture path, max string length is 259

Face scene picture path, max string length is 259

Human picture path, max string length is 259

Human scene picture path, max string length is 259

Request

GET
http://192.168.1.108/cgi-bin/mediaFileFind.cgi?action=findNextFile&object=08137&count=1
00

General APIs 192

Respons
e

found=100
items[0].Channel=1
items[0].StartTime=2011-1-1 12:00:00
items[0].EndTime=2011-1-1 13:00:00
items[0].Type=jpg
items[0].Events[0]=HumanTrait
items[0].FilePath=/mnt/dvr/sda0/2010/8/11/dav/15:40:50.jpg
items[0].Length=790
items[0].SummaryNew.Key=HumanTraitRecord
items[0].SummaryNew.Value.HumanAttributes.CoatColor=White
items[0].SummaryNew.Value.HumanAttributes.CoatType=1
items[0].SummaryNew.Value.HumanAttributes.TrousersColor=Black
items[0].SummaryNew.Value.HumanAttributes.TrousersType=1
items[0].SummaryNew.Value.HumanAttributes.HasHat=2
items[0].SummaryNew.Value.HumanAttributes.HasBag=1
items[0].SummaryNew.Value.HumanAttributes.Sex=Man
items[0].SummaryNew.Value.HumanAttributes.Age=30
items[0].SummaryNew.Value.HumanAttributes.HairStyle=2
items[0].SummaryNew.Value.HumanAttributes.HasUmbrella=1
items[0].SummaryNew.Value.HumanAttributes.Bag=0
items[0].SummaryNew.Value.HumanAttributes.Cap=2
items[0].SummaryNew.Value.FaceAttributes.Sex=Man
items[0].SummaryNew.Value.FaceAttributes.Age=35
items[0].SummaryNew.Value.FaceAttributes.Mask=0
items[0].SummaryNew.Value.FaceAttributes.Beard=1
items[0].SummaryNew.Value.FaceAttributes.Glass=2
items[0].SummaryNew.Value.FaceAttributes.Emotion=Smile
items[0].SummaryNew.Value.FacePath=/mnt/2010/8/11/dav/15:40:50.jpg
items[0].SummaryNew.Value.FaceScenePath=/mnt/2010/8/11/dav/15:40:51.jpg
…

Close the finder.

This API is the same as the API in "4.10.5 Find Media Files".

Destroy the finder.

This API is the same as the API in "4.10.5 Find Media Files".

4.10.9 Find media files with TrafficCar info

Create a media files finder.

This API is the same as the API in "4.10.5 Find Media Files".

Start to find media files satisfied the common conditions and TrafficCar conditions with the

finder

Table 4-120

General APIs 193

URL

http://<server>/cgi-bin/mediaFileFind.cgi?action=findFile

Method

GET

Description

Start to find media files satisfied the common conditions and TrafficCar conditions with
the finder.
Note: some request params can use compare condition, it's value is an array, first item is
a string of compare condition type, and the following items are compare values.
Compare condition type can be:
"==": means equal, followed with one param, if param type is string, then param value
can contain some “\*” to match any string.
"||": means equal one of the params, followed with one or more params.
"<>": means inside range, followed by two integer param,
"><": means outside range, followed by two integer param,

[ Request Params ] ( key=value format at URL )

Name

object

condition

Type

int

object

+Channel

int

+StartTime

+EndTime

+Types

string

string

R/O Param Description

R

R

R

O

O

The finder object id

The search conditions

The video channel to search, video channel index start from
1, use -1 to search all video channel.

Start time to search, ex: "2010-05-25 12:05:00"

End time to search, ex: "2010-06-25 12:05:00"

array<string> O

Search file types

+Flags

array<string> O

Search flags. It can be: "Timing", "Manual", "Marker", "Event",
"Mosaic", "Cutout"

+Events

array<string> O

Search event list
Ignored, use Event under DB param.

+Dirs

+DB

++TrafficCar

+++PlateNumb
er

+++Event

+++Speed

+++PlateType

+++PlateColor

+++VehicleCol
or

array<string> O

Search directory list, if omit, search all. Each dir path max
string length is 259.

object

object

<compare
condition>

<compare
condition>

<compare
condition>

<compare
condition>

<compare
condition>

<compare
condition>

R

R

O

O

O

O

O

O

DB object

DB filter for TrafficCar

PlateNumber condition, use compare condition format, ex:
[ "==", "*888" ]

Event condition, ex: [ "||", "TrafficGate", "Alarm*" ]

Speed condition, ex: [ "<>", 40, 80 ]

Plate type condition, use compare condition format, ex: ["==",
"Armed"],

Plate color condition, use compare condition format, ex: ["==",
"Blue"],

Vehicle color condition, use compare condition format, ex:
["==", "White"],

[ Response Params ] ( OK )

[ Example ]

Request

GET http://192.168.1.108/cgi-bin/mediaFileFind.cgi?action=findFile&object=08137&condit
ion.Channel=1&condition.StartTime=2014-1-1%2012:00:00&condition.EndTime=2015-1-1
0%2012:00:00&condition.Types[0]=jpg&condition.Flags[0]=Event&condition.DB.TrafficCar.

General APIs 194

PlateNumber[0]=%3d%3d&condition.DB.TrafficCar.PlateNumber[1]=%2a888&condition.D
B.TrafficCar.Speed[0]=%3c%3e&condition.DB.TrafficCar.Speed[1]=40&condition.DB.Traffi
cCar.Speed[2]=80&condition.DB.TrafficCar.VehicleColor[0]=%3d%3d&condition.DB.Traffic
Car.VehicleColor[1]=White

Response OK

Get the media file information found by the finder

Table 4-121

URL

http://<server>/cgi-bin/mediaFileFind.cgi?action=findNextFile

Method

GET

Descripti
on

Get the media file information found by the finder

[ Request Params ] ( key=value format at URL )

Name

object

count

Type

int

int

R/O Param Description

R

R

The finder object id

Record num to get, should less than 100.

[ Response Params ] ( key=value format )

Name

found

items

+Channel

+StartTime

+EndTime

+Type

+Events

Type

int

R/O Param Description

R

Record num that found.

array<object> R

Result record items.

int

string

string

string

O

R

R

O

The video channel index start from 0,

Start time to search, ex: "2010-05-25 12:05:00"

End time to search, ex: "2010-06-25 12:05:00"

File type, should be: "jpg"

array<string> O

Events with this record

+FilePath

string

+CutLength

+Length

+Summary

++TrafficCar

+++PlateNumb
er

int

int

object

object

string

+++PlateType

string

+++PlateColor

string

+++VehicleCol
or

string

+++Country

string

int

string

+++Speed

+++Event

[ Example ]

Request

O

O

O

R

R

R

O

O

O

O

O

O

File path, string max length is 259

File length that cut between start time and end time

File length of the whole file

DB record info

TrafficCar record info

Car plate number

Plate type,

Plate color, ex: "Yellow", "Blue", … etc

Vehicle color, ex: "Yellow", "Blue", … etc

Country info. max string length is 19

Vehicle speed, unit is km/hour

The event info, ex: “TrafficJunction”

GET http://192.168.1.108/cgi-bin/mediaFileFind.cgi?action=findNextFile&object=08137&co
unt=100

General APIs 195

Respons
e

found=100
items[0].Channel=1
items[0].StartTime=2011-1-1 12:00:00
items[0].EndTime=2011-1-1 13:00:00
items[0].Type=jpg
items[0].Events[0]=TrafficJunction
items[0].FilePath=/mnt/dvr/sda0/2010/8/11/dav/15:40:50.jpg
items[0].Length=790
items[0].Summary.TrafficCar.PlateNumber=A08888
items[0].Summary.TrafficCar.PlateType=Unknown
items[0].Summary.TrafficCar.PlateColor=Blue
items[0].Summary.TrafficCar.VehicleColor=White
items[0].Summary.TrafficCar.Country=China
items[0].Summary.TrafficCar.Speed=70
items[0].Summary.TrafficCar.Event=TrafficJunction
…

Close the finder.

This API is the same as the API in "4.10.5 Find Media Files".

Destroy the finder.

This API is the same as the API in "4.10.5 Find Media Files".

4.10.10 Find media files with IVS info

Create a media files finder.

This API is the same as the API in "4.10.5 Find Media Files".

Start to find media files satisfied the common conditions and IVS conditions with the finder

Table 4-122

URL

http://<server>/cgi-bin/mediaFileFind.cgi?action=findFile

Method

GET

Description

Start to find media files satisfied the common conditions and IVS conditions with the
finder.

[ Request Params ] ( key=value format at URL )

Name

object

condition

Type

int

object

+Channel

int

+StartTime

+EndTime

+Types

string

string

R/O Param Description

R

R

R

O

O

The finder object id

The search conditions

The video channel to search, video channel index start from
1, use -1 to search all video channel.

Start time to search, ex: "2010-05-25 12:05:00"

End time to search, ex: "2010-06-25 12:05:00"

array<string> O

Search file types

+Flags

array<string> O

Search flags. It can be: "Timing", "Manual", "Marker", "Event",
"Mosaic", "Cutout"

General APIs 196

+Events

array<string> O

Search event list,

array<string> O

Search directory list, if omit, search all. Each dir path max
string length is 259.

+Dirs

+DB

++IVS

object

object

+++Rule

string

R

R

O

+++Action

string

O

+++ObjectType array<string> O

[ Response Params ] ( OK )

[ Example ]

DB object

DB filter for IVS

IVS rule condition. It can be: "CrossLineDetection" , "Cro
ssRegionDetection" , "LeftDetection" , "WanderDetection
"
"MoveDetection" , "RioterDetection" , "CrossFenceDetectio
n" , "TakenAwayDetection" , "PasteDetection" , "Preservati
on" , "StayDetection" , "TailDetection"

IVS action. It can be: "Appear" , "Disappear" , "Inside" ,
"Cross"

IVS object type, item in array can be: "Unknown" , "Human" ,
"Vehicle" , "NonMotor"

Request

GET http://192.168.1.108/cgi-bin/mediaFileFind.cgi?action=findFile&object=08137&condit
ion.Channel=1&condition.StartTime=2014-1-1%2012:00:00&condition.EndTime=2015-1-1
0%2012:00:00&condition.Types[0]=jpg&condition.DB.IVS.Rule=CrossLineDetection&cond
ition.DB.IVS.Action=Cross&condition.DB.IVS.ObjectType[0]=Human&condition.DB.IVS.Ob
jectType[1]=NonMotor

Response OK

Get the media file information found by the finder

Table 4-123

URL

http://<server>/cgi-bin/mediaFileFind.cgi?action=findNextFile

Method

GET

Description Get the media file information found by the finder

[ Request Params ] ( key=value format at URL )

Name

object

count

Type

int

int

R/O Param Description

R

R

The finder object id

Record num to get, should less than 100.

[ Response Params ] ( key=value format )

Name

found

items

+Channel

+StartTime

+EndTime

+Type

+Events

Type

int

R/O Param Description

R

Record num that found.

array<object> R

Result record items.

int

string

string

string

O

R

R

O

The video channel index start from 0,

Start time to search, ex: "2010-05-25 12:05:00"

End time to search, ex: "2010-06-25 12:05:00"

File type, should be: "jpg"

array<string> O

Events with this record

+FilePath

string

+CutLength

+Length

int

int

O

O

O

File path, string max length is 259

File length that cut between start time and end time

File length of the whole file

General APIs 197

+Summary

++IVS

+++Rule

+++Action

object

object

string

string

+++ObjectType string

R

R

R

O

O

DB record info

IVS record info

IVS rule, see above for valid value

IVS action, see above for valid value

IVS object type, see above for valid value

[ Example ]

Request

Response

GET http://192.168.1.108/cgi-bin/mediaFileFind.cgi?action=findNextFile&object=08137&
count=100

found=100
items[0].Channel=1
items[0].StartTime=2011-1-1 12:00:00
items[0].EndTime=2011-1-1 13:00:00
items[0].Type=jpg
items[0].Events[0]=CrossLineDetection
items[0].FilePath=/mnt/dvr/sda0/2010/8/11/dav/15:40:50.jpg
items[0].Length=790
items[0].Summary.IVS.Rule=CrossLineDetection
items[0].Summary.IVS.Action=Cross
items[0].Summary.IVS.ObjectType=Human
…

Close the finder.

This API is the same as the API in "4.10.5 Find Media Files".

Destroy the finder.

This API is the same as the API in "4.10.5 Find Media Files".

4.10.11 Find media files with NonMotor info

Create a media files finder.

This API is the same as the API in "4.10.5 Find Media Files".

Start to find media files satisfied the common conditions and NonMotor conditions with the

finder

URL

http://<server>/cgi-bin/mediaFileFind.cgi?action=findFile

Method

GET

Table 4-124

Description

Start to find media files satisfied the common conditions and NonMotor conditions with
the finder.

[ Request Params ] ( key=value format at URL )

Name

object

condition

Type

int

object

+Channel

int

R/O Param Description

R

R

R

The finder object id

The search conditions

The video channel to search, video channel index start from
1, use -1 to search all video channel.

General APIs 198

+StartTime

+EndTime

+Types

string

string

O

O

Start time to search, ex: "2010-05-25 12:05:00"

End time to search, ex: "2010-06-25 12:05:00"

array<string> O

Search file types

+Flags

array<string> O

Search flags. It can be: "Timing", "Manual", "Marker", "Event",
"Mosaic", "Cutout"

+Events

array<string> O

Search event list,

+Dirs

+DB

++NonMotorRe
cordFilter

+++NumOfCycl
ing

array<string> O

object

object

R

R

Search directory list, if omit, search all. Each dir path max
string length is 259.

DB object

DB filter for NonMotor

int

O

Number of people that cycling, value can be 1 ~ 3

+++Color

string

O

"Darkviolet"

NonMotor color, can be "White" "Orange" "Pink" "Black"
"Red" "Yellow" "Gray" "Blue" "Green" "Purple" "Brown"
"Whitesmoke"
"Sliver"
"Darkorange"
"Gold"
"Darkolivegreen" "Chartreuse" "Greenyellow" "Forestgreen"
"Seagreen" "Deepskyblue" "Cyan" "Other"

"Mistyrose"

"Dimgray"

"Maroon"

"Tomato"

"Olive"

+++Category

string

O

"DualTriWheelMotorcycle"

NonMotor type, can be : "Non-Motor" "Bicycle" "Tricycle"
"Motorcycle"
"LightMotorcycle"
"EmbassyMotorcycle"
"MarginalMotorcycle"
"AreaoutMotorcycle" "ForeignMotorcycle" "TrialMotorcycle"
"CoachMotorcycle"

+++Helmet

int

O

Helmet status, 0 : unknown, 1 : without helmet, 2 : with helmet

[ Response Params ] ( OK )

[ Example ]

Request

GET http://192.168.1.108/cgi-bin/mediaFileFind.cgi?action=findFile&object=08137&condit
ion.Channel=1&condition.StartTime=2014-1-1%2012:00:00&condition.EndTime=2015-1-1
0%2012:00:00&condition.Types[0]=jpg&condition.DB.NonMotorRecordFilter.NumOfCyclin
g=2&condition.DB.NonMotorRecordFilter.Color=White&condition.DB.NonMotorRecordFilt
er.Category=Bicycle&condition.DB.NonMotorRecordFilter.Helmet=1

Response OK

Get the media file information found by the finder

Table 4-125

URL

http://<server>/cgi-bin/mediaFileFind.cgi?action=findNextFile

Method

GET

Description Get the media file information found by the finder

[ Request Params ] ( key=value format at URL )

Name

object

count

Type

int

int

R/O Param Description

R

R

The finder object id

Record num to get, should less than 100.

[ Response Params ] ( key=value format )

Name

Type

R/O Param Description

General APIs 199

found

items

+Channel

+StartTime

+EndTime

+Type

+Events

int

R

Record num that found.

array<object> R

Result record items.

int

string

string

string

O

R

R

O

The video channel index start from 0,

Start time to search, ex: "2010-05-25 12:05:00"

End time to search, ex: "2010-06-25 12:05:00"

File type, should be: "jpg"

array<string> O

Events with this record

+FilePath

string

+CutLength

+Length

int

int

+SummaryNew object

++Key

++Value

string

object

+++NumOfCycl
ing

int

O

O

O

R

R

R

O

File path, string max length is 259

File length that cut between start time and end time

File length of the whole file

NonMotor info

DB record name, should be "NonMotorRecordFilter"

DB record value

Number of people that cycling, value can be 1 ~ 3

+++Color

string

O

"Darkviolet"

NonMotor color, can be "White" "Orange" "Pink" "Black"
"Red" "Yellow" "Gray" "Blue" "Green" "Purple" "Brown"
"Whitesmoke"
"Sliver"
"Darkorange"
"Gold"
"Darkolivegreen" "Chartreuse" "Greenyellow" "Forestgreen"
"Seagreen" "Deepskyblue" "Cyan" "Other"

"Mistyrose"

"Dimgray"

"Maroon"

"Tomato"

"Olive"

+++Category

string

O

"DualTriWheelMotorcycle"

NonMotor type, can be : "Non-Motor" "Bicycle" "Tricycle"
"Motorcycle"
"LightMotorcycle"
"EmbassyMotorcycle"
"MarginalMotorcycle"
"AreaoutMotorcycle" "ForeignMotorcycle" "TrialMotorcycle"
"CoachMotorcycle"

+++Helmet

int

O

Helmet status, 0 : unknown, 1 : without helmet, 2 : with helmet

[ Example ]

Request

Response

GET http://192.168.1.108/cgi-bin/mediaFileFind.cgi?action=findNextFile&object=08137&
count=100

found=100
items[0].Channel=1
items[0].StartTime=2011-1-1 12:00:00
items[0].EndTime=2011-1-1 13:00:00
items[0].Type=jpg
items[0].Events[0]=NonMotorDetect
items[0].FilePath=/mnt/dvr/sda0/2010/8/11/dav/15:40:50.jpg
items[0].Length=790
items[0].SummaryNew.Key=NonMotorRecordFilter
items[0].SummaryNew.Value.NumOfCycling=2
items[0].SummaryNew.Value.Color=White
items[0].SummaryNew.Value.Category=Bicycle
items[0].SummaryNew.Value.Helmet=1
…

Close the finder.

This API is the same as the API in "4.10.5 Find Media Files".

General APIs 200

Destroy the finder.

This API is the same as the API in "4.10.5 Find Media Files".

4.10.12 Searching for Media Files According to WorkClothesDetection

Create a media files finder.

This API is the same as the API in "4.10.5 Find Media Files".

Start to find media files satisfied the common conditions and NonMotor conditions with

the finder

URL

http://<server>/cgi-bin/mediaFileFind.cgi?action=findFile

Method

GET

key=value format at URL

R/O

Description

Example

Parameter
Format

Name

object

Type

int32

condition

object

+Channel

int32

+StartTime

+EndTime

string

string

array<stri
ng>

array<stri
ng>

array<stri
ng>

array<stri
ng>

object

object

+Types

+Flags

+Events

+Dirs

+DB

++WorkClot
hesDetectio
n

R

R

R

R

R

O

O

R

O

R

R

+++Helmet

object

O

++++HasHe
lmet

enumint8[
6]

R

Search object of the media files

08137

Search condition

Video channel number; integer; the
video channel number starts from 1.

1

Start time of the search.

End time of the search.

"2010-05-25 12:05:00"

"2010-06-25 12:05:00"

Type of search file. It should be jpg.

["jpg"]

Search condition, including Timing,
Manual, Marker, Event, Mosaic, and
Cutout.
It should be Event.

["Event"]

Search event list. It must be
WorkClothesDetection.

["WorkClothesDetection"
]

Search directory list. If it does not
exist, searches for all directories.

["/mnt/dvr/sda0",
"/mnt/dvr/sda1"]

The filtering condition object of
database.

The filtering condition object of
database for
WorkClothesDetection.

Safety helmet attribute. If this field
does not exist, it means to search
for attributes of all helmets.

Wearing safety helmet.
enumint8[]{
0: Unknown
1: No
2: Yes
}

[1,2]

++++Helmet array<stri R

Safety helmet color.

["Red","Orange"]

General APIs 201

Color

ng>

++++IsCom
pliant

int32

O

+++Clothes

object

O

++++HasCl
othes

enumint8[
]

R

++++Clothe
sColor

array<stri
ng>

R

++++HasLe
galClothes

++++Trigger
Mode

int32

O

string

O

+++Mask

object

O

++++HasMa
sk

int32

+++Type

string

O

R

+++Normal
Hat

object

O

++++HasNo
rmalHat

enumint8[
256]

O

+++Glasses object

O

++++HasGl
asses

int32

O

For value range, see the following
ColorEnum.

Safety helmet alarm mode. 1:
Mismatch attributes alarm; 2: Match
attributes alarm.

1

Work uniform attribute. If this field
does not exist, it means to search
for attributes of all wok uniforms. It
is optional.

[1, 2]

Wearing work uniform.
enumint8[]{
0: Unknown
1: No
2: Yes
}

Work uniform color.
For value range, see the following
ColorEnum.

["Red", "Orange"]

Work uniform alarm mode. 1:
Mismatch attributes alarm; 2: Match
attributes alarm.

1

"TypeDetect"

Detection mode. Attribute detection:
TypeDetect; Registered database:
CompareDetect.

Face mask attribute. If this field
does not exist, it means to search
for attributes of all face masks.

Wearing face mask. 1: No. 2: Yes.

1

"Helmet"

[1,2]

Wear type: Safety Helmet: Helmet.
Work uniform: Clothes.
Normal hat: NormalHat.
Face mask: mask.

Normal hat attribute. If this field
does not exist, it means to search
for attributes of all normal hats.

enumint8[]{
0: Unknown
1: Not wearing normal hat
2: Wearing normal hat
}

Glasses attribute. If this field does
not exist, it means to search for
attributes of all glasses.

Wearing glasses alarm mode. 0:
Triggers an alarm when the target
wears glasses. 1: Triggers an alarm

0

General APIs 202

when the target does not wear
glasses.

Request Example

GET
http://192.168.1.108/cgi-bin/mediaFileFind.cgi?action=findFile&object=08137&condition.Channel=1&con
dition.StartTime=2014-1-1%2012:00:00&condition.EndTime=2015-1-10%2012:00:00&condition.Types[0
]=jpg&condition.Flags[0]=Event&condition.Events[0]=WorkClothesDetection&condition.DB.WorkClothes
Detection.Helmet.HasHelmet[0]=1&condition.DB.WorkClothesDetection.Helmet.HelmetColor[0]=Red&c
ondition.DB.WorkClothesDetection.Type=Helmet

[ Response Params ] ( OK )

Name

Type

R/O Description

Example

Response Example

OK

Get the media file information found by the finder

URL

http://<server>/cgi-bin/mediaFileFind.cgi?action=findNextFile

Method

GET

Parameter
Format

Name

object

count

key=value format at URL

Type

int32

int32

R/O Description

Example

R

R

Search object of the media files

08137

The number of acquired results. It
should be less than 100.

15

Request Example

GET http://192.168.1.108/cgi-bin/mediaFileFind.cgi?action=findNextFile&object=08137&count=15

[ Response Params ] ( key=value format )

Name

found

items

Type

int32

object[]

+Channel

int32

+StartTime

+EndTime

+Type

+Events

string

string

string

array<stri
ng>

+FilePath

string

+CutLength

int32

+Length

+SummaryN
ew

int32

object[]

R/O Description

Example

R

R

O

R

R

O

O

O

O

O

R

The number of searched results.

100

Searched result array.

Video channel number; integer;
the video channel number starts
from 0.

0

Start time of recording.

"2010-05-25 12:05:00"

End time of recording.

"2010-06-25 12:05:00"

File type. It should be jpg.

jpg

Events related to the recordings.

["WorkClothesDetection"]

File path. It cannot exceed 259
characters.

"/mnt/2010/8/11/dav/15:40:50.jp
g"

The file length within a specified
period.

79000

The whole file length.

5536

Database record object.

General APIs 203

++Key

string

object

object

++Value

+++Helmet

++++HasHel
met

R

O

O

Database record name. It should
be WorkClothesDetection.

Database record value.

Safety helmet attribute. Required.

"WorkClothesDetection"

enumint8 R

2

Wearing safety helmet
enumint8{
0: Unknown
1: No
2: Yes
}

++++Helmet
Color

string

R

Safety helmet color.
For value range, see the following
ColorEnum.

Red

+++Clothes

object

O

Safety helmet attribute.

++++HasClo
thes

enumint8 R

2

Wearing work uniform.
enumint8{
0: Unknown
1: No
2: Yes
}

string

R

string

uint32

string

R

R

R

Work uniform color.
For value range, see the following
ColorEnum.

"Red"

Person thumbnail path.

"/picid/1.jpg"

Image size. Unit: Byte

123

Panoramic image path
corresponding to the person
thumbnail.

"/picid/1.jpg"

uint32

R

Image size. Unit: Byte.

123

++++Clothes
Color

+++HumanP
ath

+++HumanI
mageLength

+++HumanS
ceneImage

+++HumanS
ceneImageL
ength

+++HumanB
oundingBox

Rect

R

O

Person enclosure box.
Rectangular information.

Glasses attribute.

[ 24, 16, 8152, 8144 ]

+++Glasses

object

++++Glasse
sType

enumint R

1

Alarm type for glasses detection.
enumint{
0: No glasses

1. Sunglasses
   2: Black-rimmed glasses
   3: Half-frame glasses
   4: Rimless glasses
   5: Ordinary glasses
   6: Industrial goggles
   }

++++HasGla

int32

R

Glasses detection results.

0

General APIs 204

sses

0: Compliant
1: Non-compliance
2: Unknown.

Response Example

found=100
items[0].Channel=1
items[0].StartTime=2011-1-1 12:00:00
items[0].EndTime=2011-1-1 13:00:00
items[0].Type=jpg
items[0].Events[0]=WorkClothesDetection
items[0].FilePath=/mnt/dvr/sda0/2010/8/11/dav/15:40:50.jpg
items[0].CutLength=79000
items[0].Length=5536
items[0].SummaryNew[0].Key=WorkClothesDetection
items[0].SummaryNew[0].Value.Helmet.HasHelmet=2
items[0].SummaryNew[0].Value.Helmet.HelmetColor=Red
items[0].SummaryNew[0].Value.HumanPath=/picid/1.jpg
items[0].SummaryNew[0].Value.HumanImageLength=123
items[0].SummaryNew[0].Value.HumanSceneImage=/picid/1.jpg
items[0].SummaryNew[0].Value.HumanSceneImageLength=123
items[0].SummaryNew[0].Value.HumanBoundingBox[0]=24
items[0].SummaryNew[0].Value.HumanBoundingBox[1]=16
items[0].SummaryNew[0].Value.HumanBoundingBox[2]=8152
items[0].SummaryNew[0].Value.HumanBoundingBox[3]=8144

Close the finder.

This API is the same as the API in "4.10.5 Find Media Files".

Destroy the finder.

This API is the same as the API in "4.10.5 Find Media Files".

Appendix:

Name

Type

Parameter

"Other"

"Unknown"

"Black"

"Silver"

"Gray"

"White"

ColorEnum

char[16]

Description

Unrecognized (unknown
color)

Unknown color (no
detection, or it is not in the
known color range).

Black

Silver

Gray

White

"Maroon"

Chestnut

Remarks
（254,254,254）
The value of 254 for R or G is dedicated to
special colors, so be careful to use it separately.
（254,254,252）

0,0,0
192,192,192
128,128,128

255,255,255

128,0,0

General APIs 205

"Red"

"Purple"

"Fuchsia"

"Green"

"Lime"

"Olive"

"Yellow"

"Navy"

"Blue"

"Teal"

"Aqua"

"Orange"

"Pink"

"Brown"

"Darkviolet"

"Dimgray"

"Whitesmoke"

"Darkorange"

"Mistyrose"

"Tomato"

"Gold"

Red

Purple

Magenta (not supported)

Green (the RGB value used
by the algorithm for Green is
0, 255, 0).

Green (the algorithm names
RGB value (0, 255, 0) as
Green, and the standard
name is Lime, so Lime can
be treated as green in actual
use).

Olive

Yellow

Navy (not supported)

Blue

Navy (not supported)

Aqua (not supported)

Orange (not supported)

Pink

Brown

Dark violet

Dark gray

White smoke

Dark orange

Light rosy

Tomato red

Gold

"Darkolivegreen"

Dark olive green

"Chartreuse"

"Greenyellow"

"Forestgreen"

"Seagreen"

Yellow green

Green yellow

Forest green

Ocean green

"Deepskyblue"

Deep sky blue

255,0,0

128,0,128

255,0,255

0,128,0

0,255,0

128,128,0

255,255,0

0,0,128

0,0,255

0,128,128

0,255,255

255,165,0

255,192,203

165,42,42

148,0,211

105,105,105

245,245,245

255,140,0

255,228,225

255,99,71

255,215,0

85,107,47

127,255,0

173,255,47

34,139,34

46,139,87

0,191,255

0,255,255

144,238,144

"Cyan"

"Lightgreen"

"Orangered"

Cyan

Light Green

Orange red (not supported)

255,69,0

4.10.13 Download Media File with the File Name

Download a file by filename. The <Filename> in URL is got by chapter file finding.

Request URL
Method
Request Params ( none)

http://<server>/cgi-bin/RPC_Loadfile/<Filename>
GET

General APIs 206

Request Example
http://192.168.1.108/cgi-bin/RPC_Loadfile/mnt/sd/2015-01-08/001/dav/19/19.57.12-19.58.25[M][0@0][0
].dav

Response Params (binary data in body )
<binary data>: Binary data pack

Response Example
HTTP/1.1 200 OK
Server: Device/1.0
Content-Type: Application/octet-stream
Content-Length: xxxx

<file data>

4.10.14 Download Media File between Times

Download the media data between start time and end time.

http://<server>/cgi-bin/loadfile.cgi?action=startLoad
GET

Request URL
Method
Request Params ( key=value format in URL )
Type
Name
int
channel
string
startTime

R/O Description
R
R

endTime

string

subtype

int

R

O

Types

string

O

Channel number; starting from 1
Start time of the recording in the format
of: yyyy-mm-dd hh:mm:ss
End time of the recording in the format
of: yyyy-mm-dd hh:mm:ss
Stream type.
If the parameter does not exist, the
default value is 0.
0: Main stream
1: Sub stream 1
2: Sub stream 2
The
type of
searched for

that are being

files

Example
1
“2010-05-25 12:05:00”

“2010-05-25 12:10:00”

0

“dav”

Request Example
http://192.168.1.108/cgi-bin/loadfile.cgi?action=startLoad&channel=1&startTime=2012-10-8%2013:00:0
1&endTime=2012-10-8%2014:00:01&subtype=0&Types=dav

Response Params (binary data in body )
<binary data>: Binary data pack

Response Example
HTTP/1.1 200 OK
Server: Device/1.0
Content-Type: Application/octet-stream
Content-Length: xxxx

General APIs 207

<file data>

4.10.15 Encrypted Download Media File with the File Name

Table 4-126

Syntax

http://<server>/cgi-bin/RecordStreamInterleaved.cgi?action=attachStream&path=<File
name>[&password=<password>]

Method

GET

Description

Encrypted Download a file by filename. To get filename by chapter file finding.

Example

http://172.29.2.241/cgi-bin/RecordStreamInterleaved.cgi?action=attachStream&path=/
mnt/sd/2019-07-01/001/dav/12/12.36.16-12.36.26[F][0@0][0].dav

Success
Return

Comment

HTTP Code: 200 OK
Content-Type: Application/octet-stream
Content-Length: <fileLength>
Body:
<data>
<data>

Parameters in URL:
Filename: name of media files which would be downloaded.
password: password for encrypting media file data. if not set password, then use the
preset password

4.10.16 Query Total Number of Alarms

POST

Request URL http://<server>/cgi-bin/api/mediaFileFind/getCount
Method
Request Params ( JSON format in body )
Name
Request Example
{}

R/O Description

Type

Example

Response Params ( JSON format in body )
Name
count

R/O Description
total number
R

Type
uint32

Response Example
{
"count": 100
}

Example
100

General APIs 208

4.11 Log

4.11.1 Find Logs

1.  Whether or not found logs satisfied the conditions

Table 4-127

Syntax

http://<server>/cgi-bin/log.cgi?action=startFind&condition.StartTime=<start>&condition
.EndTime=<end>[&condition.StartTimeRealUTC=<startRealUTC>&condition.EndTime
RealUTC=<endRealUTC>][&condition.Type=<type>]

Method

GET

Description

Start to find log.

Example

Find log between 2011-1-1 12:00:00 and 2011-1-10 12:00:00, UTC time between
2011-01-01T04:00:00Z and 2011-01-10T04:00:00Z. URL is:
http://192.168.1.108/cgi-bin/log.cgi?action=startFind&condition.StartTime=2011-1-1%2
012:00:00&condition.EndTime=2011-1-10%2012:00:00&condition.StartTimeRealUTC=
2011-01-01T04:00:00Z&condition.EndTimeRealUTC=2011-01-10T04:00:00Z

Success
Return

token=1
count=100

Comment

Parameters in URL:
start/end: the start/end time of log. Format is: yyyy-mm-dd hh:mm:ss.
startRealUTC/endRealUTC: Indicates the UTC time of log start/end, in the format:
yyyy-mm-ddThh:mm:ssZ. And (start, end) are mutually exclusive; If both exist, use
RealUTC time first.
In response, there is a token for further log finding process. If token is greater than 0,
logs are found; otherwise no logs are found.
Type: log type. The range is { "System", "Config", "Event", "Storage", "Account", "Data",
"File", "CourseRecord" }.
count: The logcount for the search condition.

2.  Get the particular number of logs

Table 4-128

Syntax

Method

http://<server>/cgi-bin/log.cgi?action=doFind&token=<TokenValue>&count=<logCount>

GET

Description

Find log with token TokenValue and count logCount.

Example

http://192.168.1.108/cgi-bin/log.cgi?action=doFind&token=1&count=100

Success
Return

found=2
items[0].RecNo=789
items[0].Time=2011-05-20 11:59:10
items[0].Type=ClearLog
items[0].User=admin
items[1].Detail.Compression=H.264->MJPG
items[1].Detail.Data=Encode
items[1].RecNo=790

General APIs 209

items[1].Time=2011-05-20 11:59:21
items[1].TimeRealUTC=2011-05-20T03:59:21Z
items[1].Type=SaveConfig
items[1].User=System
…

Parameters in URL:
The TokenValue is got by startFind in the above section, and logCount is the count of
logs for this query.
The maximum value of logCount is 100.

Description

Count of found log, found is 0 if no log is found.

User name.

Log type.

Comment

Appendix:

Field in
Response

found

User

Type

Time of this log.

Time
TimeRealUTC 日志 UTC 时间，TZ 格式
RecNo

Log number.

Detail

Log details.

3.  Stop query logs

Table 4-129

Syntax

Method

http://<server>/cgi-bin/log.cgi?action=stopFind&token=<TokenValue>

GET

Description

Stop query log by token TokenValue.

Example

Success
Return

Comment

http://192.168.1.108/cgi-bin/log.cgi?action=stopFind&token=1

OK

Parameters in URL:
The TokenValue is got by startFind in above section

4.11.2 Clear All the Logs

Table 4-130

Syntax

Method

http://<server>/cgi-bin/log.cgi?action=clear

GET

Description

Clear all the logs.

Example

Success
Return

Comment

http://192.168.1.108/cgi-bin/log.cgi?action=clear

OK

—

General APIs 210

4.11.3 Backup Logs

Table 4-131

Syntax

http://<server>/cgi-bin/Log.backup?action=All&condition.StartTime=<startTime>&cond
ition.EndTime=<endTime>

Method

GET

Description

Example

Download the log information between the start time and the end time as a file named
Log.Backup default.

http://192.168.1.108/cgi-bin/Log.backup?action=All&condition.StartTime=2014-8-25%2
000:02:32&condition.EndTime=2020-8-25%2001:02:32

HTTP/1.1 200 OK
CONTENT-LENGTH: 743087
CONNECTION: close
Content-type: application/binarytet-stream; charset=utf-8

Success
Return

&w_User: default
&Time: 2014-09-01 15:20:45
&Type: VideoLoss
&Content: EventType: VideoLoss
channel: <8>
StartTime: 2014-09-01 15:20:45

…

Comment

Parameters in URL:
startTime/endTime: the start/end time when log info built. 24 hour Format, as:
yyyy-mm-dd hh:mm:ss.
For example:
2014-8-25 00:02:32
2020-8-25 01:02:32

4.11.4 Seek Find Logs

Syntax

http://<server>/cgi-bin/Log.cgi?action=doSeekFind&token=<TokenValue>&offset=<offsetVa
lue>&count=<logCount>

Method GET

Descripti
on

Example

Success
Return

Find log with token TokenValue, offset offsetValue and count logCount.

http://192.168.1.108/cgi-bin/Log.cgi?action=doSeekFind&token=46878&offset=200&count=2
00

found=2
items[0].RecNo=789
items[0].Time=2011-05-20 11:59:10
items[0].Type=ClearLog
items[0].User=admin
items[0].Detail.Compression=H.264->MJPG

General APIs 211

items[0].Detail.Data=Encode
items[1].RecNo=790
items[1].Time=2011-05-20 11:59:21
items[1].Type=SaveConfig
items[1].User=System
items[1].Detail.Compression=H.264->MJPG
items[1].Detail.Data=Encode

…

Comme
nt

Parameters in URL:
The TokenValue is got by startFind in the above section, and logCount is the count of logs
for this query.offsetValue is the number which count from the first matched.
The maximum value of logCount is 100.

4.11.5 Export Encryped Log

Syntax

http://<server>/cgi-bin/Log.exportEncrypedLog?action=All&condition.StartTime=<start
Time>&condition.EndTime=<endTime>&condition.Password=<password>

Method

GET

Description

Get encrypted log in zip format

Example

Success
Return

Comment

http://192.168.1.108/cgi-bin/Log.exportEncrypedLog?action=All&condition.StartTime=2
014-8-25%2000:02:32&condition.EndTime=2020-8-25%2001:02:32&condition.Passwo
rd=12345

HTTP/1.1 200 OK
Transfer-Encoding: chunked
CONNECTION: keep_alive
Content-type: application/binarytet-stream; charset=utf-8
The binary data of encrypted log in zip format

StartTime/EndTime: the start/end time when log info built. 24 hour Format, as:
yyyy-mm-dd hh:mm:ss.
For example:
2014-8-25 00:02:32
2020-8-25 01:02:32
The Password is the input parameter for encrypted log in zip format.
The binary data should be saved as .zip forma

4.11.6 [Config] Serial Port Log Redirection

Config Data Params
Name

Type

DebugInfoRedir

object

+SerialPortLogLevel

uint8

否

R/O Description
O

The configuration of serial port log
redirection.
logs which need to be redirected.（default
is 4)

Example

4

General APIs 212

0：Fatal error; 1: Normal ; 2：Warning;3：
Info，4：The invoke path and data flow
tracking in debug level 1 ; 5：The key logic
tracking in debug level 2; 6：Other detail
information in debug level 3; 7：Debug info
for legacy compatible）
log type which need to be redirected.（0：
main chip logs；1：main chip + sub-chip
logs）

0

+SerialPortLogType

uint8

否

Please refer to "4.2.1 Get and Set Configure”for more info about the get/set operation

Get Config Request Example
http://192.168.1.108/cgi-bin/configManager.cgi?action=setConfig&name=DebugInfoRedir

Get Config Response Example
table.DebugInfoRedir.SerialPortLogLevel=3
table.DebugInfoRedir.SerialPortLogType=1

Set Config Request Example
http://192.168.1.108/cgi-bin/configManager.cgi?action=setConfig&DebugInfoRedir.SerialPortLogLevel=
6&DebugInfoRedir.SerialPortLogType=1

Set Config Response Example
OK

4.12 Upgrader

4.12.1 Strat to Upgrade

Table 4-132

Syntax

Method

Description

http://<server>/cgi-bin/upgrader.cgi?action=uploadFirmware

POST

Use this message to upload the firmware, and when the device receiving all the data
successfully, it will start to upgrade the device, and then use the getState method to get
the state.

General APIs 213

POST /cgi-bin/upgrader.cgi?action=uploadFirmware HTTP/1.1
Host: 192.168.1.108
Connection: keep-alive
Content-Type: multipart/form-data; boundary=---------------------------8655433224198
Content-Length: xxxxxxxxx

Example

-----------------------------8655433224198
Content-Disposition:form-data;name="upgrade"; filename= "xxxxxx.bin"
Content-Type: application/octet-stream

Firmware data….

-----------------------------8655433224198--

Success
Return

Comment

OK

—

4.12.2 Get Upgrade State

Syntax

Method

Description

Example

Success
Return

Comment

Table 4-133

http://<server>/cgi-bin/upgrader.cgi?action=getState

GET

Use this message to upload the firmware, and when the device receiving all the data
successfully, it will start to upgrade the device, and then use the getState method to get
the state.

http://192.168.1.108/cgi-bin/upgrader.cgi?action=getState

state.State=Upgrading
state.Progress=45

Parameters in Response:
State: the state of the upgrade, it can be Preparing, Downloading, DownloadFailed,
Upgrading, Invalid, Failed, Succeeded, Cancelled, and NotEnoughMemory.
Progress: the progress of the upgrade.

4.12.3 Set upgrader url

url with Upgrade packet address

Syntax

http://<server>/cgi-bin/upgrader.cgi?action=updateFirmwareByUrl[&Url=<Url>][&checkTy pe=<checkType>][&checkSum=<checkSum>]

Method

GET

Parameter
Format

Parameter
Url

key=value format at URL

R/O

Type
string R

Description
Upgrade package
address, also support ftp
address

Example
https://aaa/bbb/ccc/license.bin

General APIs 214

checkType

int

R

checkSum

string O

check method
enumint8{
0: MD5
}

Upgrade package
checksum

0

f38ad920

Example
http://<server>/cgi-bin/upgrader.cgi?action=updateFirmwareByUrl=http://aaa/bbb/ccc/license.bin&check
Type=0&checkSum=f38ad920

Parameter Format

OK in body

Parameter

Example

OK

Type

R/O

Description

Example

4.12.4 Cancel Upgrade

Syntax

Method
参数格式

http://<server>/cgi-bin/upgrader.cgi?action=cancel

GET

key=value format at URL

Type

Parameter
Example
http://<server>/cgi-bin/upgrader.cgi?action=cancel

R/O

Description

Example

Parameter Format

OK in body

Parameter

Example

OK

Type

R/O

Description

Example

4.12.5 Checking Cloud Update Version

Check cloud update version

Request URL

http://<server>/cgi-bin/api/CloudUpgrader/check

Method

POST

Request Params ( JSON format in body )

Name

way

Type

int32

R

R/O Description

Checking methods.
enumint8{ 0: Updating by
updating server through direct
connection. 1: Checking through
proxy server. 2: Detecting by
acquiring cached test results. }

Proxy server address, valid
when way==1 (optional).

Example

0

General APIs 215

proxy

object

O

+IP

+Port

char[40] R

Network address

int32

O

Port

"10.1.2.3"

8080

Request Example

{

}

"way" : 0,
"proxy" : {

"IP" : "10.1.2.3",
"Port" : 8080

}

Response Params ( JSON format in body )

Name

info

Status

Type

object

enumchar[12
]

O

R

R/O

Description

+PackageType

enumchar[32
]

O

Example

"None"

"all"

Test results

Update status.
enumchar[12]{
"None": No update is detected
"Regular": Regular update (It requires
user confirmation, and can only be
updated to a later version).
"Emergency": Mandatory update (The
device automatically performs detection
and update, and it can also degrade to
an earlier version).
“Automatic": Automatic update (The
device automatically updates when a
new version is available. It is currently for
custom use and needs to be enabled)
}

Update package type of new version.
When State is not None, return
enumchar[32]{
"all": All package.
"ptz": PTZ main control package.
"web"
"logo"
"custom"
"gui"
"pd"
"data"
"ptz_power": PTZ power.
"ptz_light": PTZ light.
"ptz_heater": PTZ heater.
}

+OldVersion

char[64]

O

Old version, which needs to be returned
when State is not None.

"0000"

General APIs 216

+NewVersion

char[64]

+Attention

char[2048]

+PackageUrl

char[256]

+PackageId

+CheckSum

char[64]

char[64]

+BuildTime

char[24]

O

O

O

O

O

O

Response Example

{

"info": {

New version, which needs to be returned
when State is not None.

"0004"

Updated content of the new update
package.

"What is new"

Download address of update package
(required for agent upgrade).

"https://exampl
e.com/1.zip"

Update package ID

SHA-256 checksum of the update
package

Build time of update package

"1d2ee7"

"F3D288AB"

"08-10-2018
01:01:02"

"State": "None",
"PackageType": "all",
"OldVersion": "0000",
"NewVersion": "0004",
"Attention": "What is new",
"PackageUrl": "https://example.com/1.zip",
"PackageId": "1d2ee7",
"CheckSum": "F3D288AB"
"BuildTime": "08-10-2018 01:01:02"

}

}

4.12.6 Performing Online Update

Perform online update

Request URL

http://<server>/cgi-bin/api/CloudUpgrader/execute

Method

POST

Request Params ( JSON format in body )

Name

Type

R/O Description

NewVersion

char[64] O

way

enumint8 R

proxy

object

O

Example

"2.42.00.001"

If the cloud version is
newer than the new
version obtained in the last
check, the update fails.

0

Update method enumint8{
0: Updating by updating
server through direct
connection.
1: Updating by proxy
server
}.

Proxy server address,
which is valid when way=1

General APIs 217

+IP

+Port

info

(optional).

char[40] O

Network address

uint16

object

O

O

Port

Update package
information, which is
needed when way==1
(optional).

"10.1.2.3"

8080

+PackageUrl

char[256] O

Download address of the
update package (required
for agent upgrade).

"https://example.co
m/1.zip"

+PackageId

+CheckSum

char[64] O

Update package ID

"1d2ee7"

char[64] O

SHA-256 checksum of the
update package

"F3D288AB"

Request Example

{

"NewVersion" : "2.42.00.001",
"way" : 0,
"proxy" : {

"IP" : "10.1.2.3",
"Port" : 8080

},
"info" : {

"PackageUrl" : "https://example.com/1.zip",
"PackageId" : "1d2ee7",
"CheckSum" : "F3D288AB"

}

}

Response Params ( JSON format in body )

Name

Type

R/O

Description

Example

Response Example

{}

4.12.7 Canceling Online Update

Cancel the online update during the download process. If you have already started writing Flash,
you cannot cancel the update.

Request URL

http://<server>/cgi-bin/api/CloudUpgrader/cancel

Method

GET

Request Params (JSON format in body)

Name

Type

R/O

Description

Example

Request Example

{}

Response Params ( JSON format in body )

General APIs 218

Name

Type

R/O

Description

Example

Response Example

{}

4.13 Http Uploading

4.13.1 [Config] Active Image and Event Uploading

Configure the device to upload images and events to the specified address. Before configuration,
the client should monitor in the specified address. Once the configuration is complete, the device
would upload images and event data to this address using the command described in chapter "
4.13.2 Active Image and Event Uploading ".

The parameters for uploading image and event are as follows:

Config Data Params
Name

Type

PictureHttpUpload

object

+PictureHttpUpload object
++Enable

bool

++Type

char[16]

+UploadServerList

object[]

++Address

char[128]

R
R
O

R

R

++Port
++UserName
++Password
++Uploadpath

++EventType

O
int
O
char[32]
char[128] O
char[128] O
O

char[][32]

R/O Description
R

The parameters for uploading
image and event
Enable or not
Enable or not
Authentication
"basic”: HTTP Basic Authentic
ation
"digest": HTTP Digest Authenti
cation
The list of servers that receives
uploaded information
IP address or domain name of
the server
Server port
Username
Password
Upload path
Code list for uploaded event

Example

true
"digest”

192.168.1.208

80
"abc”
"123”
"/example/handlepic.php”
["CrossLineDetection","Fa
ceDetection"]

Please refer to "4.2.1 Get and Set Configure" for configuration getting and setting. Specific
examples are as follows :

Get Config Request Example
http://192.168.1.108/cgi-bin/configManager.cgi?action=getConfig&name=PictureHttpUpload
Get Config Response Example
table.PictureHttpUpload.PictureHttpUpload.Enable=true
table.PictureHttpUpload.PictureHttpUpload.Type=digest
table.PictureHttpUpload.UploadServerList[0].Address=192.168.1.208
table.PictureHttpUpload.UploadServerList[0].Port=80
table.PictureHttpUpload.UploadServerList[0].UserName=abc
table.PictureHttpUpload.UploadServerList[0].Password=123

General APIs 219

table.PictureHttpUpload.UploadServerList[0].Uploadpath=/example/handlepic.php
table.PictureHttpUpload.UploadServerList[0].EventType[0]=CrossLineDetection
table.PictureHttpUpload.UploadServerList[0].EventType[1]=FaceDetection

Set Config Request Example
http://192.168.1.108/cgi-bin/configManager.cgi?action=setConfig&PictureHttpUpload.PictureHttpUpload
.Enable=true&PictureHttpUpload.PictureHttpUpload.Type=digest&PictureHttpUpload.UploadServerList[
0].Address=192.168.1.208&PictureHttpUpload.UploadServerList[0].Port=80&PictureHttpUpload.Upload
ServerList[0].UserName=abc&PictureHttpUpload.UploadServerList[0].Password=123&PictureHttpUploa
d.UploadServerList[0].Uploadpath=/example/handlepic.php&PictureHttpUpload.UploadServerList[0].Ev
entType[0]=CrossLineDetection&PictureHttpUpload.UploadServerList[0].EventType[1]=FaceDetection

Set Config Response Example
OK

4.13.2 Active Image and Event Uploading

The device uploads images and event data to the specified address based on the client
configuration. For details on the parameters for each event, please refer to the corresponding [Event]
chapters. The IP address, port and URL of the uploaded target server is specified by the
PictureHttpUpload. Each set of images and events are sent within one separate HTTP request, in
which multiple of images and events are contained. It is uploaded through multipart.

http://<Address>:<Port>/<Uploadpath_of_PictureHttpUpload>
POST

Request URL
Method
Request Params ( multipart ; JSON in body; binary data in body )
Name
Channel
Time

R/O Description
Type
int
R
char[32] R

video channel, which start from 0

Snap picture time

Events
+Code
+Action

+Index
+Data

object[] R
char[32] R
char[16] R

int
object

R
R

Event Information list
Event Code
Event action, with the values of "Start",
"Stop" "Pulse".
Event channel number, starting from 0.
For specific parameters of each event,
please refer to the corresponding chapters
for reference.

Request Example
POST http://192.168.1.208/example/handlepic.php HTTP/1.1
User-Agent: Device/1.0
Content-Type: multipart/x-mixed-replace; boundary=<boundary>
Connection: closed

--<boundary>
Content-Type: application/json
Content-Length: <data length>

Example
0
"2022-03-30
15:40:01"

"FaceRecognition"
"Pulse”

0

General APIs 220

{

"Channel" : 0,
"TIme" : "2022-03-30 15:40:01"
"Events" : [ {

"Code" : "FaceRecognition",
"Action" : "Pulse",
"Index" : 0
"Data" : {

                "UTC" : 123456789,

        ……

}
}, …, { } ]

}
--<boundary>
Content-Type: image/jpeg
Content-Length: <data length>

<jpeg data>
--<boundary>
…
--<boundary>--

Response Params ( OK in body )
Response Example
OK

4.13.3 [Config] Active Event Uploading

Configure the device to upload event (without image) to the specified address. Before configuration,
the client should monitor in the specified IP address. Once the configuration is complete, the device
would upload event data to this address using the command described in chapter " 4.13.4 Active
Event Uploading ".

The parameters for uploading event are as follows:

Config Data Params
Name

Type

EventHttpUpload

object

+EventHttpUpload object
++Enable

bool

++Type

char[16]

+UploadServerList object[]

R/O Description
R

Parameters for uploading
event
Whether to enable the function
Whether to enable the function
Authentication Type
"basic":HTTP Basic Authentic
ation
"digest" :HTTP Digest Authen
tication
The server list that receives
uploaded information

R
R
O

R

Example

true
"digest”

General APIs 221

++Address

char[128]

++Port
++UserName
++Password
++Uploadpath

int
char[32]
char[128]
char[128]

R

O
O
O
O

IP address or domain name of
the server
Server port
Username
Password
Upload path

192.168.1.208

80
"abc”
123’’
"/example/handleevt.php”

Please refer to "4.2.1 Get and Set Configure" for configuration getting and setting. Specific
examples are as follows :

Get Config Request Example
http://192.168.1.108/cgi-bin/configManager.cgi?action=getConfig&name=EventHttpUpload

Get Config Response Example
table.EventHttpUpload.EventHttpUpload.Enable=true
table.EventHttpUpload.EventHttpUpload.Type=digest
table.EventHttpUpload.UploadServerList[0].Address=192.168.1.208
table.EventHttpUpload.UploadServerList[0].Port=80
table.EventHttpUpload.UploadServerList[0].UserName=abc
table.EventHttpUpload.UploadServerList[0].Password=123
table.EventHttpUpload.UploadServerList[0].Uploadpath=/example/handleevt.php

Set Config Request Example
http://192.168.1.108/cgi-bin/configManager.cgi?action=setConfig&EventHttpUpload.EventHttpUpload.E
nable=true&EventHttpUpload.EventHttpUpload.Type=digest&EventHttpUpload.UploadServerList[0].Add
ress=192.168.1.208&EventHttpUpload.UploadServerList[0].Port=80&EventHttpUpload.UploadServerLis
t[0].UserName=abc&EventHttpUpload.UploadServerList[0].Password=123&EventHttpUpload.UploadSe
rverList[0].Uploadpath=/example/handleevt.php

Set Config Response Example
OK

4.13.4 Active Event Uploading

Th device upload event data (without image) to the specified address based on the configuration of
the client. For the specific parameter of each event, please refer to the corresponding [Event]
chapters. The IP address, port and URL of the upload target server is specified by EventHttpUpload.
Each event is sent within one separate HTTP request.

http://<Address>:<Port>/<Uploadpath_of_EventHttpUpload>
POST

Request URL
Method
Request Params ( JSON in body )
Name
Code
Action

Type
char[32] R
char[16] R

Index
Data

int
object

Request Example

R/O Description
Event code
"Event action, with the values of "Start",
"Stop""Pulse".
Event channel number, starting from 0
For the specific parameters for each event,
please refer to the corresponding chapters.

R
R

Example
"FaceRecognition”
"Pulse”

0

General APIs 222

Request Example
User-Agent: Device/1.0
Content-Type: application/json
Content-Length: <data length>

{

}

"Code" : "FaceRecognition",
"Action" : "Pulse",
"Index" : 0
Data
"UTC" : 123456789,
...
}

Response Params ( OK in body )
Response Example
OK

4.13.5 [Config] Active Report Data Uploading

Configure the device to upload report data to the specified address. Before configuration, the client
should monitor in the specified IP address. Once the configuration is complete, the device would
upload report data to this address using the command described in chapters 4.13.6 ~ 4.13.11.

The parameters for uploading image are as follows:

Config Data Params
Type
Name
ReportHttpUpload
object
+ReportHttpUpload object
++Enable

bool

++Type

char[16]

++Period

int

+UploadServerList

object[]

++Address

char[128]

O
R

R

++Port
++UserName
++Password
++Uploadpath

++ReportType

O
int
char[32]
O
char[128] O
char[128] O
O

char [ ][40]

R/O Description
R
R
R
O

parameters for uploading event
Whether to enable the function
Whether to enable the function
Authentication Type
"basic" :HTTP basic
authentication
"digest" :HTTP digest
authentication
Upload period (unit: hour)
The server list that receives
uploaded information
IP address or domain name of
the server
Server port
Username
Password
Upload path
For the uploaded report data list,
specific report data name,

Example

true
"digest”

1

192.168.1.208

80
"abc”
123’’
"/example/handleevt.php”
["NumberStat","ObjectDet
ect"]

General APIs 223

please refer to the
corresponding command
reporting chapter description.

Please refer to "4.2.1 Get and Set Configure" for configuration getting and setting. Specific
examples are as follows :

Get Config Request Example
http://192.168.1.108/cgi-bin/configManager.cgi?action=getConfig&name=EventHttpUpload

Get Config Response Example
table.ReportHttpUpload.ReportHttpUpload.Enable=true
table.ReportHttpUpload.ReportHttpUpload.Type=digest
table.ReportHttpUpload.ReportHttpUpload.Period=1
table.ReportHttpUpload.UploadServerList[0].Address=192.168.1.208
table.ReportHttpUpload.UploadServerList[0].Port=80
table.ReportHttpUpload.UploadServerList[0].UserName=abc
table.ReportHttpUpload.UploadServerList[0].Password=123
table.ReportHttpUpload.UploadServerList[0].Uploadpath=/example/handlerpt.php
table.ReportHttpUpload.UploadServerList[0].ReportType[0]=NumberStat
table.ReportHttpUpload.UploadServerList[0].ReportType[1]=ObjectDetect

Set Config Request Example
http://192.168.1.108/cgi-bin/configManager.cgi?action=setConfig&ReportHttpUpload.ReportHttpUpload.
Enable=true&ReportHttpUpload.ReportHttpUpload.Type=digest&ReportHttpUpload.ReportHttpUpload.
Period=1&ReportHttpUpload.UploadServerList[0].Address=192.168.1.208&ReportHttpUpload.UploadS
erverList[0].Port=80&ReportHttpUpload.UploadServerList[0].UserName=abc&ReportHttpUpload.Upload
ServerList[0].Password=123&ReportHttpUpload.UploadServerList[0].Uploadpath=/example/handlerpt.p
hp&ReportHttpUpload.UploadServerList[0].ReportType[0]=NumberStat&ReportHttpUpload.UploadServ
erList[0].ReportType[1]=ObjectDetect

Set Config Response Example
OK

4.13.6 People Counting Report Data Uploading

If the client subscribes to the Numberstat (Number Statistics) report data through the
ReportHttpUpload configuration, the device will use this command to upload the data to the
specified address. The IP address, port and URL of the target server is specified by
ReportHttpUpload. Each people counting report data is sent within one separate HTTP request.

http://<Address>:<Port>/<Uploadpath_of_ReportHttpUpload>
POST

Request URL
Method
Request Params ( JSON in body )
Type
Name
Object[] R
NumberStat
+SN
char[32] R
+PeopleCount Object[] O

R/O Description

NumberStat: each dimension is a channel.
Device serial number
Humber statistics, the number of arrays is
that of the cycles. If the period is an hour,
then the number of array is one. If the

Example

"1C03E08YAZ00020”

General APIs 224

period is three hours, then the number of
array is three.

++StartTime

char[20] O

Start time

EndTime:

char[20] O

End time

++EnteredSubt
otal
++ExitedSubtot
al
++AreaID

++Channel
+ManNumDete
ction

uint

uint

O

O

O

uint16
port
int
O
Object[] O

++StartTime

char[20] O

Subtotal of entered flow

Subtotal of exit flow

Area ID.

Channel No.
Statistics of the number of the people in the
region. The number of arrays equals to that
of the period. If the time of period is an
hour, then the number of array is one. If the
time of the period is three hours, then the
number of array is three.
Start time

EndTime:

char[20] O

End time

++InsideSubtot
al

uint

O

++AreaID

++AverageStay
Time
++Channel
+QueueDetecti
on

uint16
port
uint

O

O

O
int
Object[] O

++StartTime

char[20] O

Used with
ManNumDetection,QueueDetection, the
subtotal of number of people in the region
Area ID.

Average regional retention time

Channel No.
Queuing Management Data. The number
of arrays equals to that of the period. If the
time of period is an hour, then the number
of array is one. If the time of the period is
three hours, then the number of array is
three.
Start time

++EndTime

char[20] O

Statistics end time

++InsideSubtot
al

uint

O

++AreaID
++AverageStay
Time

uint16
uint

O
O

Subtotal people
the area when
in
ManNumDetection and QueueDetection
are used
Area ID
Average stranding time in area

"2012-03-14
00:00:00"
"2012-03-14
23:59:59"
56

56

1

0

"2012-03-14
00:00:00"
"2012-03-14
23:59:59"
56

1

10

0

"2012-03-14
00:00:00"
"2012-03-14
23:59:59"
56

1
10

General APIs 225

++Channel

int

O

Channel No.

0

Request Example
POST http://192.168.1.208:80/example/handlerpt.php HTTP/1.1
User-Agent: Device/1.0
Content-Type: application/json
Content-Length: <data length>

{
"NumberStat" : [ {
"SN" : "6M053FDYAQ00003"
"ManNumDetection" : [ {
"Channel" : 0,
"EndTime" : "2021-03-11 17:59:59",
"EnteredSubtotal" : 0,
"ExitedSubtotal" : 0,
"StartTime" : "2021-03-11 17:00:00"
}, {
"Channel" : 0,
"EndTime" : "2021-03-11 6:59:59 PM",
"EnteredSubtotal" : 0,
"ExitedSubtotal" : 0,
"StartTime" : "2021-03-11 6:00:00 PM"
}, …, { } ],
"PeopleCount" : [ {
"Channel" : 0,
"EndTime" : "2021-03-11 5:59:59 PM",
"EnteredSubtotal" : 0,
"ExitedSubtotal" : 0,
"StartTime" : "2021-03-11 5:00:00 PM"
}, {
"Channel" : 0,
"EndTime" : "2021-03-11 6:59:59 PM",
"EnteredSubtotal" : 0,
"ExitedSubtotal" : 0,
"StartTime" : "2021-03-11 6:00:00 PM"
}, …, { } ],
"QueueDetection" : [ {
"Channel" : 0,
"EndTime" : "2021-03-11 5:59:59 PM",
"EnteredSubtotal" : 0,
"ExitedSubtotal" : 0,
"StartTime" : "2021-03-11 5:00:00 PM"
}, {
"Channel" : 0,
"EndTime" : "2021-03-11 6:59:59 PM",
"EnteredSubtotal" : 0,
"ExitedSubtotal" : 0,

General APIs 226

"StartTime" : "2021-03-11 6:00:00 PM"
}, …, { } ]
}
}

Response Params ( OK in body )
Response Example
OK

4.13.7 Video Structuring Report Data Upload

When the client subscribes ObjectDetect (video Structuring) dashboard, the device will upload video
structuring dashboard to the specified address. The target service address and port, URL are
designated by ReportHttpUpload. Each video structuring report data is sent within one separate
HTTP request.

http://<Address>:<Port>/<Uploadpath_of_ReportHttpUpload>
POST

Request URL
Method
Request Params ( JSON in body )
Name
ObjectDetect

Type
Object[]
[]

R/O Description
R

SN
+UTC

char[32] R
O
uint

+UTCMS
+Period
+PeriodBySec
onds
+MotoVehicles

+Vehicles

uint
int
int

int

int

O
O
O

O

O

Video structured data, the first dimension is
channel, the second dimension is cycle
count, the cycle is an hour, the array is 1,
the cycle is 3 hours and the array is 3.
Device SN
The end time of statistical Cycle (local UTC
time)
Milliseconds
Statistical cycle (unit: minute)
Statistical cycle (unit: second)

Traffic volume of motorized vehicle such as
motorbike and tricycles
Total count of motorized and non-motorized
vehicle
Statistical data on the traffic volume based
on vehicle type
Pedestrian traffic flow

O

O

int

object

+VehicleTypeFl
ow
++PasserbyVe
hicles
Request Example
POST http://192.168.1.208:80/example/handlerpt.php HTTP/1.1
User-Agent: Device/1.0
Content-Type: application/json
Content-Length: <data length>

{
"ObjectDetect" : [ [ {

Example

"1C03E08YAZ00020"
1608508800

0
60
60

45

0

0

General APIs 227

"MotoVehicles" : 8,
"Period" : 60,
"PeriodBySeconds" : 0,
"SN" : "6J0CB81YAG10101",
"UTC" : 1615492800,
"UTCMS" : 0,
"VehicleTypeFlow" : {
"PasserbyVehicles" : 6
},
"Vehicles" : 17
}, …, { } ], …, [ ] ]
}

Response Params ( OK in body )
Response Example
OK

4.13.8 People Flow Heat Map Report Data Upload

When the client subscribes HeatMap (customer flow heat map report data, the device will upload
video structuring data to the specified address. The target service address and port, URL are
designated by ReportHttpUpload. Each people flow heat map report data is sent within one separate
HTTP request.

http://<Address>:<Port>/<Uploadpath_of_ReportHttpUpload>
POST

Request URL
Method
Request Params ( JSON in body )
Name
HeatMap

Type
Object[] R

R/O Description

+Channel
+SN
+StartTime

int
O
char[32] R
char[20] O

Heatmap is presneted in binary format.
Each dimension is a channel.
Channel
Device SN
Statistics start Time

+EndTime

char[20] O

Statistics end time

+width
+height
+EncodeData

uint
uint
string

O
O
O

Image width
Image height
base64 encoding of Heat map data

Request Example
POST http://192.168.1.208:80/example/handlerpt.php HTTP/1.1
User-Agent: Device/1.0
Content-Type: application/json
Content-Length: <data length>

{

"HeatMap" : [ {

Example

0
"1C03E08YAZ00020"
"2012-03-14
00:00:00"
"2012-03-14
23:59:59"
200
100
"abcd="

General APIs 228

"Channel" : 0,
"SN" : "66:66:66:56:78:9a",
"StartTime" : "2021-03-12 14:00:00",
"EndTime" : "2021-03-12 15:00:00",
"height" : 64,
"width" : 64
"EncodeData" : "abcd=",
}, …, {} ]
}

Response Params ( OK in body )
Response Example
OK

4.13.9 ANPR Report Data Upload

When the client subscribes RoadFlowStat (road monitoring) report data, the device will upload video
structuring datato the specified address. The target service address and port, URL are designated
by ReportHttpUpload. Each ANPR report data is sent within one separate HTTP request.

http://<Address>:<Port>/<Uploadpath_of_ReportHttpUpload>
POST

Request URL
Method
Request Params ( JSON in body )
Name
RoadFlowStat Object[]

Type

R/O Description
R

[]

char[32] O
O
uint
O
uint
O
int
O
int
O
int
O
int

int

int

O

O

object

O

int

O

SN
+UTC
+UTCMS
+Lane
+PresetID
+Period
+PeriodBySec
onds
+MotoVehicles

+Vehicles

+VehicleTypeFl
ow
++PasserbyVe
hicles

Road monitoring data, the first dimension is
channel, the second dimension is cycle
count. The cycle is an hour and the array is

1. The cycle is 3 hours and the array is 3.
   Device SN
   End time of statistical cycle
   Milliseconds
   User defined lane number
   PTZ preset, which must greater than 0.
   Statistical cycle (unit: minute)
   Statistical cycle (unit: second)

Example

"1C03E08YAZ00020"
1608508800
0
1
1
60
60

Traffic flow of non-motorized vehicles such
as motorbike and tricycles.
Total count of motorized and non-motorized
vehicle
Statistical data on the traffic volume based
on vehicle type
Pedestrian traffic flow

45

0

0

Request Example
POST http://192.168.1.208:80/example/handlerpt.php HTTP/1.1
User-Agent: Device/1.0

General APIs 229

Content-Type: application/json
Content-Length: <data length>

{
"RoadFlowStat" : [ [ {
"SN" : "6J0CB81YAG10101",
"UTC" : 1615485600,
"UTCMS" : 0,
"Lane" : 1,
"PresetID" : 0,
"Period" : 60,
"PeriodBySeconds" : 0,
"MotoVehicles" : 0,
"Vehicles" : 26506
"VehicleTypeFlow" : {
"PasserbyVehicles" : 0
},
}, …, { } ], … , [ ] ]
}

Response Params ( OK in body )
Response Example
OK

4.13.10 Crowd Distribution Report Data upload

When the client subscribes CrowdDistriMap (Crowd Distribution) report data, the device will upload
video structuring data to the specified address. The target service address and port, URL are
designated by ReportHttpUpload. Each crowd distribution report data is sent within one separate
HTTP request.

http://<Address>:<Port>/<Uploadpath_of_ReportHttpUpload>
POST

Request URL
Method
Request Params ( JSON in body )
Name
CrowdDistriMap

Type
Object[]

R/O Description
R

SN
+CrowdDistriMap

char[32] O
O
object

++DataList

object[64] O

+++UTC

uint32

O

+++AreaName
+++PeopleNum

char[32] O
O
int

Example

Data statistics on crowd distribution.
Each dimension is the data of a
channel.
Device SN
Report Data on Crowd Distribution
Map
Return Crowd Distribution Map data
list. The array size is 64 at most.
UTC time (local UTC time) when the
data is recorded
Statistics Area name
The number of people in statistics area 60

1

6555478

"CMD-5"

"1C03E08YAZ00020"

General APIs 230

Request Example
POST http://192.168.1.208:80/example/handlerpt.php HTTP/1.1
User-Agent: Device/1.0
Content-Type: application/json
Content-Length: <data length>

{
"CrowdDistriMap" : [ {
"CrowdDistriMap" : {
"DataList" : [ {
"AreaName" : "CDM-1",
"PeopleNum" : 0,
"UTC" : 1617375600
}, {
"AreaName" : "CDM-1",
"PeopleNum" : 0,
"UTC" : 1617379200
} ]
},
"SN" : "7B0606BYAQ00010"
}, … , { } ]
}

Response Params ( OK in body )
Response Example
OK

4.13.11 Vehicle Density Report Data Upload

When the client subscribes VehiclesDistri vehicle density) report data, the device will upload video
structuring data to the specified address. The target service address and port, URL are designated
by ReportHttpUpload. Each vehicle density report data is sent within one separate HTTP request.

http://<Address>:<Port>/<Uploadpath_of_ReportHttpUpload>
POST

Request URL
Method
Request Params ( JSON in body )
Name
VehiclesDistri

Type
Object[]

R/O Description
R

+SN
+CongestionDetec
tion
++DataNum

char[32] O
O
object

uint32

O

++DataList

object[]

O

Data statistics on vehicle density
distribution. Each dimension is the data
of a channel.
Device SN
The data report of vehicle density
congestion rules.
Number of returned entires on vehicle
congestion rules.
The data list of vehicle congestion
rules. The array size equal to DataNum

Example

"1C03E08YAZ00020"
0

60

General APIs 231

+++UTC

uint32

O

+++RuleName
+++VehiclesNum
+VehicleLimitDete
ction
++DataNum

char[32] O
O
int
O
object

uint32

O

++DataList

object[]

O

+++UTC
+++RuleName
+++VehiclesNum

O
uint32
char[32] O
O
int

and the element is 64 at most.
UTC time (local UTC time) when the
data is recorded
Rule name
The number of vehicles
The report data of traffic flow limit
detection rules
Returned data entries on the traffic flow
limit rules
The data
detection rules. 64 elements at most.
UTC time when the data is recorded
Rule name
The number of vehicles

list of

traffic

flow

limit

Request Example
POST http://192.168.1.208:80/example/handlerpt.php HTTP/1.1
User-Agent: Device/1.0
Content-Type: application/json
Content-Length: <data length>

{
"VehiclesDistri" : [ {
"CongestionDetection" : {
"DataList" : [ {
"RuleName" : "VD-1",
"UTC" : 1617375600,
"VehiclesNum" : 0
}, {
"RuleName" : "VD-1",
"UTC" : 1617379200,
"VehiclesNum" : 0
} ],
"DataNum" : 2
},
"SN" : "7B0606BYAQ00010",
"VehicleLimitDetection" : {
"DataNum" : 0
}
}, … , { } ]
}

Response Params ( OK in body )
Response Example
OK

3665789

"VD-1"
32
0

1

3665789

40

General APIs 232

4.13.12 FaceAnalysis Report Data Upload

When the client subscribes FaceAnalysis report data, the device will upload video structuring data to
the specified address. The target service address and port, URL are designated by ReportHttpUpload.
Each vehicle density report data is sent within one separate HTTP request.

Request URL

http://<Address>:<Port>/<Uploadpath_of_ReportHttpUpload>

Method

POST

Request Params ( JSON in body )

Name

Type

R/O

Description

Example

FaceAnalysis

Object[]

R

statistics

on
Data
Each
FaceAnalysis.
dimension is the data of
a channel.

+SN

+Channel

+Info

char[32]

uint

Object[]

R

O

Device SN

Channel

"8J0751AYAQ00004"

0

++StartTime

++EndTime

systemtim
e

systemtim
e

++RepeatCount

uint32

++FaceDetectCount

uint32

O

O

O

O

++FaceAnalysisCoun
t

uint32

O

Request Example

statistics

on
Data
FaceAnalysis.
The
number of arrays is the
number of cycles. The
cycle is one hour, the
number of arrays is 1.
The cycle is 3 hours,
and
the number of
arrays is 3.

StartTime

EndTime

Repeat Count

of

Statistics
detection
duplicate removal

face
times after

of

Statistics
analysis
duplicate removal

face
times after

"2022-12-21
11:00:00"

"2022-12-21
11:59:59"

0

102

92

General APIs 233

POST http://192.168.1.208:80/example/handlerpt.php HTTP/1.1
User-Agent: Device/1.0
Content-Type: application/json
Content-Length: <data length>

{
"FaceAnalysis" : [

{

                "Channel" : 0,
                "SN" : "8J0751AYAQ00004",
                “Info” : [{
                        "EndTime" : "2022-12-21 11:59:59",
                        "FaceAnalysisCount" : 92,
                        "FaceDetectCount" : 109,
                        "RepeatCount" : 0,
                        "StartTime" : "2022-12-21 11:00:00"

}, …,{ }]

}]

}

Response Params ( OK in body )

Response Example

OK

General APIs 234

5 Camera APIs

5.1 Image

5.1.1 [Config] Brightness, Contrast and Saturation

 Get brightness, contrast and saturation

Syntax

Method

http://<server>/cgi-bin/configManager.cgi?action=getConfig&name=VideoColor

GET

Description

Get brightness, contrast and saturation

Example

Success
Return

Comment

http://192.168.1.108/cgi-bin/configManager.cgi?action=getConfig&name=VideoColor

head.Name=Day,
head.Brightness=50,
head.Contrast=50,
head.Saturation=50,
head.Hue=50,
head.Gamma=50,
head.ChromaSuppress=50,
head.Style=Standard,
head.TimeSection=1 00:00:00-24:00:00

Parameters in URL:
paramName and paramValue are as table below.
In table below,
head = table.VideoInSharpness [ChannelNo] [ConfigNo]
ChannelNo: integer, array index starts from 0, which means video channel (equals to
video channel index -1, and so 0 means channel 1).
ConfigNo: array index, can be 0, 1 or 2. 0 means config for day, 1 means config for
night, and 2 means config for normal scene.

 Set brightness, contrast and saturation

Syntax

http://<server>/cgi-bin/configManager.cgi?action=setConfig&<paramName>=<paramV
alue>[&<paramName>=<paramValue>…]

Method

SET

Description

Set brightness, contrast and saturation

Example

Success
Return

Comment

http://192.168.1.108/cgi-bin/configManager.cgi?action=setConfig&VideoColor[0][0].Brig
htness=50

OK

Parameters in URL:
paramName and paramValue are as table below.
In table below,
head = table.VideoInSharpness [ChannelNo] [ConfigNo]

Camera APIs 235

ChannelNo: integer, array index starts from 0, which means video channel (equals to
video channel index -1, and so 0 means channel 1).
ConfigNo: array index, can be 0, 1 or 2. 0 means config for day, 1 means config for
night, and 2 means config for normal scene.

Appendix:

ParamName

ParamValue type Description

head.Brightness

head.Contrast

head.Saturation

integer

integer

integer

Brightness, range is [0—100]
Contrast, range is [0—100]
Saturation, range is [0—100]

5.1.2 [Config] Sharpness

 Get sharpness

Table 5-1

Syntax

Method

http://<server>/cgi-bin/configManager.cgi?action=getConfig&name=VideoInSharpness

GET

Description

Get sharpness

Example

Success
Return

Comment

http://192.168.1.108/cgi-bin/configManager.cgi?action=getConfig&name=VideoInSharp
ness

head.Level=4
head.Sharpness=8

Parameters in URL:
paramName and paramValue are as table below.
In table below,
head = table.VideoInSharpness [ChannelNo] [ConfigNo]
ChannelNo: integer, array index starts from 0, which means video channel (equals to
video channel index -1, and so 0 means channel 1).
ConfigNo: array index, can be 0, 1 or 2. 0 means config for day, 1 means config for
night, and 2 means config for normal scene.

 Set sharpness

Table 5-2

Syntax

http://<server>/cgi-bin/configManager.cgi?action=setConfig&<paramName>=<paramV
alue>[&<paramName>=<paramValue>…]

Method

SET

Description

Set sharpness

Example

Success
Return

Comment

http://192.168.1.108/cgi-bin/configManager.cgi?action=setConfig&VideoInSharpness[0]
[0].Level=10&VideoInSharpness[0][0].Mode=1&VideoInSharpness[0][0].Sharpness=0

OK

Parameters in URL:
paramName and paramValue are as table below.
In table below,

Camera APIs 236

head = VideoInSharpness [ChannelNo] [ConfigNo]
ChannelNo: integer, array index starts from 0, which means video channel (equals to
video channel index -1, and so 0 means channel 1).
ConfigNo: array index, can be 0, 1 or 2. 0 means config for day, 1 means config for
night, and 2 means config for normal scene.

Appendix:

ParamName

head.Sharpness

head.Level

ParamValue type

integer

integer

Description
Range is 0—100
Range is 0—100

5.1.3 [Config] Flip, Mirror and Rotate90

 Get flip, mirror and Rotate90

Table 5-3

Syntax

Method

http://<server>/cgi-bin/configManager.cgi?action=getConfig&name=VideoImageControl

GET

Description

Get flip, mirror and Rotate90

Example

Success
Return

Comment

http://192.168.1.108/cgi-bin/configManager.cgi?action=getConfig&name=VideoImageC
ontrol

head.Flip=true
head.Mirror=false
head.Rotate90=0

Parameters in Response:
head = table.VideoImageControl [ChannelNo]
ChannelNo: integer, array index starts from 0, which means video channel (equals to
video channel index -1, and so 0 means channel 1).
ConfigNo: array index, can be 0, 1 or 2. 0 means config for day, 1 means config for
night, and 2 means config for normal scene.

 Set flip, mirror and Rotate90

Table 5-4

Syntax

http://<server>/cgi-bin/configManager.cgi?action=setConfig&<paramName>=<paramV
alue>[&<paramName>=<paramValue>…]

Method

SET

Description

Set flip, mirror and Rotate90

Example

Success
Return

Comment

http://192.168.1.108/cgi-bin/configManager.cgi?action=setConfig&VideoImageControl[
0].Flip=true

OK

Parameters in URL:
head = VideoImageControl [ChannelNo]
ChannelNo: integer, array index starts from 0, which means video channel (equals to
video channel index -1, and so 0 means channel 1).

Camera APIs 237

ConfigNo: array index, can be 0, 1 or 2. 0 means config for day, 1 means config for
night, and 2 means config for normal scene.

ParamValue type

Description

true: enable video flip function
false: disable video flip function

true: enable video mirror function
false: disable video mirror function

Range is {0,1,2}
Video rotation:
0: No rotate
1: clockwise rotate 90°
2: anticlockwise rotate 90°

Appendix:

ParamName

head.Flip

head.Mirror

bool

bool

head.Rotate90

integer

5.2 Exposure

5.2.1 [Config] Exposure Config

 Get exposure

Table 5-5

Syntax

Method

http://<server>/cgi-bin/configManager.cgi?action=getConfig&name=VideoInExposure

GET

Description

Get exposure

Example

http://192.168.1.108/cgi-bin/configManager.cgi?action=getConfig&name=VideoInExpos
ure

Success
Return

Comment

head.AntiFlicker=0
head.Gain=50
head.GainMax=50
head.GainMin=0
head.Iris=50
head.IrisAuto=false
head.Mode=0
head.Value1=40
head.Value2=40

Parameters in Response:
head = table.VideoInExposure[ChannelNo][ConfigNo]
ChannelNo: integer, array index starts from 0, which means video channel (equals to
video channel index -1, and so 0 means channel 1).
ConfigNo: array index, can be 0, 1 or 2. 0 means config for day, 1 means config for
night, and 2 means config for normal scene.

 Set exposure

Camera APIs 238

Syntax

http://<server>/cgi-bin/configManager.cgi?action=setConfig&<paramName>=<paramV
alue>[&<paramName>=<paramValue>…]

Table 5-6

Method

SET

Description

Set exposure

Example

Success
Return

Comment

Appendix:

ParamName

http://192.168.1.108/cgi-bin/configManager.cgi?action=setConfig&VideoInExposure[0][
0].Iris=50

OK

Parameters in URL:
head = VideoInExposure[ChannelNo][ConfigNo]
ChannelNo: integer, array index starts from 0, which means video channel (equals to
video channel index -1, and so 0 means channel 1).
ConfigNo: array index, can be 0, 1 or 2. 0 means config for day, 1 means config for
night, and 2 means config for normal scene.

ParamValue type

Description

head.AntiFlicker

integer

head.Gain

head.GainMax

head.GainMin

head.Iris

integer

integer

integer

integer

head.IrisAuto

bool

head.Mode

integer

Range is {0,1,2}
AntiFlicker mode:
0: Outdoor
1: 50 Hz AntiFlicker
2: 60 Hz AntiFlicker
Range is [0—100]
If GainAuto is true, it's upper limit of auto gain,
else it's the fixed gain adjust value.

Range is 0–100; the value must be greater than
GainMin.

Range is 0–100; the value must be smaller than
GainMax.

Manual Iris setting. Range is 0–100.

Enable Iris automatically.
true: IrisAuto

false: No IrisAuto

0: "Auto" by default
1: Low noise
2: Anti-smear
4: Manual (range)
5: Aperture priority
6: Manual (fixed)
7: Gain priority
8: Shutter priority
9: Flash light matching mode

head.Value1

float

Range is [0-1000], unit is millisecond
If ExposureSpeed is 0(AutoExposure enable), it's

Camera APIs 239

ParamName

ParamValue type

Description

lower limit of AutoExposure time, otherwise it's
time of manualExposure

Range is [0-1000], unit is millisecond
Upper limit of AutoExposure time, should be
bigger than ExposureValue1

head.Value2

float

5.3 Backlight

5.3.1 [Config] Backlight Config

 Get backlight

Table 5-7

Syntax

Method

http://<server>/cgi-bin/configManager.cgi?action=getConfig&name=VideoInBacklight

GET

Description

Get backlight

Example

Success
Return

Comment

http://192.168.1.108/cgi-bin/configManager.cgi?action=getConfig&name=VideoInBackli
ght

head.GlareInhibition=50
head.Mode=Off
head.WideDynamicRange=50

Parameters in Response:
head = table.VideoInBacklight[ChannelNo][ConfigNo]
ChannelNo: integer, array index starts from 0, which means video channel (equals to
video channel index -1, and so 0 means channel 1).
ConfigNo: array index, can be 0, 1 or 2. 0 means config for day, 1 means config for
night, and 2 means config for normal scene.

 Set backlight

Table 5-8

Syntax

http://<server>/cgi-bin/configManager.cgi?action=setConfig&<paramName>=<paramV
alue>[&<paramName>=<paramValue>…]

Method

SET

Description

Set backlight

Example

Success
Return

Comment

http://192.168.1.108/cgi-bin/configManager.cgi?action=setConfig&VideoInBacklight[0][
0].GlareInhibition=50

OK

Parameters in URL:
head = VideoInBacklight[ChannelNo][ConfigNo]
ChannelNo: integer, array index starts from 0, which means video channel (equals to
video channel index -1, and so 0 means channel 1).
ConfigNo: array index, can be 0, 1 or 2. 0 means config for day, 1 means config for
night, and 2 means config for normal scene.

Camera APIs 240

Appendix:

ParamName

ParamValue type

Description

head.GlareInhibition

integer

head.Mode

char[32]

Range is 1–100.
Off: Switched off
Backlight: Backlight compensation
GlareInhibition: HLC
WideDynamic: WDR
SSA: Scene adaptation

head.WideDynamicRange

integer

Range is 1–100.

5.4 White Balance

5.4.1 [Config] White Balance Config

 Get white balance

Table 5-9

Syntax

http://<server>/cgi-bin/configManager.cgi?action=getConfig&name=VideoInWhiteBalan
ce

Method

GET

Description

Get white balance

Example

Success
Return

Comment

http://192.168.1.108/cgi-bin/configManager.cgi?action=getConfig&name=VideoInWhite
Balance

head.GainBlue=50
head.GainRed=50
head.Mode=Auto

Parameters in Response:
head = table.VideoInWhiteBalance[ChannelNo][ColorConfigNo]
ChannelNo: integer, array index starts from 0, which means video channel (equals to
video channel index -1, and so 0 means channel 1).
ConfigNo: array index, can be 0, 1 or 2. 0 means config for day, 1 means config for
night, and 2 means config for normal scene.

 Set white balance

Table 5-10

Syntax

http://<server>/cgi-bin/configManager.cgi?action=setConfig&<paramName>=<paramV
alue>[&<paramName>=<paramValue>…]

Method

SET

Description

Set white balance

Example

Success
Return

http://192.168.1.108/cgi-bin/configManager.cgi?action=setConfig&VideoInWhiteBalanc
e[0][0].GainBlue=50

OK

Comment

Parameters in URL:

Camera APIs 241

head = VideoInWhiteBalance[ChannelNo][ConfigNo]
ChannelNo: integer, array index starts from 0, which means video channel (equals to
video channel index -1, and so 0 means channel 1).
ConfigNo: array index, can be 0, 1 or 2. 0 means config for day, 1 means config for
night, and 2 means config for normal scene.

Appendix:

ParamName

ParamValue type

head.GainBlue

integer

head.GainRed

integer

head.Mode

char[][32]

5.5 Day-Night

5.5.1 [Config] Day-Night Config

 Get day-night

Description
Range is [0—100]
Gain for blue value, Value is effective when
WhiteBalance is "Custom."
Range is [0—100]
Gain for red value, Value is effective when
WhiteBalance is "Custom."

Auto; Indoor; Outdoor; ATW; Manual; Sodium;
Natural; StreetLamp; ManualDatum

Table 5-11

Syntax

Method

http://<server>/cgi-bin/configManager.cgi?action=getConfig&name=VideoInDayNight

GET

Description Get day-night

Example

http://192.168.1.108/cgi-bin/configManager.cgi?action=getConfig&name=VideoInDayNight

Success
Return

head.Delay=10
head.Mode=Brightness
head.Sensitivity=2
head.Type=Mechanism

Comment

head = table.VideoInDayNight[ChannelNo][ConfigNo]:
ChannelNo: integer, array index starts from 0, which means video channel (equals to
video channel index -1, and so 0 means channel 1).
ConfigNo: array index, can be 0, 1 or 2. 0 means config for day, 1 means config for night,
and 2 means config for normal scene.

 Set Day-Night

Syntax

http://<server>/cgi-bin/configManager.cgi?action=setConfig&<paramName>=<paramV
alue>[&<paramName>=<paramValue>…]

Table 5-12

Method

SET

Description

Set day-night

Camera APIs 242

http://192.168.1.108/cgi-bin/configManager.cgi?action=setConfig&VideoInDayNight[0][
0].Mode=BlackWhite

OK

Parameters in URL:
ParamName and paramValue are as table below. In table below,
head = VideoInDayNight[ChannelNo][ConfigNo]

Example

Success
Return

Comment

Appendix:

ParamName

ParamValue type

Description

head.Type

string

head.Mode

string

The range
"Auto" }, the way of ICR switching.

is {"Electron", "Mechanism", "NightICR",

is {"Color", "Brightness", "BlackWhite,

The range
"Photoresistor", "Gain"}.
"Color": Always "color"
"Brightness": Day/Night Auto
"BlackWhite": Always black-and-white
"Photoresistor": Switch according to photoresistor，
"Gain": Switch according to gain

head.Sensitivity

integer

Range is [1-3]. Sensitivity of switching mode

head.Delay

integer

Range is [2-10].
Delay seconds when switching mode.

5.6 Zoom and Focus

To get the capability set of video input, refer to 4.5.12. For instance, you can use the following URL:

http://192.168.1.108/cgi-bin/devVideoInput.cgi?action=getCaps&channel=1

If ElectricFocus or SyncFocus of the return value is true, use 5.6.1 ~ 5.6.4; Otherwise, use 5.6.5 ~
5.6.6 .

5.6.1 Adjust Focus

Adjust magnification and focus.

http://<server>/cgi-bin/devVideoInput.cgi?action=adjustFocus
GET

Request URL
Method
Request Params ( key=value format in URL )
Name
channel

R/O Description
O

Type
int

focus

double O

zoom

double O

Request Example

The video channel number which starts
from 1, and the default value is 1.
Relative stepping position of the vari-focal
motor; range: [0–1].
-1 means resetting.
Relative stepping position of the zoom
motor; range: [0–1].
-1 means resetting.

Example
1

0.5

-0.5

Camera APIs 243

http://192.168.1.108/cgi-bin/devVideoInput.cgi?action=adjustFocus&focus=0.5&zoom=-0.5

Response Params ( OK in body )
Response Example
OK

5.6.2 Adjust Focus Continuously

Continuously adjust magnification and focus. Firstly, send a "non-zero" value to start zooming and
adjusting the focal length to drive the motor to move, and then send “0” to stop the motor from
moving. If only one of the operations is required, set the value of the other operation as -1.

http://<server>/cgi-bin/devVideoInput.cgi?action=adjustFocusContinuously
GET

Request URL
Method
Request Params ( key=value format in URL )
Name
channel

R/O Description
O

Type
int

focus

double O

zoom

double O

The video channel number which starts
from 1, and the default value is 1.
Relative focusing rate; range: [-1,1].
-1: No operation
0: Stop
Positive number: Moving forward
Negative number: Moving backward
Relative zooming rate; range: [-1,1].
-1: No operation
0: Stop

Example
1

0.02

-1

Request Example
http://192.168.1.108/cgi-bin/devVideoInput.cgi?action=adjustFocusContinuously&channel=1&focus=0.0
2&zoom=-1

Response Params ( OK in body )
Response Example
OK

5.6.3 Auto Focus

Auto focus.

http://<server>/cgi-bin/devVideoInput.cgi?action=autoFocus
GET

Request URL
Method
Request Params ( key=value format in URL )
Name
channel

R/O Description
O

Type
int

The video channel number which starts
from 1, and the default value is 1.

Request Example
http://192.168.1.108/cgi-bin/devVideoInput.cgi?action=autoFocus&channel=1

Example
1

Camera APIs 244

Response Params ( OK in body )
Response Example
OK

5.6.4 Get Focus Status

Get the focusing status.

http://<server>/cgi-bin/devVideoInput.cgi?action=getFocusStatus
GET

Request URL
Method
Request Params ( key=value format in URL )
Name
channel

R/O Description
O

Type
int

The video channel number which starts
from 1, and the default value is 1.

Example
1

Request Example
http://192.168.1.108/cgi-bin/devVideoInput.cgi?action=getFocusStatus&channel=1

Response Params ( key=value format in body )
Type
Name
object
status

R/O Description
R

+Focus

double R

+Zoom

double R

+Status

char[16] R

Response Example
status.Focus=0.8
status.Zoom=0.3
status.Status=Normal

Return the status information
Relative stepping position of the focusing motor;
range: [0,1]
Relative stepping position of the zooming motor;
range: [0,1]
Focusing status
"Normal": Normal
"Autofocus": Auto focusing

Example

0.8

0.3

"Normal"

5.6.5 [Config] Zoom Config

Zooming configuration parameter:

Config Data Params
Name
VideoInZoom

Type
object[][] R

R/O Description

parameter;

configuration

Zooming
two-dimensional array.
The first dimension represents the video
channel which starts from 1, and the
second dimension represents the lighting
scene. The beginning three elements
constantly represent day, night and
general scene.
Scene name
Zooming speed; range: [0–100]

Example

"Day"
8

Camera APIs 245

+Name
+Speed

char[16] O
O
int

+DigitalZoom

bool

O

Whether to enable digital zoom

true

Please refer to "4.2.1 Get and Set Configure" for configuration getting and setting. Specific
examples are as follows :

Get Config Request Example
http://192.168.1.108/cgi-bin/configManager.cgi?action=getConfig&name=VideoInZoom

Get Config Response Example
table.VideoInZoom[0][0].Name=Day
table.VideoInZoom[0][0].Speed=8
table.VideoInZoom[0][0].DigitalZoom=true
…

Set Config Request Example
http://192.168.1.108/cgi-bin/configManager.cgi?action=setConfig&VideoInZoom[0][0].DigitalZoom=false
&VideoInZoom[0][0].Speed=8

Set Config Response Example
OK

5.6.6 [Config] Focus Config

Vari-focal configuration parameter:

Config Data Params
Name
VideoInFocus

Type
object[][] R

R/O Description

Example

+Name
+Mode

char[16] O
O
int

+FocusLimit

int

O

+FocusFarLimit

int

O

Vari-focal configuration parameter;
two-dimensional array.
The first dimension represents the video
channel which starts from 1, and the
second dimension represents the lighting
scene. The beginning three elements
constantly represent day, night and general
scene.
Scene name
Focus mode
2: Auto focus
3: Semi Auto (Customizable, uses auto
focus first, and then locks the focusing
module. Auto focus is not available at the
time, and you have to manually adjust the
focal length.)
4: Manual focus
Recommended limit value of near-field
focusing; unit: mm.
The value range depends on the device
capability.
Recommended limit value of far-field
focusing; unit: mm.

"Day"
2

2000

5000

Camera APIs 246

+AutoFocusTrace

int

+IRCorrection

int

O

O

+Sensitivity

int

O

+FocusLimitSelect
Mode

char[16] O

The value range depends on the device
capability.
Vari-focal tracking
0: Close
1: Open
IR light focusing and correction
0: No correction
1: Manual correction
2: Auto correction
Focusing sensitivity
0: High
1: Default
2: Low
Focuings limit mode (The distance limit for
near-field focusing)
"Manual"
"Auto"

1

1

1

"Auto"

Please refer to "4.2.1 Get and Set Configure" for configuration getting and setting. Specific
examples are as follows :

Get Config Request Example
http://192.168.1.108/cgi-bin/configManager.cgi?action=getConfig&name=VideoInFocus

Get Config Response Example
table.VideoInFocus[0][0].Name=Day
table.VideoInFocus[0][0].Mode=0
table.VideoInFocus[0][0].Sensitivity=1
table.VideoInFocus[0][0].FocusLimitSelectMode=Manual,
table.VideoInFocus[0][0].FocusLimit=2000
table.VideoInFocus[0][0].FocusFarLimit=5000
table.VideoInFocus[0][0].AutoFocusTrace=0
table.VideoInFocus[0][0].IRCorrection=0
…

Set Config Request Example
http://192.168.1.108/cgi-bin/configManager.cgi?action=setConfig&VideoInFocus[0][0].FocusLimit=2000
&VideoInFocus[0][0].FocusFarLimit=5000&VideoInFocus[0][0].Sensitivity=1

Set Config Response Example
OK

5.7 Lighting

5.7.1 [Config] Lighting Config

 Get lighting

Table 5-13

Camera APIs 247

Syntax

Method

http://<server>/cgi-bin/configManager.cgi?action=getConfig&name=Lighting

GET

Description Get lighting

Example

http://192.168.1.108/cgi-bin/configManager.cgi?action=getConfig&name=Lighting

Success
Return

Comment

head.Correction=50
head.FarLight[0].Angle=0
head.FarLight[0].Light=0
head.Mode=ZoomPrio
head.NearLight[0].Angle=0
head.NearLight[0].Light=0
head.MiddleLight[0].Angle=50
head.MiddleLight[0].Light=50
head = table.Lighting[ChannelNo][ConfigNo]：
ChannelNo: integer, array index starts from 0, which means video channel (equals to
video channel index -1, and so 0 means channel 1).
ConfigNo: array index, can be 0, 1 or 2. 0 means config for day, 1 means config for night,
and 2 means config for normal scene.

 Set lighting

Syntax

http://<server>/cgi-bin/configManager.cgi?action=setConfig&<paramName>=<paramV
alue>[&<paramName>=<paramValue>…]

Table 5-14

Method

GET

Description

Set lighting

Example

Turn on light:
http://192.168.1.108/cgi-bin/configManager.cgi?action=setConfig&Lighting[0][0].FarLig
ht[0].Light=10&Lighting[0][0].NearLight[0].Light=90&Lighting[0][0].Mode=Manual

Shift the light to ZoomPrio mode:
http://192.168.1.108/cgi-bin/configManager.cgi?action=setConfig&Lighting[0][0].Correct
ion=50&Lighting[0][0].Mode=ZoomPrio

Success
Return

OK

Parameters in URL:
paramName and paramValue are as table below.
In table below,
head = Lighting[ChannelNo][ConfigNo]
Some lighting equipment has the following restriction:
Lighting[0][0].FarLight[0].Light +
MiddleLight [0]. Light <=100.

Lighting[0][0].NearLight[0].Light+

Lighting[0][0].

ParamValue type

Description

Comment

Appendix:

ParamName

Camera APIs 248

ParamName

ParamValue type

Description

head.Mode

string

head.Correction

integer

head.FarLight[Index].Light

integer

head.MiddleLight[Index].Light

integer

head.NearLight[Index].Light

integer

5.8 Video in Options

is

{"Manual",

Light mode.
range
The
"ZoomPrio"}.
The following are special for composite lamps.
The range is { "Timing" , "SmartLight" ,
"ExclusiveManual" }

"Auto",

"Off",

Light compensation.
The range is [0—100], effective in ZoomPrio
mode.
Range is [0—100].
The luminance of far light.
Range is [0—100].
The luminance of middle light.
Range is [0—100].
The luminance of near light.

5.8.1 Change binocular camera's splice mode

http://<server>/cgi-bin/api/MultiVideo/changeSpliceMode
POST

Request URL
Method
Request Params ( JSON format in body )
Name

Type

R/O
是

Example
0

Description
Splicing state
1: Switch to splice mode
(Binocular camera's monocular
mode)
0: Switch to non-splicing
mode (Binocular camera's
original mode)

State

int32

Request Example

{

                "State": 0

}
Response Params ( JSON format in body )
Name
Type
Response Example
{ }

R/O

Description

Example

Camera APIs 249

5.8.2 [Config] Video in Options Config

It’s not recommended to use the CGI command from “ video in options ” ; It’s now recommended to

use the commands in 5.1 – 5.7.

 Get video in options

Table 5-15

Syntax

Method

Description

Example

http://<server>/cgi-bin/configManager.cgi?action=getConfig&name=VideoInOptions

GET

Get video in options config, such as Backlight, ExposureSpeed, DayNightColor,
DayOptions, NightOptions, and NormalOptions.

http://192.168.1.108/cgi-bin/configManager.cgi?action=getConfig&name=VideoInOptio
ns

Success
Return

head.Backlight=0
head.DayNightColor=false
head.ExposureSpeed=0
head.ExposureValue1=0.100000
head.ExposureValue2=80.000000
head.ExternalSync=0
head.ExternalSyncPhase=0
head.FlashControl.Mode=0
head.FlashControl.Pole=0
head.FlashControl.Value=0
head.FlashControl.PreValue=0
head.Flip=false
head.Gain=50
head.GainAuto=true
head.IrisAuto=false
head.Mirror=false
head.NightOptions.AntiFlicker=0
head.NightOptions.Backlight=0
head.NightOptions.BacklightRegion[0]=3096
head.NightOptions.BacklightRegion[1]=3096
head.NightOptions.BacklightRegion[2]=5096
head.NightOptions.BacklightRegion[3]=5096
head.NightOptions.BrightnessThreshold=50
head.NightOptions.DayNightColor=2
head.NightOptions.ExposureMode=0
head.NightOptions.ExposureSpeed=0
head.NightOptions.ExposureValue1=0
head.NightOptions.ExposureValue2=40
head.NightOptions.ExternalSyncPhase=125
head.NightOptions.Flip=false
head.NightOptions.Gain=50
head.NightOptions.GainAuto=true
head.NightOptions.GainBlue=50

Camera APIs 250

head.NightOptions.GainGreen=50
head.NightOptions.GainMax=50
head.NightOptions.GainMin=0
head.NightOptions.GainRed=50
head.NightOptions.GlareInhibition=0
head.NightOptions.IrisAuto=true
head.NightOptions.Mirror=false
head.NightOptions.Profile=3
head.NightOptions.ReferenceLevel=50
head.NightOptions.Rotate90=0
head.NightOptions.SunriseHour=0
head.NightOptions.SunriseMinute=0
head.NightOptions.SunriseSecond=0
head.NightOptions.SunsetHour=23
head.NightOptions.SunsetMinute=59
head.NightOptions.SunsetSecond=59
head.NightOptions.SwitchMode=4
head.NightOptions.WhiteBalance=Auto
head.NightOptions.WideDynamicRange=0
head.NightOptions.WideDynamicRangeMode=0
head.NormalOptions.AntiFlicker=0
head.NormalOptions.Backlight=0
head.NormalOptions.BacklightRegion[0]=3096
head.NormalOptions.BacklightRegion[1]=3096
head.NormalOptions.BacklightRegion[2]=5096
head.NormalOptions.BacklightRegion[3]=5096
head.NormalOptions.BrightnessThreshold=50
head.NormalOptions.DayNightColor=1
head.NormalOptions.ExposureMode=0
head.NormalOptions.ExposureSpeed=0
head.NormalOptions.ExposureValue1=0
head.NormalOptions.ExposureValue2=40
head.NormalOptions.ExternalSyncPhase=125
head.NormalOptions.Flip=false
head.NormalOptions.Gain=50
head.NormalOptions.GainAuto=true
head.NormalOptions.GainBlue=50
head.NormalOptions.GainGreen=50
head.NormalOptions.GainMax=50
head.NormalOptions.GainMin=0
head.NormalOptions.GainRed=50
head.NormalOptions.GlareInhibition=0
head.NormalOptions.IrisAuto=true
head.NormalOptions.Mirror=false
head.NormalOptions.Profile=0
head.NormalOptions.ReferenceLevel=50
head.NormalOptions.Rotate90=0

Camera APIs 251

head.NormalOptions.SunriseHour=0
head.NormalOptions.SunriseMinute=0
head.NormalOptions.SunriseSecond=0
head.NormalOptions.SunsetHour=23
head.NormalOptions.SunsetMinute=59
head.NormalOptions.SunsetSecond=59
head.NormalOptions.SwitchMode=0
head.ReferenceLevel=50
head.ReferenceLevelEnable=false
head.Rotate90=0
head.SignalFormat=BT656
head.WhiteBalance=Disable

Comment

Parameters in Response:
head = table.VideoInOptions[ChannelNo]
ChannelNo: integer, array index starts from 0, which means video channel (equals to
video channel index -1, and so 0 means channel 1).

 Set video in options

Table 5-16

Syntax

http://<server>/cgi-bin/configManager.cgi?action=setConfig&<paramName>=<paramV
alue>[&<paramName>=<paramValue>…]

Method

GET

Description

Set video in options config, such as Backlight, ExposureSpeed, DayNightColor,
DayOptions, NightOptions, and NormalOptions.

Set Auto Exposure:
http://192.168.1.108/cgi-bin/configManager.cgi?action=setConfig&VideoInOptions[0].E
xposureMode=0&VideoInOptions[0].ExposureSpeed=0

Set Low Noise:
http://192.168.1.108/cgi-bin/configManager.cgi?action=setConfig&VideoInOptions[0].E
xposureMode=1&VideoInOptions[0].ExposureSpeed=0&VideoInOptions[0].GainMin=0
&VideoInOptions[0].GainMax=60

Example

Set Low Motion Blur:
http://192.168.1.108/cgi-bin/configManager.cgi?action=setConfig&VideoInOptions[0].E
xposureMode=2&VideoInOptions[0].ExposureSpeed=0&VideoInOptions[0].GainMin=0
&VideoInOptions[0].GainMax=50&VideoInOptions[0].ExposureValue1=0&VideoInOptio
ns[0].ExposureValue2=20

Set Manual:
http://192.168.1.108/cgi-bin/configManager.cgi?action=setConfig&VideoInOptions[0].E
xposureMode=4&VideoInOptions[0].ExposureSpeed=32&VideoInOptions[0].GainMin=
0&VideoInOptions[0].GainMax=50&VideoInOptions[0].ExposureValue1=40&VideoInOp
tions[0].ExposureValue2=40

Set SmartIRExposure:

Camera APIs 252

http://192.168.1.108/cgi-bin/configManager.cgi?action=setConfig&VideoInOptions[0].S
martIRExposure=true

Set Video Rotate:
Filp:
http://192.168.1.108/cgi-bin/configManager.cgi?action=setConfig&VideoInOptions[0].Fli
p=true
Mirror:
http://192.168.1.108/cgi-bin/configManager.cgi?action=setConfig&VideoInOptions[0].Mi
rror=true
Or turn 90°:
http://192.168.1.108/cgi-bin/configManager.cgi?action=setConfig&VideoInOptions[0].R
otate90=1

Set White Balance:
http://192.168.1.108/cgi-bin/configManager.cgi?action=setConfig&VideoInOptions[0].W
hiteBalance=Night
Or
http://192.168.1.108/cgi-bin/configManager.cgi?action=setConfig&VideoInOptions[0].W
hiteBalance=Custom&VideoInOptions[0].GainRed=50&VideoInOptions[0].GainBlue=50
&VideoInOptions[0].GainGreen=50
(Sometimes you should set mode first before set GainRed or GainBlue:
http://192.168.1.108/cgi-bin/configManager.cgi?action=setConfig&VideoInOptions[0].W
hiteBalance=Custom )

Success
Return

OK

Comment

Appendix:

ParamName

Parameters in URL:
In table below, head = VideoInOptions[ChannelNo]
ChannelNo: integer, array index starts from 0, which means video channel (equals to
video channel index -1, and so 0 means channel 1).

ParamValue type Description

head.Backlight

integer

head.DayNightColor

integer

Range is [0—n]
n depends on capability in GetVideoInputCaps
0: backlight closed.
1: backlight grade 1
...
n - backlight grade n

Range is {0,1,2}
0: always multicolor
1: autoswitch along with brightness,
2: always monochrome

Camera APIs 253

ParamName

ParamValue type Description

head.ExposureMode

integer

head.ExposureSpeed

integer

head.ExposureValue1

float

head.ExposureValue2

float

head.ExternalSync

integer

head.ExternalSyncPhase

foat

Range is {0,1,2, 4}
0: AutoExposure
1: Gain first
2: Exposure first
4: Manual.
Range is [0 — n+1]
n depends on capability in GetVideoInputCaps
0: AutoExposure
1-n-1: manual Exposure grade
n: AutoExposure with time limit.
n+1: manualExposure with user-defined time
(n is supported maximum exposure grade )
Range is [0.1—80], unit is millisecond
If ExposureSpeed is 0(AutoExposure enable), it's
lower limit of AutoExposure time, otherwise it's
time of manualExposure

Range is [0.1-80], unit is millisecond
Upper limit of AutoExposure time, should be bigger
than ExposureValue1

Range is {0,1}
External Synchronous
0: Internal Synchronization
1: External Synchronous
Range is [0°—360°]
External Synchronous Signal Phase

head.SmartIRExposure

bool

true: enable, false: disable

head.FlashControl.Mode

integer

head.FlashControl.Pole

integer

head.FlashControl.Value

integer

Range is {0,1,2}
0: forbid flash
1: always flash
2: auto flash

Range is {0,1, 2, 3}
Trigger mode:
0: low level
1: high level
2: rising-edge
3: falling-edge
Range is [0—15]
Flashlight time-unit:
0: 0us,
1: 64us,
2: 128us,
3: 192us
…
15 - 960us

Camera APIs 254

ParamName

ParamValue type Description

head.FlashControl.PreValue

integer

head.Flip

bool

head.Gain

integer

head.GainBlue

integer

head.GainRed

integer

head.GainGreen

integer

head.GainAuto

head.IrisAuto

head.Mirror

bool

bool

bool

head.WhiteBalance

String

head.ReferenceLevel

integer

head.Rotate90

integer

Range is [0—100]
It is threshold of brightness value: if brightness is
less than this value, flash light will begin to work.

true: enable video flip function
false: disable video flip function
Range is [0—100]
If GainAuto is true, it's upper limit of auto gain, else
it's the fixed gain adjust value.
Range is [0—100]
Gain for blue value, Value is effective when
WhiteBalance is "Custom."
Range is [0—100]
Gain for red value, Value is effective when
WhiteBalance is "Custom."
Range is [0—100]
Gain for green value, Value is effective when
WhiteBalance is "Custom."

true: GainAuto
false: No GainAuto

true: IrisAuto
false: No IrisAuto

true: enable video mirror function
false: disable video mirror function

White balance Mode.
Range is {Disable, Auto, Custom, Sunny, Cloudy,
Home, Office, Night}
Some IPC supports common modes: "Disable",
"Auto", "Sunny", "Night", "Outdoor", "Custom"
Sometimes the device support other advanced
"Indoor",
"CustomColorTemperature",
modes:
"ATW", "Manual", "AutoOutdoor", "ManualDatum"
and so on.
Range is [0—100]
The expected average brightness level of video
frames.

Range is {0,1,2}
Video rotation:
0: No rotate
1: clockwise rotate 90°
2: anticlockwise rotate 90°

head.SignalFormat

String

Range is {Inside, BT656, 720p, 1080p, 1080i,
1080sF}
Input Signal Mode

Camera APIs 255

ParamName

ParamValue type Description

head.AntiFlicker

integer

head.GlareInhibition

integer

head.NightOptions.Brightnes
sThreshold

integer

head.NightOptions.IrisAuto

bool

head.NightOptions.SunriseH
our

head.NightOptions.SunriseMi
nute

head.NightOptions.SunriseS
econd

head.NightOptions.SunsetHo
ur

head.NightOptions.SunsetMi
nute

head.NightOptions.SunsetSe
cond

integer

integer

integer

integer

integer

integer

head.NightOptions.SwitchMo
de

integer

head.NightOptions.Profile

integer

head.NightOptions.Exposure
Speed

head.NightOptions.Exposure
Value1

head.NightOptions.Exposure
Value2

integer

float

float

Range is {0,1,2}
AntiFlicker mode:
0: Outdoor
1: 50 Hz AntiFlicker
2: 60 Hz AntiFlicker
Range is [0—100]
GlareInhibition:
0: Close GlareInhibition.

NightOptions contain a set of parameters used
when brightness is not enough.
Range is [0—100]
when
BrightnessThreshold, parameters change
Nightoptions.

brightness

the
to

than

less

is

true: IrisAuto
false: No IrisAuto
Range is [00—23]
Sunrise hour.
Range is [00—59]
Sunrise minute
Range is [00—59]
Sunrise second

Sunset time. Its range is same with sunrise time,
and it should be after sunrise time.
NightOptions are used if time is after sunset time
and before sunrise time.

Range is {0,1,2}
0: NoSwitch, always use day options.
1: Switch depends on brightness.
2: Switch depends on time, switch to NightOptions
when time is after sunset time and before sunrise.
3: NoSwitch, always use NightOptions.
4: No switch, always use NormalOptions.

Range is {0,1,2,3}
0: use temporary day options.
1: use temporary NightOptions.
2: use temporary NormalOptions.
3: depends on head.NightOptions.SwitchMode

Range is the same as relevant items of day
options in this table.
Example:
Value range of head.NightOptions.ExposureSpeed
is the same with head. ExposureSpeed.

Camera APIs 256

ParamName

ParamValue type Description

head.NightOptions.Gain

integer

head.NightOptions.GainAuto bool

head.NightOptions.GainBlue

integer

head.NightOptions.GainGree
n

integer

head.NightOptions.GainRed

integer

head.NightOptions.WhiteBal
ance

head.NightOptions.Referenc
eLevel

String

integer

head.NightOptions.ExternalS
yncPhase

float

head.NightOptions.AntiFlicke
r

integer

head.NightOptions.Backlight

integer

head.NightOptions.DayNight
Color

head.NightOptions.Exposure
Mode

head.NightOptions.GlareInhi
bition

head.NightOptions.Mirror

head.NightOptions.Flip

integer

integer

integer

integer

integer

head.NightOptions.Rotate90

integer

head.NomalOptions.Brightne
ssThreshold

integer

head.NormalOptions.IrisAuto bool

head.NormalOptions.Sunrise
Hour

head.NormalOptions.Sunrise
Minute

head.NormalOptions.Sunrise
Second

head.NormalOptions.Sunset
Hour

head.NormalOptions.Sunset
Minute

head.NormalOptions.Sunset
Second

head.NormalOptions.Exposu
reSpeed

head.NormalOptions.Exposu
reValue1

head.NormalOptions.Exposu
reValue2

integer

integer

integer

integer

integer

integer

integer

float

float

NomalOptions contain a set of parameters similar
with NightOptions.
Range
is
NightOptions in this table.

the same as

items of

relevant

Camera APIs 257

ParamName

ParamValue type Description

head.NormalOptions.Gain

integer

head.NormalOptions.GainAu
to

bool

head.NormalOptions.GainBlu
e

head.NormalOptions.GainGr
een

head.NormalOptions.GainRe
d

head.NormalOptions.WhiteB
alance

head.NormalOptions.Referen
ceLevel

integer

integer

integer

String

integer

head.NormalOptions.Externa
lSyncPhase

float

head.NormalOptions.AntiFlic
ker

head.NormalOptions.Backlig
ht

head.NormalOptions.DayNig
htColor

head.NormalOptions.Exposu
reMode

head.NormalOptions.GlareIn
hibition

integer

integer

integer

integer

integer

head.NormalOptions.Mirror

integer

head.NormalOptions.Flip

integer

head.NormalOptions.Rotate9
0

integer

Camera APIs 258

6 Storage APIs

6.1 Storage Devices

6.1.1 Get Hard Disk Information

Get the hard disk information.

http://<server>/cgi-bin/storageDevice.cgi?action=factory.getPortInfo
GET

Request URL
Method
Request Params ( key=value format in URL )
Name
Request Example
http://192.168.1.108/cgi-bin/storageDevice.cgi?action=factory.getPortInfo

R/O Description

Type

Example

Example

Response Params ( key=value format in body )
Type
Name
object
into
uint
+Total

R/O Description
R
O

Return the hard disk information
The number of ports of the bus, including the
expansion bus.
The number of the mounted IDE (damaged IDEs
are excluded)
Indicates whether there is an IDE (including
damaged IDE) mounted on the bus channel.
Each bit represents the main IDE or the sub IDE
of the bus channel.
If the bit is set to "1", there is a mounted IDE. If
the bit is set to "0", there is no mounted IDE. For
example, bit 0 represents the main IDE of IDE0,
bit1 represents
IDE0, bit2
represents the main IDE of IDE1, bit3 represents
the sub IDE of IDE1, and more.
Indicates whether there is a damaged IDE
mounted on each channel.
Each bit represents the main or sub IDE of each
channel. If the bit is set to "1", there is a damaged
IDE. If the bit is set to "0", there is no damaged
IDE. See Mask for the corresponding relationship.
The number of mounted IDE
The total port number of the eSATA

the sub

IDE of

2

1

1

0

1
4

+Plug

uint

O

+Mask

uint64

O

+Bad

uint

O

uint
uint

+IDE
+Esata
Response Example
info.Total=2
info.Plug=1

O
O

Storage APIs 259

info.Mask=1
info.Bad=0
info.IDE=1
info.Esata=4

6.1.2 Get the Name of All Storage Devices

Get the name of all storage devices.

http://<server>/cgi-bin/storageDevice.cgi?action=factory.getCollect
GET

Request URL
Method
Request Params ( key=value format in URL )
Name
Request Example
http://192.168.1.108/cgi-bin/storageDevice.cgi?action=factory.getCollect

R/O Description

Type

Example

Example
[ "/dev/sda0", "/dev/sda1",
"/dev/sg1"]

Response Params ( key=value format in body )
Type
Name
char[][64] R
list

R/O Description

Return the name of the storage
device

Response Example
list[0]="/dev/sda0"
list[1]="/dev/sda1"
list[2]="/dev/sg1"

6.1.3 Get Storage Device Information

Get all the storage device information .

http://<server>/cgi-bin/storageDevice.cgi?action=getDeviceAllInfo
GET

Request URL
Method
Request Params ( key=value format in URL )
Name
Request Example
http://192.168.1.108/cgi-bin/storageDevice.cgi?action=getDeviceAllInfo

R/O Description

Type

Example

Response Params ( key=value format in body )
R/O Description
Type
Name
Return object
object
list
R
Object array of the storage device information
object[] R
+info
Partition information
object[] O
++Detail
Whether the partition is abnormal
O
bool
+++IsError
Partition operation handle
uint
+++Pointer
O
Total partition space; unit: Byte
double O
+++TotalBytes
Partition type
"ReadWrite": Read and write partition
"ReadOnly": Read only partition

char[16] O

+++Type

Example

false
27023434
0
"ReadWrite"

Storage APIs 260

+++Path

+++UsedBytes
++Name

O

char[12
8]
double O
char[32] R

++State

char[4] R

Partition name

Occupied partition space; unit: Byte
Device name
Device status
"Error": Failed to get the device status
"Initializing": Getting the device status
"Success": Successfully get the device status

"/mnt/dvr/sd
a0"

"/dev/sda"
"Success"

Response Example
list.info[0].Detail[0].IsError=false
list.info[0].Detail[0].Pointer=27023434
list.info[0].Detail[0].TotalBytes=0
list.info[0].Detail[0].Type=ReadWrite
list.info[0].Detail[0].Path=/mnt/dvr/sda0
list.info[0].Detail[0].UsedBytes=0
list.info[0].Name=/dev/sda
list.info[0].State=Success

6.1.4 Get Storage Capability

Table 6-1

Syntax

Method

http://<server>/cgi-bin/storage.cgi?action=getCaps

GET

Description

Get storage capabilities.

Example

Success
Return

Comment

http://192.168.1.108/cgi-bin/storage.cgi?action=getCaps

caps.RedundantDisk.Support=false
caps.SupportRemoteLimit=true
—

6.1.5 Format Camera SD-Card

Syntax

http://<server>/cgi-bin/storageDevice.cgi?action=setDevice&type=FormatPatition&path=<p
ath> [&<paramName>=<paramValue>…]

Table 6-2

Method

GET

Descriptio
n

Format camera SD card.

[ Request Params ] (key=value format at URL )

Name

type

path

Type

string

string

formattype Array<object>

+fs

string

R/O

R

O

O

R

Param Description

operation

disk part path

disk part information

File system type

Example

http://192.168.1.108/cgi-bin/storageDevice.cgi?action=setDevice&type=FormatPatition&pa

Storage APIs 261

th= /dev/sda&formattype[0].fs=fat32

Success
Return

OK

Comment

If set successfully, return true, else return false.
path : The stringValue is got from cgi API "Get storage device information"
(/cgi-bin/storageDevice.cgi?action=getDeviceAllInfo). stringValue is list[0].Name.

6.1.6 [Config] Hard Disk Recording Type

Config Data Params

Name

Type

R/O Description

Example

SupportDiskRecordType object

+DiskRecordType

char[32]

O

O

Supported disk recording type
info.

Disk recording mode
"SMR", "CMR"

"SMR"

Please refer to "4.2.1 Get and Set Configure" for configuration getting and setting. Specific
examples are as follows :

Get Config Request Example

http://192.168.1.108/cgi-bin/configManager.cgi?action=getConfig&name=SupportDiskRecordType

Get Config Response Example

table.SupportDiskType.DiskRecordType =SMR

Set Config Request Example

http://192.168.1.108/cgi-bin/configManager.cgi?action=setConfig&SupportDiskRecordType.DiskRecord
Type=SMR

Set Config Response Example

OK

6.1.7 Getting Disk Information

POST

Request URL http://<server>/cgi-bin/api/StorageDeviceManager/getDeviceInfos
Method
Request Params ( JSON format in body )
Name
volume

Type
char[32]

Example
"PhysicalVolume"

R/O Description
Volume type
R
enumchar[32]{
"PhysicalVolume": physical volume
(includes physical disk in RAID and
VG, and includes USB flash drive).
"InvidualPhysicalVolume": Individual
physical volume (does not
participate in RAID, virtual, and
clone groups).

Storage APIs 262

"RaidVolume": Raid volume
"InvidualRaidVolume": individual
RAID volume (does not participate
in virtual and other groups)
"VolumeGroup": VG virtual volume
group
"iSCSI": iSCSI volume
"GlobalSpareVolume": global hot
standby volume
"NAS": NAS volume (Includes FTP,
SAMBA, NFS)
}
Keep consistent with the definition of
Device Information
Volume type value is "”, get the
information of all volumes, including

InvidualPhysical、InvidualRaid、

VolumeGroup

Request Example
{
"volume": "PhysicalVolume"
}

Response Params ( JSON format in body )
Type
Name
object[256]
device
char[32]
+Name
char[]
+Media

R/O Description
O
O
O

+BUS

char[8]

+PhysicNo

uint

+LogicNo

uint

+Capacity
+Volume

double
enumchar[32]

O

O

O

O
O

Disk Information
Device name
Media type
"CDROM": disk
"DISK": hard drive
"FLASH": SD card
"FROCK": frock
"UNKNOWN": unknown
Bus type, supporting "ATA",
"SATA", "USB", "SDIO",
"SCSI", "SAS” and more.
Physical number of the
similar device storage port,
starting from 1.
Logic number of the similar
device storage port
Total capacity, Unit: Byte
Volume type enumchar[32]{
"PhysicalVolume":
independent physical
volume/global hot standby

Example
[ , …, ]
"/dev/sda"
"CDROM"

"ATA"

1

0

314537952
"RaidVolume"

Storage APIs 263

+State

enumchar[32]

O

"Running"

"RaidVolume": Raid volume
(Includes sub-disk of the
soft Raid and local hot
standby)
"VolumeGroup": VG virtual
volume group (once VG is
composed of single disk or
Raid, then the result will be
VG)
"iSCSI": iSCSI volume
Physical hard disk status
information
enumchar[32]{
"Error": general faults.
Some partition still can be
used.
"Fatal": serious faults, all of
the partitions cannot be
used (new DVR fault type)
"Offline": offline status of
physical disks (not used)
"Running": the operating
status of the physical disk
"RaidSub": the disk now is a
single disk and it was a Raid
sub disk before. It is likely to
automatically add Raid after
the device is restarted.
/_( the four status are used
in single disk)_/
"Active": RAID active
"Sync": RAID sync
"Spare": RAID hot standby
(local)
"Faulty": RAID invalid
"Rebuilding": RAID rebuild
"Removed": RAID removed
(not used)
"WriteError": RAID write
error
"WantReplacement": RAID
need to be replaces
"Replacement": RAID is
replacement
/_(the 9 status are used in
RAID sub disk)_/
"GlobalSpare": global hot

Storage APIs 264

standby
/_(the status is used in
global hot standby disk)_/
"SnapshotParent": snapshot
parent
"SnapshotChild": snapshot
child
"VolumeCloneParent":
volume clone parent
"VolumeCloneChild":
volume clone child
/_(the 4 status are used in
snapshot/volume clone
disk)_/
}
Name of the storage
physical device or name of
the parent storage group of
the virtual device. It might
be VG or RAID.
Disk feature (read and write,
read-only)
enumchar[32]{
"ReadWrite"
"ReadOnly"
}
Device module
Device serial number
Single disk temperature
(unit: °C)
Firmware version
Partition information
Each partition has a
WorkDirectory. When the
disk has fault or is not
formatted, the field does not
exist.
Partition name
Start to offset. Unit: Byte
Total capacity. Unit: Byte
The remained capacity.
Unit: Byte
Mount point. The App use
this directory name to
access files.
File system, such as
"DHFS", "EXT3", "EXT4",

"/dev/md0"

"ReadWrite"

"HCT7210SLA360"
"STH607MGAS"
38.5

"ST6OA31E"

"/dev/sda0"
0
2000000000
1000000000

"/mnt/dvr/idea0"

"VFAT"

Storage APIs 265

+Parent

char[32]

O

+Type

enumchar[32]

O

+Module
+SerialNo
+Temperature

+Firmware
+Partitions

char[32]
char[32]
float

char[32]
object[]

++Name
++Start
++Total
++Remain

char[32]
double
double
double

++MountOn

char[256]

++FileSystem

char[16]

O
O
O

O
O

O
O
O
O

O

O

++IsSupportFs

bool

O

++Status

enumchar[32]

O

++Group
++IsError

char[32]
bool

+Raid

object

++Members

char[][16]

++MemberInfos

object[]

+++ID

uint16

+++Spare

bool

++Level
++RaidDevices
++TotalDevices

uint8
uint16
uint16

++State

char[][16]

O
O

O

O

O

O

O

O
O
O

O

"ture"

"LvAvailable"

"ReadWrite2"
false

["/dev/sda", "/dev/sdb",
"/dev/sdc"]

1

true

5
3

４

["Active", "Degraded"]

"XFS", "VFAT",
"UNKNOWN” and more.
Empty means it is not
formatted.
Whether the device
supports the current file
system.
Partition status information
enumchar[32]{
"LvAvailable": LV available
status
"LvNotAvailable": LV
unavailable status
Partition working group
Whether the file system of
the working directory fails
RAID information, and it is
only valid to RAID volume.
RAID member, including
sub disk and local hot
standby disk.
RAID member information
one-dimensional array, and
the index is corresponding
to Members.
Disk number, and it is used
to describe the slot of the
disk on the disk cabinet.
Whether it is local hot
standby.
True: local hot standby
False: RAID sub disk
RAID Level
Number of RAID devices
Total number of RAID
devices
RAID status, and it is a
combination of various
status. RAID sub disk status
is achieved by State.
Supports status "Active"
"Inactive" "Clean" "Failed"
"Degraded" "Recovering"
"Resyncing" "Reshaping"
"Checking" "NotStarted"
"Readonly" "DataCorrupt"
"CreatVG" RAID disk is

Storage APIs 266

++ActiveDevices
++WorkingDevice
s
++FailedDevices
++SpareDevices

uint16
uint16

uint16
uint16

++RecoverPercen
t

double

O
O

O
O

O

++RecoverMBps

double

O

++RecoverTimeR
emain

double

O

++AliasName
++Sync

char[24]
enumint8

O
O

+ISCSI

object

++Name

char[16]

+Tank

object

++Level
++Slot

int
uint16

O

O

O

O
O

being created to VG
Number of active devices
Number of working devices

Number of failed devices
Number of hot standby
devices
Recover percent. Its is valid
when “Recovering” or
“Resyncing” is in RAID
status. Value: [0, 100]
Recover speed. Its is valid
when “Recovering” or
“Resyncing” is in RAID
status. Unit: Mbps
Remaining time. When in
RAID status, “Recovering”
or “Resyncing” is valid. Unit:
Minute (s)
RAID alias, UTF-8 code.
Sync mode. I/O resources
distributing strategy
enumint8{
0: Self-adaptive (The
default value is ) 1: I / O is
prioritized to RAID
synchronization.
2: I / O is prioritized to hard
drive to write data.
3: Balance
}
ISCSI information. It is only
valid for ISCSI disk.
iSCSI name. It is the same
with the Name in NAS
configuration.
Information of the
expansion drawer where
the disk in (Note: it refers to
Dahua expansion drawer,
not the disk cabinet)
You can get the information
of the through
storage.getTankInfo
Control module is level 0.
Board number on the
related cabinet. (starting

3
3

3
3

12.3

29.531

30.0

"Image storage RAID"
0

"iSCSIA"

1
0

Storage APIs 267

++TankNo

uint16

O

+Slot
+PowerMode

int
enumchar[32]

O
O

+PreDiskCheck

enumchar[32]

O

1

0
"StandBy"

"Good"

from 0). Each cabinet can
be inserted on many
expansion boards and each
expansion drawer (such as
Raid card) can cascade
many cabinets.
Expansion port number of
the expansion drawer at the
same level (starting from 0).
There may have many ports
on the expansion board
(such as SAS)
Slot of the disk.
Hard drive power status
enumchar[32]{
"None": unknown status
"Active": active status
"StandBy": standby status
"Idle": idle status
}
Hard drive pre-check status
(EVS optional field, and
uses with disk pre-check
function)
enumchar[32]{
"Good": read speed of the
hard drive can be up to 120,
and there are few mistakes
in smart information.
Nothing else is wrong.
"Warn": there are several
mistake records in cmd
information and there are
mistake records in smart
information.
"Error": there are several
mistake records in cmd
information and there are
mistake records in smart
information. There are
records of bad sectors.
"Willfail": hard drive speed
is low, under 64 M. There
are several mistake records
in cmd information and
there are mistake records in
smart information. There

Storage APIs 268

+OpState

enumint

O

+ManuFactory

enumchar[32]

O

+PosLedState

enumint8

O

+CmrSize

uint32

O

are records of bad sectors.
"Fail": the hard drive failed
to return.
"None": unknown status
"Becheck": checking status
"Checkfail": failed to check
}
enumint{
0: Normal working status
1: Standby status
2: Waiting to be formatted
3: Formatting…
4: Waiting to be
fragmentated
5: Fragmenting...
6: Waiting to create RAID
7: Creating RAID...
8: Waiting to delete RAID
9: Deleting RAID...
10: Waiting to fix file system
11: Fixing...
12: Waiting to pre-check
13: Pre-checking...
14: Configuring hot standby
disk...
15: Create storage pool
16: Delete storage pool
}
Hard drive device
manufacturer
enumchar[32]{
"Unknown"
"WD": WD
"SG" : Seagate
}
Status of the hard dive GPS
indicator
enumint8{
0: The hard dive GPS
indicator is off
1: The hard dive GPS
indicator is on
}
It refers to CMR hard drive,
and the unit is sector (513
bytes)
Otherwise, the field is 0.

0

"WD"

0

0

Storage APIs 269

+MRType

enumint

O

+MediaType
+DRTypeMixState enumchar[32]

char[32]

O
O

0

"SSD"
"Mix"

Disk recording method
enumint{
0: CMR
1: PMR
2: SMR
}
Disk media type
Hard drive recording
method
enumchar[32]{
"Single": single record
method,
"Mix": mixed record method.
}

Example
{

"device": {

"Name" : "/dev/sda",
"Media" : "CDROM",
"BUS" : "ATA",
"PhysicNo" : 1,
"LogicNo" : 0,
"Capacity" : 314537952,
"Volume": "RaidVolume",
"State": "Running",
"Parent" : "/dev/md0",
"Type" : "ReadWrite",
"Module" : "HCT7210SLA360",
"SerialNo" : "STH607MGAS",
"Temperature" : 38.5,
"Firmware" : "ST6OA31E",
"Partitions" : [ {

"Name" : "/dev/sda0",
"Start" : 0,
"Total" : 2000000000,
"Remain" : 1000000000,
"MountOn" : "/mnt/dvr/idea0",
"FileSystem" : "VFAT",
"IsSupportFs" : "ture",
"Status" : "LvAvailable",
"Group" : "ReadWrite2",
"IsError" : false

},…,{}],
"Raid" : {

"Members" : ["/dev/sda", "/dev/sdb", "/dev/sdc"],
"MemberInfos" : [{
"ID" : 1,

Storage APIs 270

"Spare" : true,

}, …, {}],
"Level" : 5,
"RaidDevices" : 3,
"TotalDevices" : 4,
"State" : ["Active", "Degraded"],
"ActiveDevices" : 3,
"WorkingDevices" : 3,
"FailedDevices" : 3,
"SpareDevices" : 3,
"RecoverPercent" : 12.3,
"RecoverMBps" : 29.531,
"RecoverTimeRemain" : 30.0,
"AliasName" : "image storage RAID"
"Sync" : 0
},//end of Raid
"ISCSI" : {

"Name" : "iSCSIA"

}, // end of ISCSI
"Tank" : {

"Level" : 1,
"Slot" : 0,
"TankNo" : 1

}, // end of Tank
"Slot" : 0,
"PowerMode" : "StandBy",
"PreDiskCheck" : "Good",
"OpState" : 0
"ManuFactory": "WD",
"PosLedState": 0,
"CmrSize": 0,
"MRType": 0,
"MediaType": "SSD",
"DRTypeMixState": "Mix"

}

}

6.2 NAS

6.2.1 [Config] NAS Information

 Get NAS config

Syntax

http://<server>/cgi-bin/configManager.cgi?action=getConfig&name=NAS

Table 6-3

Storage APIs 271

Method

GET

Description

Get all the directories on the NAS server.

Example

http://192.168.1.108/cgi-bin/configManager.cgi?action=getConfig&name=NAS

table.NAS[0].Name="FTP1"
table.NAS[0].Enable=true
table.NAS[0].Protocol="FTP"
table.NAS[0].Address="www.ttt.com"
table.NAS[0].Port=21
table.NAS[0].UserName="anonymity"
table.NAS[0].Password="none"
table.NAS[0].Directory="share"
—

Success
Return

Comment

 Set NAS config

Syntax

http://<server>/cgi-bin/configManager.cgi?action=setConfig&<paramName>=<paramV
alue>[&<paramName>=<paramValue>…]

Table 6-4

Method

GET

Description

Set NAS config.

Example

Success
Return

Comment

http://192.168.1.108/cgi-bin/configManager.cgi?action=setConfig&NAS[0].Name=nas0
1&NAS[0].Enable=true

OK

Parameters in URL:
In table below,
Head=NAS[index]
index: The index of the NAS Server

Appendix:

ParamName

Head.Name

Head.Enable

Head.Protocol

Head.Address

Head.Port

Head.UserName

Head.Password

Head.Directory

ParamValue type

Description

string

bool

string

string

integer

string

string

string

NAS name.

Enable/Disable the NAS.

The range is {"FTP", "SFTP", "SMB", "NFS", "Cloud",
"ISCSI" }

The IP address or host name.

NAS port.

NAS username.

NAS password.

Directory name.

6.3 Storage Point

6.3.1 [Config] Record Storage Point

 Get record storage point config

Storage APIs 272

Table 6-5

Syntax

http://<server>/cgi-bin/configManager.cgi?action=getConfig&name=RecordStoragePoi
nt

Method

GET

Description

Get record storage point config.

Example

http://192.168.1.108/cgi-bin/configManager.cgi?action=getConfig&name=RecordStora
gePoint

table.RecordStoragePoint [0].TimingRecord.Local=1
table.RecordStoragePoint [0].TimingRecord.Redundant=Redundant
table.RecordStoragePoint [0].TimingRecord.Remote=FTP
table.RecordStoragePoint [0].TimingRecord.AutoSync=false
table.RecordStoragePoint [0].TimingRecord.AutoSyncRange=0
table.RecordStoragePoint [0].TimingRecord.LocalForEmergency=false
table.RecordStoragePoint [0].TimingRecord.CompressBefore=15
—

Success
Return

Comment

 Set record storage point config

Table 6-6

Syntax

http://<server>/cgi-bin/configManager.cgi?action=setConfig&<paramName>=<paramV
alue>[&<paramName>=<paramValue>…]

Method

GET

Description

Set record storage point config.

Example

Success
Return

Comment

Appendix:

ParamName

http://192.168.1.108/cgi-bin/configManager.cgi?action=setConfig&RecordStoragePoint[
0].TimingRecord.Local=local

OK

Parameters in URL:
In table below,
ch: integer, array index starts from 0, which means video channel(equals to video
channel index -1, and so 0 means channel 1).
recType: The range
"EventRecord",
"EventSnapShot"}

is {"TimingRecord", "VideoDetectRecord", "AlarmRecord",
"AlarmSnapShot",

"VideoDetectSnapShot",

"TimingSnapShot",

ParamValue type Description

RecordStoragePoint[ch].[recType].Local

integer/boolean

RecordStoragePoint[ch].[recType].Redu
ndant

RecordStoragePoint[ch].[recType].Remo
te

string

string

some

Local directory number, count from 1.
For
reason,
The front-end devices use Boolean
type. True for SD card, false for no SD
card.

Redundant directory name.

Remote directory name.

Storage APIs 273

ParamName

ParamValue type Description

RecordStoragePoint[ch].[recType].Auto
Sync

bool

RecordStoragePoint[ch].[recType].Auto
SyncRange

integer

RecordStoragePoint[ch].[recType].Local
ForEmergency

bool

When remote directory recovers, auto
synchronize local directory to remote
directory or not.

From the remote directory recovering
time, how long the data needs to be
synchronized. The unit is hour. If it is
0, all
to be
the data needs
synchronized.

the

remote directory

When
is
unusable, save the data the local
directory or not.

RecordStoragePoint[ch].[recType].Comp
ressBefore

integer

The days' data which will be
compressed.

6.3.2 [Config] Storage Group

 Get storage group config

Table 6-7

Syntax

Method

http://<server>/cgi-bin/configManager.cgi?action=getConfig&name=StorageGroup

GET

Description

Get storage group config.

Example

http://192.168.1.168/cgi-bin/configManager.cgi?action=getConfig&name=StorageGrou
p

table.StorageGroup[0].Channels[0].MaxPictures=0
table.StorageGroup[0].FileHoldTime=0
table.StorageGroup[0].Memo=For Reading & Writing Files
table.StorageGroup[0].Name=ReadWrite
table.StorageGroup[0].OverWrite=true
table.StorageGroup[0].PicturePathRule=%y-%M-%d/%c/jpg/%h/%m/%s[%E][%O@%S ][%R].jpg
table.StorageGroup[0].RecordPathRule=%y-%M-%d/%c/dav/%h/%h.%m.%s-%h.%m.
%s[%E][%O@%S][%R].dav
table.StorageGroup[1].Channels[0].MaxPictures=0
table.StorageGroup[1].FileHoldTime=0
table.StorageGroup[1].Memo=For FTP Files
table.StorageGroup[1].Name=Remote
table.StorageGroup[1].OverWrite=true
table.StorageGroup[1].PicturePathRule=%y-%M-%d/%c/jpg/%h/%m/%s[%E][%O@%S ][%R].jpg
table.StorageGroup[1].RecordPathRule=%y-%M-%d/%c/dav/%h/%h.%m.%s-%h.%m.
%s[%E][%O@%S][%R].dav
—

Success
Return

Comment

 Set storage group config

Storage APIs 274

Table 6-8

Syntax

http://<server>/cgi-bin/configManager.cgi?action=setConfig&<paramName>=<paramV
alue>[&<paramName>=<paramValue>…]

Method

GET

Description

Set storage group config.

Example

Success
Return

Comment

Appendix:

ParamName

http://192.168.1.108/cgi-bin/configManager.cgi?action=setConfig&StorageGroup[0].Na
me=main

OK

Parameters in URL:
In table below,
Index = Storage Group index
ch: integer, array index starts from 0, which means video channel (equals to video
channel index -1, and so 0 means channel 1).

ParamValue type Description

StorageGroup[Index].Name

StorageGroup[Index].Memo

string

string

Storage group name.

Storage group memo.

StorageGroup[Index].FileHoldTime

integer

How many days the file will hold.

StorageGroup[Index].OverWrite

bool

StorageGroup[Index].Channels[ch].
MaxPictures

Integer

Over write or not when there is not enough
storage.

The max pictures beyond which the old
pictures will be over written. If it is 0, the old
pictures will be not over written.

StorageGroup[Index].Channels[ch].
Path

string

The channel path.

6.4 SDEncrypt

6.4.1 Encrypt SD Card

Syntax

http://<server>/cgi-bin/SDEncrypt.cgi?action=encrypt&deviceName=<deviceName>&p
assword=<password>

Table 6-9

Method

GET

Description

SD encryption operation.

Example

Success
Return

Comment

http://192.168.1.108/cgi-bin/SDEncrypt.cgi?action=encrypt&deviceName=/dev/mmc0&
password=123456

OK

If set successfully, return true, else return false.
deviceName: The stringValue is got from cgi API Get storage device information
(cgi-bin/storageDevice.cgi?action=getDeviceAllInfo).

Storage APIs 275

password: The stringValue Card is Encrypted

6.4.2 Decrypt SD Card

Syntax

http://<server>/cgi-bin/SDEncrypt.cgi?action=decrypt&deviceName=<deviceName>&p
assword=<password>

Table 6-10

Method

GET

Description

SD decrypt operation.

Example

Success
Return

Comment

http://192.168.1.108/cgi-bin/SDEncrypt.cgi?action=decrypt&deviceName=/dev/mmc0&
password=123456

OK

If set successfully, return true, else return false.
deviceName: The stringValue is got from cgi API Get storage device information
(cgi-bin/storageDevice.cgi?action=getDeviceAllInfo).
password: The stringValue ard is Encrypted

6.4.3 Clear SD Card Password

Table 6-11

Syntax

http://<server>/cgi-bin/SDEncrypt.cgi?action=clearPassword&deviceName=<deviceNa
me>&password=<password>

Method

GET

Description

SD clear password operation.

Example

Success
Return

Comment

http://192.168.1.108/cgi-bin/SDEncrypt.cgi?action=clearPassword&deviceName=/dev/
mmc0&password=123456

OK

If set successfully, return true, else return false.
deviceName: The stringValue is got from cgi API Get storage device information
(cgi-bin/storageDevice.cgi?action=getDeviceAllInfo).
password: The stringValue ard is Encrypted

6.4.4 Modify SD Card Password

Table 6-12

Syntax

http://<server>/cgi-bin/SDEncrypt.cgi?action=modifyPassword&deviceName=<device
Name>&password=<password>&oldPassword=<oldPassword>

Method

GET

Description

SD change password operation.

Example

http://192.168.1.108/cgi-bin/SDEncrypt.cgi?action=clearPassword&deviceName=/dev/
mmc0&password=123456&oldPassword=654321

Storage APIs 276

Success
Return

OK

Comment

If set successfully, return true, else return false.
deviceName: The stringValue is got from cgi API Get storage device information
(cgi-bin/storageDevice.cgi?action=getDeviceAllInfo).
password: The new stringValue Card is Encrypted
oldPassword: The old stringValue Card is Encrypted

6.4.5 Get SD Card Operate Error Policy

Table 6-13

Syntax

http://<server>/cgi-bin/SDEncrypt.cgi?action=getOperateErrorPolicy&deviceName=<de
viceName>&operate=<operate>

Method

GET

Description

When decrypt, clearPassword, modifyPassword failed, get the error info, leftTimes and
left time.

Example

Success
Return

Comment

http://192.168.1.108/cgi-bin/SDEncrypt.cgi?action=getOperateErrorPolicy&deviceNam
e=/dev/mmc0&operate=decrypt

policy.leftTimes=5
policy.lockSeconds=30

If set successfully, return true, else return false.
deviceName: the stringValue is got from cgi API Get storage device information
(cgi-bin/storageDevice.cgi?action=getDeviceAllInfo).
Operate: operate type, can be: decrypt, modifyPassword and clearPassword
leftTimes : remain operate times, max is 5
lockSeconds : lock operate time, unit is seconds, max is 30

6.4.6 [Config] Storage Health Alarm Settings

 Get StorageHealthAlarm config

Table 6-14

Syntax

http://<server>/cgi-bin/configManager.cgi?action=getConfig&name=StorageHealthAlar
m

Method

GET

Description

Get SD health info alarm config.

Example

Success
Return

Comment

http://<server>/cgi-bin/configManager.cgi?action=getConfig&name=StorageHealthAlar
m

table.StorageHealthAlarm.Enable=true
table.StorageHealthAlarm.LowerLimit=10
table.StorageHealthAlarm.EventHandler= (output of EventHandler is described in
GetEventHandler)
—

 Set StorageHealthAlarm config

Storage APIs 277

Table 6-15

Syntax

http://<server>/cgi-bin/configManager.cgi?action=setConfig&<paramName>=<paramV
alue>[&<paramName>=<paramValue>…]

Method

GET

Description

Set SD health info alarm config.

Example

Success
Return

Comment

http://192.168.1.108/cgi-bin/configManager.cgi?action=setConfig&StorageHealthAlarm.
Enable=true

OK

—

Storage APIs 278

7 Display APIs

7.1 GUI

7.1.1 [Config] GUISet

 Get GUISet config

Table 7-1

Syntax

Method

http://<server>/cgi-bin/configManager.cgi?action=getConfig&name=GUISet

GET

Description

Get the GUI settings. Every video out screen has a group setting.

Example

http://192.168.1.108/cgi-bin/configManager.cgi?action=getConfig&name=GUISet

Success
Return

table.GUISet[index].WindowAlpha=128
table.GUISet[index].TimeTitleEnable=true
table.GUISet[index].TimeTitlePos[0]=0
table.GUISet[index].TimeTitlePos[1]=0
table.GUISet[index].TimeTitlePos[2]=8191
table.GUISet[index].TimeTitlePos[3]=8191
table.GUISet[index].MenuShowOption=0
table.GUISet[index].MenuAutoHideTime=10
table.GUISet[index].AutoLogout=10
table.GUISet[index].ChannelTitleShowEnable=true
table.GUISet[index].ChannelTitlePos[0]=0
table.GUISet[index].ChannelTitlePos[1]=0
table.GUISet[index].ChannelTitlePos[2]=8191
table.GUISet[index].ChannelTitlePos[3]=8191
table.GUISet[index].AutoGuideEnable=true
…

Comment

Parameters in Response :
index: the array index which starts from 0.

 Set GUISet config

Table 7-2

Syntax

http://<server>/cgi-bin/configManager.cgi?action=setConfig&<paramName>=<paramV
alue>[&<paramName>=<paramValue>…]

Method

GET

Description

Set the GUI settings. Every video out screen has a group setting.

Example

http://192.168.1.108/cgi-bin/configManager.cgi?action=setConfig&GUISet[0].WindowAl
pha=192&GUISet[0].TimeTitleEnable=false&GUISet[0].MenuShowOption=1

Display APIs 279

Success
Return

OK

Comment

Appendix:

ParamName

Parameters in URL:
The paramName and paramValue are in the table below.
in table below,
index : the array index which starts from 0.

ParamValue type

Description

GUISet[index].WindowAlpha

GUISet[index].TimeTitleEnable

GUISet[index].TimeTitlePos[0]

GUISet[index].TimeTitlePos[1]

GUISet[index].TimeTitlePos[2]

GUISet[index].TimeTitlePos[3]

integer

bool

integer

integer

integer

integer

GUISet[index].MenuShowOption

integer

GUISet[index].MenuAutoHideTime

integer

GUISet[index].AutoLogout

integer

Diaphaneity
background.

of

the

window

Show the time title or not.

The position of the time title.

0: Show the directory.
1: Hide the directory.
2: Timing-hide the directory.

How many seconds
directory.

to hide

the

How many minutes to auto logout.
The range is [0-120]. 0 expresses not
logout.

GUISet[index].ChannelTitleShowEnable bool

Show the channel title or not.

GUISet[index].ChannelTitlePos[0]

GUISet[index].ChannelTitlePos[1]

GUISet[index].ChannelTitlePos[2]

GUISet[index].ChannelTitlePos[3]

GUISet[index].AutoGuideEnable

integer

integer

integer

integer

bool

The position of the channel title.

Auto guide or not when startup.

7.2 Split Screen

7.2.1 Split Screen Mode

 Get split screen mode

Table 7-3

Syntax

Method

http://<server>/cgi-bin/split.cgi?action=getMode&channel=<ChannelNo>

GET

Description

Get the split screen mode.

Example

Success
Return

http://192.168.1.108/cgi-bin/split.cgi?action=getMode&channel=1

mode=split1
group=4

Comment

Parameters in URL:

Display APIs 280

ChannelNo: the display screen No. Start from 1 and <= 2.

 Set split screen mode

Table 7-4

Syntax

http://<server>/cgi-bin/split.cgi?action=setMode&channel=<ChannelNo>&mode=<mo
de>&group=<group>

Method

GET

Description

Set the split screen mode.

Example

Success
Return

Comment

http://192.168.1.108/cgi-bin/split.cgi?action=setMode&channel=1&mode=split4&group
=1

OK

Parameters in URL:
ChannelNo: the display screen No. Start from 1.
mode:enum{split1,split2,split4,split6,split8,split9,split12,split16,split20,split25,split36,sp
lit64,split144,pip1,pip3, "Free", "CompositeSplit1" / "FitDisplayUnit1", "CompositeSplit1"
/ "FitDisplayUnit4"};
group: the No. of a group which contains certain number channels. For example, if 16
video channels display in split4 Mode which contains 4 video channels on Screen, then
there are 4 groups and each group contains 4 video channels.

7.3 Moniter Tour

7.3.1 [Config] Moniter Tour

 Get moniter tour config

Table 7-5

Syntax

Method

http://<server>/cgi-bin/configManager.cgi?action=getConfig&name=MonitorTour

GET

Description

Get monitor tour config.

Example

http://192.168.1.108/cgi-bin/configManager.cgi?action=getConfig&name=MonitorTour

Success
Return

Comment

table.MonitorTour[ch].Enable=128
table.MonitorTour[ch].Interval=true
table.MonitorTour[ch].Mask.Split1=0,1,5
table.MonitorTour[ch].Mask.Split8=0,1,5
table.MonitorTour[ch].Collections=Favortite1, Favortite2…
—

 Set moniter tour config

Table 7-6

Syntax

http://<server>/cgi-bin/configManager.cgi?action=setConfig&<paramName>=<paramV
alue>[&<paramName>=<paramValue>…]

Method

GET

Display APIs 281

Description

Set monitor tour config.

http://192.168.1.108/cgi-bin/configManager.cgi?action=setConfig&MonitorTour[0].Enabl
e=true

OK.

Parameters in URL:
The paramName and paramValue are in the table below.

ParamValue type

Description

bool

integer
—
—
—

MonitorTour or not.

MonitorTour interval.

Channel array for split1

Channel array for split8

Split collections

Example

Success
Return

Comment

Appendix:

ParamName

MonitorTour[ch].Enable

MonitorTour[ch].Interval

MonitorTour[ch].Mask.Split1

MonitorTour[ch].Mask.Split8

MonitorTour[ch].Collections

7.3.2 Enable Tour

Table 7-7

Syntax

http://<server>/cgi-bin/split.cgi?action=enableTour&channel=<ChannelNo>&enable=<fl
ag>

Method

GET

Description Enable tour in every video channel on a screen or not.

Example

Success
Return

Comment

http://192.168.1.108/cgi-bin/split.cgi?action=enableTour&channel=1&enable=true

OK

ChannelNo: the display screen No. Start from 1 and <= 2.
flag : true or false

7.3.3 [Config] Monitor Collection

 Get monitor collection config

Table 7-8

Syntax

Method

http://<server>/cgi-bin/configManager.cgi?action=getConfig&name=MonitorCollection

GET

Description

Get monitor collection config.

Example

http://192.168.1.108/cgi-bin/configManager.cgi?action=getConfig&name=MonitorCollec
tion

Success
Return

table.MonitorCollection.collectionname. Mode=Split1
table.MonitorCollection.collectionname.Windows[winno].Enable= true
table.MonitorCollection.collectionname.Windows[winno].Device=device1
table.MonitorCollection.collectionname.Windows[winno].VideoChannel=5
table.MonitorCollection.collectionname.Windows[winno].VideoStream=Main
table.MonitorCollection.collectionname.Windows[winno].AudioChannel=5

Display APIs 282

table.MonitorCollection.collectionname.Windows[winno].AudioStream=Main
…

Comment

Parameters in Response :
winno : integer, the array index which equals to the window index in a screen and starts
from 0.

 Set monitor collection config

Table 7-9

Syntax

http://<server>/cgi-bin/configManager.cgi?action=setConfig&<paramName>=<paramV
alue>[&<paramName>=<paramValue>…]

Method

GET

Description

Set monitor collection config.

http://192.168.1.108/cgi-bin/configManager.cgi?action=setConfig&MonitorCollection.Fa
vorite1.Mode=split4&MonitorCollection.Favorite1.Windows[1].Enable=true&MonitorColl
ection.Favorite1.Windows[1].VideoChannel=2

OK

Parameters in URL:
The paramName and paramValue are in the table below.
In table below:
Collect=MonitorCollection.collectionname.
collectionname: can be any name.
winno: integer, the array index which equals to the window index in a screen and starts
from 0.

ParamValue type

Description

Example

Success
Return

Comment

Appendix:

ParamName

Collect.Mode

Collect.Windows[winno].Enable

Collect.Windows[winno].Device

Collect.Windows[winno].VideoChannel

integer

Collect.Windows[winno].VideoStream

string

string

bool

string

range

The
SetSplitMode.

is

the

same as

Enable the window or not.

The device Id.

The video channel.

range

The
"Extra2", "Extra3", "Auto"}.

{"Main",

is

"Extra1",

"Extra1",

Collect.Windows[winno].AudioChannel

integer

The audio channel.

Collect.Windows[winno].AudioStream

string

range

The
"Extra2", "Extra3", "Auto"}.

{"Main",

is

Display APIs 283

8 Comm APIs

8.1 PTZ

8.1.1 [Config] PTZ Config

 Get PTZ config

Table 8-1

Syntax

Method

http://<server>/cgi-bin/configManager.cgi?action=getConfig&name=Ptz

GET

Description

Get PTZ config.

Example

http://192.168.1.108/cgi-bin/configManager.cgi?action=getConfig&name=Ptz

table.Ptz[port].Address=8
table.Ptz[port].Attribute[0]=115200
table.Ptz[port].Attribute[1]=8
table.Ptz[port].Attribute[2]=Even
table.Ptz[port].Attribute[3]=1
table.Ptz[port].Homing[0]=0
table.Ptz[port].Homing[1]=30
table.Ptz[port].NumberInMatrixs=0
table.Ptz[port].ProtocolName=NONE

Parameters in Response:
port is PTZ port index, start form 0.

Success
Return

Comment

 Set PTZ config

Syntax

http://<server>/cgi-bin/configManager.cgi?action=setConfig&<paramName>=<paramV
alue>[&<paramName>=<paramValue>…]

Table 8-2

Method

GET

Description

Set PTZ config.

Example

Success
Return

http://192.168.1.108/cgi-bin/configManager.cgi?action=setConfig&Ptz[0].Address=192.
168.0.1&Ptz[0].Attribute[0]=9600

OK

Comment

port in below ParamName is PTZ port index, start form 0.

Appendix:

ParamName

ParamValue type

Ptz[port].Address

integer

Description
Range is [0—255].
Device address, if there are more than one device

Comm APIs 284

ParamName

ParamValue type

Description

Ptz[port].Attribute[0]

integer

Ptz[port].Attribute[1]

integer

Ptz[port].Attribute[2]

string

Ptz[port].Attribute[3]

float

Ptz[port].Homing[0]

integer

Ptz[port].Homing[1]

integer

Ptz[port].ProtocolName

string

connected to this port, distinguish them by this
address.

The baud rate. Range is {1200, 2400, 4800, 9600,
19200, 38400, 57600, 115200}.

Range is {4, 5, 6, 7, 8}.
Data bit.

Range is {Even, Mark, None, Odd, Space}.
Parity verification mode.

Range is {1, 1.5, 2}.
Stop bit.
Range is {-1,0—255}
-1: homing is not enabled.
[0—255]: preset point number
Range is [0—65535].
No operation timeout, unit is seconds.
After no operation timeout, PTZ go to preset point
set in Ptz[port].Homing[0].

PTZ protocol name depends on PTZ capability.
Refer to GetProtocolList to get the protocol list.

Ptz[port].ControlDelayTime

integer

PTZ control delay time, unit: second

Ptz[port].ControlPriority

string

PTZ control priority,the range is "RS485", "Net".
default : "Net"

8.1.2 Get PTZ Protocol List

Table 8-3

Syntax

Method

http://<server>/cgi-bin/ptz.cgi?action=getProtocolList[&channel=<ChannelNo>]

GET

Description

Get the protocol list that PTZ can support. Unsupported now.

Example

http://192.168.1.108/cgi-bin/ptz.cgi?action=getProtocolList&channel=1

Success
Return

info.RS[0]=Pelco
info.RS[1]=DH-SD1
info.Coaxial[0]=HD-CVI
info.Coaxial[1]=HD-CVI2.0

Comment

Response contains all support PTZ protocols of the server.
ChannelNo: integer, video channel index which starts from 1.

8.1.3 Get PTZ Capability of Current Protocol

Table 8-4

Syntax

Method

http://<server>/cgi-bin/ptz.cgi?action=getCurrentProtocolCaps[&channel=<ChannelNo>]

GET

Description Get PTZ channel protocol capabilities.

Comm APIs 285

Example

http://192.168.1.108/cgi-bin/ptz.cgi?action=getCurrentProtocolCaps&channel=1

Success
Return

caps.AlarmLen=0
caps.AuxMax=8
caps.AuxMin=1
caps.CamAddrMax=255
caps.CamAddrMin=1
caps.Flip=false
caps.Focus=false
caps.Interval=200
caps.Iris=false
caps.Menu=false
caps.MonAddrMax=255
caps.MonAddrMin=0
caps.Name=DH-SD1
caps.Pan=false
caps.PanSpeedMax=255
caps.PanSpeedMin=1
caps.PatternMax=5
caps.PatternMin=1
caps.PresetMax=80
caps.PresetMin=1
caps.Tile=false
caps.TileSpeedMax=255
caps.TileSpeedMin=1
caps.TourMax=7
caps.TourMin=0
caps.Type=1
caps.Zoom=false
caps.PtzMotionRange.HorizontalAngle[0]=0
caps.PtzMotionRange.HorizontalAngle[1]=360
caps.PtzMotionRange.VerticalAngle[0]=-20
caps.PtzMotionRange.VerticalAngle[1]=90
caps.ZoomMax=30
caps.ZoomMin=1

Comment

Parameters in URL:
ChannelNo: PTZ channel index which starts from 1.

Appendix:

Field in response

Description

AlarmLen

AuxMax

AuxMin

CamAddrMax

CamAddrMin

Flip

Focus

Iris

Alarm length in protocol.

Maximum/Minimum number for auxiliary functions.

Maximum/Minimum channel address.

True or false, support picture flip or not.

True or false, support focus or not.

True or false, support Iris adjusts or not.

Comm APIs 286

Field in response

Description

Menu

MonAddrMax

MonAddrMin

Name

Pan

PanSpeedMax

PanSpeedMin

PatternMax

PatternMin

PresetMax

PresetMin

Tile

Zoom

TileSpeedMax

TileSpeedMin

TourMax

TourMin

Type

PtzMotionRange.HorizontalAngle

PtzMotionRange.VerticalAngle

True or false, support internal menu of the PTZ or not.

Maximum/Minimum monitor address.

Name of the operation protocol.

True or false, support pan or not.

Maximum/Minimum pan speed.

Maximum/Minimum pattern path number.

Maximum/Minimum preset point number.

True or false, support tilt or not.

True or false, support zoom or not.

Maximum/Minimum tile speed.

Maximum/Minimum tour path number.

Type of PTZ protocol.
Horizontal angle range，[0] for minimum angle，[1] for maximum
angle
it only when Pan was true
Vertical angle range，[0] for minimum angle，[1] for maximum angle
it only when Tile was true

ZoomMax

ZoomMin

Maximum/Minimum Zoom.
it only when Zoom was true

8.1.4 Get PTZ Status

Table 8-5

Syntax

Method

http://<server>/cgi-bin/ptz.cgi?action=getStatus[&channel=<ChannelNo>]

GET

Description

Get PTZ status.

Example

http://192.168.1.108/cgi-bin/ptz.cgi?action=getStatus&channel=1

Success
Return

status.UTC=6538920
status.MoveStatus=Idle
status.ZoomStatus=Idle
status.PresetID=10
status.Position=120,12,2

Comment

ChannelNo: integer, video channel index which starts from 1.

8.1.5 PTZ Control

 PTZ Basic Movement

Start moving the PTZ.

Comm APIs 287

http://<server>/cgi-bin/ptz.cgi?action=start
GET

Request URL
Method
Request Params ( key=value format in URL )
Name
channel
code

R/O Description
Type
int
R
char[16] R

arg1

arg2

arg3

int

int

int

O

O

O

The PTZ channel index; starting from 1
See the following table for the operation
codes for PTZ movement.
Operation parameter 1: See the following
table for the meaning of the operation code.
Operation parameter 2: See the following
table for the meaning of the operation code.
Operation parameter 3: See the following
table for the meaning of the operation code.

Example
1
"Up"

0

1

0

Request Example
http://192.168.1.108/cgi-bin/ptz.cgi?action=start&channel=1&code=Up&arg1=0&arg2=1&arg3=0

Response Params ( OK in body )
Response Example
OK

Stop moving the PTZ.

http://<server>/cgi-bin/ptz.cgi?action=stop
GET

Request URL
Method
Request Params ( key=value format in URL )
Name
channel
code

R/O Description
Type
int
R
char[16] R

The PTZ channel index; starting from 1
See the following table for the operation
codes for PTZ movement.
Operation Parameter 1, reserved.
Operation Parameter 2, reserved.
Operation Parameter 3, reserved.

Example
1
"Up"

0
0
0

arg1
arg2
arg3

int
int
int

O
O
O

Request Example
http://192.168.1.108/cgi-bin/ptz.cgi?action=stop&code=Up&channel=1&arg1=0&arg2=0&arg3=0

Response Params ( OK in body )
Response Example
OK

Appendix: Operation codes for PTZ movement and the parameters.

Code

Code description

arg1

arg2

arg3

Up

Move up

Down

Move down

Left

Move left

0

0

0

Vertical motion
range: [1–8]

Vertical motion
range: [1–8]

speed;

speed;

Horizontal motion speed;
range: [1–8]

0

0

0

Comm APIs 288

Code

Code description

arg1

arg2

arg3

Right

Move right

0

Horizontal motion speed;
range: [1–8]

LeftUp

RightUp

Move in an upper-left
direction

Vertical motion speed;
range: [1–8]

Horizontal motion speed;
range: [1–8]

Move in an upper-right
direction

Vertical motion speed;
range: [1–8]

Horizontal motion speed;
range: [1–8]

LeftDown

Move in an lower-left
direction

Vertical motion speed;
range: [1–8]

Horizontal motion speed;
range: [1–8]

RightDown

Move in an lower-right
direction

Vertical motion speed;
range: [1–8]

Horizontal motion speed;
range: [1–8]

ZoomWide Zoom in

ZoomTele

Zoom out

FocusNear Focus (near-field)

FocusFar

Focus (far-field)

IrisLarge

Increase the aperture

0

0

0

0

0

IrisSmall

Decrease the aperture 0

 PTZ Continuously Moving

Start continuously moving the PTZ

0

0

0

0

0

0

0

0

0

0

0

0

0

0

0

0

0

http://<server>/cgi-bin/ptz.cgi?action=start&code=Continuously
GET

Request URL
Method
Request Params ( key=value format in URL )
Name
channel
code

R/O Description
Type
R
int
char[16] R

The PTZ channel index; starting from 1
PTZ continuously moving operation code,
must be "Continuously".
See the table below for the motion direction
and step length.
See the table below for the motion direction
and step length.
Zooming speed; range: [-100–100]
Overtime period; unit: s (maximum 3600 s).
If the PTZ does not receive the stop
command before
the preset overtime
period, it will stop moving automatically.

Example
1
"Continuously"

5

5

5
60

arg1

arg2

arg3
arg4

int

int

int
int

O

O

O
O

Request Example
http://192.168.1.108/cgi-bin/ptz.cgi?action=start&code=Continuously&channel=1&arg1=5&arg2=5&arg3
=5&arg4=60

Response Params ( OK in body )
Response Example
OK

Appendix: Direction of the continuous movement of the PTZ and the step length parameters.

Move description

arg1

arg2

Comm APIs 289

Move description

Continuously move left

Continuously move right

Continuously move up

Continuously move down

Continuously move in an
upper-left direction

Continuously move in an
upper-right direction

Continuously move
lower-left direction

Continuously move
lower-right direction

in a

in a

arg1

< -4

> 4

0

0

< -4

> 4

< -4

> 4

Stop continuously moving the PTZ

arg2

0

0

> 4

< -4

> 4

> 4

< -4

＜ -4

http://<server>/cgi-bin/ptz.cgi?action=stop&code=Continuously
GET

Request URL
Method
Request Params ( key=value format in URL )
Name
channel
code

R/O Description
Type
int
R
char[16] R

The PTZ channel index; starting from 1
PTZ continuously moving operation code,
must be "Continuously".
Operation Parameter 1, reserved.
Operation Parameter 2, reserved.
Operation Parameter 3, reserved.
Operation Parameter 4, reserved.

Example
1
"Continuously"

0
0
0
0

arg1
arg2
arg3
arg4

int
int
int
int

O
O
O
O

Request Example
http://192.168.1.108/cgi-bin/ptz.cgi?action=stop&code=Continuously&channel=1&arg1=0&arg2=0&arg3
=0&arg4=0

Response Params ( OK in body )
Response Example
OK



3D Positioning

The PTZ moves to the specified position [startX, startY], [endX, endY] on the screen through 3D
positioning .

http://<server>/cgi-bin/ptzBase.cgi?action=moveDirectly
GET

Request URL
Method
Request Params ( key=value format in URL )
Name
channel
startPoint

R/O Description
R
R

Type
int
int[2]

The PTZ channel index; starting from 1
The start point of the target matrix [startX,
startY]; relative coordinate; the value of X
and Y is normalized to a number between 0
and 8192.
The end point of the target matrix [startX,

endpoint

int[2]

R

Example
1
[7253,2275]

[7893,3034]

Comm APIs 290

startY]; relative coordinate; the value of X
and Y is normalized to a number between 0
and 8192.

Request Example
http://192.168.1.108/cgi-bin/ptzBase.cgi?action=moveDirectly&channel=1&startPoint[0]=7253&startPoin
t[1]=2275&endPoint[0]=7893&endPoint[1]=3034

Response Params ( OK in body )
Response Example
OK

 Relative PTZ Movement

Relative PTZ movement

http://<server>/cgi-bin/ptz.cgi?action=moveRelatively
GET

Request URL
Method
Request Params ( key=value format in URL )
Name
channel
arg1
arg2
arg3

R/O Description
Type
R
int
double O
double O
double O

The PTZ channel index; starting from 1
Relative horizontal motion; normalized to [-1, 1] 0.1
0.1
Relative vertical motion; normalized to [-1, 1]
0.5
Relative zoom; normalized to [-1, 1]

Example
1

Request Example
http://192.168.1.108/cgi-bin/ptz.cgi?action=moveRelatively&channel=1&arg1=0.1&arg2=0.1&arg3=0.5

Response Params ( OK in body )
Response Example
OK

 Accurate PTZ Positioning

Accurate PTZ positioning; the actual parameter range depends on the device. For capability details,
execute the command mentioned in "8.1.3 Get PTZ Capability of Current Protocol".

http://<server>/cgi-bin/ptz.cgi?action=moveAbsolutely
GET

Request URL
Method
Request Params ( key=value format in URL )
Name
channel
arg1

R/O Description
Type
int
R
double O

The PTZ channel index; starting from 1
Relative horizontal position; normalized to [-1, 1];
arg1 < 0: Angle = 180.0 × arg1 + 360.0, and the
actual range is [180.0, 360.0];
arg1 ≥ 0: Angle = 180.0 × arg1, and the actual
range is [0, 180.0]
Absolute vertical position; normalized to [-1, 1];
Angle = -180.0 × arg2 , the actual range is
[-180.0, 180.0]
Absolute zoom; normalized to [-1, 1]

Example
1
-0.8

0.3

0.5

arg2

double O

arg3

double O

Request Example

Comm APIs 291

http://192.168.1.108/cgi-bin/ptz.cgi?action=moveAbsolutely&channel=1&arg1=-0.8&arg2=0.3&arg3=0.5

Response Params ( OK in body )
Response Example
OK

8.1.6 Preset

 Getting Preset Information

Get the preset information

http://<server>/cgi-bin/ptz.cgi?action=getPresets
GET

Request URL
Method
Request Params ( key=value format in URL )
Name
channel

R/O Description
O

Type
int

Video channel number, starting from 1; the
default value is 1.

Request Example
http://192.168.1.108/cgi-bin/ptz.cgi?action=getPresets&channel=1

Example
1

Response Params ( key=value format in body )
R/O Description
Type
Name
R
object[]
presets
R
int
+Index
char[256] O
+Name

+Type

int

O

+PresetFunction

char[16] O

+Position

int[3]

O

Response Example
presets[0].Index=1

Example

1
"preset1"
0

"VideoBlack
"

[900, -900,
5]

List of preset information
The preset number; starting from 1
The preset name
Preset type
0: Normal preset
1: Preset configured with smart rules
2: Special preset
Function List of the Special Presets
"VideoBlack": Day/Night Mode (B/W)
"VideoColor": Day/Night Mode (Color)
"VideoBrightness": Day/Night Mode (Auto)
The coordinate of the preset and zoom; three
integers
The first parameter is the horizontal coordinate;
range: [0,3599], referring to 0° to 359.9° (the
number of degree is expanded by 10 times).
The second parameter is the vertical coordinate;
range: [-1800,1800], referring to -180° to 180°
(the number of degree is expanded by 10
times).
The third parameter is the expansion parameter;
range: [0,128], referring to the zoom range.

Comm APIs 292

presets[0].Name=Preset 1
presets[0].Type=0
presets[0].PresetFunction="VideoBlack"
presets[0].Position=[900, -900, 5]
…

 Moving to the Preset

Move to the preset.

http://<server>/cgi-bin/ptz.cgi?action=start&code=GotoPreset
GET

Request URL
Method
Request Params ( key=value format in URL )
Name
channel
arg1
arg2
arg3

R/O Description
R
O
R
O

Type
int
int
int
int

The PTZ channel index; starting from 1
Ignore
The preset number; starting from 1
Ignore

Example
1
0
1
0

Request Example
http://192.168.1.108/cgi-bin/ptz.cgi?action=start&code=GotoPreset&channel=1&arg1=0&arg2=1&arg3=
0

Response Params ( OK in body )
Response Example
OK

 Configuring Preset

Configure a preset.

http://<server>/cgi-bin/ptz.cgi?action=start&code=SetPreset
GET

Request URL
Method
Request Params ( key=value format in URL )
Name
channel
arg1
arg2
arg3
Request Example
http://192.168.1.108/cgi-bin/ptz.cgi?action=start&code=SetPreset&channel=1&arg1=0&arg2=2&arg3=0

The PTZ channel index; starting from 1
Ignore
The preset number; starting from 1
Ignore

R/O Description
R
O
R
O

Example
1
0
1
0

Type
int
int
int
int

Response Params ( OK in body )
Response Example
OK

 Configuring Preset Name

Configure a name for the preset.

Request URL
Method
Request Params ( key=value format in URL )

http://<server>/cgi-bin/ptz.cgi?action=SetPreset
GET

Comm APIs 293

Name
channel
arg1
arg2

Type
R/O Description
int
R
R
int
char[256] R

The PTZ channel index; starting from 1
The preset number; starting from 1
The preset name

Example
1
2
"preset2"

Request Example
http://192.168.1.108/cgi-bin/ptz.cgi?action=SetPreset&channel=1&arg1=2&arg2=preset2

Response Params ( OK in body )
Response Example
OK

 Deleting Preset

Delete a preset.

http://<server>/cgi-bin/ptz.cgi?action=start&code=ClearPreset
GET

Request URL
Method
Request Params ( key=value format in URL )
Name
channel
arg1
arg2
arg3

R/O Description
R
O
R
O

Type
int
int
int
int

The PTZ channel index; starting from 1
Ignore
The preset number; starting from 1
Ignore

Example
1
0
2
0

Request Example
http://192.168.1.108/cgi-bin/ptz.cgi?action=start&code=ClearPreset&channel=1&arg1=0&arg2=2&arg3
=0

Response Params ( OK in body )
Response Example
OK

8.1.7 Tour

 Start the tour

Syntax

http://<server>/cgi-bin/ptz.cgi?action=start&channel=<ch>&code=StartTour&arg1=<index

> &arg2=0&arg3=0

Table 8-6

Method

GET

Description Start the tour.

Example

Success
Return

Comment

http://192.168.1.108/cgi-bin/ptz.cgi?action=start&channel=1&code=StartTour&arg1=1&arg
2=0&arg3=0

OK

Parameters in URL:
ch is PTZ channel index which starts from 1. Range is [1 — n].
arg1 is the number of tour route

Comm APIs 294

 Stop the tour

Table 8-7

Syntax

http://<server>/cgi-bin/ptz.cgi?action=start&channel=<ch>&code=StopTour&arg1=<index

> &arg2=0&arg3=0

Method

GET

Description Stop the tour.

Example

Success
Return

Comment

http://192.168.1.108/cgi-bin/ptz.cgi?action=start&channel=1&code=StopTour&arg1=1&arg
2=0&arg3=0

OK

Parameters in URL:
ch is PTZ channel index which starts from 1. Range is [1 — n].
arg1 is the number of tour route

 Add tour group

Table 8-8

Syntax

http://<server>/cgi-bin/ptz.cgi?action=setTour&channel=<ch>&arg1=<index>&arg2=<nam
e>

Method

GET

Descriptio
n

Add tour group, including set the tour route and name. Frequently used with add tour
preset.

Example

http://192.168.1.108/cgi-bin/ptz.cgi?action=setTour&channel=1&arg1=1&arg2=1

Success
Return

OK

Comment

Parameters in URL:
ch is PTZ channel index which starts from 1. Range is [1 — n].
arg1 is the number of tour route
arg2 is tour name

 Delete tour group

Table 8-9

Syntax

http://<server>/cgi-bin/ptz.cgi?action=start&channel=<ch>&code=ClearTour&arg1=<inde
x>&arg2=0&arg3=0

Method

GET

Description Delete the tour group with specified number.

Example

Success
Return

Comment

http://192.168.1.108/cgi-bin/ptz.cgi?action=start&channel=1&code=ClearTour&arg1=1&ar
g2=0&arg3=0

OK

Parameters in URL:
ch is PTZ channel index which starts from 1. Range is [1 — n].
arg1 is the number of tour group

 Add tour preset

Comm APIs 295

Syntax

http://<server>/cgi-bin/ptz.cgi?action=start&channel=<ch>&code=AddTour&arg1=<index
1>&arg2=<index2>&arg3=0

Table 8-10

Method

GET

Description Add preset to tour group.

Example

Success
Return

Comment

http://192.168.1.108/cgi-bin/ptz.cgi?action=start&channel=1&code=AddTour&arg1=1&arg
2=2&arg3=0

OK

Parameters in URL:
ch is PTZ channel index which starts from 1. Range is [1 — n].
arg1 is the number of tour route
arg2 is the number of preset

 Delete tour preset

Table 8-11

Syntax

http://<server>/cgi-bin/ptz.cgi?action=start&channel=<ch>&code=DelTour&arg1=<index1

> &arg2=<index2>&arg3=0

Method

GET

Description Delete the specified preset from a particular tour group.

Example

Success
Return

Comment

http://192.168.1.108/cgi-bin/ptz.cgi?action=start&channel=1&code=DelTour&arg1=1&arg2
=2&arg3=0

OK

Parameters in URL:
ch is PTZ channel index which starts from 1. Range is [1 — n].
arg1 is the number of tour route
arg2 is the number of preset

8.1.8 Scan

 Set left boundary

Syntax

http://<server>/cgi-bin/ptz.cgi?action=start&channel=<ch>&code=SetLeftLimit&arg1=<ind
ex>&arg2=0&arg3=0

Table 8-12

Method

GET

Description Set left boundary.

Example

Success
Return

Comment

http://192.168.1.108/cgi-bin/ptz.cgi?action=start&channel=1&code=SetLeftLimit&arg1=1&
arg2=0&arg3=0

OK

Parameters in URL:
ch is PTZ channel index which starts from 1. Range is [1 — n].

Comm APIs 296

arg1 is the scan number

 Set right boundary

Syntax

http://<server>/cgi-bin/ptz.cgi?action=start&channel=<ch>&code=SetRightLimit&arg1=<in
dex>&arg2=0&arg3=0

Table 8-13

Method

GET

Description Set right boundary.

Example

Success
Return

Comment

http://192.168.1.108/cgi-bin/ptz.cgi?action=start&channel=1&code=SetRightLimit&arg1=1
&arg2=0&arg3=0

OK

Parameters in URL:
ch is PTZ channel index which starts from 1. Range is [1 — n].
arg1 is the scan number

 Start scan

Table 8-14

Syntax

http://<server>/cgi-bin/ptz.cgi?action=start&channel=<ch>&code=AutoScanOn&arg1=<in
dex>&arg2=0&arg3=0

Method

GET

Description Start scanning.

Example

Success
Return

Comment

http://192.168.1.108/cgi-bin/ptz.cgi?action=start&channel=1&code=AutoScanOn&arg1=1
&arg2=0&arg3=0

OK

Parameters in URL:
ch is PTZ channel index which starts from 1. Range is [1—n].
arg1 is scan number

 Stop scan

Table 8-15

Syntax

http://<server>/cgi-bin/ptz.cgi?action=start&channel=<ch>&code=AutoScanOff&arg1=<in
dex>&arg2=0&arg3=0

Method

GET

Description Stop scanning.

Example

Success
Return

Comment

http://192.168.1.108/cgi-bin/ptz.cgi?action=start&channel=1&code=AutoScanOff&arg1=1
&arg2=0&arg3=0

OK

Parameters in URL:
ch is PTZ channel index which starts from 1. Range is [1 — n].
arg1 is scan number

Comm APIs 297

8.1.9 Pattern

 Start pattern record

Syntax

http://<server>/cgi-bin/ptz.cgi?action=start&channel=<ch>&code=SetPatternBegin&arg1=
<index>&arg2=0&arg3=0

Table 8-16

Method

GET

Description Start pattern record.

Example

Success
Return

Comment

http://192.168.1.108/cgi-bin/ptz.cgi?action=start&channel=1&code=SetPatternBegin&arg1
=1&arg2=0&arg3=0

OK

Parameters in URL:
ch is PTZ channel index which starts from 1. Range is [1 — n].
arg1 is pattern number

 Stop pattern record

Table 8-17

Syntax

http://<server>/cgi-bin/ptz.cgi?action=start&channel=<ch>&code=SetPatternEnd&arg1=<i
ndex>&arg2=0&arg3=0

Method

GET

Description Stop pattern record.

Example

Success
Return

Comment

http://192.168.1.108/cgi-bin/ptz.cgi?action=start&channel=1&code=SetPatternEnd&arg1=
1&arg2=0&arg3=0

OK

Parameters in URL:
ch is PTZ channel index which starts from 1. Range is [1 — n].
arg1 is pattern number

 Start pattern

Table 8-18

Syntax

http://<server>/cgi-bin/ptz.cgi?action=start&channel=<ch>&code=StartPattern&arg1=<ind
ex>&arg2=0&arg3=0

Method

GET

Description Start pattern.

Example

Success
Return

Comment

http://192.168.1.108/cgi-bin/ptz.cgi?action=start&channel=1&code=StartPattern&arg1=1&
arg2=0&arg3=0

OK

Parameters in URL:
ch is PTZ channel index which starts from 1. Range is [1 — n].
arg1 is pattern number

Comm APIs 298

 Stop pattern

Table 8-19

Syntax

http://<server>/cgi-bin/ptz.cgi?action=start&channel=<ch>&code=StopPattern&arg1=<ind
ex>&arg2=0&arg3=0

Method

GET

Description Stop pattern.

Example

Success
Return

Comment

http://192.168.1.108/cgi-bin/ptz.cgi?action=start&channel=1&code=StopPattern&arg1=1&
arg2=0&arg3=0

OK

Parameters in URL:
ch is PTZ channel index which starts from 1. Range is [1 — n].
arg1 is pattern number

8.1.10 Pan

 Start pan

Syntax

http://<server>/cgi-bin/ptz.cgi?action=start&channel=<ch>&code=AutoPanOn&arg1=0&ar
g2=0&arg3=0

Table 8-20

Method

GET

Description Start pan.

Example

Success
Return

Comment

http://192.168.1.108/cgi-bin/ptz.cgi?action=start&channel=1&code=AutoPanOn&arg1=0&
arg2=0&arg3=0

OK

Parameters in URL:
ch is PTZ channel index which starts from 1. Range is [1 — n].

 Stop pan

Table 8-21

Syntax

http://<server>/cgi-bin/ptz.cgi?action=start&channel=<ch>&code=AutoPanOff&arg1=0&ar
g2=0&arg3=0

Method

GET

Description Stop pan.

Example

Success
Return

http://192.168.1.108/cgi-bin/ptz.cgi?action=start&channel=1&code=AutoPanOff&arg1=0&
arg2=0&arg3=0

OK

Comment

Parameters in URL:
ch is PTZ channel index which starts from 1. Range is [1 — n].

Comm APIs 299

8.1.11 [Config] PTZ Auto Movement

 Get PTZ auto movement configuration

Table 8-22

Syntax

Method

http://<server>/cgi-bin/configManager.cgi?action=getConfig&name=PtzAutoMovement

GET

Description

Get PTZ auto movement configuration.

Example

http://192.168.1.108/cgi-bin/configManager.cgi?action=getConfig&name=PtzAutoMove
ment

Success
Return

table.PtzAutoMovement[port][Task].Enable = true
table.PtzAutoMovement[port][Task].TimeSection[week][section] = 0 00:00:00-23:59:59
…
table.PtzAutoMovement[port][Task].Function = None
table.PtzAutoMovement[port][Task].ScanId = 0
table.PtzAutoMovement[port][Task].PresetId = 0
table.PtzAutoMovement[port][Task].PatternId = 0
table.PtzAutoMovement[port][Task].TourId = 0
table.PtzAutoMovement[port][Task].AutoHoming.Time = 30
table.PtzAutoMovement[port][Task].SnapshotEnable = false
table.PtzAutoMovement[port][Task].SnapshotDelayTime = 30

Comment

Parameters in Response:
port is PTZ port index, start from 0.
Task is the number of task, start from 0.
week: from 1 to 7.
section: time section, from 0 to 5.

 Set PTZ auto movement

Table 8-23

Syntax

http://<server>/cgi-bin/configManager.cgi?action=setConfig&<paramName>=<paramV
alue>[&<paramName>=<paramValue>…]

Method

GET

Description

Set PTZ auto movement.

Example

Success
Return

Comment

http://192.168.1.108/cgi-bin/configManager.cgi?action=setConfig&PtzAutoMovement[0]
[0].Function=Preset&PtzAutoMovement[0][0].PresetId=1

OK

Parameters in URL:
In table below,
head=PtzAutoMovement[port][task]
port is PTZ port index, start from 0.
task is the number of task, start from 0.
week: from 1 to 7.
section: time section, from 0 to 5.

Comm APIs 300

Appendix:

ParamName

head.Enable

ParamValue type Description

bool

Enable/Disable PtzAutoMovement

head.TimeSection

timeSchedule

head.Function

head.ScanId

head.PresetId

head.PatternId

head.TourId

head.AutoHoming.Time

head.SnapshotEnable

string

integer

integer

integer

integer

integer

bool

timeSchedule[week][section]=1 10:00:00-11:00:00
…

Range is {Scan, Preset, Pattern, Tour}.

Scan Id, start from 1

Preset Id, start from 1

Pattern Id, start from 1

Tour Id, start from 1

Recover time, unit is second.

Enable/Disable Snap, when "Fuction" is "Preset".

head.SnapshotDelayTime

integer

Delay time of snap, when "Fuction" is "Preset".

8.1.12 PTZ Restart

Syntax

http://<server>/cgi-bin/ptz.cgi?action=start&channel=<ch>&code=Restart&arg1=0&arg
2=0&arg3=0

Table 8-24

Method

GET

Description

PTZ restart.

Example

Success
Return

Comment

http://192.168.1.108/cgi-bin/ptz.cgi?action=start&channel=1&code=Restart&arg1=0&ar
g2=0&arg3=0

OK

Parameters in URL:
ch is PTZ channel index which starts from 1. Range is [1 — n].

8.1.13 PTZ Reset

Syntax

http://<server>/cgi-bin/ptz.cgi?action=start&channel=<ch>&code=Reset&arg1=0&arg2
=0&arg3=0

Table 8-25

Method

GET

Description

PTZ reset.

Example

Success
Return

Comment

http://192.168.1.108/cgi-bin/ptz.cgi?action=start&channel=1&code=Reset&arg1=0&arg
2=0&arg3=0

OK

Parameters in URL:
ch is PTZ channel index which starts from 1. Range is [1 — n].

Comm APIs 301

8.1.14 OSD Menu

 Enter the menu

Syntax

http://<server>/cgi-bin/ptz.cgi?action=start&channel=<ch>&code=Menu&arg1=0&arg2
=0&arg3=0

Table 8-26

Method

GET

Description

Enter the menu.

Example

Success
Return

Comment

http://192.168.1.108/cgi-bin/ptz.cgi?action=start&channel=1&code=Menu&arg1=0&arg
2=0&arg3=0

OK

Parameters in URL:
ch is PTZ channel index which starts from 1. Range is [1 — n].

 Exit the menu

Table 8-27

Syntax

http://<server>/cgi-bin/ptz.cgi?action=start&channel=<ch>&code=Exit&arg1=0&arg2=0&
arg3=0

Method

GET

Description Exit the menu.

Example

Success
Return

Comment

http://192.168.1.108/cgi-bin/ptz.cgi?action=start&channel=1&code=Exit&arg1=0&arg2=0
&arg3=0

OK

Parameters in URL:
ch is PTZ channel index which starts from 1. Range is [1 — n].

 Confirm

Table 8-28

Syntax

http://<server>/cgi-bin/ptz.cgi?action=start&channel=<ch>&code=Enter&arg1=0&arg2=0
&arg3=0

Method

GET

Description Confirm the menu.

Example

Success
Return

Comment

http://192.168.1.108/cgi-bin/ptz.cgi?action=start&channel=1&code=Enter&arg1=0&arg2=
0&arg3=0

OK

Parameters in URL:
ch is PTZ channel index which starts from 1. Range is [1 — n].

 Start the basic operation of menu

Table 8-29

Comm APIs 302

Syntax

http://<server>/cgi-bin/ptz.cgi?action=start&channel=<ch>&code=<code>&arg1=<arg1

> &arg2=<arg2>&arg3=<arg3>

Method

GET

Description

Start the basic operation of menu.

http://192.168.1.108/cgi-bin/ptz.cgi?action=start&channel=1&code=MenuUp&arg1=0&
arg2=0&arg3=0

OK

Parameters in URL:
ch is PTZ channel index which starts from 1. Range is [1 — n].
code is PTZ operation, and arg1, arg2, arg3 are arguments of operation.
code and argN values are listed in table below.

Example

Success
Return

Comment

Appendix:

Code

Code description

arg1

arg2

arg3

MenuUp

MenuUp

MenuDown

MenuDown

MenuLeft

MenuLeft

MenuRight

MenuRight

0

0

0

0

0

0

0

0

0

0

0

0

8.1.15 [Config] Set up electronic PTZ

Request URL

http://<server>/cgi-bin/configManager.cgi?action=setConfig&<paramName>=<
paramValue>[&<paramName>=<paramValue>…]

Method

GET

Request Params (key=value format at URL )

Name

EptzLink[channel].Ena
ble

Type

bool

R/O

O

EptzLink[channel].Dis
playMode

char[32]

O

EptzLink[channel].Tra
ckEnable

bool

O

Description

Whether to enable the
electronic PTZ function in
this channel.
Channel indicates the
channel number

Display mode, used to
select the number of
channels to track;
Options are:
"original" - normal mode;
"Oneplusone" - 1 + 1 mode;
"Oneplusthree" - 1 + 3
mode;
"Oneplusfive" - 1 + 5 mode

Whether to start linkage
tracking;
True - on,
False close

Example

true

"Original"

true

EptzLink[channel].Tra

char[32]

O

Tracking duration options,

"Manual"

Comm APIs 303

ckTime

EptzLink[channel].Ma
nualTrackTime[i]

uint16

O

EptzLink[channel].Tra
ckRect[i][j][k]

uint32

O

including full-time tracking
and manual configuration of
tracking duration.
"Fulltimetrack": full-time
tracking, indicating that the
tracking duration lasts until
the target disappears;
"Manual": customize the
tracking duration. If this
mode is selected, it will be
tracked according to the
user configured tracking
duration.

If tracktime is in "manual"
mode, it will be tracked
according to the tracking
duration range configured
by the user in this field
([minimum tracking time,
maximum tracking time]),
which can be configured for
5-300 seconds. The
maximum duration of
tracking is the
disappearance time of the
target. For example, if the
tracking duration is set to 50
seconds and the target
disappears in 30 seconds,
the tracking will stop). ‘I’
represents the index of the
array, and ‘i’ can take 0 or 1

The coordinate information
of the tracking target frame
represents one of the
points. The first dimension
represents the display
mode, the second
dimension represents the
number of frames, and the
third dimension is the
bounding box of the
rectangular frame, which is
normalized to the 8192
coordinate system.

5

2047

Example

http://192.168.1.108/cgi-bin/configManager.cgi?action=setConfig&EptzLink[0].Enable=true

Comm APIs 304

8.1.16 Get View Range Status

http://<server>/cgi-bin/api/ptz/getViewRangeStatus
POST

Request URL
Method
Request Params ( JSON format in body )
Type
Name
int32
Channel

R/O
R

Description
Video channel number,
starting from 0

Example
0

Request Example
{
"Channel": 0
}

Response Params ( JSON format in body )
Name
status

R/O Description
否

Type
object

+Distance

double

+AngelH

double

+AzimuthH

double

否

否

否

+AngelV

double

+AzimuthV

double

否

否

view range status
Visual distance in
meters
Horizontal viewing angle
Unit: degrees
Horizontal azimuth
angle
(The angle between the
central axis of the
included angle projected
by the visual field on the
horizontal plane and the
reference axis on the
horizontal plane)
Expressed in radians,
normalized to - 1~1.
Turn counterclockwise
for positive direction
Vertical viewing angle
Unit: degrees
Vertical azimuth angle
(The angle between the
central axis of the
included angle projected
by the visual field on the
vertical plane and the
angle of the reference
axis on the vertical
plane)

Example

20.0

30.5

0.5

30.5

0.5

Comm APIs 305

0.5

Expressed in radians,
normalized to - 1~1.
Horizontal inclination
angle
(The included angle
between the equipment
horizontal datum plane
and the horizontal
plane)
Unit: degrees
Normalized to - 1~1.

+InclinationH

double

否

Response Example
{

"status" : {

        "Distance" : 20.0,
        "AngelH" : 30.5,
        "AzimuthH" : 0.5,
        "AngelV" : 30.5,
        "AzimuthV" : 0.5,
        "InclinationH" : 0.5

}

}

8.2 Wiper

8.2.1 Move Continuously

Make the wiper continuously move until you call the stopMove function to stop it.

http://<server>/cgi-bin/rainBrush.cgi?action=moveContinuously
GET

Request URL
Method
Request Params ( key=value format in URL )
Name
channel

R/O Description
O

Type
int

Video channel number, starting from 1; the default
value is 1
Interval for the motion of the wiper; unit: second

Example
1

5

interval

int

R

Request Example
http://192.168.1.108/cgi-bin/rainBrush.cgi?action=moveContinuously&channel=1&interval=5

Response Params ( OK in body )
Response Example
OK

Comm APIs 306

8.2.2 Stop Move

Stop the motion of the wiper.

http://<server>/cgi-bin/rainBrush.cgi?action=stopMove
GET

Request URL
Method
Request Params ( key=value format in URL )
Name
channel

R/O Description
O

Type
int

Video channel number, starting from 1; the
default value is 1

Request Example
http://192.168.1.108/cgi-bin/rainBrush.cgi?action=stopMove&channel=1

Response Params ( OK in body )
Response Example
OK

8.2.3 Move Once

Control the wiper to move once.

http://<server>/cgi-bin/rainBrush.cgi?action=moveOnce
GET

Request URL
Method
Request Params ( key=value format in URL )
Name
channel

R/O Description
O

Type
int

video channel index which starts from 1,
default 1 if not specified.

Example
1

Example
1

Request Example
http://192.168.1.108/cgi-bin/rainBrush.cgi?action=moveOnce&channel=1

Response Params ( OK in body )
Response Example
OK

8.3 Illuminator

The following commands are applicable to non-intelligent illuminators.

8.3.1 [Config] Visible-light Illuminator

Template

Method
Parameter
Format
Parameter

http://<server>/cgi-bin/configManager.cgi?action=setConfig&SignLight[0].onCycle=3
0

GET
key=value format in URL

Type

Required Description

Example

Comm APIs 307

onCycle

Uint32

Yes

Range[0-100]

30

Example
http://192.168.1.108/cgi-bin/configManager.cgi?action=setConfig&SignLight[0].onCycle=30

OK at body

Type

Required Description

Example

Parameter
Format
Parameter
Example
OK

8.4 Flashlight

8.4.1 [Config] Flashlight Config

Configuration parameters of the flashing light (Not recommended).

Config Data Params
Name

Type

FlashLight

object

+Enable
+Brightness

bool
int

+TimeSection

char[7][24][
32]

Example

true
50
[ [ "1 00:00:00-
23:59:59", "0 0
0:00:00-23:59:
59","0 00:00:0
0-23:59:59", "
0 00:00:00-23:
59:59", … ] ]

R/O Description
R

R
R
R

Configuration parameters of the flashing
light
Whether to enable the flashing light
Brightness; range [0, 100]
Two-dimensional array in strings.
The first dimension of the array is the day of
the week; range: [0-6] (Sunday–Saturday).
The second dimension is the period index.
One day is divided into multiple periods, and
the range is [0–23].
Each period is set as a string in the format of
mask hh: mm: ss-hh: mm: ss
Mask: Value range: [0, 1]
hh: Hour; range: [0–24]
mm: Minute; range: [0–59]
ss: Second; range: [0–59]
Mask value:
0: Disable the parameter in the period
1: Enable the parameter in the period
For example:
TimeSection[1][0]=1 12:00:00—18:00:00
flashing
Meaning
12:00:00 through 18:00:00 on Monday.

light works

from

the

For getting and setting the configurations, see 4.2.1 Get and Set Configure”.

Get Config Request Example
http://192.168.1.108/cgi-bin/configManager.cgi?action=getConfig&name=FlashLight

Get Config Response Example

Comm APIs 308

table.FlashLight.Enable=true
table.FlashLight.Brightness=50
table.FlashLight.TimeSection[0][0]=1 00:00:00-23:59:59
table.FlashLight.TimeSection[0][1]=0 00:00:00-23:59:59
…
table.FlashLight.TimeSection[6][5]=0 00:00:00-23:59:59
…

Set Config Request Example
http://192.168.1.108/cgi-bin/configManager.cgi?action=setConfig&FlashLight.Enable=true&FlashLight.B
rightness=50&FlashLight.TimeSection[1][0]=1%2012:00:00-18:00:00

Set Config Response Example
OK

8.5 Coaxial Control IO

8.5.1 Control White Light or Speaker

Send commands for controlling the white light and speaker

http://<server>/cgi-bin/coaxialControlIO.cgi?action=control
GET

Request URL
Method
Request Params ( key=value format in URL )
Name
channel

R/O Description
O

Type
int

info
+Type

object[] R
R
int

+IO

int

R

+TriggerMode

int

R

It is the video channel number for the white
light, and the audio output channel for the
speaker. The default value is 0.
Operation details
Operation type
1: White light
2: Speaker
Switch
1: On
2: Off
Trigger Mode
1: Linked trigger
2: Manual trigger

Example
1

1

1

2

Request Example
http://192.168.1.108/cgi-bin/coaxialControlIO.cgi?action=control&channel=1&info[0].Type=1&info[0].IO=
1&info[0].TriggerMode=2

Response Params ( OK in body )
Response Example
OK

Comm APIs 309

8.5.2 Get White Light and Speaker Status

Get the status of the white light and the speaker.

http://<server>/cgi-bin/coaxialControlIO.cgi?action=getstatus
GET

Request URL
Method
Request Params ( key=value format in URL )
Name
channel

R/O Description
O

Type
int

The video channel number which starts
from 1, and the default value is 1.

Example
1

Request Example
http://192.168.1.108/cgi-bin/coaxialControlIO.cgi?action=getstatus&channel=1

Response Params ( key=value format in body )
R/O Description
Type
Name
object
status
R
char[4] R
+whitelight
char[4] R
+speaker

Return status information
White light status, "on" or "off"
Speaker status, "on" or "off"

Example

"on"
"on"

Response Example
status.whitelight=on
status.speaker=on

8.6 Pir Alarm

8.6.1 [Config] Pir Parameter

 Get pir parameter

Table 8-30

Syntax

Method

http://<server>/cgi-bin/pirAlarm.cgi?action=getPirParam&[channel=<channelNo>]

GET

Description

Get pir parameter.

Example

http://192.168.1.108/cgi-bin/pirAlarm.cgi?action=getPirParam&channel=1

Success
Return

head.Enable=true
head.PirLink.LightingLink.Enable=true
head.PirLink.LightingLink.LightLinkType=Filcker
head.PirLink.LightingLink.FilckerIntevalTime=5
head.PirLink.LightingLink.LightDuration=10
head.PirLink.LightingLink.WhiteLightTimeSection=TimeSection
head.PirLink.TimeSection[weekday][0]=1 00:00:00-24:00:00
head.PirLink.TimeSection[weekday][1]=0 02:00:00-24:00:00
head.PirLink.TimeSection[weekday][2]=0 03:00:00-24:00:00
head.PirLink.TimeSection[weekday][3]=0 04:00:00-24:00:00
head.PirLink.TimeSection[weekday][4]=0 05:00:00-24:00:00
head.PirLink.TimeSection[weekday][5]=0 06:00:00-24:00:00

Comm APIs 310

head.RecordEnable=true
head.RecordChannels=[0, 1, 2]
head.RecordLatch=10
head.AlarmOutEnable=true
head.AlarmOutChannels=[1, 4]
head.AlarmOutLatch=10
head.SnapshotEnable=true
head.SnapshotChannels=[2, 4]
head.MailEnable=true
head.AlarmBellEnable=true
head.AlarmBellLatch=10
head.Dejitter=0
head.LogEnable=true
head.DetectWindow[0].Level=3
head.DetectWindow[0].Id=0
head.DetectWindow[0].Name=Region0
head.DetectWindow[0].Sensitive=58
head.DetectWindow[0].Threshold=4
head.DetectWindow[0].Region[0]=3932160
head.DetectWindow[0].Region[1]=3932160
…
…
head. DetectWindow [1]…

Comment

if a device has one or more pir, PirParam is a array
channel : video channel index
weekday : range is [0-6] (Sunday - Saturday)
head=configEx[channelNo]



set pir parameter

Table 8-31

Syntax

http://<server>/cgi-bin/pirAlarm.cgi?action=setPirParam&[channel=<channelNo>]&<pa
ramName>=<paramValue>...&<paramName>=<paramValue>

Method

GET

Description

Set pir parameter.

Example

Success
Return

Comment

Appendix:

ParamName

head.Enable

http://192.168.1.108/cgi-bin/pirAlarm.cgi?action=setPirParam&channel=1&configEx[1].
Enable=true&configEx[1].PirLink.LightingLink.Enable=true&...

OK

channel : video channel index
head=configEx[channelNo]

ParamValue type Description

bool

Enable/Disable motion detect feature in a
channel.

Comm APIs 311

ParamName

ParamValue type Description

head.DetectWindow[WinNum].Level

integer

WinNum
Index of detect window, there are 4 detect
windows at present. Each window
is
divided into 18 lines and 22 blocks/line.

Range is [1—6].
Sensitivity of pir
1: lowest sensitivity.
6: highest sensitivity.

head.DetectWindow[WinNum].Id

integer

It is the Id of a detect window.

head.DetectWindow[WinNum].Nam
e

string

It is the name of a detect window.

head.DetectWindow[WinNum].Sens
itive

integer

head.DetectWindow[WinNum].Thre
shold

integer

head.DetectWindow[WinNum].Regi
on[LineNum]

integer

Range is [0—100].
It presents more sensitive if the value is
larger.
Range is [0—100].
It presents the threshold value when trigger
motion detect.

LineNum
Index of region, region is divided into lines
and each line has several blocks, a line is
described by a 32 bit integer, a bit for a
block.
0=Line 1
1=Line 2
…
…

Currently, region is divided into 18 lines
and 22 blocks/line.
A bit describes a block in the line.
Bit = 1: motion in this block is monitored.
Example:
4194303
MotionDetect[0].Region[0]
(0x3FFFFF):: motion in channel 0 line 0's
22 blocks is monitored.
MotionDetect[0].Region[1] =0: motion in
line 1's 22 blocks is not monitored.
MotionDetect[0].Region[17] = 3: in the last
line of channel 0, motion in the left two
blocks is monitored.

=

Comm APIs 312

ParamName

ParamValue type Description

wd (week day) range is [0—6] (Sunday -
Staurday)
ts
(time section)
timesection table index.

[0 — 23],

range

is

head.TimeSection[wd][ts]

string

head.PirLink.RecordChannels[ch]

Integer

head.PirLink.RecordEnable

bool

head.PirLink.RecordLatch

integer

head.PirLink.AlarmOutChannels[ch]

integer

head.PirLink.AlarmOutEnable

bool

head.PirLink.AlarmOutLatch

Integer

head.PirLink.SnapshotChannels[ch]

integer

head.PirLink.SnapshotEnable

bool

head.PirLink.Dejitter

integer

Format: mask hh:mm:ss-hh:mm:ss
Mask: [0—65535], hh: [0—24], mm: [0—
59], ss: [0—59]
Mask indicates record type by bits:
Bit0: regular record
Bit1: motion detection record
Bit2: alarm record
Bit3: card record

Range is {0, 1}
0 – do not record on video channel ch
1 – record on video channel ch

Enable/Disable record function.
Range is [10—300].
Unit is seconds, indicates the time to
record after input alarm is cleared.

Range is {0, 1}, ch is alarm out channel
index.
0 — do not output alarm at alarm out
channel ch
1 — output alarm at alarm out channel ch
Enable/Disable alarm out function.
Range is [10—300].
Unit is seconds, indicates the time to
output alarm after input alarm is cleared.

Range is {0, 1}
0 — do not snapshot on video channel ch
1 — snapshot on video channel ch
Enable/Disable snapshot function.
Range is [0—255].
Alarm signal dejitter seconds. Alarm signal
change during this period is ignored.

head.PirLink.MailEnable

head.PirLink.AlarmBellEnable

bool

bool

Enable/Disable mail send for alarm.

Enable/Disable mail send for alarm.

head.PirLink.AlarmBellLatch

integer

Range is [10, 300]
Unit is seconds

head.PirLink.LogEnable

bool

Enable/Disable log for alarm.

Comm APIs 313

8.7 SCADA

8.7.1 Searching for SCADA Attributes

Request URL http://<server>/cgi-bin/api/SCADA/getAttribute
Method

POST

Request Params ( JSON format in body )

Name
condition

+DeviceId

+ID

Type
object

char[32]

char[][]

Example

"01001010111"

["01001010111",
"01001010112",…]

R/O Description
R

R

No

Device ID

An array of
corresponding
monitoring point ID.
If there is no node,
return all IDs under
DeviceId.

Request Example
{
"condition": {
"DeviceId": "01001010111",
"ID": ["01001010111", "01001010112",…]
}
}

Response Params ( JSON format in body )

Name
info

Type
object[]

R/O Description
R

+SignalName

char[128]

R

Point name

+Unit

char[20]

+Type

char[20]

+ID
+StartDelay

char[32]
uint

+StopDelay

uint

+Period

uint

R

R

R
O

O

O

Unit

Type of signal point
YC: remote metering; analog
input.
YX: remote signaling; digital
input.
YT: remote regulation; analog
output.
YK: remote control; digital
output.

Signal point ID
Start delay of alarms, unit:
second
End delay of alarms, unit:
second
Storing and reporting period,

Example

“Environment
temperature”

"℃"

"YC"

"01001010111"
120

20

180

Comm APIs 314

+Threshold

+AlarmWaveV
al

float

float

+AbsoluteVal

float

+RelativeVal

float

O

O

O

O

+Status

uint

R

+DisplayOptio
ns

uint

O

+Valid

bool

R

+Delay

uint32

O

+Describe

char[]

O

+IECCode

char[]

O

+HJCode

char[]

O

Response Example

unit: second

Alarm threshold

Alarm hysteresis. Only when
the hysteresis range is
exceeded, the alarm can be
restored. Alarm recovery and
alarm delay do not take effect at
the same time.

Absolute threshold. Stores and
reports continuous data points
(AI, AO).

Percentage threshold. Stores
and reports continuous data
points (AI, AO). It is used when
the absolute threshold is
disabled or is "0".

Data status of signal point
0: normal
1: Level-1 alarm
2: Level-2 alarm
3: Level-3 alarm
4: Level-4 alarm
5: Operation event
6: Invalid data

Displays data:
BIT0: Displays the switch. 0:
No; 1: Yes.
BIT1: Displays the switch when
scrolling. 0: No; 1: Yes.
Invalid signal point
true: Yes
false: No

Alarm delay time. When an
alarm is triggered, the device
response such as reporting and
linkage is delayed. Unit:
Second.

Point description. For example,
0&Normal; 1&Alarm. Supports
up to 120 characters.

Power 104 protocol point
number. Supports up to 16
characters.

Environment 212 protocol point
number. Supports up to 16
characters.

40.0

2

0.2

0

0

0x00000000

true

120

“Environment
temperature”

"12345"

"a01001"

Comm APIs 315

{
"info": [{
"SignalName": "Environment temperature",

                "Unit": "℃",

                "Type": "YC",
                "ID": "01001010111",
                "StartDelay": 120,
                "StopDelay": 20,
                "Period": 180,
                "Threshold": 40.0,
                "AlarmWaveVal": 2,
                "AbsoluteVal": 0.2,
                "RelativeVal": 0,
                "Status": 0,
                "DisplayOptions": 0x00000000,
                "Valid": true,
                "Delay": 120,
                "Describe": "Environment temperature",
                "IECCode": "12345",
                "HJCode": "a01001"
        },…{}]

}

8.7.2 Configuring SCADA Attributes

You can use this method to disable or enable the point of SCADA devices.
Request URL http://<server>/cgi-bin/api/SCADA/setAttribute
Method

POST

Request Params ( JSON format in body )
Name
DeviceId

Type
char[32]

R/O Description
R

Detector

points

+ID
+SignalName

object[]

char[32]
char[128]

+StartDelay

uint

+StopDelay

uint

+Period

uint

+Threshold
+AlarmWaveV
al

float
float

R

R
O

O

O

O

O
O

Point name

Start delay of alarms, unit:
second

End delay of alarms, unit:
second

Storing and reporting period,
unit: second

Alarm threshold
Alarm hysteresis. Only when
the hysteresis range is
exceeded, the alarm can be
restored. Alarm recovery and

Example
"01001010111"

"01001010110"
“Environment
temperature”

120

20

180

40.0
2

Comm APIs 316

+AbsoluteVal

float

+RelativeVal

float

O

O

+Status

enumint

O

+DisplayOptio
ns

uint

O

+Valid

bool

R

alarm delay do not take effect at
the same .

Absolute threshold. Stores and
reports continuous data points
(AI, AO).

Percentage threshold. Stores
and reports continuous data
points (AI, AO). It is used when
the absolute threshold is
disabled or is "0".

Data status of signal point
enumint{
0: normal
1: Level-1 alarm
2: Level-2 alarm
3: Level-3 alarm
4: Level-4 alarm
5: Operation event
6: Invalid data
}
Displays data:
BIT0: Displays the switch or
not. 0: No; 1: Yes.
BIT1: Displays the switch when
scrolling. 0: No; 1: Yes.
Valid signal point. true: Valid.
false: Invalid.

0.2

0

0

0x00000000

true

Request Example
{
"DeviceId": "01001010111",
"points": [{
"ID": "01001010110",
"SignalName": "Environment temperature",
"StartDelay": 120,
"StopDelay": 20,
"Period": 180,
"Threshold": 40.0,
"AlarmWaveVal": 2,
"AbsoluteVal": 0.2,
"RelativeVal": 0,
"Status": 0,
"DisplayOptions": 0x00000000,
"Valid": true
},…{}]
}

Response Params ( JSON format in body )

Comm APIs 317

Name
state

+Success

Type
object

char[][]

+Fail

char[][]

R/O Description
O

Example

O

O

The list with successful
IDs

[ "01001010111"]

The list with failed IDs

["01001010122"]

Response Example
{
"state": {
"Success": [ "01001010111"],
"Fail": ["01001010122"]
}
}

8.7.3 Obtaining Real-time Data of Monitoring Points

Request URL http://<server>/cgi-bin/api/SCADA/get
Method

POST

Example

"01001010111"

["01001010111",
"01001010112",…
]

false

Request Params ( JSON format in body )
Name
condition

R/O Description
R

Type
object

+DeviceId

+ID

char[16]

char[][]

R

O

+IsHandle

bool

O

Detector ID

An array of corresponding
monitoring point ID
If there is no node, return all
IDs under the DeviceId.

The returned data is
processed (such as filtering
invalid data). "false": No,
"true": Yes.
Default: false.

Request Example
{
"condition": {
"DeviceId": "01001010111",
"ID": ["01001010111", "01001010112",…],
"IsHandle": false
}
}

Response Params ( JSON format in body )

Name
info

+Type

Type
object[]

R/O Description
R

enumchar[
32]

O

Point type
enumchar[32]{
YC: Remote metering; analog
input.
YX: Remote signaling; digital

Example

"YC"

Comm APIs 318

+ID

char[32]

+PointName

char[32]

+MeasuredVal

float

R

O

R

+SetupVal

float

O

+Status

enumint

O

input.
YT: Remote regulation; analog
output.
YK: Remote control; digital
output.
}

Point

"01001010111"

Matches the point table name.

"aaa"

213.1

123.0

0

The actual measured value.
You can change the type.
YX: Integer
YC: Floating-point number

The configured value. You can
change the type.
YK: Integer
YT: Floating-point number

Data status
enumint{
0: Normal
1: Level-1 alarm
2: Level-2 alarm
3: Level-3 alarm
4: Level-4 alarm
5: Operation Event
6: Invalid data
}

+RecordTime

char[20]

O

Collection time

"2015-1-3
10:10:45"

Response Example
{
"info": [{
"Type": "YC",
"ID": "01001010111",
"PointName": "aaa",
"MeasuredVal": 213.1,
"SetupVal": 123.0,
"Status": 0,
"RecordTime": "2015-1-3 10:10:45"
},…{}]
}

8.7.4 Configuring Monitoring Points

Request URL http://<server>/cgi-bin/api/SCADA/set

Method

POST

Request Params ( JSON format in body )

Name

Type

R/O Description

Example

Comm APIs 319

Detector

"01001010111"

Point type
YK YT

Point number

The configured value
YT: Floating-point number
YK: Integer

"YT"

"01001010111"

12.3

DeviceId

points

+Type

char[32]

object[]

char[32]

+ID

char[64]

+SetupVal

float

R

R

O

R

R

Request Example
{
"DeviceId": "01001010111",
"points": [{
"Type": "YT",
"ID": "01001010111",
"SetupVal": 12.3
},…{}]
}

Response Params ( JSON format in body )

Name
state

+Success

Type
object

char[][]

+Fail

char[][]

R/O Description
O

O

O

The list with successfully
controlled and adjusted IDs

The list with unsuccessfully
controlled and adjusted IDs

Example

["01001010111"]

["01001010122"]

Response Example
{
"state": {
"Success": ["01001010111"],
"Fail": ["01001010122"]
}
}

8.7.5 Starting Searching for Historical Data

Start searching for historical data based on device ID and time, and get search token.
Request URL http://<server>/cgi-bin/api/SCADA/startFind
Method

POST

Request Params ( JSON format in body )

Name
condition

+StartTime

+EndTime

Type
object

char[20]

char[20]

R/O Description
R

Search conditions

Example

R

O

Start time

End time
If you don't enter content
is this field, it means up
to now.

"2015-1-2 10:10:45"

"2015-1-3 10:10:45"

+DeviceId

char[32]

R

Device ID

"01001010111"

Comm APIs 320

+ID

char[32]

O

ID of corresponding
monitoring point

"01001010111"

Request Example
{
"condition": {
"StartTime": "2015-1-2 10:10:45",
"EndTime": "2015-1-3 10:10:45",
"DeviceId": "01001010111",
"ID": "01001010111"
}
}

Response Params ( JSON format in body )

R/O Description
R

Obtained search token

Example
46878

O

Total number of qualified
results

3333

Name
token

totalCount

Type
int

int

Response Example
{
"token": 46878,
"totalCount": 3333
}

8.7.6 Obtaining Historical Data

Obtain historical data based on search token.

Request URL http://<server>/cgi-bin/api/SCADA/doFind
Method

POST

Request Params ( JSON format in body )

Name
token

Type
int

R/O Description
Search token
R

beginNumber

int

R

Start number of the search. The
search starts from the
“beginNumber” records, and
returns predefined number of
records.
0<=beginNumber<=totalCount-1

Example
46878

0

count

int

R

Number of traffic statistics for
each search

24

Request Example
{
"token": 46878,
"beginNumber": 0,
"count": 24
}

Response Params ( JSON format in body )

Comm APIs 321

Name
found

info

Type
int

R/O Description
R

Number of searched entries

Example
12

object[]

R

+Type

char[32]

R

+ID
+MeasuredVal

char[32]
float

R
R

+SetupVal

float

R

Traffic statistics
It is an array and each
element represents a traffic
record that satisfies the
condition.

Point type
enumchar[32]{
YC: remote metering;
analog input
YX: Remote signaling;
digital input:
YT: Remote regulation;
analog output
YK: Remote control; digital
output
}

Monitoring point ID
Value You can change this
filed type, which is relevant
to Type filed.
When Type is YC, this value
is floating point number;
When Type is YX, this value
is integer.

Configured value You can
change this filed type, which
is relevant to Type filed.
When Type is YC, this value
is floating point number;
When Type is YX, this value
is integer.

"YC"

"01001010111"
213.1

123.0

+Status
+RecordTime

int
char[20]

R
R

Point status
Record time

0
"2015-1-3 10:10:45"

Response Example
{
"found": 12,
"info": [{
"Type": "YC",
"ID": "01001010111",
"MeasuredVal": 213.1,
"SetupVal": 123.0,
"Status": 0,
"RecordTime": "2015-1-3 10:10:45"
},…{}]
}

Comm APIs 322

8.7.7 Stopping Searching for Historical Data

Request URL http://<server>/cgi-bin/api/SCADA/stopFind
Method

POST

Request Params ( JSON format in body )

Name
token

Type
int

R/O Description
Search token
R

Example
46878

Request Example
{
"token": 46878
}

Response Params ( JSON format in body )

Name

Type

R/O Description

Example

Response Example

{}

8.7.8 Obtaining IDs of External Devices Connected to the Host

Request URL http://<server>/cgi-bin/api/SCADA/getDeviceList
Method

POST

Request Params ( JSON format in body )
Name

Type

R/O Description

Example

Request Example
{}

Response Params ( JSON format in body )

R/O Description
R

Device ID array

Name
devices

+DeviceId
+DevName

+DevCode

+Slot

Type
object[]

char[32]
char[32]

char[8]

int

R
O

O

O

Device ID
Device name

Device model

Virtual slot number In general, 0
means analog channel and 1
means digital channel. If it is
greater than 1, it means
RS-485, RS-232, or network
channel. The actual channel
number = virtual slot number – 2.

The detector address
configured by the environment
surveillance server. A slot lot
can be connected to multiple
detectors, and different

Example

"0101012345"
"UPS1"

"1801"

0

1

Comm APIs 323

+Level

int

O

detectors are distinguished by
address.

Response Example
{
"devices": [{
"DeviceId": "0101012345",
"DevName": "UPS1",
"DevCode": "1801",
"Slot": 0,
"Level": 1
},…{}]
}

8.8 Gyro

8.8.1 get gyroscope info

http://<server>/cgi-bin/api/Gyro/getData
POST

Request URL
Method
Request Params ( JSON format in body )
Name
Request Example
{}

Type

R/O Description

Response Params ( JSON format in body )
R/O Description
Type
Name
object
detail
R
double R
+AccelX

Gravitational acceleration in X
direction, unit m/s2
Gravitational acceleration in Y
direction, unit m/s2
Gravitational acceleration in Z
direction, unit m/s2
Pitch angle, in degrees
range[-90, 90]
roll angle, in degrees
range[-180, 180]
yaw angle, in degrees
range[-180, 180]
X-direction angular velocity（rad/s）
Y-direction angular velocity（rad/s）
Z-direction angular velocity（rad/s）

+AccelY

double R

+AccelZ

double R

+Pitch

double O

+Roll

+Yaw

double O

double O

+AngularSpeedX
+AngularSpeedY
+AngularSpeedZ

double R
double R
double R

Response Example
{

Example

Example

15,3

20.7

10.5

1.3

23.6

120.2

2.5
3.3
3.6

Comm APIs 324

"detail": {
"AccelX": 15,3,
"AccelY": 20.7,
"AccelZ": 10.5,
"Pitch": 1.3,
"Roll": 23.6,
"Yaw": 120.2,
"AngularSpeedX": 2.5,
"AngularSpeedY": 3.3,
"AngularSpeedZ": 3.6
}
}

Comm APIs 325

9 Video Analyse APIs

9.1 Video Analyse Event

9.1.1 [Event] LeftDetection

Usage

Refer to "4.9.17 Subscribe to Event Message"for how to subscribe event

Table 9-1

Description

When detect some object left, send this event.

[ Event Params ] ( JSON format )

Name

Object

Type

object

R/O Param Description

R

The object that left.

+BoundingBox

Array<int> R

The detected object bounding box, 4 interge, refer to x's value
of left—top point, y's value of left—top point, x's value of right—
bottom point, y's value of right — bottom point. Coordinate
remap to 0 — 8192.

[ Example ]

Event

--<boundary>
Content-Type: text/plain
Content-Length: <length>

Code=LeftDetection;action=pulse;index=0;data={
"Object": { "BoundingBox": [2992,1136,4960,5192] }
}
--<boundary>

9.1.2 [Event] TakenAwayDetection

Table 9-2

Usage

Refer to "4.9.17 Subscribe to Event Message"for how to subscribe event

Description When detect some object was taken away, send this event.

[ Event Params ] ( JSON format )

Name

Object

Type

object

R/O Param Description

R

The object that was taken away.

+BoundingBox

Array<int> R

[ Example ]

Event

--<boundary>

The detected object bounding box, 4 interge, refer to x's value
of left—top point, y's value of left—top point, x's value of right—
bottom point, y's value of right — bottom point. Coordinate
remap to 0 — 8192.

Video Analyse APIs 326

Content-Type: text/plain
Content-Length: <length>

Code=TakenAwayDetection;action=pulse;index=0;data={
"Object": { "BoundingBox": [2992,1136,4960,5192] }
}
--<boundary>

9.1.3 [Event] WanderDetection

Table 9-3

Usage

Refer to "4.9.17 Subscribe to Event Message"for how to subscribe event

Description

When detect some object was wandering, send this event

[ Event Params ] ( JSON format )

Name

Objects

Type

R/O Param Description

Array<object> R

The objects that was wandering.

The detected object bounding box, 4 interge, refer to x's value
of left—top point, y's value of left—top point, x's value of right
—bottom point, y's value of right—bottom point. Coordinate
remap to 0 — 8192.
The object wandering tracks, array of polyline, one polyline
for one object, polyline is array of points, point is array of two
int, x's value and y's value. Coordinate remap to 0 — 8192.
The detection region, the first array is point list, max item is
20, the second array is point, must be two int, means x and y
value, coordinate remap to 0 — 8192.

+BoundingBox Array<int>

R

Array<Array<
Array<int>>>

Array<Array<i
nt>>

O

R

Tracks

DetectRegion

[ Example ]

--<boundary>
Content-Type: text/plain
Content-Length: <length>

Event

Code=WanderDetection;action=start;index=0;data={
"Objects": [ { "BoundingBox": [2992,1136,4960,5192] },
{ "BoundingBox": [4392,4136,6960,6512] },
{…}, … ],
"Tracks": [ [ [1202, 576], [1456, 863], [1921, 1204], [2341, 1823], [3512, 2314] ],
[ [2214, 3412], [3153, 3674], [4512, 4213] ],

[…], … ],

    "DetectRegion": [ [1292,3469], [6535,3373], … ]

}
--<boundary>

9.1.4 [Event] StayDetection

Table 9-4

Video Analyse APIs 327

Usage

Refer to "4.9.17 Subscribe to Event Message"for how to subscribe event

Description

When detect some object was stay, send this event

[ Event Params ] ( JSON format )

Name

Object

Type

object

R/O Param Description

O

The object that was stay.

The detected object bounding box, 4 interge, refer to x's value
of left—top point, y's value of left—top point, x's value of right
—bottom point, y's value of right—bottom point. Coordinate
remap to 0 — 8192.
If detect several object, store in this array.

The detected object bounding box, 4 interge, refer to x's value
of left—top point, y's value of left—top point, x's value of right
—bottom point, y's value of right—bottom point. Coordinate
remap to 0 — 8192.
The detection region, the first array is point list, max item is
20, the second array is point, must be two int, means x and y
value, coordinate remap to 0 — 8192.
The area id, begin from 1, if omit, means single area.

The preset id, if omit, means preset is unknown.

+BoundingBox Array<int>

O

Objects

array<object> O

+BoundingBox Array<int>

O

DetectRegion

Array<Array<i
nt>>

AreaID

PresetID

[ Example ]

int

int

O

O

O

--<boundary>
Content-Type: text/plain
Content-Length: <length>

Event

Code=StayDetection;action=start;index=0;data={
"Object": { "BoundingBox": [2992,1136,4960,5192] },
"Objects": [ { "BoundingBox": [2992,1136,4960,5192] },
{ "BoundingBox": [4392,4136,6960,6512] },

{…}, … ],

    "DetectRegion": [ [1292,3469], [6535,3373], … ],
    "AreaID" : 2

}
--<boundary>

9.1.5 [Event] HumanTrait

Table 9-5

Usage

Refer to "4.4.3 Subscribe to Snapshot "for how to subscribe event

Description When detect a human trait, send this event.

[ Event Params ] ( key=value format )

Name

Events

Type

R/O Param Description

array<object> O

Event info array.

+EventBaseInfo

object

++Code

++Action

String

String

R

R

R

Base info of event.

Event Code. It should be HumanTrait.

Event Action. It can be: "Start", "Stop", "Pulse".

Video Analyse APIs 328

++Index

int

+HumanAttribute
s

object

O

O

The channel index relate to this event, start from 0.

The human attributes.

++BoundingBox Array<int>

O

++Sex

++Age

++Angle

string

int

int

O

O

O

The detected human bounding box, 4 interge, refer to x's
value of left-top point, y's value of left-top point, x's value of
right-bottom point.
right-bottom point, y's value of
Coordinate remap to 0 — 8192.
Sex, can be "Man", "Woman", "Unknown".

Age.

Angle, 0: unknown, 1: front, 2: side, 3: back.

++CoatColor

string

O

++CoatType

int

++TrousersColor string

++TrousersType

int

++HasHat

++HasBag

int

int

++HasUmbrella

int

++Bag

int

++UpperPattern

int

++HairStyle

++Cap

int

int

+FaceAttributes

object

O

O

O

O

O

O

O

O

O

O

O

++BoundingBox Array<int>

O

++Sex

++Age

string

int

O

O

++Feature

array<string> O

++Eye

++Mouth

int

int

O

O

Coat color, can be: "White", "Orange", "Pink", "Black",
"Red", "Yellow", "Gray", "Blue", "Green", "Purple", "Brown",
"Sliver", "Darkviolet", "Maroon", "Dimgray", "Whitesmoke",
"Darkorange",
"Gold",
"Greenyellow",
"Darkolivegreen",
"Forestgreen", "Seagreen", "Chartreuse", "Deepskyblue",
"Cyan", "Other".

"Chartreuse",

"Mistyrose",

"Tomato",

"Olive",

Coat type, 0: unknown, 1: long sleeve, 2: short sleeve.

Trousers color, value can be that of CoatColor.

Trousers type, 0: unknown, 1: long pants, 2: short pants, 3:
skirt.

Has hat or not, 0: unknown, 1: not has hat, 2: has hat.

Has bag or not, 0: unknown, 1: not has bag, 2: has bag.

Has umbrella or not, 0: unknown, 1: not has umbrella, 2: has
umbrella.

Bag type, 0: unknown, 1: handbag, 2: shoulder bag, 3:
knapsack, 4: draw-bar box.

Upper clothes pattern, 0: unknown, 1: pure color, 2: stripe,
3: pattern, 4: gap, 5: grid.

Hair style, 0: unknown, 1: long hair, 2: short hair, 3: ponytail,
4: updo, 5: hiddened.

Cap style, 0: unknown, 1: normal cap, 2: helmet.

If the human's face can be detected, find it's attributes.

The detected face bounding box, 4 interge, refer to x's value
of left-top point, y's value of left-top point, x's value of
right-bottom point, y's value of
right-bottom point.
Coordinate remap to 0 — 8192.
Sex, it can be "Man", "Woman", "Unknown".

Age.

Face feature, can be some of the following : "WearGlasses",
"SunGlasses", "NoGlasses", "Smile", "Anger", "Sadness",
"Disgust", "Fear", "Surprise", "Neutral", "Laugh", "Happy",
"Confused", "Scream".

Eye status, 0: not detected, 1: close eye, 2: open eye.

Mouth status, 0: not detected, 1: close mouth, 2: open
mouth.

Video Analyse APIs 329

++Mask

++Beard

++Glass

[ Example ]

int

int

Int

O

O

O

Mask status, 0: not detected, 1: not wearing mask, 2:
wearing mask.

Beard status, 0: not detected, 1: no beard, 2: has beard.

Glasses status, 0: unknown, 1: not wearing, 2: normal
Glasses, 3: sun glasses, 4: black frame glasses.

--<boundary>
Content-Type: text/plain
Content-Length: <length>

Events[0].EventBaseInfo .Code=HumanTrait
Events[0].EventBaseInfo .Action=Pulse
Events[0].EventBaseInfo .Index=0
Events[0].HumanAttributes.BoundingBox[0]=1341
Events[0].HumanAttributes.BoundingBox[1]=2451
Events[0].HumanAttributes.BoundingBox[2]=4513
Events[0].HumanAttributes.BoundingBox[3]=4135
Events[0].HumanAttributes.Sex=Man
Events[0].HumanAttributes.Age=30
Events[0].HumanAttributes.CoatColor=White
Events[0].HumanAttributes.CoatType=1
Events[0].HumanAttributes.TrousersColor=Black
Events[0].HumanAttributes.TrousersType=1
Events[0].HumanAttributes.HasHat=1
Events[0].HumanAttributes.HasBag=2
Events[0].FaceAttributes.BoundingBox[0]=1341
Events[0].FaceAttributes.BoundingBox[1]=2451
Events[0].FaceAttributes.BoundingBox[2]=4513
Events[0].FaceAttributes.BoundingBox[3]=4135
Events[0].FaceAttributes.Sex=Man
Events[0].FaceAttributes.Age=30
Events[0].FaceAttributes.Feature[0]=Smile
Events[0].FaceAttributes.Eye=2
Events[0].FaceAttributes.Mouth=1
Events[0].FaceAttributes.Glass=1
--<boundary>
Content-Type: image/jpeg
Content-Length: <image size>

Event

<Jpeg image data>
--<boundary>

9.1.6 [Event] CrossLineDetection

Usage

Refer to "4.9.17 Subscribe to Event Message"for how to subscribe event

Table 9-6

Video Analyse APIs 330

Description

When detect some object cross the line, send this event.

[ Event Params ] ( JSON format )

Name

Object

Type

object

R/O Param Description

R

The object that cross the line.

The detected object bounding box, 4 interge, refer to x's value
of left—top point, y's value of left—top point, x's value of right
—bottom point, y's value of right-bottom point. Coordinate
remap to 0 — 8192.
If detect several object, store in this array.

The detected object bounding box, 4 interge, refer to x's value
of left—top point, y's value of left—top point, x's value of right
—bottom point, y's value of right-bottom point. Coordinate
remap to 0 — 8192.
The detection line, the first array is point list, max item is 20,
the second array is point, must be two int, means x and y
value, coordinate remap to 0 — 8192.
The crossline direction, can be : “LeftToRight”, “RightToLeft”,
“Any”.

+BoundingBox Array<int>

R

Objects

array<object> O

+BoundingBox Array<int>

R

DetectLine

Array<Array<i
nt>>

Direction

string

[ Example ]

R

O

--<boundary>
Content-Type: text/plain
Content-Length: <length>

Event

Code=CrossLineDetection;action=pulse;index=0;data={
"Object": { "BoundingBox": [2992,1136,4960,5192] },
"DetectLine": [ [1292,3469], [6535,3373], … ],

"Direction" : "LeftToRight"

}
--<boundary>

9.1.7 [Event] CrossRegionDetection

Table 9-7

Usage

Refer to "4.9.17 Subscribe to Event Message"for how to subscribe event

Description

When detect some object cross the region, send this event

[ Event Params ] ( JSON format )

Name

Object

Type

object

R/
O

R

Param Description

The object that cross the region.

+BoundingBox

Array<int>

R

Objects

array<object> O

The detected object bounding box, 4 interge, refer to x's value
of left—top point, y's value of left-top point, x's value of right
—bottom point, y's value of right-bottom point. Coordinate
remap to 0 — 8192.
If detect several object, store in this array.

Video Analyse APIs 331

The detected object bounding box, 4 interge, refer to x's value
of left—top point, y's value of left—top point, x's value of right
—bottom point, y's value of right-bottom point. Coordinate
remap to 0 — 8192.
The detection region, the first array is point list, max item is
20, the second array is point, must be two int, means x and y
value, coordinate remap to 0 — 8192.
The cross action, can be : "Appear", "Disappear",
"Cross","Inside"

The cross direction, valid on if the “Action” is “Cross”, can be :
"Enter", "Leave", "Both".

+BoundingBox

Array<int>

R

DetectRegion

Array<Array<i
nt>>

Action

string

Direction

string

[ Example ]

R

R

O

--<boundary>
Content-Type: text/plain
Content-Length: <length>

Event

Code=CrossRegionDetection;action=pulse;index=0;data={
"Object": { "BoundingBox": [2992,1136,4960,5192] },
"DetectRegion": [ [1292,3469], [6535,3373], … ],
“Action” : “Cross”,

"Direction" : "Enter"

}
--<boundary>

9.1.8 [Event] QueueStayDetection

Table 9-8

Usage

Refer to "4.9.17 Subscribe to Event Message"for how to subscribe event

Description

When detect the queue stay time too long, send this event

[ Event Params ] ( JSON format )

Name

Object

Type

object

R/O Param Description

O

The object that was stay.

+BoundingBox Array<int>

O

Objects

array<object> O

+BoundingBox Array<int>

O

DetectRegion

Array<Array<i
nt>>

AreaID

int

O

O

The detected object bounding box, 4 interge, refer to x's value
of left—top point, y's value of left—top point, x's value of right
—bottom point, y's value of right—bottom point. Coordinate
remap to 0 — 8192.
If detect several object, store in this array.

The detected object bounding box, 4 interge, refer to x's value
of left—top point, y's value of left—top point, x's value of right
—bottom point, y's value of right—bottom point. Coordinate
remap to 0 — 8192.
The detection region, the first array is point list, max item is
20, the second array is point, must be two int, means x and y
value, coordinate remap to 0 — 8192.
The area id, begin from 1, if omit, means single area.

Video Analyse APIs 332

PresetID

int

O

The preset id, Valid ID starts from 1; 0 means meaningless,
not involved. if omit, means preset is unknown.

[ Example ]

--<boundary>
Content-Type: text/plain
Content-Length: <length>

Event

Code=QueueStayDetection;action=start;index=0;data={
"Object": { "BoundingBox": [2992,1136,4960,5192] },
"Objects": [ { "BoundingBox": [2992,1136,4960,5192] },
{ "BoundingBox": [4392,4136,6960,6512] },

{…}, … ],

    "DetectRegion": [ [1292,3469], [6535,3373], … ],
    "AreaID" : 2

}
--<boundary>

9.1.9 [Event] QueueNumDetection

Table 9-9

Usage

Refer to "4.9.17 Subscribe to Event Message"for how to subscribe event

Description

When detect the queue people number exceed limit, send this event

[ Event Params ] ( JSON format )

Name

ManList

Type

R/O Param Description

Array<object> R

The people info list.

The detected people bounding box, 4 interge, refer to x's
value of left-top point, y's value of left-top point, x's value of
right-bottom point, y's value of right-bottom point. Coordinate
remap to 0 — 8192.
The people's stature, unit is cm.

The area id, begin from 1, if omit, means single area.

The preset id, Valid ID starts from 1; 0 means meaningless,
not involved. if omit, means preset is unknown.

+BoundingBox Array<int>

R

+Stature

AreaID

PresetID

[ Example ]

int

int

int

R

O

O

--<boundary>
Content-Type: text/plain
Content-Length: <length>

Event

Code=QueueNumDetection;action=pulse;index=0;data={
"ManList": [ { "BoundingBox": [2992,1136,4960,5192], "Stature": 170 },
{ "BoundingBox": [4392,4136,6960,6512], "Stature": 175 },

{…}, … ],
"AreaID" : 2
}
--<boundary>

Video Analyse APIs 333

9.2 FaceRecognitionServer

9.2.1 Create Face Group

URL

http://<server>/cgi-bin/faceRecognitionServer.cgi?action=createGroup

Table 9-10

Method

GET

Description Create a face group.

[ Request Params ] ( key=value format at URL )

Name

groupName

Type

string

groupDetail

string

R/O Param Description

R

O

The face group name, max string length is 127.

The description detail of the face group, max string length is 255.

[ Response Params ] ( key=value format )

Name

groupID

[ Example ]

Request

Type

string

R/O Param Description

R

The identity of the created face group, max string length is 63.

GET
http://192.168.1.108/cgi-bin/faceRecognitionServer.cgi?action=createGroup&groupName
=Test1&groupDetail=ForTest1

Response

groupID=10000

9.2.2 Modify Face Group

URL

http://<server>/cgi-bin/faceRecognitionServer.cgi?action=modifyGroup

Table 9-11

Method

GET

Description Modify a face group.

[ Request Params ] ( key=value format at URL )

Name

groupID

groupName

groupDetail

Type

string

string

string

[ Response Params ] ( OK )

R/O Param Description

R

R

O

The identity of the face group, max string length is 63.

The name of the the face group, max string length is 127.

Description detail of the face group, max string length is 255.

[ Example ]

Request

GET
http://192.168.1.108/cgi-bin/faceRecognitionServer.cgi?action=modifyGroup&groupID=10
000&groupName=Test1&groupDetail=ForTest1

Response OK

9.2.3 Delete Face Group

Table 9-12

Video Analyse APIs 334

URL

http://<server>/cgi-bin/faceRecognitionServer.cgi?action=deleteGroup

Method

GET

Description Delete a face group.

[ Request Params ] ( key=value format at URL )

Name

groupID

Type

string

[ Response Params ] ( OK )

R/O Param Description

R

The identity of the face group, max string length is 63.

[ Example ]

Request

GET
http://192.168.1.108/cgi-bin/faceRecognitionServer.cgi?action=deleteGroup&groupID=100
00

Response OK

9.2.4 Deploy Face Group

There are two ways to deploy the group. One is based on the group (putDisposition), and the
another one is based on the channel (setGroup).

 Put disposition to group

Table 9-13

URL

http://<server>/cgi-bin/faceRecognitionServer.cgi?action=putDisposition

Method

GET

Description

Deploy the face group to some video channels. If the video channel has been deployed
already, it will change the similary.

[ Request Params ] ( key=value format at URL )

Name

groupID

list

+channel

+similary

Type

string

Array<object>

int

int

R/O Param Description

R

R

R

R

The identity of the face group, max string length is 63.

List of disposition info.

Video channel index which starts from 1.
The threshold of the face similary, 0 — 100.

[ Response Params ] ( key=value format )

Name

report

[ Example ]

Request

Type

R/O Param Description

array<bool>

R

Result of putting disposition for each request channel.

GET
http://192.168.1.108/cgi-bin/faceRecognitionServer.cgi?action=putDisposition&groupID=1
0000&list[0].channel=1&list[0].similary=80&list[1].channel=2&list[1].similary=70

Response

report[0]=true
report[1]=false

 Delete some disposition from group

Table 9-14

URL

http://<server>/cgi-bin/faceRecognitionServer.cgi?action=deleteDisposition

Method

GET

Descripti

Remove the deployment of face group from some video channels.

Video Analyse APIs 335

on

[ Request Params ] ( key=value format at URL )

Name

groupID

channel

Type

string

Array<int>

R/O Param Description

R

R

The identity of the face group, max string length is 63.

Video channel index which starts from 1.

[ Response Params ] ( key=value format )

Name

report

[ Example ]

Request

Type

R/O Param Description

array<bool> R

Result of deleting disposition for each request channel.

GET
http://192.168.1.108/cgi-bin/faceRecognitionServer.cgi?action=deleteDisposition&groupID
=10000&channel[0]=1&channel[1]=2

Response

report[0]=true
report[1]=false



set disposition group to channel

Table 9-15

URL

http://<server>/cgi-bin/faceRecognitionServer.cgi?action=setGroup

Method

GET

Descripti
on

Deploy some face groups to one video channel. If the video channel has been deployed
already, it will change the similary.
Note: This method will do an overwrite operation.

[ Request Params ] ( key=value format at URL )

Name

channel

Type

int

list

Array<object>

+groupID

+similary

int

int

[ Response Params ] ( OK )

R/O Param Description

R

O

R

R

Video channel index which starts from 1.

List of disposition info, if not exist, remove all disposition from
channel.

The identity of the face group, max string length is 63.
The threshold of the face similary, 0 — 100.

[ Example ]

Request

GET
http://192.168.1.108/cgi-bin/faceRecognitionServer.cgi?action=setGroup&channel=1&list
[0].groupID=10000&list[0].similary=80&list[1].groupID=10002&list[1].similary=75

Response

OK



get disposition group from channel

Table 9-16

URL

http://<server>/cgi-bin/faceRecognitionServer.cgi?action=getGroup

Method

GET

Descripti
on

Get the Deployment about the video channel.
Note: If the video channel does not deploy any group, then the response will be success
with empty http body.

[ Request Params ] ( key=value format at URL )

Video Analyse APIs 336

Name

channel

Type

int

R/O Param Description

R

Video channel index which starts from 1.

[ Response Params ] (key=value format)

Name

groupID

similary

[ Example ]

Type

R/O Param Description

Array<int>

Array<int>

R

R

The identity of the face group, max string length is 63.
The threshold of the face similary, 0 — 100.

Request

GET http://192.168.1.108/cgi-bin/faceRecognitionServer.cgi?action=getGroup&channel=1

Response

groupID[0]=10001
groupID[1]=10003
groupID[2]=10006
….
similary[0]=80
similary[1]=75
similary[2]=85
….

9.2.5 Find Face Group

Table 9-17

URL

http://<server>/cgi-bin/faceRecognitionServer.cgi?action=findGroup

Method

GET

Description

Find the face group. If the groupID is not present in the URL, it will return all the groups.

[ Request Params ] ( key=value format at URL )

Name

groupID

Type

string

R/O Param Description

O

The identity of the face group, max string length is 63.

[ Response Params ] ( key=value format )

Type

R/O Param Description

Array<object> R

The face group information list.

Name

GroupList

+groupID

+groupName

+groupDetail

string

string

string

+groupSize

int

+channels

+similarity

Array<int>

Array<int>

+groupType

string

+TimeSection

[ Example ]

Array<Array<s
tring>>

R

R

O

R

O

O

O

O

The identity of the face group, max string length is 63.

Name of the face group, max string length is 127.

Description detail of the face group, max string length is 255.

The number of face in this face group.

Video channel index which starts from 0.

The threshold of the face similary.

The type of face group

The time section of face group

Request

GET http://192.168.1.108/cgi-bin/faceRecognitionServer.cgi?action=findGroup

Response

GroupList[0].groupID=00001
GroupList[0].groupName=Test1
GroupList[0].groupDetail=ForTest1
GroupList[0].groupSize=30
GroupList[0].channels[0]=1

Video Analyse APIs 337

GroupList[0].channels[1]=2
…
GroupList[0].similarity[0]=80
GroupList[0].similarity[1]=75
…
GroupList[0].groupType=BlackListDB
GroupList[0].TimeSection[0][0]=1 00:00:00-23:59:59
GroupList[0].TimeSection[0][1]=0 00:00:00-23:59:59
GroupList[0].TimeSection[0][2]=0 00:00:00-23:59:59
GroupList[0].TimeSection[0][3]=0 00:00:00-23:59:59
GroupList[0].TimeSection[0][4]=0 00:00:00-23:59:59
GroupList[0].TimeSection[0][5]=0 00:00:00-23:59:59
GroupList[0].TimeSection[1][0]=1 00:00:00-23:59:59
GroupList[0].TimeSection[1][1]=0 00:00:00-23:59:59
GroupList[0].TimeSection[1][2]=0 00:00:00-23:59:59
GroupList[0].TimeSection[1][3]=0 00:00:00-23:59:59
GroupList[0].TimeSection[1][4]=0 00:00:00-23:59:59
GroupList[0].TimeSection[1][5]=0 00:00:00-23:59:59
GroupList[0].TimeSection[2][0]=1 00:00:00-23:59:59
GroupList[0].TimeSection[2][1]=0 00:00:00-23:59:59
GroupList[0].TimeSection[2][2]=0 00:00:00-23:59:59
GroupList[0].TimeSection[2][3]=0 00:00:00-23:59:59
GroupList[0].TimeSection[2][4]=0 00:00:00-23:59:59
GroupList[0].TimeSection[2][5]=0 00:00:00-23:59:59
GroupList[0].TimeSection[3][0]=1 00:00:00-23:59:59
GroupList[0].TimeSection[3][1]=0 00:00:00-23:59:59
GroupList[0].TimeSection[3][2]=0 00:00:00-23:59:59
GroupList[0].TimeSection[3][3]=0 00:00:00-23:59:59
GroupList[0].TimeSection[3][4]=0 00:00:00-23:59:59
GroupList[0].TimeSection[3][5]=0 00:00:00-23:59:59
GroupList[0].TimeSection[4][0]=1 00:00:00-23:59:59
GroupList[0].TimeSection[4][1]=0 00:00:00-23:59:59
GroupList[0].TimeSection[4][2]=0 00:00:00-23:59:59
GroupList[0].TimeSection[4][3]=0 00:00:00-23:59:59
GroupList[0].TimeSection[4][4]=0 00:00:00-23:59:59
GroupList[0].TimeSection[4][5]=0 00:00:00-23:59:59
GroupList[0].TimeSection[5][0]=1 00:00:00-23:59:59
GroupList[0].TimeSection[5][1]=0 00:00:00-23:59:59
GroupList[0].TimeSection[5][2]=0 00:00:00-23:59:59
GroupList[0].TimeSection[5][3]=0 00:00:00-23:59:59
GroupList[0].TimeSection[5][4]=0 00:00:00-23:59:59
GroupList[0].TimeSection[5][5]=0 00:00:00-23:59:59
GroupList[0].TimeSection[6][0]=1 00:00:00-23:59:59
GroupList[0].TimeSection[6][1]=0 00:00:00-23:59:59
GroupList[0].TimeSection[6][2]=0 00:00:00-23:59:59
GroupList[0].TimeSection[6][3]=0 00:00:00-23:59:59
GroupList[0].TimeSection[6][4]=0 00:00:00-23:59:59

Video Analyse APIs 338

GroupList[0].TimeSection[6][5]=0 00:00:00-23:59:59

GroupList[1].groupID=00003
GroupList[1].groupName=Test3
GroupList[1].groupDetail=ForTest3
GroupList[1].groupSize=50
GroupList[1].channels[0]=1
GroupList[1].channels[1]=2
…
GroupList[1].similarity[0]=70
GroupList[1].similarity[1]=85
…

9.2.6 Re-Abstract Feature By Group

 Start ReAbstract

URL

Method

Description

Table 9-18

http://<server>/cgi-bin/faceRecognitionServer.cgi?action=groupReAbstract

GET

Abstract features for the groups.
About
the process of
"FaceFeatureAbstract" to report the process.

the re-extract,

the device will use an event named

[ Request Params ] ( key=value format at URL )

Name

groupID

Type

R/O Param Description

Array<int>

R

The identity of the face group, max string length is 63.

[ Response Params ] (key=value format)

Name

token

[ Example ]

Request

Type

int

R/O Param Description

R

The identity of this operation.

GET
http://192.168.1.108/cgi-bin/faceRecognitionServer.cgi?action=groupReAbstract&groupID[
0]=10000&groupID[1]=10001

Response

token=12345

 Stop ReAbstract

URL

http://<server>/cgi-bin/faceRecognitionServer.cgi?action=stopGroupReAbstract

Table 9-19

Method

GET

Descripti
on

Stop the abstract features process.

[ Request Params ] ( key=value format at URL )

Name

token

Type

int

R/O

Param Description

R

The identity of this operation.

[ Response Params ] ( OK )

Video Analyse APIs 339

[ Example ]

Request

GET
http://192.168.1.108/cgi-bin/faceRecognitionServer.cgi?action=stopGroupReAbstract&tok
en=12345

Response OK

9.2.7 Add Person

URL

http://<server>/cgi-bin/faceRecognitionServer.cgi?action=addPerson

Table 9-20

Method

POST

Description Add a person to a group.

[ Request Params ] ( key=value format in URL )

Name

Type

R/O Param Description

groupID

name

birthday

sex

country

province

city

certificateType

id

string

string

string

string

string

string

string

string

string

R

R

O

O

O

O

O

O

O

The identity of the face group that this person to add. Max string
length is 63.

The person name, max string length is 63.

The person's birthday, ex: "1980-01-01".

Sex, it can be "Male", "Female", "Unknown".

The country name, length must be 2, and value should be
according to ISO3166.

The province name, max string length is 63.

The city name, max string length is 63.

The certificate type. It can be: "IC', "Passport", "Unknown".

The ID of certificate type, max string length is 31.

[ Response Params ] (key=value format )

Name

uid

[ Example ]

Type

string

R/O Param Description

R

The id for this Person, max string length is 31.

POST
http://<server>/cgi-bin/faceRecognitionServer.cgi?action=addPerson&groupID=10000&na
me=ZhangSan&birthday=1980-01-05&sex=Male&country=CN&province=XXX&city=YYY
HTTP/1.1
Content-Type: image/jpeg
Content-Length: <image size>

Request

<JPEG image data>

Response

uid=0005

9.2.8 Modify Person

URL

http://<server>/cgi-bin/faceRecognitionServer.cgi?action=modifyPerson

Method

POST

Table 9-21

Video Analyse APIs 340

Description

Modify a person's info.
Note: If you do not want to change the image about the person, the request should not
contain the image data.
Note: You should provide at lease one optional param to update.

[ Request Params ] ( key=value format in URL )

Name

uid

groupID

name

birthday

sex

country

province

city

certificateType

id

Type

string

string

string

string

string

string

string

string

string

string

[ Response Params ] ( OK )

[ Example ]

R/O

Param Description

R

R

O

O

O

O

O

O

O

O

The identity of the Person, max string length is 31.

The identity of the Face Group that this Person in. max string
length is 63.

The person's name, max string length is 63.

The person's birthday, ex: "1980-01-01".

Sex, it can be "Male", "Female", "Unknown".

The country name, length must be 2, and value should be
according to ISO3166.

The province name, max string length is 63.

The city name, max string length is 63.

The certificate type. It can be: "IC', "Passport", "Unknown".

The ID of certificate type, max string length is 31.

POST
http://<server>/cgi-bin/faceRecognitionServer.cgi?action=modifyPerson&uid=0005&grou
pID=10000&name=ZhangSan&birthday=1980-01-05&sex=Male&country=CN&province=
XXX&city=YYY HTTP/1.1
Content-Type: image/jpeg
Content-Length: <image size>

Request

<JPEG image data>

Response

OK

9.2.9 Delete Person

URL

http://<server>/cgi-bin/faceRecognitionServer.cgi?action=deletePerson

Table 9-22

Method

GET

Description Delete a person from a group.

[ Request Params ] ( key=value format in URL )

Name

uid

groupID

Type

string

string

[ Response Params ] ( OK )

[ Example ]

R/O Param Description

R

R

The identity of the person, max string length is 31.

The identity of the face group that this Person in. max string
length is 63.

Video Analyse APIs 341

Request

GET
http://192.168.1.108/cgi-bin/faceRecognitionServer.cgi?action=deletePerson&uid=001&gr
oupID=10000

Response OK

9.2.10 Find Person

 Start to find

Table 9-23

URL

Method

Description

http://<server>/cgi-bin/faceRecognitionServer.cgi?action=startFind

GET

Start to find person in face groups.
Note: the returned token will be expired after 60 seconds without any doFind call.

[ Request Params ] ( key=value format in URL )

Type

Object

R/O Param Description

R

Search scope condition.

Array<string> R

The list of identity of the face group, max string length is 63.

Name

condition

+GroupID

person

+Name

+Sex

+Country

+Province

+City

object

string

string

string

string

string

+CertificateType

string

+ID

string

+FeatureState

int

O

O

O

O

O

O

O

O

O

Person condition.

Person Name, max string length is 63.

Sex, it can be "Male", "Female", "Unknown".

Country name, length must be 2, and value should be
according to ISO3166.

Province name, max string length is 63.

City name, max string length is 63.

Certificate Type. It can be: "IC', "Passport", "Unknown".

Person ID of CertificateType, max string length is 31.

Feature State, 0:Unknown, 1:Failed, 2:OK.

[ Response Params ] ( key=value format )

Name

token

totalCount

[ Example ]

Request

Type

R/O Param Description

uint

int

R

R

Token for this search, use this token to get result and stop
search.

Result num, return -1 means still searching.

GET
http://<server>/cgi-bin/faceRecognitionServer.cgi?action=startFind&condition.GroupID[0]
=10000&condition.GroupID[1]=10003&person.Sex=Male&person.Country=CN&person.F
eatureState=1

Response

token=123456789
totalCount=24

 Get find result

URL

http://<server>/cgi-bin/faceRecognitionServer.cgi?action=doFind

Method

GET

Table 9-24

Video Analyse APIs 342

Descripti
on

Get one result of person's information from the search result set.
Note: the returned token will be expired after 60 seconds without any doFind call.

[ Request Params ] ( key=value format in URL )

Name

token

index

Type

uint

uint

R/O Param Description

R

R

Token for this search, use this token to get result and stop
search.

The index in search result, should between 0 and totalCount
–1.

[ Response Params ] ( JSON format )

Name

person

+UID

+GroupID

+Name

+Sex

+Birthday

+Country

+Province

+City

Type

object

string

string

string

string

string

string

string

string

+CertificateType

string

+ID

string

+FeatureState

int

R/O Param Description

R

R

R

R

O

O

O

O

O

O

O

O

Person condition.

The identity of the person, max string length is 31.

The identity of the face group that this Person in. max string
length is 63.

The person name, max string length is 63.

Sex, it can be "Male", "Female", "Unknown".

The person's birthday, ex: "1980-01-01".

Country name, length must be 2, and value should be
according to ISO3166.

Province name, max string length is 63.

City name, max string length is 63.

Certificate Type, can be: "IC', "Passport", "Unknown".

Person ID of CertificateType, max string length is 31.

Feature State, 0:Unknown, 1:Failed, 2:OK.

[ Example ]

Request

Response

GET
http://<server>/cgi-bin/faceRecognitionServer.cgi?action=doFind&token=123456789&in
dex=0

HTTP/1.1 200 OK
Server: Device/1.0
Content-Type: multipart/x-mixed-replace; boundary=<boundary>
Content-Length: <length>

--<boundary>
Content-Type: text/plain
Content-Length: <length>

person.UID=0005
person.GroupID=10000
person.Name=ZhangSan
person.Birthday=1980-01-01
person.Sex=Male
person.Country=CN
person.Province=XXX
person.City=YYY
person.CertificateType=IC

Video Analyse APIs 343

person.ID=1234567890
person.FeatureState=0
--<boundary>
Content-Type: image/jpeg
Content-Length: <image size>

< jpeg image data ... >
--<boundary>--

 Stop finding

URL

http://<server>/cgi-bin/faceRecognitionServer.cgi?action=stopFind

Table 9-25

Method

GET

Descripti
on

Stop the search session.

[ Request Params ] ( key=value format in URL )

Name

token

Type

R/O

Param Description

uint

R

The token for this search, use this token to get result and stop
search.

[ Response Params ] ( OK )

[ Example ]

Request

GET
http://<server>/cgi-bin/faceRecognitionServer.cgi?action=stopFind&token=123456789

Response OK

9.2.11 Re-Abstract Features By Person

 Start ReAbstract

URL

http://<server>/cgi-bin/faceRecognitionServer.cgi?action=reAbstract

Method

GET

Table 9-26

Description

Abstract features for the persons.
About
the process of
"FaceFeatureAbstract"to report the process.

the re-extract,

the device will use an event named

[ Request Params ] ( key=value format at URL )

Name

UID

Type

R/O Param Description

Array<int> O

The list of identity of person, max string length is 31.

[ Response Params ] ( OK )

[ Example ]

Request

GET
http://192.168.1.108/cgi-bin/faceRecognitionServer.cgi?action=reAbstract&uid[0]=001&ui
d[1]=002

Response

OK

 Stop ReAbstract

Video Analyse APIs 344

URL

http://<server>/cgi-bin/faceRecognitionServer.cgi?action=stopReAbstract

Table 9-27

Method

GET

Descripti
on

Stop the abstract features process.

[ Request Params ] ( None )

[ Response Params ] ( OK )

[ Example ]

Request GET http://192.168.1.108/cgi-bin/faceRecognitionServer.cgi?action=stopReAbstract

Respons
e

OK

9.2.12 [Config] Face Recognition AlarmOut Setting

 Get FaceRecognitionAlarm config

URL

http://<server>/cgi-bin/configManager.cgi?action=getConfig&name=FaceRecognitionAlar
m

Table 9-28

Method

GET

Description Get the Face Recognition Alarm Out Setting.

[ Request Params ] ( None )

[ Response Params ] ( key=value format )

Name

table

Type

object

R/O Param Description

R

Config info table.

+FaceRecognitio
nAlarm

++GroupID

++GroupName

++AlarmOutEna
ble

array<object> R

Each face group has one config object in this array.

String

String

Bool

R

R

R

The face group ID, max string length is 63.

The face group name, max string length is 127.

Enable AlarmOut or not.

++AlarmChannel Array<object> R

Each AlarmOut channel has one config object in this array.

+++AlarmRuleM
ask

+++AlarmOutLat
ch

[ Example ]

Int

Int

R

Alarm rule mask.
 Bit 0 : recognition success
 Bit 1 : recognition failed

R

Alarm out delay, unit is second, value between 1 anf 300.

Request

GET
http://10.0.0.8/cgi-bin/configManager.cgi?action=getConfig&name=FaceRecognitionAlar
m

Video Analyse APIs 345

Response

table.FaceRecognitionAlarm[0].GroupID=0017
table.FaceRecognitionAlarm[0].GroupName=wsd
table.FaceRecognitionAlarm[0].AlarmOutEnable=true
table.FaceRecognitionAlarm[0].AlarmChannel[0].AlarmRuleMask=0
table.FaceRecognitionAlarm[0].AlarmChannel[0].AlarmOutLatch=5
table.FaceRecognitionAlarm[0].AlarmChannel[1].AlarmRuleMask=0
table.FaceRecognitionAlarm[0].AlarmChannel[1].AlarmOutLatch=8
…
table.FaceRecognitionAlarm[1].GroupID=0018
table.FaceRecognitionAlarm[1].GroupName=cst
table.FaceRecognitionAlarm[1].AlarmOutEnable=true
table.FaceRecognitionAlarm[1].AlarmChannel[0].AlarmRuleMask=0
table.FaceRecognitionAlarm[1].AlarmChannel[0].AlarmOutLatch=10
table.FaceRecognitionAlarm[1].AlarmChannel[1].AlarmRuleMask=0
table.FaceRecognitionAlarm[1].AlarmChannel[1].AlarmOutLatch=15
…

 Set FaceRecognitionAlarm config

URL

http://<server>/cgi-bin/configManager.cgi?action=setConfig

Method

GET

Descripti
on

Set the Face Recognition Alarm Out Setting.

[ Request Params ] ( key=value format at URL )

Name

Type

R/O Param Description

FaceRecognition
Alarm

+GroupID

+GroupName

+AlarmOutEnabl
e

array<object> R

Each face group has one config object in this array.

String

String

Bool

R

R

R

The face group ID, max string length is 63.

The face group name, max string length is 127.

Enable AlarmOut or not.

+AlarmChannel

Array<object> R

Each AlarmOut channel has one config object in this array.

++AlarmRuleMa
sk

++AlarmOutLatc
h

Int

Int

[ Response Params ] ( OK )

[ Example ]

R

Alarm rule mask.
 Bit 0 : recognition success
 Bit 1 : recognition failed

R

Alarm out delay, seconds, value between 1 and 300.

Request

GET
http://10.0.0.8/cgi-bin/configManager.cgi?action=setConfig&FaceRecognitionAlarm[0].Gr
oupID=0017&FaceRecognitionAlarm[0].GroupName=wsd&FaceRecognitionAlarm[0].Ala
rmOutEnable=true&FaceRecognitionAlarm[0].AlarmChannel[0].AlarmRuleMask=0&Face
RecognitionAlarm[0].AlarmChannel[0].AlarmOutLatch=5

Response

OK

Video Analyse APIs 346

9.2.13 Find Person by Picture

 Start to find

Table 9-29

URL

Method

Description

http://<server>/cgi-bin/faceRecognitionServer.cgi?action=startFindByPic

POST

Start to find person in face groups by picture. The search may last for some time, so the
response may push at regular intervals until 100% Progress
Note: If you want to find person in face groups by person info, see above "Find
Person"API.
Note: The returned token will be expired after 60 seconds without any doFind call.

[ Request Params ] ( key=value format in URL )

Name

GroupID

Similarity

MaxCandidate

Type

R/O Param Description

array<string> R

int

int

R

O

Face groups to find, max string length is 63.
Similarity percent, 1 — 100.
Max Candidate result number.

[ Response Params ] ( JSON format )

Name

token

progress

totalCount

[ Example ]

Request

Type

R/O Param Description

uint

uint

int

R

R

R

The token of this search, use this token to get result and stop
search.

Search Progress, 100 means finished.

Result num, return -1 means still searching.

POST
http://<server>/cgi-bin/faceRecognitionServer.cgi?action=startFindByPic&GroupID[0]=0000
1&GroupID[1]=00003&Similarity=80&MaxCandidate=500
Content-Type: image/jpeg
Content-Length: <image size>

<JPEG data>

HTTP/1.1 200 OK
Server: Device/1.0
Content-Type: multipart/x-mixed-replace; boundary=<boundary>
Connection: closed

--<boundary>
Content-Type: application/json
Content-Length: <length>

Respons
e

{ "token": 123456789,
"progress": 20
"totalCount": -1
}
--<boundary>
Content-Type: application/json

Video Analyse APIs 347

Content-Length: <length>

{ "token": 123456789,
"progress": 60
"totalCount": -1
}
--<boundary>
Content-Type: application/json
Content-Length: <length>

{ "token": 123456789,
"progress": 100
"totalCount": 350
}
--<boundary>--

 Get the find result

Table 9-30

URL

http://<server>/cgi-bin/faceRecognitionServer.cgi?action=doFindByPic

Method

GET

Descripti
on

Get the find result, reply using multipart format, first part is json string to describe all
candidate person, then the following parts are the person's pictures, refer by UID and
GroupID in part header Content-Info.
Note: the returned token will be expired after 60 seconds without any doFind call.

[ Request Params ] ( key=value format in URL )

Name

token

index

count

Type

uint

uint

uint

R/O Param Description

R

R

R

Token for this search, use this token to get result and stop
search.

The index in search result, should between 0 and totalCount
–1.

Number of result person to get.

[ Response Params ] ( JSON format )

Name

Found

Type

int

R/O Param Description

R

Number of result person that return.

Candidates

Array<object> R

Candidates Person.

+Person

++UID

object

string

++GroupID

string

++Name

++Birthday

++Sex

string

string

string

++Country

string

++Province

++City

string

string

R

R

R

R

O

O

O

O

O

Person Info.

System id for this Person, max string length is 31.

The identity of the Face Group that this Person in. max string
length is 63.

Person Name, max string length is 63.

Birthday ex: "1980-01-01".

Sex, it can be "Male", "Female", "Unknown".

Country name, length must be 2, value should be according
to ISO3166.

Province name, max string length is 63.

City name, max string length is 63.

Video Analyse APIs 348

++CertificateTy
pe

++ID

++FeatureStat
e

++HomeAddre
ss

string

string

int

string

+Similarity

int

[ Example ]

O

O

O

O

R

Certificate Type. It can be "IC', "Passport", or "Unknown".

Person ID of CertificateType, max string length is 31.

Feature State, 0:Unknown, 1:Failed, 2:OK.

Home Address, ex: “binanRoad NO1199”

Similarity.

Request

GET
http://<server>/cgi-bin/faceRecognitionServer.cgi?action=doFindByPic&token=12345678
9&index=0&count=10

HTTP/1.1 200 OK
Server: Device/1.0
Content-Type: multipart/x-mixed-replace; boundary=<boundary>
Connection: closed

Response

--<boundary>
Content-Type: application/json
Content-Length: <length>

{ "Found" : 10,
"Candidates" : [
{
"person" : {
"UID" : "0001",
"GroupID" : "001",
"Name" : "ZhangSan",
"Birthday" : "1980-01-05",
"Sex" : "Male",
...
},
"Similarity" : 85
},
{
"person" : {
"UID" : "0002",
"GroupID" : "002",
"Name" : "LiSi",
"Birthday" : "1980-01-06",
"Sex" : "Male",
...
},
"Similarity" : 80
},
{ ... }, ...
]

Video Analyse APIs 349

}
--<boundary>
Content-Info: UID=0001&GroupID=001
Content-Type: image/jpeg
Content-Length: <length>

< jpeg image data ... >
--<boundary>
Content-Info: UID=0002&GroupID=002
Content-Type: image/jpeg
Content-Length: <length>

< jpeg image data ... >
--<boundary>
...

 Stop finding

URL

http://<server>/cgi-bin/faceRecognitionServer.cgi?action=stopFindByPic

Table 9-31

Method

GET

Descripti
on

Stop the search session.

[ Request Params ] ( key=value format in URL )

Name

token

Type

R/O

Param Description

uint

R

Token for this search, use this token to get result and stop
search.

[ Response Params ] ( OK )

[ Example ]

Request

GET
http://<server>/cgi-bin/faceRecognitionServer.cgi?action=stopFindByPic&token=12345678
9

Response OK

9.2.14 Find History Person by Picture

 Start to find

Table 9-32

URL

Method

Description

http://<server>/cgi-bin/faceRecognitionServer.cgi?action=startFindHistoryByPic

POST

Start to find person in capture history by picture. The search may last for some time, so
the response may push at regular intervals until 100% Progress.
Note: If you want to find person in capture history by person info, please refer to
"mediaFileFind"API.
Note: the returned token will be expired after 60 seconds without any doFind call.

Video Analyse APIs 350

[ Request Params ] ( key=value format in URL )

Name

Channel

StartTime

EndTime

Similarity

MaxCandidate

Type

int

string

string

int

int

R/O

Param Description

R

R

R

R

O

Video channel index which starts from 0.

Start time to search, ex: 2018-01-13T00:00:00Z.

End time to search, ex: 2018-01-14T00:00:00Z.
Similarity percent, 1 — 100.
Max Candidate result number.

[ Response Params ] ( JSON format )

Name

token

progress

totalCount

[ Example ]

Request

Type

R/O

Param Description

uint

uint

int

R

R

R

Token for this search, use this token to get result and stop
search.

Search Progress, 100 means finished.

Result num, return -1 means still searching.

POST
http://<server>/cgi-bin/faceRecognitionServer.cgi?action=startFindHistoryByPic&Channe
l=0&StartTime=2018-01-13T00:00:00Z&EndTime=2018-01-14T00:00:00Z&Type=All&Si
milarity=80&MaxCandidate=500
Content-Type: image/jpeg
Content-Length: <image size>

<JPEG data>

Video Analyse APIs 351

HTTP/1.1 200 OK
Server: Device/1.0
Content-Type: multipart/x-mixed-replace; boundary=<boundary>
Connection: closed

Response

--<boundary>
Content-Type: application/json
Content-Length: <length>

{ "token": 123456789,
"progress": 20
"totalCount": -1
}
--<boundary>
Content-Type: application/json
Content-Length: <length>

{ "token": 123456789,
"progress": 60
"totalCount": -1
}
--<boundary>
Content-Type: application/json
Content-Length: <length>

{ "token": 123456789,
"progress": 100
"totalCount": 350
}
--<boundary>--

 Get find result

Table 9-33

URL

http://<server>/cgi-bin/faceRecognitionServer.cgi?action=doFindHistoryByPic

Method

GET

Descripti
on

Get the find result, reply by multipart, first part is json string to describe all candidate person,
then the following part is the person's picture, refer by UID in part header Content-Info.
Note: the returned token will be expired after 60 seconds without any doFind call.

[ Request Params ] ( key=value format in URL )

Name

token

index

count

Type

uint

uint

uint

R/O Param Description

R

R

R

Token for this search, use this token to get result and stop
search.

The index in search result, should between 0 and totalCount
–1.

Number of result person to get, start from Index.

[ Response Params ] ( JSON format )

Video Analyse APIs 352

Name

Found

Type

int

R/O Param Description

R

Number of result person that return.

Candidates

Array<object> R

Candidates Person.

+Person

++UID

++Sex

++Age

++Glasses

+Similarity

+Time

[ Example ]

Request

object

string

string

int

int

int

string

R

R

O

O

O

R
O

Person Info.

System id for this Person, max string length is 63.

Sex. It can be "Male", "Female" or "Unknown".

Age.

Glasses Status, 0: all, 1: not wear, 2: wear.

Similarity.

Appear time of the Person, format is "2013-09-02 00:00:00".

GET
http://<server>/cgi-bin/faceRecognitionServer.cgi?action=doFindHistoryByPic&token=12
3456789&index=0&count=12

HTTP/1.1 200 OK
Server: Device/1.0
Content-Type: multipart/x-mixed-replace; boundary=<boundary>
Connection: closed

Response

--<boundary>
Content-Type: application/json
Content-Length: <length>

{ "Found" : 12,
"Candidates" : [
{
"person" : {
"UID" : "0001",
"Sex" : "Male",
"Age" : 30,
"Glasses": 1
},
"Similarity" : 85
“Time”: “2013-09-02 00:00:00”
},
{
"person" : {
"UID" : "0002",
"Sex" : "Male",
"Age" : 50,
"Glasses": 2
},
"Similarity" : 80
“Time”: “2013-09-02 00:00:00”
},
{ ... }, ...
]

Video Analyse APIs 353

}
--<boundary>
Content-Info: UID=0001
Content-Type: image/jpeg
Content-Length: <length>

< jpeg image data ... >
--<boundary>
Content-Info: UID=0002
Content-Type: image/jpeg
Content-Length: <length>

< jpeg image data ... >
--<boundary>
...

 Stop finding

URL

http://<server>/cgi-bin/faceRecognitionServer.cgi?action=stopFindHistoryByPic

Table 9-34

Method

GET

Descripti
on

Stop finding.

[ Request Params ] ( key=value format in URL )

Name

token

Type

R/O

Param Description

uint

R

Token for this search, use this token to get result and stop
searching.

[ Response Params ] ( OK )

[ Example ]

Request

GET
http://<server>/cgi-bin/faceRecognitionServer.cgi?action=stopFindHistoryByPic&token=1
23456789

Response

OK

9.2.15 [Event] FaceDetection

Table 9-35

Usage

Refer to "4.9.17 Subscribe to Event Message"for how to subscribe event

Description

When the video channel disposition with some face group, and the video channel detect
a face, send this event.

[ Event Params ] ( JSON format )

Name

Faces

Type

R/O Param Description

Array<object> R

The detected faces info.

Video Analyse APIs 354

The detected face bounding box, 4 interge, refer to x's value
of left—top point, y's value of left—top point, x's value of right
—bottom point, y's value of right—bottom point. Coordinate
remap to 0 — 8192.
Sex, it can be "Man", "Woman".

Age.

Face feature, can be some of the following: "WearGlasses",
"SunGlasses", "NoGlasses", "Smile", "Anger", "Sadness",
"Disgust", "Fear", "Surprise", "Neutral", "Laugh", "Happy",
"Confused", "Scream".

Eye status, 0: not detected, 1: close eye, 2: open eye.

Mouth status, 0: not detected, 1: close mouth, 2: open mouth.

Mask status, 0: not detected, 1: not wearing mask, 2: wearing
mask.

Beard status, 0: not detected, 1: no beard, 2: has beard.

+BoundingBox Array<int>

R

+Sex

+Age

string

int

O

O

+Feature

array<string> O

+Eye

+Mouth

+Mask

+Beard

[ Example ]

int

int

int

int

O

O

O

O

--<boundary>
Content-Type: text/plain
Content-Length: <length>

Event

Code=FaceDetection;action=Start;index=0;data={
"Faces": [ { "BoundingBox": [2992,136,6960,8192],
"Sex": "Man",
"Age": 40,
"Feature": [ "WearGlasses", "Smile"],
"Eye": 2,
"Mouth": 1,
"Mask": 1,
"Beard": 2
}, {…}, … ]
}
--<boundary>

9.2.16 [Event] FaceRecognition

Table 9-36

Usage

Refer to "4.4.3 Subscribe to Snapshot"for how to subscribe event

Description

When the video channel disposition with some face group, and the video channel detect
a face, after recognize in the face groups, send this event.

[ Event Params ] ( key=value format )

Name

Events

Type

R/O Param Description

array<object> R

Event info array.

+EventBaseInf
o

++Code

object

String

R

R

Base info of event.

Event Code. It should be FaceRecognition.

Video Analyse APIs 355

++Action

++Index

+UID

String

int

String

R

O

R

Event Action. It can be "Start", "Stop" or "Pulse".

The channel index relate to this event, start from 0.

The identity of the Person, max string length is 31.

+Candidates

array<object> O

The Candidates person list.

++Person

+++UID

object

string

+++GroupID

string

+++Name

+++Birthday

+++Sex

string

string

string

+++Country

string

+++Province

+++City

+++CertificateT
ype

+++ID

string

string

string

string

++Similarity

int

+Face

++Sex

++Age

object

string

int

O

R

R

O

O

O

O

O

O

O

O

O

O

O

O

++Feature

array<string> O

++Eye

++Mouth

++Mask

++Beard

[ Example ]

int

int

int

int

O

O

O

O

--<boundary>
Content-Type: text/plain
Content-Length: <length>

The information of candidate person.

The identity of the Person, max string length is 31.

The identity of the Face Group that this Person in. max string
length is 63.

Person Name, max string length is 63.

Birthday ex: "1980-01-01".

Sex, it can be "Male", "Female", "Unknown".

Country name. The length must be 2, and value should be
according to ISO3166.

Province name, max string length is 63.

City name, max string length is 63.

Certificate Type. It can be: "IC', "Passport", "Unknown".

Person ID of CertificateType, max string length is 31.

Similarity of the Candidates person and the detected person,
value between 1 — 100.
The attribute information of face.

Sex, it can be "Man", "Woman".

Age.

Face feature, can be some of the following : "WearGlasses",
"SunGlasses", "NoGlasses", "Smile", "Anger", "Sadness",
"Disgust", "Fear", "Surprise", "Neutral", "Laugh", "Happy",
"Confused", "Scream".

Eye status, 0: not detected, 1: close eye, 2: open eye.

Mouth status, 0: not detected, 1: close mouth, 2: open mouth.

Mask status, 0: not detected, 1: not wearing mask, 2: wearing
mask.

Beard status, 0: not detected, 1: no beard, 2: has beard.

Event

Events[0].EventBaseInfo .Code=FaceRecognition
Events[0].EventBaseInfo .Action=Pulse
Events[0].EventBaseInfo .Index=0
Events[0].UID=00105
Events[0].Candidates[0].Person.UID=0012
Events[0].Candidates[0].Person.GroupID=10000
Events[0].Candidates[0].Person.Name=ZhangSan
Events[0].Candidates[0].Person.Birthday=1980-01-02
Events[0].Candidates[0].Person.Sex=Male

Video Analyse APIs 356

…
Events[0].Candidates[0].Similarity=80
Events[0].Candidates[1].Person.UID=0014
Events[0].Candidates[1].Person.GroupID=10000
Events[0].Candidates[1].Person.Name=Lisi
Events[0].Candidates[1].Person.Birthday=1980-01-05
Events[0].Candidates[1].Person.Sex=Male
…
Events[0].Candidates[1].Similarity=75
…
Events[0].Face.Sex=Man
Events[0].Face.Age=20
Events[0].Face.Feature[0]=SunGlasses
Events[0].Face.Feature[1]=Smile
Events[0].Face.Eye=2
Events[0].Face.Mouth=1
Events[0].Face.Mask=1
Events[0].Face.Beard=2
--<boundary>
Content-Type: image/jpeg
Content-Length: <image size>

<Jpeg image data>
--<boundary>

9.2.17 [Event] FaceFeatureAbstract

Table 9-37

Usage

Refer to "4.9.17 Subscribe to Event Message"for how to subscribe event

Description

When Re-Abstract Feature By Group or By Person, the abstract progress detail will send
in this event.

[ Event Params ] ( JSON format )

Name

Infos

Type

R/O Param Description

Array<object> R

Abstrace detail Info, max size is 100.

+State

String

+Process

+UID

+GroupID

[ Example ]

int

string

string

R

O

O

O

Abstract state, it can be :







"Success" : Abstract success,
"False" : Failed to abstract;
"Process" : In Process;

The abstract progress.

The identity of the person, max string length is 31.

The identity of the face group, max string length is 63.

Video Analyse APIs 357

--<boundary>
Content-Type: text/plain
Content-Length: <length>

Event

Code=FaceFeatureAbstract;action=Start;index=0;data={
"Infos": [ { "State": "Progress",
"Progress": 30,
"UID": "20005",
"GroupID": "10000"
}, {…}, … ]
}
--<boundary>

9.2.18 [Config] Face Recognition Event Handler Setting

 Get FaceRecognitionEventHandler config

Table 9-38

URL

http://<server>/cgi-bin/configManager.cgi?action=getConfig&name=FaceRecognitionEve
ntHandler

Method

GET

Description Get the Face Recognition Event Handler Setting.

[ Request Params ] ( None )

[ Response Params ] ( key=value format )

Name

table

Type

object

R/O Param Description

R

Config info table.

+FaceRecognitio
nEventHandler

array<object> R

Each face group has one config object in this array.

++GroupID

++GroupName

String

String

++EventEnable
Mask

int

++RecordEnable
Mask

int

++RecordLatch

Int

++SnapEnableM
ask

Int

++MailEnableMa
sk

Int

[ Example ]

R

R

R

R

R

R

R

The face group ID, max string length is 63.

The face group name, max string length is 127.

Report event mask, 0 means not to report event.
 Bit 0 : recognition success
 Bit 1 : recognition failed

Record media file mask., 0 means not to record.
 Bit 0 : recognition success
 Bit 1 : recognition failed

Record latch time, unit is second.

Snap picture mask., 0 means not to snap picture
 Bit 0 : recognition success
 Bit 1 : recognition failed

Send mail mask., 0 means not to send mail.
 Bit 0 : recognition success
 Bit 1 : recognition failed

Video Analyse APIs 358

Request

GET
http://10.0.0.8/cgi-bin/configManager.cgi?action=getConfig&name=FaceRecognitionEve
ntHandler

Response

table.FaceRecognitionEventHandler[0].GroupID=0017
table.FaceRecognitionEventHandler[0].GroupName=wsd
table.FaceRecognitionEventHandler[0].EventEnableMask=3
table.FaceRecognitionEventHandler[0].RecordEnableMask=0
table.FaceRecognitionEventHandler[0].RecordLatch=10
table.FaceRecognitionEventHandler[0].SnapEnableMask=3
table.FaceRecognitionEventHandler[0].MailEnableMask=0
…
table.FaceRecognitionEventHandler[1].GroupID=0018
table.FaceRecognitionEventHandler[1].GroupName=cst
table.FaceRecognitionEventHandler[1].EventEnableMask=3
table.FaceRecognitionEventHandler[1].RecordEnableMask=0
table.FaceRecognitionEventHandler[1].RecordLatch=10
table.FaceRecognitionEventHandler[1].SnapEnableMask=3
table.FaceRecognitionEventHandler[1].MailEnableMask=0
…

 Set FaceRecognitionEventHandler config

URL

http://<server>/cgi-bin/configManager.cgi?action=setConfig

Method

GET

Descripti
on

Set the Face Recognition Event Handler Setting.

[ Request Params ] ( key=value format at URL )

Name

Type

R/O Param Description

FaceRecognition
Alarm

array<object> R

Each face group has one config object in this array.

+GroupID

+GroupName

String

String

+EventEnableM
ask

+RecordEnable
Mask

int

int

+RecordLatch

Int

+SnapEnableMa
sk

+MailEnableMas
k

Int

Int

[ Response Params ] ( OK )

[ Example ]

R

R

R

R

R

R

R

The face group ID, max string length is 63.

The face group name, max string length is 127.

Report event mask, 0 means not to report event.
 Bit 0 : recognition success
 Bit 1 : recognition failed

Record media file mask., 0 means not to record.
 Bit 0 : recognition success
 Bit 1 : recognition failed

Record latch time, unit is second.

Snap picture mask., 0 means not to snap picture
 Bit 0 : recognition success
 Bit 1 : recognition failed

Send mail mask., 0 means not to send mail.
 Bit 0 : recognition success
 Bit 1 : recognition failed

Video Analyse APIs 359

Request

GET
http://10.0.0.8/cgi-bin/configManager.cgi?action=setConfig&FaceRecognitionEventHandl
er[0].GroupID=0017&FaceRecognitionEventHandler[0].GroupName=wsd&FaceRecognit
ionEventHandler[0].EventEnableMask=3&FaceRecognitionEventHandler[0].RecordEnab
leMask=0&FaceRecognitionEventHandler[0].RecordLatch=10&FaceRecognitionEventHa
ndler[0].SnapEnableMask=3&FaceRecognitionEventHandler[0].MailEnableMask=0

Response

OK

9.2.19 [Config] Face-ID Recognition Threshold

Template

Method
Parameter
Format
Parameter
Threshold

http://<server>/cgi-bin/configManager.cgi?action=setConfig&CitizenPictureCompare
Rule.Threshold=60
GET
key=value format in URL

Type
uint8

Required Description
Yes

Face-ID comparison
threshold [1, 100]

Example
60

Example
http://192.168.1.108/cgi-bin/configManager.cgi?action=setConfig&CitizenPictureCompareRule.Threshol
d=60

OK at body

Type

Required Description

Example

Parameter
Format
Parameter
Example
OK

9.2.20 Export Face Database

The exported data is binary.

Request URL

http://<server>/cgi-bin/api/FaceLibImExport/export

Method

POST

Request Params (JSON format in body)

Name

groupID

Password

Type

char[64]

char[64]

R/O

Description

Example

R

O

Person group ID

"10"

Unzip password

"abcd"

Request Example

{
"groupID" : "10",

"password": "abcd"

}

Response Params (binary in body )

Video Analyse APIs 360

Name

Type

R/O

Description

Example

Response Example

HTTP/1.1 200 OK
NTP Server Device/1.0
Content-Type: application/octet-stream
Content-Length: <length>

< binary data>

9.2.21 Importing Face Database

The imported data is binary.

Request URL

Method

http://<server>/cgi-bin/api/FaceLibImExport/import

POST

Request Params (multipart in body)

Name

password

Request Example

Type

R/O

Description

char[64] O

Unzip password

Example

"abcd"

POST http://<server>/cgi-bin/api/FaceLibImExport/import HTTP/1.1
User-Agent: client/1.0
Content-Type: multipart/x-mixed-replace; boundary=<boundary>

--<boundary>
Content-Type: application/json
Content-Length: 20

{
"password": "abcd"
}
--<boundary>
Content-Type: application/octet-stream
Content-Length: 800

< binary data>
--<boundary>

Response Params ( JSON format in body )

Name

Type

R/O

Description

Example

Response Example

{}

Video Analyse APIs 361

9.3 People Counting

9.3.1 Get Summary

Get summary information of people statistics in video.

http://<server>/cgi-bin/videoStatServer.cgi?action=getSummary
GET

Request URL
Method
Request Params ( key=value format in URL )
Name
channel
Request Example
http://192.168.1.108/cgi-bin/videoStatServer.cgi?action=getSummary&channel=1

R/O Description
O

Type
int

Video channel index which starts from 1, default is 1.

Response Params ( key=value format in body )
Name
summary
+Channel

R/O Description
R
R

Type
object
int

Summary information of people statistics in video .
Video channel index which starts from 0.
Rule type, it can be:

+RuleName

string

R

+EnteredSubto
tal
++Total
++Today
++Hour
++TotalInTime
Section
+ExitedSubtota
l
++Total
++Today
++Hour
++TotalInTime
Section
+PassedSubtot
al
++Total
++Today
++Hour
++TotalInTime
Section

object

int
int
int

int

object

int
int
int

int

object

int
int
int

int

O

R
R
R

O

O

R
R
R

O

O

R
R
R

O





"ManNumDetection": count the people num in
region, and the detail stat is in "InsideSubtotal"
param.
"NumberStat": count the people entering and
leaving the region, and the detail stat is in
"EnteredSubtotal" and "ExitedSubtotal"param.

People enter stat.

Total enter num.
Today enter num.
This hour enter num.

Today enter num after call clearSectionStat.

People leave stat.

Total leave num.
Today leave num.
This hour leave num.

Today leave num after call clearSectionStat.

People pass stat.

Total pass num.
Today pass num.
This hour pass num.

Today pass num after call clearSectionStat

Example
1

Example

1
"NumberSta
t"

14
0
0
0

32
0
0
0

32
0
0
0

Video Analyse APIs 362

+EnteredDupS
ubtotal
++Total
++Today
++Hour
++TotalInTime
Section
+ExitedDupSu
btotal
++Total
++Today
++Hour
++TotalInTime
Section
+InsideSubtota
l
++Total

++ManStayStat

object

int
int
int

int

object

int
int
int

int

object

int
array<obj
ect>

+++EnterTime

string

+++ExitTime

string

O

R
R
R

O

O

R
R
R

O

O

R

O

O

O

People duplicate enter stat.

Total duplicate enter num.
Today duplicate enter num.
This hour duplicate enter num.
duplicate
Today
clearSectionStat

enter

People duplicate leave stat.

num

after

call

Total duplicate leave num.
Today duplicate leave num.
This hour duplicate leave num.
Today
clearSectionStat

duplicate

leave

num

after

call

People inside region stat.

Today inside num.

The entering and leaving stat of people that leaved.

14
0
0
0

32
0
0
0

65

People enter time.

People leave time.

2012-01-04
00:00:00
2012-01-04
00:00:45

Response Example
summary.Channel=0
summary.RuleName=NumberStat
summary.EnteredSubtotal.Today=0
summary.EnteredSubtotal.Total=14
summary.EnteredSubtotal.TotalInTimeSection=0
summary.ExitedSubtotal.Today=0
summary.ExitedSubtotal.Total=32
summary.ExitedSubtotal.TotalInTimeSection=0
summary.PassedSubtotal.Hour=0
summary.PassedSubtotal.Today=0
summary.PassedSubtotal.Total=142
summary.PassedSubtotal.TotalInTimeSection=0
summary.EnteredDupSubtotal.Hour=0
summary.EnteredDupSubtotal.Today=0
summary.EnteredDupSubtotal.Total=0
summary.EnteredDupSubtotal.TotalInTimeSection=0
summary.EnteredSubtotal.TotalInTimeSection=17
summary.ExitedDupSubtotal.Hour=0
summary.ExitedDupSubtotal.Today=0
summary.ExitedDupSubtotal.Total=0
summary.ExitedDupSubtotal.TotalInTimeSection=0
summary.InsideSubtotal.Total=65
summary.InsideSubtotal.ManStayStat[0].EnterTime=2012-01-04 00:00:00

Video Analyse APIs 363

summary.InsideSubtotal.ManStayStat[0].ExitTime=2012-01-04 00:00:45
summary.InsideSubtotal.ManStayStat[1].EnterTime=2012-01-04 00:00:00
summary.InsideSubtotal.ManStayStat[1].ExitTime=2012-01-04 00:00:45

9.3.2 Query the Count of People

 Start to find

Start to find video stat info, in response, there is a token for further info finding process, and there is
a totalCount shows how many data count(s).

http://<server>/cgi-bin/videoStatServer.cgi?action=startFind
GET

Request URL
Method
Request Params ( key=value format in URL )
Name

Type

R/O Description

channel

int

condition

object

+StartTime

string

O

R

R

Video channel index which starts from 1,
default is 1.
Find condition.

Find time range start

+EndTime

string

R

Find time range end

+Granularity

string

R

+RuleType

string

O

+MinStayTime

int

+PlanID

int

+PtzPresetId

int

+AreaID

Array<i
nt>

O

O

O

O

+OtherRule

string

O

it

can be: NumberStat,
is
If omit, default

The information granularity returned by the
query requirements. The range is { Hour, Day,
Week, Month, Season, Year } (Note: Most
devices only support Hour, Day, Week.)
type,
Rule
ManNumDetection.
NumberStat
Valid when ruleType is ManNumDetection,
report people stay over this minimal time.
The plan id, only valid for dome camera.
The ptz preset index which starts from 1, only
valid for dome camera. Note: new device
should use PtzPresetId instead of PlanID.
The area id which starts from 1, max array size
is 20.
The
other
AverageStayTime

search

rule,

can

be

:

Example
1

2012-01-04
00:00:00
2012-01-04
00:02:00
Hour

NumberStat

20

2
1

[1,2]

AverageStayTime

Request Example
http://192.168.1.108/cgi-bin/videoStatServer.cgi?action=startFind&channel=1&condition.StartTime=201
1-01-01%2012:00:00&condition.EndTime=2011-01-10%2012:00:00&condition.Granularity=Hour&condit
ion.RuleType=NumberStat&condition.MinStayTime=20&condition.AreaID[0]=2&condition.AreaID[1]=3

Response Params ( key=value format in body )
Name

R/O Description

Type

token

int

R

Token for this search, use this token to get result
and stop search.

Example
12345

Video Analyse APIs 364

totalCount

int

R

Number of find result.

56

Response Example
token=12345
totalCount=56

 Get the find result

Get the find result of Video Stat info with channel, token, begin Number and count.

http://<server>/cgi-bin/videoStatServer.cgi?action=doFind
GET

Request URL
Method
Request Params ( key=value format in URL )
Name

Type

R/O Description

channel

token

int

int

beginNumber

int

O

R

R

Video channel index which starts from 1,
default is 1.
NOTE: must be the same as startFind.
Token for this search, use this token to get
result and stop searching.
The start count. It must be between 0 and
totalCount -1.
The count of info for this query.

Example
1

12345

0

R

int

count
Request Example
http://192.168.1.108/cgi-bin/videoStatServer.cgi?action=doFind&channel=1&token=12345&beginNumb
er=0&count=20

20

Response Params ( key=value format in body )
Type
Name
int
found
array<o
bject>
int
int

+Channel
+PlanID

R/O Description
R

R
O

info

R

Number of result that return.

Result information of video Stat.

+PtzPresetId

+AreaID

+AverageStayTim
e

int

int

int

O

O

O

+RuleName

string

R

Video channel index which starts from 0.
The plan id, only valid for dome camera.
The ptz preset index which starts from 1, only
valid for dome camera.
The area id which starts from 1.
The average stay time, only valid when startFind
with
is
OtherRule
“AverageStayTime”.
Rule name, it can be:

param’s

value





"ManNumDetection": count people num in
region, detail stat is in
"InsideSubtotal"param
"NumberStat": count people enter and leave
region, detail stat is in "EnteredSubtotal"and
"ExitedSubtotal"param.

+StartTime

+EndTime

string

string

O

O

Find time range start

Find time range end

Example
20

0
2
1

3
20

NumberStat

2012-01-04
00:00:00
2012-01-04

Video Analyse APIs 365

+EnteredSubtotal
+ExitedSubtotal
+InsideSubtotal
+PassedSubtotal
+EnteredDupSubt
otal
+ExitedDupSubtot
al

int
int
int
int
int

int

O
O
O
O
O

O

Total enter num.
Total leave num.
Total inside num.
Total pass num.

Total duplicate entered num.

Total duplicate leave num.

00:02:00
14
5
65
14
14

5

Response Example
found=20
info[0].Channel=0
info[0].AreaID=2
info[0].RuleName=NumberStat
info[0].StartTime=2012-03-14 00:00:00
info[0].EndTime=2012-04-14 00:00:00
info[0].EnteredSubtotal=14
info[0].ExitedSubtotal=5
info[0].InsideSubtotal=65
info[0].PassedSubtotal=0
info[0].EnteredDupSubtotal=0
info[0].ExitedDupSubtotal=0
info[1].Channel=0
info[1].AreaID=3
info[1].RuleName=NumberStat
info[1].StartTime=2012-03-14 00:00:00
info[1].EndTime=2012-04-14 00:00:00
info[1].EnteredSubtotal=14
info[1].ExitedSubtotal=5
info[1].InsideSubtotal=65
info[1].PassedSubtotal=0
info[1].EnteredDupSubtotal=0
info[1].ExitedDupSubtotal=0

…

 Stop the searching session

Stop query video stat by channel and token.

http://<server>/cgi-bin/videoStatServer.cgi?action=stopFind
GET

Request URL
Method
Request Params ( key=value format in URL )
Name

Type

R/O Description

channel

token

int

int

O

R

Video channel index which starts from 1,
default is 1.
NOTE: must be the same as startFind.
Token for this search, use this token to get
result and stop searching.

Example
1

12345

Video Analyse APIs 366

Request Example
GET http://192.168.1.108/cgi-bin/videoStatServer.cgi?action=stopFind&channel=1&token=12345

Response Params ( OK in body )
Response Example
OK

9.3.3 Clear the People Count Information

Clear the people count information.

http://<server>/cgi-bin/videoStatServer.cgi?action=clearSectionStat
GET

Request URL
Method
Request Params ( key=value format in URL )
Name

Type

R/O Description

channel

int

O

Video channel index which starts from 1,
default is 1.

Example
1

Request Example
GET http://192.168.1.108/cgi-bin/videoStatServer.cgi?action=clearSectionStat&channel=1

Response Params ( OK in body )
Response Example
OK

9.3.4 Subscribe the People Count Information

Subscribe the people count information.

http://<server>/cgi-bin/videoStatServer.cgi?action=attach
GET

Request URL
Method
Request Params ( key=value format in URL )
Name

Type

R/O Description

channel

int

O

heartbeat

int

O

Video channel index which starts from 1,
default is 1.
Send heartbeat interval, range is [1, 60],unit is
second. If the URL contains this parameter,
and the value is 5, it means every 5 seconds
the device should send the heartbeat message
to the client, the heartbeat message is an
string "Heartbeat". If this parameter is not
present, its default value is 60.

Example
1

5

Request Example
http://192.168.1.108/cgi-bin/videoStatServer.cgi?action=attach&channel=1&heartbeat=5

Response Params ( key=value format in body )
Name
summary

R/O Description
R

Type
object

Summary information of video Stat.

Example

Video Analyse APIs 367

+Channel

int

R

Video channel index which starts from 0.
Rule type, it can be:

0
NumberStat

+RuleName

string

R

+EnteredSubto
tal
++Total
++Today
++Hour
++TotalInTime
Section
+ExitedSubtota
l
++Total
++Today
++Hour
++TotalInTime
Section
+PassedSubtot
al
++Total
++Today
++Hour
++TotalInTime
Section
+EnteredDupS
ubtotal
++Total
++Today
++Hour
++TotalInTime
Section
+ExitedDupSu
btotal
++Total
++Today
++Hour
++TotalInTime
Section
+InsideSubtota
l
++Total

++ManStayStat

object

int
int
int

int

object

int
int
int

int

object

int
int
int

int

object

int
int
int

int

object

int
int
int

int

object

int
array<obj
ect>

O

R
R
R

O

O

R
R
R

O

O

R
R
R

O

O

R
R
R

O

O

R
R
R

O

O

R

O





"ManNumDetection": Count people num in
region, detail stat is in "InsideSubtotal" param.
"NumberStat": Count people entering and
leaving region, detail stat is in
"EnteredSubtotal" and "ExitedSubtotal" param.

People enter stat.

Total enter num.
Today enter num.
This hour enter num.

Today enter num after call clearSectionStat.

People leave stat.

Total leave num.
Today leave num.
This hour leave num.

Today leave num after call clearSectionStat.

People pass stat.

Total pass num.
Today pass num.
This hour pass num.

Today pass num after call clearSectionStat

People duplicate enter stat.

Total duplicate enter num.
Today duplicate enter num.
This hour duplicate enter num.
Today
duplicate
clearSectionStat

enter

People duplicate leave stat.

num

after

call

Total duplicate leave num.
Today duplicate leave num.
This hour duplicate leave num.
Today
clearSectionStat

duplicate

leave

num

after

call

People inside region stat.

Today inside num.

The entering and leaving stat of people that leaved.

14
2
1
0

32
3
2
0

32
0
0
0

14
0
0
0

32
0
0
0

65

Video Analyse APIs 368

2012-01-04
00:00:00
2012-01-04
00:00:45

+++EnterTime

string

+++ExitTime

string

O

O

People enter time

People leave time

Response Example
HTTP/1.1 200 OK
Server: Device/1.0
Content-Type: multipart/x-mixed-replace; boundary=<boundary>
Connection: closed

--<boundary>
Content-Type: text/plain
Content-Length: <length>

summary.Channel=0
summary.RuleName=NumberStat
summary.EnteredSubtotal.Today=2
summary.EnteredSubtotal.Total=14
summary.EnteredSubtotal.TotalInTimeSection=1
summary.ExitedSubtotal.Today=3
summary.ExitedSubtotal.Total=32
summary.ExitedSubtotal.TotalInTimeSection=2
summary.PassedSubtotal.Hour=0
summary.PassedSubtotal.Today=0
summary.PassedSubtotal.Total=142
summary.PassedSubtotal.TotalInTimeSection=0
summary.EnteredDupSubtotal.Hour=0
summary.EnteredDupSubtotal.Today=0
summary.EnteredDupSubtotal.Total=0
summary.EnteredDupSubtotal.TotalInTimeSection=0
summary.EnteredSubtotal.TotalInTimeSection=17
summary.ExitedDupSubtotal.Hour=0
summary.ExitedDupSubtotal.Today=0
summary.ExitedDupSubtotal.Total=0
summary.ExitedDupSubtotal.TotalInTimeSection=0
summary.InsideSubtotal.Total=65
summary.InsideSubtotal.ManStayStat[0].EnterTime=2012-01-04 00:00:00
summary.InsideSubtotal.ManStayStat[0].ExitTime=2012-01-04 00:00:45
summary.InsideSubtotal.ManStayStat[1].EnterTime=2012-01-04 00:00:00
summary.InsideSubtotal.ManStayStat[1].ExitTime=2012-01-04 00:00:45
--<boundary>
Content-Type: text/plain
Content-Length: 11

Heartbeat
--<boundary>
Content-Type: text/plain

Video Analyse APIs 369

Content-Length: <length>

summary.Channel=0
summary.RuleName=NumberStat
summary.EnteredSubtotal.Today=2
summary.EnteredSubtotal.Total=14
…

9.3.5 Clear statistics in time section

Table 9-39

URL

http://<server>/cgi-bin/videoStatServer.cgi?action=clearSectionStat[&AreaID=<AreaID>][ &PtzPresetId=<PtzPresetId>]

Method

GET

Description Clear statistics in time section

[ Request Params ] ( key=value format in URL )

Name

channel

AreaID

PtzPresetId

Type

R/O

Param Description

int

int

int

O

O

O

Video channel index which starts from 1, default is 1.

The area index which starts from 1, valid for multiple area
device, if omit means clear all area statistics.

The ptz preset index which starts from 1.

[ Response Params ] ( OK )

[ Example ]

Request

GET http://192.168.1.108/cgi-bin/videoStatServer.cgi?action=clearSectionStat&AreaID=2

Response OK

9.3.6 [Config] Video Widget Number Status

People Counting Overlay OSD Configuration Parameters

Type

R/O Description

Example

Config Data Params
Name

VideoWidgetNumber
Stat

object[]

R

+EncodeBlend

bool

+ShowEnterNum

bool

+ShowExitNum

bool

+TextAlign

int

R

R

R

R

Array, one element for each
channel, and the array index is the
channel number, starting from 0.
Whether to overlay it to the main
stream video encoding
Whether to display the number of
people entering
Whether to display the number of
people leaving
Text alignment mode:
0: Left alignment
2: Right alignment

true

true

true

0

Please refer to "4.2.1 Obtaining and Setting Configuration" to obtain and set the configuration. The
specific examples are as follows:

Video Analyse APIs 370

Get Config Request Example
http://192.168.1.108/cgi-bin/configManager.cgi?action=getConfig&name=VideoWidgetNumberStat

Get Config Response Example
table.VideoWidgetNumberStat[0].EncodeBlend=true
table.VideoWidgetNumberStat[0].ShowEnterNum=true
table.VideoWidgetNumberStat[0].ShowExitNum=true
table.VideoWidgetNumberStat[0].TextAlign=0
…

Set Config Request Example
http://192.168.1.108/cgi-bin/configManager.cgi?action=setConfig&VideoWidgetNumberStat[0].EncodeBl
end=true&VideoWidgetNumberStat[0].ShowEnterNum=true&VideoWidgetNumberStat[0].ShowExitNum
=true&VideoWidgetNumberStat[0].TextAlign=0

Set Config Response Example
OK

9.3.7 [Event] NumberStat

Table 9-40

Usage

Refer to "4.9.17 Subscribe to Event Message"for how to subscribe event

Description

When people number triggers the rule, send this event.

[ Event Params ] ( JSON format )

Type

R/O Param Description

Name

Number

EnteredNumber

ExitedNumber

PassedNumber

EnteredDupNum
ber

ExitedDupNumb
er

int

int

int

int

int

int

Type

string

AreaID

PresetID

[ Example ]

int

int

R

R

R

O

O

O

R

O

O

Total number in detect region.

Total number that enter the detect region.

Total number that leave the detect region.

Total pass number in detect region.

Total duplicate number that enter the detect region.

Total duplicate number that leave the detect region.

Number overrun type, it can be: "EnterOver", "ExitOver",
"InsideOver", “PassOver”.

The area id, begin from 1, if omit, means single area.

The preset id, if omit, means preset is unknown.

--<boundary>
Content-Type: text/plain
Content-Length: <length>

Event

Code=NumberStat;action=Start;index=0;data={
"Number": 120,
"EnteredNumber": 180,
"ExitedNumber": 60,
"PassedNumber": 60,

Video Analyse APIs 371

"EnteredDupNumber": 180,
"ExitedDupNumber": 60,
"Type": "EnterOver",
"Area": 2
}
--<boundary>

9.3.8 [Event] ManNumDetection

Usage

Refer to "4.9.17 Subscribe to Event Message"for how to subscribe event

Description

When people number triggers the rule, send this event.

Table 9-41

[ Event Params ] ( JSON format )

Name

ManList

Type

R/O Param Description

Array<obje
ct>

R

The people info list.

The detected people bounding box, 4 interge, refer to x's value
of left-top point, y's value of left-top point, x's value of
right-bottom point, y's value of right-bottom point. Coordinate
remap to 0 — 8192.
The people's stature, unit is cm.

The area id, begin from 1, if omit, means single area.

The preset id, if omit, means preset is unknown.

+BoundingBox

Array<int> R

+Stature

AreaID

PresetID

[ Example ]

int

int

int

R

O

O

--<boundary>
Content-Type: text/plain
Content-Length: <length>

Event

Code=ManNumDetection;action=pulse;index=0;data={
"ManList": [ { "BoundingBox": [2992,1136,4960,5192], "Stature": 170 },
{ "BoundingBox": [4392,4136,6960,6512], "Stature": 175 },

{…}, … ],
"AreaID" : 2
}
--<boundary>

9.3.9 [Event] CrowdDetection

Table 9-42

Usage

Refer to "4.9.17 Subscribe to Event Message"for how to subscribe event

Description

When crowd density overrun, send this event.

[ Event Params ] ( JSON format )

Name

Type

R/O Param Description

Video Analyse APIs 372

CrowdList

Array<obje
ct>

O

The global crowd density overrun list.

The center point, must be two int, means x and y value,
coordinate remap to 0 — 8192.
The radius length.

The people num overrun region list.

The region index.

The people count in region.

+Center

Array<int> R

+Radius

int

RegionList

+RegionID

+PeopleNum

[ Example ]

Array<obje
ct>

int

int

R

O

R

R

--<boundary>
Content-Type: text/plain
Content-Length: <length>

Event

Code=CrowdDetection;action=start;index=0;data={
"CrowdList": [ { "Center" : [5734,2377],"Radius" : 10}, …{} ],
"RegionList" : [ { "RegionID" : 0, "PeopleNum" : 100 },…{} ]

}
--<boundary>

9.4 Heat Map

9.4.1 Get Heat Map Information

Get heat map statistics by time

http://<server>/cgi-bin/heatMap.cgi?action=getPicByTime
GET

Request URL
Method
Request Params ( key=value format in URL )
Name
channel
StartTime

R/O Description
Type
R
int
char[32] R

Video channel number, starting from 1,
Heat Map Start time, 24 h: yyyy-MM-dd
HH:mm:ss.
Heat Map End time, 24 h: yyyy-MM-dd
HH:mm:ss.
Preset, starting from 1

EndTime

char[32] R

PtzPresetId

int

O

Example
1
"2015-08-20
00:00:00"
"2015-08-21
23:59:59"
1

Request Example
http://192.168.1.108/cgi-bin/heatMap.cgi?action=getPicByTime&channel=1&StartTime=2015-08-20%20
00:00:00&EndTime=2015-08-21%2023:59:59&PtzPresetId=1

Response Params ( binary data in body )
Response Example
HTTP/1.1 200 OK
Server: Device/1.0
Content-Type: application/octet-stream
Content-Length: <length>

Video Analyse APIs 373

<heatmap data>

Appendix: Format of the heat map

0

1

2

3

4

…

15

16

17

18

…

Width

Height

Reserved

Data: every byte symbolize a pixel

9.4.2 Get People Heat Map Information

URL

http://<server>/cgi-bin/videoStatServer.cgi?action=getHeatMap

Table 9-43

Method

GET

Description Get People Heat Map Information

[ Request Params ] ( key=value format in URL )

Type

R/O

Param Description

Name

channel

PlanID

StartTime

EndTime

int

int

string

string

O

O

R

R

HeatMapType

string

R

[ Response Params ] ( binary data )

Video channel index which starts from 1, default is 1.

The plan id, only valid for dome camera.

The start time, ex: "2010-05-12 20:00:00"

The end time, ex: "2010-05-12 22:00:00"

The heat map type, it can be:
“AverageStayTime” : average stay time heat map
“HumanStatistics” : human statistics heat map
“HumanTrack” : human track heat map

[ Example ]

Request

Response

GET http://192.168.1.108/cgi-bin/videoStatServer.cgi?action=getHeatMap&channel=1&
PlanID=2&StartTime=2010-05-12%2020:00:00&EndTime=2010-05-12%2022:00:00&He
atMapType=AverageStayTime

HTTP/1.1 200 OK
Server: Device/1.0
Content-Type: application/octet-stream
Content-Length: <length>

<heat map binary data>

Appendix A: The heat map binary data format when HeatMapType is AverageStayTime.

3

4~7

8~11

12~15

reserv
ed

total data length

totol lines

lines in this packet

octet

value

octet

value

0

vers
ion

1

cha
nnel

2

pres
et

16~31

reserved

octet

32~35

36~39

40~43

44~44+4\*（N-1）

value

line number

data num in this line

data 1

data N

Video Analyse APIs 374

octet

44+4*（N-1）+1~
44+4*（N-1）+4

……

……

……

value

next line number

data num in next line

data 1

data N

Note: If “lines in this packet” is 0, then all data has been sent, and connection will be closed.

Appendix B: The heat map binary data format when HeatMapType is HumanStatistics.

octet

value

octet

value

0

vers
ion

1

cha
nnel

2

pres
et

16~31

reserved

3

4~7

8~11

12~15

reserv
ed

total data length

total lines

lines in this packet

octet

32~35

36~39

40~43

44~44+4\*（N-1）

value

line number

data num in this line

data 1

data N

octet

44+4*（N-1）+1~
44+4*（N-1）+4

……

……

……

value

next line number

data num in next line

data 1

data N

Note: If “lines in this packet” is 0, then all data has been sent, and connection will be closed.

Appendix C: The heat map binary data format when HeatMapType is HumanTrack.

octet

0

1

value

versi
on

chann
el

2

pres
et

3

reser
ved

4~7

8~11

12~15

total data length

total tracks

tracks in this packet

octet

16~31

value

reserved

octet

32~35

36~39

40~43

44~44+4\*（N-1）

value Object ID

octet

44+4*（N-1）+1~
44+4*（N-1）+4

value

next object ID

track point num in
this object

track point 1

track point N

……

……

……

track point num in
next object

track point 1

track point N

 Note: If “tracks in this packet” is 0, then all data has been sent, and connection will be closed.

9.4.3 Subscribe People Realtime Trace Information

Table 9-44

URL

Method

http://<server>/cgi-bin/videoStatServer.cgi?action=attachRealTraceProc
GET

Description Subscribe the people realtime trace information.

Video Analyse APIs 375

[ Request Params ] ( key=value format in URL )

Name

channel

Type

int

R/O

Param Description

O

Video channel index which starts from 1, default is 1.

heartbeat

int

O

Send heartbeat interval, range is [1, 60],unit is second. If the
URL contains this parameter, and the value is 5, it means every
5 seconds the device should send the heartbeat message to
the client, the heartbeat meaage are "Heartbeat". If this
parameter is not present, its default value is 60.

[ Response Params ] (multipart binary data)

[ Example ]

Request

GET http://192.168.1.108/cgi-bin/videoStatServer.cgi?action=attachRealTraceProc&cha
nnel=1&heartbeat=5

HTTP/1.1 200 OK
Server: Device/1.0
Content-Type: multipart/x-mixed-replace; boundary=<boundary>
Connection: closed

--<boundary>
Content-Type: application/octet-stream
Content-Length: <length>

Response

<realtime trace binary data>
--<boundary>
Content-Type: text/plain
Content-Length: 11

Heartbeat -<boundary>
Content-Type: application/octet-stream
Content-Length: <length>

<realtime trace binary data>
--<boundary>
…

 Appendix A: The realtime trace binary data format.

octet

0

value

version

1

chan
nel

2

pres
et

3

reser
ved

4~7

8~11

12~15

total data length

reserved

object num in this
packet

octet

value

octet

value

16~31

reserved

32~35

36~37

38~39

40~43

44~47

object ID 1

object
coord x，

object
coord y

current
time in utc

reserved

Video Analyse APIs 376

octet

value

48~51

52~53

54~55

56~57

58~61

object ID 2

object
coord x

object
coord y

current
time in utc

reserved

9.4.4 Get People Histroy Trace Information

URL

http://<server>/cgi-bin/videoStatServer.cgi?action=getHistoryTrace

Table 9-45

Method

GET

Description Get people history trace information.

[ Request Params ] ( key=value format in URL )

Name

channel

PlanID

StartTime

EndTime

Type

R/O

Param Description

int

int

string

string

O

O

R

R

Video channel index which starts from 1, default is 1.

The plan id, only valid for dome camera.

The start time, ex: "2010-05-12 20:00:00"

The end time, ex: "2010-05-12 22:00:00"

[ Response Params ] ( multipart binary data )

[ Example ]

Request

GET http://192.168.1.108/cgi-bin/videoStatServer.cgi?action=getHistoryTrace&channel=
1&PlanID=2&StartTime=2010-05-12%2020:00:00&EndTime=2010-05-12%2022:00:00

HTTP/1.1 200 OK
Server: Device/1.0
Content-Type: multipart/x-mixed-replace; boundary=<boundary>
Connection: closed

Response

--<boundary>
Content-Type: application/octet-stream
Content-Length: <length>

<history trace binary data>
--<boundary>
Content-Type: application/octet-stream
Content-Length: <length>

<history trace binary data>
--<boundary>
…

 Appendix A: The history trace binary data format.

octet

value

octet

value

0

versi
on

1

chann
el

2

pres
et

3

reserv
ed

4~7

8~11

12~15

total data length

total object
num

object num in this
packet

16~31

reserved

Video Analyse APIs 377

octet

value

octet

value

32~35

36~37

38~39

40~43

44~47

object ID 1

48~51

object ID 2

object
coord x

52~53

object
coord x

object
coord y

54~55

object
coord y

current
time in utc

reserved

56~57

58~61

current
time in utc

reserved

Note: If “object num in this packet” is 0, then all data has been sent, and connection will be closed.

9.4.5 Subscribe Heat Map Raw Data

Table 9-46

URL

Method

http://<server>/cgi-bin/HeatMapManager.cgi?action=attachRaw
GET

Description Subscribe the heap map raw data.

[ Request Params ] ( key=value format in URL )

Name

channel

Type

int

R/O

Param Description

O

Video channel index which starts from 1, default is 1.

heartbeat

int

O

Send heartbeat interval, range is [1, 60],unit is second. If the
URL contains this parameter, and the value is 5, it means every
5 seconds the device should send the heartbeat message to
the client, the heartbeat meaage are "Heartbeat". If this
parameter is not present, its default value is 60.

[ Response Params ] (multipart binary data)

[ Example ]

Request

GET http://192.168.1.108/cgi-bin/HeatMapManager.cgi?action=attachRaw&channel=1&
heartbeat=5

HTTP/1.1 200 OK
Server: Device/1.0
Content-Type: multipart/x-mixed-replace; boundary=<boundary>
Connection: closed

--<boundary>
Content-Type: application/octet-stream
Content-Length: <length>

Response

<heap map raw data>
--<boundary>
Content-Type: text/plain
Content-Length: 11

Heartbeat -<boundary>
Content-Type: application/octet-stream
Content-Length: <length>

Video Analyse APIs 378

<heap map raw data>
--<boundary>
…

 Appendix A: The heap map raw data format.

octet

value

octet

value

0

1

2

3

4 ~ 23

width

height

24~43

EndTime, ex: “2012-01-04 01:00:00”

StartTime, ex: “2012-01-04 00:00:00”

44 ~ 47

reserved

octet

48

49

…

value

Data: every byte symbolize a pixel

9.5 Crowd Distribute Map

9.5.1 Get Channel Caps

Table 9-47

Syntax

Method

http://<server>/cgi-bin/crowdDistriMap.cgi?action=getCaps

GET

Description Get Channel CrowdistriMap Caps.

Example

http://192.168.1.108/cgi-bin/crowdDistriMap.cgi?action=getCaps

Success
Return

Comment

CrowdCapsList[0].channel=<ChannelNo>
CrowdCapsList[0].Support=<Support>
CrowdCapsList[1].channel=<ChannelNo>
CrowdCapsList[1].Support=<Support>
…

Parameters in URL and Response:
ChannelNo : video channel index
Support : true or false, support or not

9.5.2 Subscribe to Realtime Crowd Stat

Table 9-48

Syntax

http://<server>/cgi-bin/crowdDistriMap.cgi?action=attach&channel=<ChannelNo>[&he
artbeat=<Heartbeat>]

Method

GET

Description

Subscribe the crowd distribuite map information, return info at regular time.

Example

http://<server>/cgi-bin/crowdDistriMap.cgi?action=attach&channel=1&heartbeat=5

Success
Return

HTTP/1.1 200 OK
Content-Type: multipart/x-mixed-replace; boundary=<boundary>
Connection: close

Video Analyse APIs 379

--<boundary>
Content-Type: text/plain
Content-Length: <data length>

CrowdStatData[0].Channel=1
CrowdStatData[0].GloabalPeopleNum =10
CrowdStatData[0].RegionNum =1
CrowdStatData[0].RegionPeopleList[0].RegionID=0
CrowdStatData[0].RegionPeopleList[0].Region[0][0]=10
CrowdStatData[0].RegionPeopleList[0].Region[0][1]=10
CrowdStatData[0].RegionPeopleList[0].Region[1][0]=10
CrowdStatData[0].RegionPeopleList[0].Region[1][1]=100
…
CrowdStatData[0].RegionPeopleList[0].RegionPeopleNum=100
CrowdStatData[0].CrowdEventNum =2
CrowdStatData[0].CrowdList[0].Center=2
CrowdStatData[0].CrowdList[0].Radius=2
CrowdStatData[0].RegionEventNum =2
CrowdStatData[0].RegionList[0].Region[0][0]=10
CrowdStatData[0].RegionList[0].Region[0][1]=10
CrowdStatData[0].RegionList[0].Region[1][0]=10
CrowdStatData[0].RegionList[0].Region[1][0]=100
…
CrowdStatData[0].RegionList[0].RegionID=0
CrowdStatData[0].RegionList[0].PeopleNum=100
--<boundary>
Content-Type: text/plain
Content-Length: 11

Heartbeat
--<boundary>
Content-Type: text/plain
Content-Length: <data length>

CrowdStatData[0].Channel=1
…

Parameters in URL and Response
ChannelNo: integer, video channel index to subscribe

Comment

Region is Polygon, has a list of points, every point has x and y , so Region[0][0] is first
point's x, Region[0][1] is first point's y, Region[1][0] is second point's x, Region[1][1] is
second point's y, and so on

Heartbeat: integer, range is [1,60],unit is second.If the URL contains this parameter,
and the value is 5, it means every 5 seconds the device should send the heartbeat
message to the client,the heartbeat meaage are "Heartbeat".

Video Analyse APIs 380

9.5.3 Get Current Crowd Stat

Table 9-49

Syntax

http://<server>/cgi-bin/crowdDistriMap.cgi?action=getSummary&channel=<ChannelNo

>

Method

GET

Description

Get crowd distribuite map information, return info only once.

Example

http://<server>/cgi-bin/crowdDistriMap.cgi?action=getSummary&channel=1

Success
Return

CrowdStatData[0].Channel=1
CrowdStatData[0].GloabalPeopleNum =10
CrowdStatData[0].RegionNum =1
CrowdStatData[0].RegionPeopleList[0].RegionID=0
CrowdStatData[0].RegionPeopleList[0].Region[0][0]=10
CrowdStatData[0].RegionPeopleList[0].Region[0][1]=10
CrowdStatData[0].RegionPeopleList[0].Region[1][0]=10
CrowdStatData[0].RegionPeopleList[0].Region[1][1]=100
…
CrowdStatData[0].RegionPeopleList[0].RegionPeopleNum=100
CrowdStatData[0].CrowdEventNum =2
CrowdStatData[0].CrowdList[0].Center=2
CrowdStatData[0].CrowdList[0].Radius=2
CrowdStatData[0].RegionEventNum =2
CrowdStatData[0].RegionList[0].Region[0][0]=10
CrowdStatData[0].RegionList[0].Region[0][1]=10
CrowdStatData[0].RegionList[0].Region[1][0]=10
CrowdStatData[0].RegionList[0].Region[1][0]=100
…
CrowdStatData[0].RegionList[0].RegionID=0
CrowdStatData[0].RegionList[0].PeopleNum=100

Comment

Similar to above "Subscribe to Realtime Crowd Stat", but reply stat only once, not at
regular time.
ChannelNo: integer, video channel index which starts from 1.

9.6 Video Analyse

9.6.1 Get Video Analyse Capability

Table 9-50

Syntax

Method

http://<server>/cgi-bin/devVideoAnalyse.cgi?action=getcaps&channel=<ChannelNo>

GET

Description

Get video analyse capabilities.

Example

Success
Return

http://192.168.1.108/cgi-bin/devVideoAnalyse.cgi?action=getcaps&channel=1

caps.CalibrateBoxs[0]=2
caps.CalibrateBoxs[1]=3

Video Analyse APIs 381

caps.ComplexSizeFilter=false
caps.MaxCelibateAreas=10
caps.MaxExcludeRegions=0
caps.MaxInternalOptions=512
caps.MaxModules=1
caps.SupportGlobalDeviceParam=1
caps.MaxPointOfLine=20
caps.MaxPointOfRegion=20
caps.MaxRules=10
caps.MaxStaffs=4
caps.SpecifiedObjectFilter=true
caps.SupportedRules[0]=CrossLineDetection
caps.SupportedRules[1]=CrossRegionDetection
caps.SupportedRules[2]=LeftDetection
caps.SupportedRules[3]=TakenAwayDetection
caps.SupportedScene[0]=Normal
caps.SupportedScene[1]=FaceDetection
caps.SupportedScene[2]=VideoDiagnosis
caps.SupportedScenes.FaceDetection.SupportedCalibrateParams.Groud.HorizontalSt
affs[0]=0
caps.SupportedScenes.FaceDetection.SupportedCalibrateParams.Groud.HorizontalSt
affs[1]=0
caps.SupportedScenes.FaceDetection.SupportedCalibrateParams.Groud.VerticalStaffs
[0]=0
caps.SupportedScenes.FaceDetection.SupportedCalibrateParams.Groud.VerticalStaffs
[1]=0
caps.SupportedScenes.StereoNumber.SupportedRules.ManNumDetection.SupportLoc
alDataStore=false
caps.SupportedScenes.NumberStat.CameraType=1
caps.SupportedScenes.NumberStat.SupportedRules.NumberStat.MaxRules=8
caps.SupportedScenes.StereoBehavior.OnlyFindLastEvtList[0]="ManStandDetection"

Parameters in URL:
ChannelNo: integer, video channel index which starts from 1.

Comment

Appendix

ParamName

ParamValue type Description

caps.SupportedScenes.Stere
oBehavior.OnlyFindLastEvtLi
st

array<string>

event type list in which last ones are supported to
be inquired.

9.6.2 [Config] Video Analyse Global

 Get video analyse global config

Table 9-51

Syntax

http://<server>/cgi-bin/configManager.cgi?action=getConfig&name=VideoAnalyseGlob

Video Analyse APIs 382

Method

al

GET

Description

Get video analyse global config.

Example

http://192.168.1.108/cgi-bin/configManager.cgi?action=getConfig&name=VideoAnalyse
Global

Success
Return

head.Scene.Type=Normal
head.Scene.PtzPresetId=1
head.Scene.Depth=Far
head.Scene.Detail.CameraAngle=30
head.Scene.Detail.CameraDistance=10.000000
head.Scene.Detail.CameraHeight=6.200000
head.TimePeriod.Day[0]=8:00:00
head.TimePeriod.Day[1]=20:00:00
head.TimePeriod.Night[0]=20:00:00
head.TimePeriod.Night[1]=8:00:00
…

Comment

Parameters in Response :
head =table.VideoAnalyseGlobal[ChannelNo]
ChannelNo: integer, array index starts from 0, which means video channel(equals to
video channel index -1, and so 0 means channel 1).

 Set video analyse global config

Table 9-52

Syntax

http://<server>/cgi-bin/configManager.cgi?action=setConfig&<paramName>=<paramV
alue>[&<paramName>=<paramValue>...]

Method

GET

Description

Set video analyse global config.

http://192.168.1.108/cgi-bin/configManager.cgi?action=setConfig&VideoAnalyseGlobal[
0].Scene.Type=Normal&VideoAnalyseGlobal[0].Scene.PtzPresetId=1

OK

Parameters in URL:
paramName and paramValue are as table below.
In table below, head =VideoAnalyseGlobal[ChannelNo]
ChannelNo: integer, array index starts from 0, which means video channel (equals to
video channel index -1, and so 0 means channel 1).
ParamName start with head.Scene.Detail depends on head.Scene.Type.

Example

Success
Return

Comment

Appendix

ParamName

ParamValue type Description

head.Scene.Type

string

"Traffic",

Scene class, the range is { "", "Normal", "Indoor",
"FaceRecognition",
"ATM",
"HeatMap",
"FaceDetection",
"VehicleAnalyse",
"VideoDiagnosis",
"TrafficPatrol",
,
"Vehicle"
"CourseRecord",
"ObjectDetect", "VehicleCompare"}

"NumberStat",

Video Analyse APIs 383

ParamName

ParamValue type Description

head.Scene.PtzPresetId

integer

head.Scene.Depth

string

Range is 0 — 255, 0 means that the scene is
unassociated with PTZ.

Picture distance feature, the range is { "Normal",
"Far", "Middle", "Near" }

head.Scene.Detail.Value

string

Detail config of a scene. For example, when
Scene.Type
includes
CameraAngle, CameraDistance, CameraHeight,
etc.

is "Normal",

it's detail

head.TimePeriod.Day[0]

head.TimePeriod.Day[1]

head.TimePeriod.Night[0]

head.TimePeriod.Night[1]

string

string

string

string

The start time of Day, it's format is hh:mm:ss

The end time of Day

The start time of Night, it's format is hh:mm:ss

The end time of Night

9.6.3 [Config] Video Analyse Rule

 Get video analyse rule

Table 9-53

Syntax

Method

http://<server>/cgi-bin/configManager.cgi?action=getConfig&name=VideoAnalyseRule

GET

Description

Get video analyse rules config.

Example

http://192.168.1.108/cgi-bin/configManager.cgi?action=getConfig&name=VideoAnalyse
Rule

Success
Return

Comment

head.Name= line1
head.Type=CrossLineDetection
head.VideoAnalyseRule[0][0].Enable =true
head.VideoAnalyseRule[0][0].EventHandler= (output of EventHandler is described in
GetEventHandler)
…
Parameters in Response :
head =table.VideoAnalyseRule[ChannelNo] [RuleNo]
ChannelNo: integer, array index starts from 0, which means video channel (equals to
video channel index -1, and so 0 means channel 1).
RuleNo =rule index.

 Set video analyse rule

Table 9-54

Syntax

http://<server>/cgi-bin/configManager.cgi?action=setConfig&<paramName>=<paramV
alue>[&<paramName>=<paramValue>…]

Method

GET

Description

Set video analyse rules config.

Example

http://192.168.1.108/cgi-bin/configManager.cgi?action=setConfig&VideoAnalyseRule[0]
[0].Name=myAnalyseRule1&VideoAnalyseRule[0][0].Type=CrossLineDetection

Success

OK

Video Analyse APIs 384

Return

Comment

Appendix

ParamName

head.Name

Parameters in URL:
paramName and paramValue are as table below.
In table below, head =VideoAnalyseRule[ChannelNo] [RuleNo]
ChannelNo: integer, array index starts from 0, which means video channel (equals to
video channel index -1, and so 0 means channel 1).
RuleNo =rule index.
ParamName start with head.Config is only effective with {"CrossLineDetection",
"CrossRegionDetection", "LeftDetection", "TakenAwayDetection"}.

ParamValue type

Description

string

Rule name, it must be unique.

head.Type

string

is

{"CrossLineDetection",
"LeftDetection",

The
range
"CrossRegionDetection",
"TakenAwayDetection",
"VideoAbnormalDetection",
"AudioMutation",
"VideoUnFocus",
"RioterDetection",
"MoveDetection",
"FaceAttribute",
"NonMotorDetect",
"ObjectPlacement", "ObjectRemoval" }.

"FaceDetection",
"AudioAnomaly",
"WanderDetection",
"ParkingDetection",
"HeatMap",
"VehicleDetect",
"HumanTrait",

"NumberStat",

head.Enable

head.EventHandler

bool

—

Enable/Disable this rule.

Setting of EventHandler
SetEventHandler.

is described

in

head.Config.DetectLine[0][0]

integer

The start point of DetectLine 0;

head.Config.DetectLine[0][1]

integer

The end point of DetectLine 0;

head.Config.DetectLine[1][0]

integer

The start point of DetectLine 1;

head.Config.DetectLine[1][1]

integer

The end point of DetectLine 1;

head.Config.Direction

string

range

The
"Both"}.

is

{"LeftToRight",

"RightToLeft",

head.Config.SizeFilter.MaxSi
ze[0]

integer

to

Maximum width. The width of the object must not
be beyond maximum width.
Adapt
"CrossRegionDetection",
"TakenAwayDetection",
"WanderDetection",
"ParkingDetection", "MoveDetection"}.

{"CrossLineDetection",
"LeftDetection",
"FaceDetection",
"RioterDetection",

head.Config.SizeFilter.MaxSi
ze[1]

head.Config.SizeFilter.MinSi
ze[0]

head.Config.SizeFilter.MinSi
ze[1]

integer

integer

integer

Maximum height. The height of the object must
not be beyond maximum height.

Minimum width. The width of the object must not
be less than minimum width.

Minimum height. The height of the object must
not be beyond minimum height.

Video Analyse APIs 385

ParamName

ParamValue type

Description

head.Config.DetectRegion[0]
[0]

integer

The start point of DetectRegion 0;
to
Adapt
"LeftDetection",
"WanderDetection",
"ParkingDetection", "MoveDetection"}.

{"CrossRegionDetection",
"TakenAwayDetection",
"RioterDetection",

head.Config.DetectRegion[0]
[1]

head.Config.DetectRegion[1]
[0]

head.Config.DetectRegion[1]
[1]

head.Config.DetectRegion[2]
[0]

head.Config.DetectRegion[2]
[1]

integer

The end point of DetectRegion 0;

integer

The start point of DetectRegion 1;

integer

The end point of DetectRegion 1;

integer

The start point of DetectRegion 2;

integer

The start point of DetectRegion 2;

head.Config.MinDuration

integer

head.Config.Sensitivity

integer

head.Config.EnterThreshold

integer

head.Config.ExitThreshold

integer

head.Config.InsideThreshold

integer

head.Config.DirectionStats.E
nable

bool

head.Config.DirectionStats.D
etectLine[0][0]

integer

head.Config.DirectionStats.D
etectLine[0][1]

integer

head.Config.DirectionStats.D
etectLine[1][0]

integer

Range is 1—600, adapt to {"LeftDetection",
"TakenAwayDetection", "WanderDetection"}.
Range is 10-300, adapt to {"RioterDetection"}.
Range is 6-300, adapt to {"ParkingDetection"}.

Range is 1—10, adapt to {"RioterDetection",
"MoveDetection"}.

Range
{"NumberStat"}.

is

Range
{"NumberStat"}.

is

Range
{"NumberStat"}.

is

0—100000000,

adapt

to

0—100000000,

adapt

to

0—100000000,

adapt

to

Enable/Disable objectdetect Direction. Rule
range is {"VehicleDetect", "NonMotorDetect",
"HumanTrait"}.

The start point of DetectLine 0, Rule range is
{"VehicleDetect", "NonMotorDetect",
"HumanTrait"}.

The start point of DetectLine 0, Rule range is
{"VehicleDetect", "NonMotorDetect",
"HumanTrait"}.

The start point of DetectLine 1, Rule range is
{"VehicleDetect", "NonMotorDetect",
"HumanTrait"}.

head.Config.DirectionStats.D
etectLine[1][1]

integer

The start point of DetectLine 1, Rule range is
{"VehicleDetect", "NonMotorDetect",

Video Analyse APIs 386

ParamName

ParamValue type

Description

"HumanTrait"}.

head.Config.DirectionStats.D
irection

string

head.Config.FilterUnAliveEn
able

head.Config.EyesDistThresh
old

bool

uint32

The range is {"LeftToRight", "RightToLeft",
"Both"}. Rule range is {"VehicleDetect",
"NonMotorDetect", "HumanTrait"}.

Enable the non-living filtering function. It is false

by default.

Set filtering threshold of pupillary distance. If the

actual pupillary distance is less than the
threshold, it will be filtered. Refer to GB/T
35678-2017: Value range [50–no upper limit]
required for face recognition application image
technology. The default value 0 indicates no
filtering.

head.Config.HelmetEnable

bool

Enable safety helmet detection. With the

function enabled, the face recognition result
carries information related to safety helmet
detection. It is false by default.

head.Config.TempSwitch

uint8

Select temperature monitoring status:

0: Disable temperature monitoring

1: Normal temperature monitoring

2: Debug temperature monitoring

head.Config.TempModel

uint8

Temperature monitoring mode (valid when

TempSwitch is not 0):

head.Config.TempStrategy.T
empValueMax

head.Config.TempStrategy.T
empValueMin

double

double

head.Config.TempStrategy.T
empType

uint8

head.Config.TempStrategy.S
lideNum

head.Config.TempStrategy.H
ightTempStrategy.TempDete
ctRegion

uint8

uint8

0: Automatical mode

1: Thermal image detection mode

2: Calibration mode

Maximum value of normal face temperature

range

Minimum value of normal face temperature range

Strategy type for calculating face temperature:

0: Use the highest temperature

1: Use the average temperature

The number of sliding cache frames. 0 means no
sliding, and the maximum cache is 32 frames.

Parameter for maximum temperature strategy

(valid when tempType is 0).

Calculate the highest temperature area:

0: Forehead

Video Analyse APIs 387

ParamName

ParamValue type

Description
1: Whole face

head.Config.TempStrategy.A
verageTempStrategy.Strateg
yType

uint8

head.Config.TempStrategy.A
verageTempStrategy.PointN
um

uint8

head.Config.TempStrategy.A
verageTempStrategy.Enable
Filter

bool

head.Config.FilterMaskUnAli
veEnable

bool

9.6.4 Get Last Event Info

Get Last Event Info

Parameter for maximum temperature strategy

(valid when tempType is 1).

Average temperature strategy type:

0: Center point

1: high temperature point

Parameter for average temperature strategy

(valid when tempType is 1).

The number of points used to find the average

value, and it is the square of the integer, such
as 4, 9, and 16.

Parameter for average temperature strategy

(valid when tempType is 1).

Whether to enable the removal of the highest
temperature and the lowest temperature to
take the average value:

False: Disable

True: Enable

Select whether to enable liveness detection for
person wearing mask. This value is related to
FilterUnAliveEnable. When
FilterUnAliveEnable is true (liveness detection
is enabled), this field is valid.

Syntax

http://<server>/cgi-bin/devVideoAnalyse.cgi?action=getLastEventInfo&channel=<Chan
nelNo>&ClassName=<ClassNameStr>&EventName=<EventNameStr>

Table 9-55

Method

GET

Description

Get last event info

Example

Success
Return

Comment

http://192.168.1.108/cgi-bin/devVideoAnalyse.cgi?action=getLastEventInfo&channel=1
&ClassName=StereoBehavior&EventName=ManStandDetection

State=1
EventInfo.Code=ManStandDetection
EventInfo.Action=Start

Parameters in Response :
ChannelNo: integer, array index starts from 0, which means video channel (equals to
video channel index -1, and so 0 means channel 1).
ClassNameStr: str, means Class name.

Video Analyse APIs 388

EventNameStr: str, means Event name.

9.6.5 [Config] GlobalDeviceParam

 Get Global Device Param

Syntax

http://<server>/cgi-bin/configManager.cgi?action=getConfig&name=GlobalDevicePara
m

Method

GET

Description

Get Global Device Param

[ Request Params ] (key=value format at URL )

Name

Type

R/O Param Description

[ Response Params ] (key=value format )

Name

table

Type

object

+LocateHeight

Float

R/O Param Description

R

R

Device locate Height

[ Example ]

Request

http://<server>/cgi-bin/configManager.cgi?action=getConfig&name=
GlobalDeviceParam

Response

table.GlobalDeviceParam.LocateHeight=10.5

 Set Global Device Param

Syntax

http://<server>/cgi-bin/configManager.cgi?action=setConfig&<paramName>=<param
Value>[&<paramName>=<paramValue>…]

Method

GET

Description

Set Global Device Param

[ Request Params ] (key=value format at URL )

Name

GlobalDeviceP
aram

Type

object

+LocateHeight

float

R/O Param Description

R

R

Global Device Param

Device locate Height

[ Response Params ] (OK at Body )

Name

Type

R/O Param Description

[ Example ]

Request

http://<server>/cgi-bin/configManager.cgi?action=setConfig&
GlobalDeviceParam.LocateHeight = 10.5

Response

Ok

9.6.6 Get Template Rule

Gets all intelligent rule configuration templates and default values under the specified category

GET

Request URL http://<server>/cgi-bin/VideoInAnalyse.cgi?action=getTemplateRule
Method
Request Params ( key=value format in URL )
Name
Class

R/O Description
R

Type
Char[32]

the same meaning with Type in config
VideoAnalyseGlobal

Example
"Normal"

Video Analyse APIs 389

"Normal"
"Traffic"
"TrafficPatrol"
"FaceDetection"(shared by face detect and
face recognition)
in added, Web can use “ALL” for all rules.
video channel, which starts from 1.

integer

Channel
Example
http://<server>/cgi-bin/VideoInAnalyse.cgi?action=getTemplateRule&Channel=1&Class=Normal

R

1

Example

[0, 0]
[8191, 8191]

"Both"
0

["Unknown"]

"CrossLineDetection"
"Normal"
false
0

default config of crossline
format as the same as each object in
the second dimension of
VideoAnalyseRule
detail of rule config

Type
object
object
object

Response Params ( key=value format in body )
Name
Rule
+Normal
++CrossRegio
nDetection
++CrossLineD
etection

R/O Description
R
R
R

object

R

rule info
business class
cross region templet

R

R

R
R

char[][]

object[]

R
R
R
R

Preset number

char[]
integer

type of detect object

object
+++Config
++++SizeFilter object
int[2]
+++++MinSize
int[2]
+++++MaxSiz
e
++++DetectLin
e
++++Direction
+++PtzPresetI
d
+++ObjectTyp
es
+++Type
+++Class
+++Enable
+++Id
Example
Rule.Normal.CrossLineDetection.Id=0
Rule.Normal.CrossLineDetection.Enable=false
Rule.Normal.CrossLineDetection.Class=Normal
Rule.Normal.CrossLineDetection.Type=CrossLineDetection
Rule.Normal.CrossLineDetection.ObjectTypes[0]=Unknown
Rule.Normal.CrossLineDetection.PtzPresetId=0
Rule.Normal.Config.Direction=Both
Rule.Normal.Config.SizeFilter.MaxSize[0]=[8191, 8191]
Rule.Normal.Config.SizeFilter.MinSize[0]=[0, 0]

rule type
business plan class
enable the rule
rule id

char[64]
char[16]
bool
integer

R
R
R
R

Video Analyse APIs 390

…

9.6.7 [Config] IntelliSchemeTourEnableSetting

http://<server>/cgi-bin/configManager.cgi?action=setConfig&IntelliSchemeTour.Enable
=<enableValue>

Syntax

Method

Request
Params

Name

IntelliSchemeT
our

SET

key=value format at URL

Type

object

R/O

O

+Enable

bool

R

Example

Description

Example

IntelliSchemeTour Enable
Setting

IntelliSchemeTour Enable
Setting

True

http://<server>/cgi-bin/configManager.cgi?action=setConfig&IntelliSchemeTour.Enable=true

Request Params

key=value format at URL

Name

Example

OK

Type

R/O Description

Example

9.6.8 [Config] Intelligent Tour Plan

Get intelligent tour plan

Syntax

Method

Parameter
Format

Parameter

http://<server>/cgi-bin/configManager.cgi?action=getConfig&name=I
ntelliSchemeTour

GET

key=value format at URL

Type

Required

Description

Example

IntelliSchemeTour object

Yes

Intelligent package
tour plan

Example

http://<server>/cgi-bin/configManager.cgi?action=getConfig&name=IntelliSchemeTour

Parameter
Format

Parameter

key=value format at URL

Type

Required Description

Example

IntelliSchemeTour object

No

+Enable

bool

No

Intelligent package
tour plan. No
channel sensitive.

Whether the
package tour plan is
enabled.

true

Video Analyse APIs 391

+TourPriMode

enumchar[
32]

No

Tour priority mode

"Switch"

enumchar[32]{

"Switch": Scene
priority, tour in strict
accordance with the
defined tour time.

"Detect": Detection
priority, with the
complete set of data
as the condition for
scene switching
upon completion of
scene detection (For
illegal parking
detection cameras.
Multiple images may
be needed in one
scene. In this case,
the camera can
rotate to the next
scene after all
images are
captured).

"Tour": Tour priority,
similar to detection
priority, with a set of
data as the
condition for scene
switching upon
completion of scene
detection (both
close shot and long
shot available. Apply
close shot first and
then long shot
according to the tour
path).

}

For details, refer to
the capability set
IntelliScheme.getCa

Video Analyse APIs 392

+IdleWaitingTime

uint32

No

+SceneSwitching
Time

uint32

No

10

20

ps.

Idle waiting time,
that is, the idle delay
time until the tour
plan continues to
take effect after a
user stops operating
the device, in
second(s).

Scene switching
time. When the tour
plan is enabled and
the priority mode is
either detection
priority or tour
priority, it will
automatically rotate
to the next scene
after an object
cannot be detected
for a certain period
of time.

+TourPlan

object[7][1 6]

No

Package tour plan

2D array. The first
dimension indicates
the day of a week,
totally 7 weekdays,
and the second
dimension indicates
the tour groups
supported that day.

Period of time.
00:00:00 indicates
the start time and
23:59:59 indicates
the end time.

"1
00:00:00-23:59:59"

++TimeSection

TimeSectio
n

No

++TourPath

object[]

No

Tour path

null

1D array, to adjust
the order of
packages. Up to 10
packages are
supported. It is null
by default and
added by a user.
Field values are

Video Analyse APIs 393

+++SchemeID

uint32

No

+++Duration

uint32

No

+++Speed

uint32

No

1

600

7

specified by a user.

Intelligent package
ID, value range:
1-300.

Retention time,
value range:
30-36,000 s or 0.

It is 0 by default if
this field is
unavailable.
Indicates that the
switching has not
been made during
the period of time.

The speed of the
camera rotating to
the preset when a
package includes a
preset channel of a
PTZ camera, value
range: 1-10 speed
levels.

Example

table.IntelliSchemeTour.Enable=true
table.IntelliSchemeTour.IdleWaitingTime=10
table.IntelliSchemeTour.SceneSwitchingTime=20
table.IntelliSchemeTour.TourPlan[0][0].TimeSection=1 00:00:00-00:00:00
table.IntelliSchemeTour.TourPlan[0][1].TimeSection=1 00:00:00-00:00:00
table.IntelliSchemeTour.TourPlan[0][2].TimeSection=1 00:00:00-00:00:00
table.IntelliSchemeTour.TourPlan[0][3].TimeSection=1 00:00:00-00:00:00
table.IntelliSchemeTour.TourPlan[0][4].TimeSection=1 00:00:00-00:00:00
table.IntelliSchemeTour.TourPlan[0][5].TimeSection=1 00:00:00-00:00:00
table.IntelliSchemeTour.TourPlan[0][6].TimeSection=1 00:00:00-00:00:00
table.IntelliSchemeTour.TourPlan[0][7].TimeSection=1 00:00:00-00:00:00
table.IntelliSchemeTour.TourPlan[0][8].TimeSection=1 00:00:00-00:00:00
table.IntelliSchemeTour.TourPlan[0][9].TimeSection=1 00:00:00-00:00:00
table.IntelliSchemeTour.TourPlan[0][10].TimeSection=1 00:00:00-00:00:00
table.IntelliSchemeTour.TourPlan[0][11].TimeSection=1 00:00:00-00:00:00
table.IntelliSchemeTour.TourPlan[0][12].TimeSection=1 00:00:00-00:00:00
table.IntelliSchemeTour.TourPlan[0][13].TimeSection=1 00:00:00-00:00:00
table.IntelliSchemeTour.TourPlan[0][14].TimeSection=1 00:00:00-00:00:00
table.IntelliSchemeTour.TourPlan[0][15].TimeSection=1 00:00:00-00:00:00
table.IntelliSchemeTour.TourPlan[1][0].TimeSection=1 00:00:00-00:00:00
table.IntelliSchemeTour.TourPlan[1][1].TimeSection=1 00:00:00-00:00:00
table.IntelliSchemeTour.TourPlan[1][2].TimeSection=1 00:00:00-00:00:00
table.IntelliSchemeTour.TourPlan[1][3].TimeSection=1 00:00:00-00:00:00

Video Analyse APIs 394

table.IntelliSchemeTour.TourPlan[1][4].TimeSection=1 00:00:00-00:00:00
table.IntelliSchemeTour.TourPlan[1][5].TimeSection=1 00:00:00-23:00:00
table.IntelliSchemeTour.TourPlan[1][6].TimeSection=1 00:00:00-00:00:00
table.IntelliSchemeTour.TourPlan[1][7].TimeSection=1 00:00:00-00:00:00
table.IntelliSchemeTour.TourPlan[1][8].TimeSection=1 00:00:00-00:00:00
table.IntelliSchemeTour.TourPlan[1][9].TimeSection=1 00:00:00-00:00:00
table.IntelliSchemeTour.TourPlan[1][10].TimeSection=1 00:00:00-00:00:00
table.IntelliSchemeTour.TourPlan[1][11].TimeSection=1 00:00:00-00:00:00
table.IntelliSchemeTour.TourPlan[1][12].TimeSection=1 00:00:00-00:00:00
table.IntelliSchemeTour.TourPlan[1][13].TimeSection=1 00:00:00-00:00:00
table.IntelliSchemeTour.TourPlan[1][14].TimeSection=1 00:00:00-00:00:00
table.IntelliSchemeTour.TourPlan[1][15].TimeSection=1 00:00:00-00:00:00
table.IntelliSchemeTour.TourPlan[2][0].TimeSection=1 00:00:00-00:00:00
table.IntelliSchemeTour.TourPlan[2][1].TimeSection=1 00:00:00-00:00:00
table.IntelliSchemeTour.TourPlan[2][2].TimeSection=1 00:00:00-00:00:00
table.IntelliSchemeTour.TourPlan[2][3].TimeSection=1 00:00:00-00:00:00
table.IntelliSchemeTour.TourPlan[2][4].TimeSection=1 00:00:00-00:00:00
table.IntelliSchemeTour.TourPlan[2][5].TimeSection=1 00:00:00-00:00:00
table.IntelliSchemeTour.TourPlan[2][6].TimeSection=1 00:00:00-00:00:00
table.IntelliSchemeTour.TourPlan[2][7].TimeSection=1 00:00:00-00:00:00
table.IntelliSchemeTour.TourPlan[2][8].TimeSection=1 00:00:00-00:00:00
table.IntelliSchemeTour.TourPlan[2][9].TimeSection=1 00:00:00-00:00:00
table.IntelliSchemeTour.TourPlan[2][10].TimeSection=1 00:00:00-00:00:00
table.IntelliSchemeTour.TourPlan[2][11].TimeSection=1 00:00:00-00:00:00
table.IntelliSchemeTour.TourPlan[2][12].TimeSection=1 00:00:00-00:00:00
table.IntelliSchemeTour.TourPlan[2][13].TimeSection=1 00:00:00-00:00:00
table.IntelliSchemeTour.TourPlan[2][14].TimeSection=1 00:00:00-00:00:00
table.IntelliSchemeTour.TourPlan[2][15].TimeSection=1 00:00:00-00:00:00
table.IntelliSchemeTour.TourPlan[3][0].TimeSection=1 00:00:00-00:00:00
table.IntelliSchemeTour.TourPlan[3][1].TimeSection=1 00:00:00-00:00:00
table.IntelliSchemeTour.TourPlan[3][2].TimeSection=1 00:00:00-00:00:00
table.IntelliSchemeTour.TourPlan[3][3].TimeSection=1 00:00:00-00:00:00
table.IntelliSchemeTour.TourPlan[3][4].TimeSection=1 00:00:00-00:00:00
table.IntelliSchemeTour.TourPlan[3][5].TimeSection=1 00:00:00-00:00:00
table.IntelliSchemeTour.TourPlan[3][6].TimeSection=1 00:00:00-00:00:00
table.IntelliSchemeTour.TourPlan[3][7].TimeSection=1 00:00:00-00:00:00
table.IntelliSchemeTour.TourPlan[3][8].TimeSection=1 00:00:00-00:00:00
table.IntelliSchemeTour.TourPlan[3][9].TimeSection=1 00:00:00-00:00:00
table.IntelliSchemeTour.TourPlan[3][10].TimeSection=1 00:00:00-00:00:00
table.IntelliSchemeTour.TourPlan[3][11].TimeSection=1 00:00:00-00:00:00
table.IntelliSchemeTour.TourPlan[3][12].TimeSection=1 00:00:00-00:00:00
table.IntelliSchemeTour.TourPlan[3][13].TimeSection=1 00:00:00-00:00:00
table.IntelliSchemeTour.TourPlan[3][14].TimeSection=1 00:00:00-00:00:00
table.IntelliSchemeTour.TourPlan[3][15].TimeSection=1 00:00:00-00:00:00
table.IntelliSchemeTour.TourPlan[4][0].TimeSection=1 00:00:00-00:00:00
table.IntelliSchemeTour.TourPlan[4][1].TimeSection=1 00:00:00-00:00:00
table.IntelliSchemeTour.TourPlan[4][2].TimeSection=1 00:00:00-00:00:00

Video Analyse APIs 395

table.IntelliSchemeTour.TourPlan[4][3].TimeSection=1 00:00:00-00:00:00
table.IntelliSchemeTour.TourPlan[4][4].TimeSection=1 00:00:00-00:00:00
table.IntelliSchemeTour.TourPlan[4][5].TimeSection=1 00:00:00-00:00:00
table.IntelliSchemeTour.TourPlan[4][6].TimeSection=1 00:00:00-00:00:00
table.IntelliSchemeTour.TourPlan[4][7].TimeSection=1 00:00:00-00:00:00
table.IntelliSchemeTour.TourPlan[4][8].TimeSection=1 00:00:00-00:00:00
table.IntelliSchemeTour.TourPlan[4][9].TimeSection=1 00:00:00-00:00:00
table.IntelliSchemeTour.TourPlan[4][10].TimeSection=1 00:00:00-00:00:00
table.IntelliSchemeTour.TourPlan[4][11].TimeSection=1 00:00:00-00:00:00
table.IntelliSchemeTour.TourPlan[4][12].TimeSection=1 00:00:00-00:00:00
table.IntelliSchemeTour.TourPlan[4][13].TimeSection=1 00:00:00-00:00:00
table.IntelliSchemeTour.TourPlan[4][14].TimeSection=1 00:00:00-00:00:00
table.IntelliSchemeTour.TourPlan[4][15].TimeSection=1 00:00:00-00:00:00
table.IntelliSchemeTour.TourPlan[5][0].TimeSection=1 00:00:00-00:00:00
table.IntelliSchemeTour.TourPlan[5][1].TimeSection=1 00:00:00-00:00:00
table.IntelliSchemeTour.TourPlan[5][2].TimeSection=1 00:00:00-00:00:00
table.IntelliSchemeTour.TourPlan[5][3].TimeSection=1 00:00:00-00:00:00
table.IntelliSchemeTour.TourPlan[5][4].TimeSection=1 00:00:00-00:00:00
table.IntelliSchemeTour.TourPlan[5][5].TimeSection=1 00:00:00-00:00:00
table.IntelliSchemeTour.TourPlan[5][6].TimeSection=1 00:00:00-00:00:00
table.IntelliSchemeTour.TourPlan[5][7].TimeSection=1 00:00:00-00:00:00
table.IntelliSchemeTour.TourPlan[5][8].TimeSection=1 00:00:00-00:00:00
table.IntelliSchemeTour.TourPlan[5][9].TimeSection=1 00:00:00-00:00:00
table.IntelliSchemeTour.TourPlan[5][10].TimeSection=1 00:00:00-00:00:00
table.IntelliSchemeTour.TourPlan[5][11].TimeSection=1 00:00:00-00:00:00
table.IntelliSchemeTour.TourPlan[5][12].TimeSection=1 00:00:00-00:00:00
table.IntelliSchemeTour.TourPlan[5][13].TimeSection=1 00:00:00-00:00:00
table.IntelliSchemeTour.TourPlan[5][14].TimeSection=1 00:00:00-00:00:00
table.IntelliSchemeTour.TourPlan[5][15].TimeSection=1 00:00:00-00:00:00
table.IntelliSchemeTour.TourPlan[6][0].TimeSection=1 00:00:00-00:00:00
table.IntelliSchemeTour.TourPlan[6][1].TimeSection=1 00:00:00-00:00:00
table.IntelliSchemeTour.TourPlan[6][2].TimeSection=1 00:00:00-00:00:00
table.IntelliSchemeTour.TourPlan[6][3].TimeSection=1 00:00:00-00:00:00
table.IntelliSchemeTour.TourPlan[6][4].TimeSection=1 00:00:00-00:00:00
table.IntelliSchemeTour.TourPlan[6][5].TimeSection=1 00:00:00-00:00:00
table.IntelliSchemeTour.TourPlan[6][6].TimeSection=1 00:00:00-00:00:00
table.IntelliSchemeTour.TourPlan[6][7].TimeSection=1 00:00:00-00:00:00
table.IntelliSchemeTour.TourPlan[6][8].TimeSection=1 00:00:00-00:00:00
table.IntelliSchemeTour.TourPlan[6][9].TimeSection=1 00:00:00-00:00:00
table.IntelliSchemeTour.TourPlan[6][10].TimeSection=1 00:00:00-00:00:00
table.IntelliSchemeTour.TourPlan[6][11].TimeSection=1 00:00:00-00:00:00
table.IntelliSchemeTour.TourPlan[6][12].TimeSection=1 00:00:00-00:00:00
table.IntelliSchemeTour.TourPlan[6][13].TimeSection=1 00:00:00-00:00:00
table.IntelliSchemeTour.TourPlan[6][14].TimeSection=1 00:00:00-00:00:00
table.IntelliSchemeTour.TourPlan[6][15].TimeSection=1 00:00:00-00:00:00
table.IntelliSchemeTour.TourPriMode=Switch

Video Analyse APIs 396

9.6.9 Export Intelligent Diagnosis, Allowlist, and Blocklist Information

Export information, such as intelligent diagnosis, allowlist, and blocklist information. The export data
format is csv

Request URL

http://<server>/cgi-bin/api/ImExport/exportData

Method

POST

Request Params (JSON format in body)

Type

R/O

Description

Example

enumint O

0

Exported data type.
enumint{
0: License plate allowlist
1: License plate blocklist
2: License plate blocklist and
allowlist
3: Voice talk contacts
4: Custom password
5: Card recordset
6: Face information for access
control
7: Fingerprints for access control
8: IPC information of voice talk
9: Calling person information
10: Public password recordset
11: Operation and maintenance
information
}

Name

type

Request Example

{
"type": 1
}

Response Params (binary in body)

Name

Type

R/O

Description

Example

Response Example

HTTP/1.1 200 OK
Server: Device/1.0
Content-Type: application/octet-stream
Content-Length: <length>

< binary data>

9.6.10 Import Intelligent O&M, Allowlist, and Blocklist Information

Import intelligent O&M, allowlist, and blocklist information.

Request URL

http://<server>/cgi-bin/api/ImExport/importData

Video Analyse APIs 397

Method

POST

Request Params (multipart in body)

Name

type

Example

0

Type R/O Description

uint32 R

Imported data type
enumint{
0 : License plate allowlist
1 : License plate blocklist
2 : License plate blocklist and
allowlist
3: Voice talk contacts
4: Custom password
5: Card recordset
6: Face information for access
control
7: Fingerprint for access control
8: IPC information of voice talk
9: Calling person information
10: Public password recordset
11: Operation and maintenance
information
}

isOverWrite

bool

R

true

Whether to overwrite the original
data. If isOverWrite=true, clear all
license plate lists, and then import
the data. If isOverWrite=false, it will
be imported directly, even if the
license plate to be imported is
duplicated with the existing license
plate of the device.

Request Example

POST http://<server>/cgi-bin/api/ImExport/importData HTTP/1.1
User-Agent: client/1.0
Content-Type: multipart/x-mixed-replace; boundary=<boundary>

--<boundary>
Content-Type: application/json
Content-Length: 12

{

"type": 0,
"isOverWrite": true

}
--<boundary>
Content-Type: application/octet-stream
Content-Length: 800

< binary data>

Video Analyse APIs 398

--<boundary>

Response Params ( JSON format in body )

Name

Type

R/O

Description

Example

Response Example

{}

9.6.11 Get Intelligent Capability

URL

http://<server>/cgi-bin/intelli.cgi?action=getCaps

Method

GET

Description Get video analyse intelligent capabilities.

[ Request Params ] ( key=value )

capsName

string

O

[ Response Params ] ( key=value )

caps

object

+AnalyseMode

string

+MultiChannelM
ode

object

++IndepMode

Array<Arra
y<object>>

+++Channel

int

+++Type

string

++CompMode

Array<Arra
y<object>>

+++Channel

int

+++Type

string

+MultiVideoAnal
yse

Array<obje
ct>

++caps

+Algorithm

++Class

++AlgorithmVers
ion

++AlgorithmVen
dor

+TotalCapacity

object

Array<obje
ct>

string

string

sting

Array<obje
ct>

R

O

O

O

R

R

O

R

R

O

R

O

R

R

R

O

Name of capability, it can be:

AnalyseMode: get analyse mode capacity
MultiChannelMode: get multi channel seperate
capacity and combined intelligent capacity
MultiVideoAnalyse: get all
multichannel device in each channel
if omit, means get all capacity

intelligent capacity

intelligent

from

the

The video service capabilities.

Analyse mode, can be : RealStream, RecordFileStream,
PicFileStream

Multi channel description

Multi channel open at one time separately

Video channel number, start from 0

Business class

Multi channel combined mode

Video channel number, start from 0

Business class

List of channel capabilities

Video analyse capabilities

Algorithm version information

Intelligent analyse class, ex : ObjectDetect

Algorithm version

Algorithm Vendor name

Intelligent analyse total capacity

Video Analyse APIs 399

++Class

string

++Type

Array<strin
g>

++Number

int

[ Example ]

R

R

R

Intelligent analyse class, ex : ObjectDetect

Intelligent analyse rules, ex : FaceDetection

The maximum number of video channels that can be analysed
at same time

Request

GET http://192.168.1.108/cgi-bin/intelli.cgi?action=getCaps

Response

caps.AnalyseMode=RealStream
caps.MultiChannelMode.IndepMode[0][0].Channel=0
caps.MultiChannelMode.IndepMode[0][0].Type=Normal
caps.MultiChannelMode.IndepMode[0][1].Channel=1
caps.MultiChannelMode.IndepMode[0][1].Type=ObjectDetect
…
caps.MultiChannelMode.CompMode[0][0].Channel=0
caps.MultiChannelMode.CompMode[0][0].Type=Normal
caps.MultiChannelMode.CompMode[0][1].Channel=1
caps.MultiChannelMode.CompMode[0][1].Type=ObjectDetect
…
caps.Algorithm[0].Class=Normal
caps.Algorithm[0].AlgorithmVersion=V2.8
caps.Algorithm[0].AlgorithmVendor=XXX
caps.Algorithm[1].Class=ObjectDetect
caps.Algorithm[1].AlgorithmVersion=V2.8
caps.Algorithm[1].AlgorithmVendor=YYY
…
caps.TotalCapacity[0].Class=Normal
caps.TotalCapacity[0].Type[0]=FaceDetection
caps.TotalCapacity[0].Number=3
caps.TotalCapacity[1].Class=ObjectDetect
caps.TotalCapacity[1].Type[0]=FaceDetection
caps.TotalCapacity[1].Number=3
…

9.6.12 Subscribe Resource Usage Info

URL

http://<server>/cgi-bin/intelli.cgi?action=attachResource

Method

GET

Description Subscribe the intelligent analyse resource

[ Request Params ] ( key=value format in URL )

heartbeat

int

O

Send heartbeat interval, range is [1, 60],unit is second. If the
URL contains this parameter, and the value is 5, it means every
5 seconds the device should send the heartbeat message to
the client, the heartbeat meaage are "Heartbeat". If this
parameter is not present, its default value is 60.

[ Response Params ] (key=value format)

Name

Type

R/O

Param Description

Video Analyse APIs 400

RemainCapacity

+Class

+Number

[ Example ]

Array<obj
ect>

string

int

R

R

O

Remain capacity of intelligent analyse

Intelligent analyse class, ex : ObjectDetect

Remain number of video channels that can be analysed

Request

GET http://192.168.1.108/cgi-bin/intelli.cgi?action=attachResource&heartbeat=5

HTTP/1.1 200 OK
Server: Device/1.0
Content-Type: multipart/x-mixed-replace; boundary=<boundary>
Connection: closed

--<boundary>
Content-Type: text/plain
Content-Length: <length>

RemainCapacity[0].Class=Normal
RemainCapacity[0].Number=1
RemainCapacity[1].Class=ObjectDetect
RemainCapacity[1].Number=2

Response

--<boundary>
Content-Type: text/plain
Content-Length: 11

Heartbeat
--<boundary>
Content-Type: text/plain
Content-Length: <length>

RemainCapacity[0].Class=Normal
RemainCapacity[0].Number=1
RemainCapacity[1].Class=ObjectDetect
RemainCapacity[1].Number=1
…

9.6.13 Export Encrypted Files

POST

Request URL http://<server>/cgi-bin/api/SecurityImExport/exportData
Method
Request Params ( JSON format in body )
Name
key

Type
char[1024] NA

R/O Description

Example
"1BBzdSS\*\*\*"

type

enumint

NA

Password string encrypted with
public key and encoded by
Base64
Exported types
enumint{
0: License plate allowlist

0

Video Analyse APIs 401

1: License plate blocklist
2: License plate
allowlist/blocklist
3: Voice talk contacts
4: Custom password
5: Card recordset
6: Face information for access
control
7: Fingerprint for access control
8: Network camera information
of voice talk
9: Calling person information
10: Public password recordset
11: Operation and maintenance
information
12: Face data
13: Face images
}

Request Example
{
"key": "1BBzdSS\*\*\*",
"type": 0
}

R/O Description

Response Params ( binary in body )
Name
Type
Response Example
HTTP/1.1 200 OK
Server: Device/1.0
Content-Type: application/octet-stream
Content-Length: <length>

Example

< binary data>
//Before the device returns the actual data, use AES symmetric encryption (the key is
generated according to the plaintext conversion after key decryption).
//AES-256bit-CBC. Filling mode: PKCS7.

9.6.14 Platform intelligent control

POST

Request URL http://<server>/cgi-bin/api/intelli/setPollingConfig
Method
Request Params ( JSON format in body )
Name
Config
+Enable

R/O Description
O
O

Type
object[]
bool

Length max 256
Whether it is intelligently
turned on

Example

true

Video Analyse APIs 402

+Channel
+GlobalType

uint32
char[64]

O
O

+RulelType

char[16][64 ]

O

+GlobalTypeLi
st

char[6][64] O

12
"Normal"

["CrossLineDetection"]

["Normal", "GasStation"]

Channel number
Global configuration,
only support single
channel and single
intelligence,
Rule configuration,
which represents all
rules enabled in the
GlobalType or
GlobalTypeList scenario
The global configuration
list, the extension
supports the opening of
multiple intelligence of a
single channel, choose
one of GlobalType and
GlobalTypeList,
GlobalTypeList will be
used first

Request Example
{
"Config": [{
"Enable": true,
"Channel": 12,
"GlobalType": "Normal",
"RulelType": ["CrossLineDetection"],
"GlobalTypeList": ["Normal", "GasStation"]
},…{}]
}

Response Params ( JSON format in body )
Name
Response Example
{}

Type

R/O Description

Example

9.6.15 Get Scene List

Get the list of intelligent schemes that have been opened for a channel.

Request URL

http://<server>/cgi-bin/devVideoAnalyse.cgi?action=getSceneList

Method

GET

Request Params ( JSON format in body )

Name

Type

R/O

Description

Example

Request Example

http://<server>/cgi-bin/devVideoAnalyse.cgi?action=getSceneList

Video Analyse APIs 403

Response Params ( key=value format in body )
Name
VideoAnalyseGlo
bal
+Scenes

Type
object[]

char[32][16]

R/O
R

R

Description
List of intelligent schemes opened for
each video channel.
If none of the intelligent schemes are
enabled, return
VideoAnalyseGlobal[0].Scenes[0]=""

Sample

["Normal",
"HeatMap"]

Response Example
VideoAnalyseGlobal[0].Scenes[0]=Normal
VideoAnalyseGlobal[0].Scenes[1]=FaceDetection

9.6.16 Open Intelligent Schemes

Open several intelligent schemes for a channel

Request URL

http://<server>/cgi-bin/devVideoAnalyse.cgi?action=enableScene&typeList
=<TypeList>&channel=<ChannelNo>

Method

GET

Request Params ( JSON format in body )

Name

type

char[32][16]

R

Type

R/O

Description

Example

For the list of intelligent
schemes to open, refer
to getSceneList

["Normal","HeatMap"]

Video channel, counted
from 0

0

channel

int32

R

Request Example

http://192.168.1.108/cgi-bin/devVideoAnalyse.cgi?action=enableScene&typeList=[Normal,Heat
Map]&channel=0

Response Params ( key=value format in body )
Name
response

Type
char[256]

R/O
R

Description
Result
"OK" is returned for success, and
"Error" is returned for failure

Sample
"OK"

Response Example
OK

Close Intelligent Schemes

Close several intelligent schemes for a channel

Request URL

http://<server>/cgi-bin/devVideoAnalyse.cgi?action=disableScene&typeList
=<TypeList>&channel=<ChannelNo>

Video Analyse APIs 404

Method

GET

Request Params ( JSON format in body )

Name

typeList

char[32][16]

R

channel

int32

O

Request Example

Type

R/O

Description

Example

For the list of intelligent
schemes to close, refer
to getSceneList

["Normal","HeatMap"]

Video channel, counted
from 0

0

http://192.168.1.108/cgi-bin/devVideoAnalyse.cgi?action=disableScene&typeList=[Normal,Heat
Map]&channel=0

Response Params ( key=value format in body )
Name
response

Type
char[256]

R/O
R

Description
Result
"OK" is returned for success, and
"Error" is returned for failure

Sample
"OK"

Response Example
OK

9.7 WorkSuitCompareServer

9.7.1 Add Compliance Library

Request URL http://<server>/cgi-bin/api/WorkSuitCompareServer/createGroup

Method

POST

Request Params ( JSON format in body )

Name

Group

Type

object

+GroupName

char[128]

+CutoutPolicy

uint32

+Similarity

uint8

+GroupType

enumchar[
16]

+GroupDetail

char[256]

+Type

enumchar[
16]

R/O Description

R

R

O

O

O

O

O

Compliance library group info

Compliance library group name, up to
127 characters.

Preferred solution
0: Full body
1: Upper body

Similarity threshold, range [1, 100],
default 67

Compliance library group type
enumchar[16]{
"BlockListDB": Registry (control list) to
save external imported data
}

group remark information

type, default: "WorkSuit"
enumchar[16]{

Example

"takeout"

1

90

"BlockListDB"

"community owner"

"ClothesCommon"

Video Analyse APIs 405

"WorkSuit"
"ClothesCommon"
}
In the future, there may be traffic police
comparison, takeout comparison and
worker comparison, and
"clothescommon" may be used for
comparison through clothing
characteristics

Request Example

{
"Group": {
"GroupName": "takeout",
"CutoutPolicy": 1,
"Similarity": 90,
"GroupType": "BlockListDB",
"GroupDetail":"community owner",
"Type": "ClothesCommon"
}
}

Response Params ( JSON format in body )

Name

GroupID

Type

R/O Description

char[64]

R

Compliance library group ID

Example

"10000"

Response Example

{
"GroupID": "10000"
}

9.7.2 Delete Compliance Library

Request URL http://<server>/cgi-bin/api/WorkSuitCompareServer/deleteGroup

Method

POST

Request Params ( JSON format in body )

Name

GroupID

Type

R/O Description

char[64]

R

Compliance library group ID

Example

"000001"

Request Example

{
"GroupID": "000001"
}

Response Params ( JSON format in body )

Name

Type

R/O Description

Example

Response Example

Video Analyse APIs 406

{}

9.7.3 Find Compliance Library

Request URL http://<server>/cgi-bin/api/WorkSuitCompareServer/findGroup

Method

POST

Request Params ( JSON format in body )

Name

GroupID

Type

R/O Description

char[64]

R

Compliance library group ID，""
for all Compliance library group
IDs

Example

"000001"

Request Example

{
"GroupID": "000001"
}

Response Params ( JSON format in body )

Name

Type

R/O Description

Example

GroupList

object[64]

O

+GroupID

char[64]

+GroupName

char[128]

+CutoutPolicy

uint32

+GroupType

enumchar[
16]

+GroupDetail

char[256]

+GroupSize

int

O

O

O

O

O

O

+Channels

int16[1024] O

+Similarity

uint8[1024] O

List of found compliance library
group information

Compliance library group ID

Compliance library group name, up
to 127 characters.

Preferred solution
0: Full body
1: Upper body

Compliance library group type
enumchar[16]{
"BlockListDB": Registry (control list)
to save external imported data
}

group remark info
当前组内工装数
The list of video channel numbers to
which the current group is bound
(see setgroup).
If not associated with any video
channel, it should be [-1]

It corresponds to the similarity
threshold when Binding video. The
array length is equal to channels. It
is meaningless when no video
channel is bound.
Each value range [1, 100]

"000001"

"taken"

0

"BlockListDB"

"community owner"

30

[0]

[90]

+FeatureState uint[4]

O

The number of work suit in various
states in the group and the work suit

[10,20,30,40]

Video Analyse APIs 407

that have not completed modeling
(feature extraction) cannot be
identified by the algorithm
Array subscript correspondence
[0] - the number of work suit ready
for modeling does not guarantee the
success of modeling
[1] - the number of work suit failed in
modeling, the picture does not meet
the algorithm requirements, and the
picture needs to be replaced
[2] - the number of work suit
successfully modeled, and the data
can be used for work suit
identification by algorithm
[3] - the number of models that have
been successfully modeled but
become unavailable due to
algorithm upgrade, it will be
available after remodeled.

Response Example

{
"GroupList": [{
"GroupID": "000001",
"GroupName": "taken",
"CutoutPolicy": 0,
"GroupType": "BlockListDB",
"GroupDetail": "community owner",
"GroupSize": 30,
"Channels": [0],
"Similarity": [90],
"FeatureState": [10,20,30,40]
},…{}]
}

9.7.4 Get Compliance Library Arming Information of Channels

Request URL http://<server>/cgi-bin/api/WorkSuitCompareServer/getGroup

Method

POST

Request Params ( JSON format in body )

Name

Channel

Type

int

R/O Description

Example

R

Video channel number

0

Request Example

{
"Channel": 0
}

Video Analyse APIs 408

Response Params ( JSON format in body )

Type

R/O Description

Example

object[128] O

List of compliance library group information

O

O

O

Compliance group ID, up to 63 characters.

"001"

Similarity threshold; value range: 1–100.

Preferred solution
0: Full body
1: Upper body

80

1

Name

GroupList

+GroupID

char[64]

+Similarity

uint8

+CutoutPolicy

uint32

Response Example

{
"GroupList": [{
"GroupID": "001",
"Similarity": 80,
"CutoutPolicy": 1
},…{}]
}

9.7.5 Modify Compliance Group Information

Request URL http://<server>/cgi-bin/api/WorkSuitCompareServer/modifyGroup

Method

POST

Request Params ( JSON format in body )

Name

Group

Type

object

+GroupID

char[64]

+GroupName

char[128]

+Similarity

uint8

+GroupType

enumchar[
16]

R/O Description

Example

R

R

O

O

O

Compliance library group info

Compliance group ID, up to 63 characters

"0001"

Compliance library group name, up to 127
characters.

"park"

Similarity threshold, range [1, 100], default
67

90

Compliance library group type
enumchar[16]{
"BlockListDB": Registry (control list) to
save external imported data
}

"BlockListDB"

+GroupDetail

char[256]

O

group remark info

"community owner"

Request Example

{
"Group": {
"GroupID": "0001",
"GroupName": "park",
"Similarity": 90,
"GroupType": "BlockListDB",
"GroupDetail": "community owner"
}
}

Video Analyse APIs 409

Response Params ( JSON format in body )

Name

Type

R/O Description

Example

Response Example

{}

9.7.6 Deploy Compliance Library

Request URL http://<server>/cgi-bin/api/WorkSuitCompareServer/setGroup

Method

POST

Request Params ( JSON format in body )

Name

Channel

Type

int

R/O Description

R

video channel number

GroupList

object[128] O

+GroupID

char[64]

+Similarity

uint8

O

O

Arming information list: If the list does not exist,
the arming of all compliance libraries for the
channels are deleted.

Compliance group ID, up to 63 characters

Similarity threshold for each compliance group.
Action after the comparison similarity is higher
than the threshold
Absence of this field means no modification
Similarity range [0, 100]

Example

0

"001"

80

Request Example

{
"Channel": 0,
"GroupList": [{
"GroupID": "001",
"Similarity": 80
},…{}]
}

Response Params ( JSON format in body )

Name

Type

R/O Description

Example

Response Example

{}

9.7.7 Find Workwear Information in Compliance Library

Request URL http://<server>/cgi-bin/api/WorkSuitCompareServer/startFind

Method

POST

Request Params ( JSON format in body )

Name

Condition

+GroupID

Type

object

char[128][6 4]

R/O Description

Example

O

O

Search condition.

Array list of compliance library IDs.
Each compliance library ID is up to 63
characters.

["00001","00002"]

WorkSuit

object

O

Search condition of workwear

Video Analyse APIs 410

+FeatureState uint8

O

1

information

Feature value status:
0: Unknown;
1: Extraction failed;
2: Extracted successfully;
3: Modeled but algorithm upgrade
causes data unavailability and
remodeling is required.

Request Example

{
"Condition": {
"GroupID": ["00001","00002"]
},
"WorkSuit": {
"FeatureState": 1
}
}

Response Params ( JSON format in body )

R/O Description
否

Token for search task, which is used to get
search results and stop the search.

Example

2342343

否

Total number of results returned.

3333

Name

Token

Type

uint

TotalCount

int

Response Example

{
"Token": 2342343,
"TotalCount": 3333
}

9.7.8 Get Find Workwear Information Result

Acquire the work uniform information from the search result.
Note: If doFind operation is not performed for 60 seconds, the returned token will be invalid.

Request URL

http://<server>/cgi-bin/api/WorkSuitCompareServer/doFind

Method

POST

Request Params ( JSON format in body )

Name

Condition

Type

object

+Token

+BeginNumber

uint

uint

R/O

Description

Example

R

R

R

Search for the input
parameter of work
uniform.

Search token.

Start number of the
search.
The search starts from
the “beginNumber”
records, and returns

46878

0

Video Analyse APIs 411

20

1

predefined number
(count) of records.
0<=beginNumber<=
totalCount-1

Number of entries
obtained each time.
It should not exceed 50.

Image format mask
returned by search
results.
It is added for IPC. bit0
means to return the
HTTP link of image.
For example, 1 only
returns HTTP link. If the
field does not exist, the
server decides how to
return it.

+Count

int

+NeedData

uint

R

O

Request Example

{
"Condition": {
"Token": 46878,
"BeginNumber": 0,
"Count": 20,
"NeedData": 1
}
}

Response Params ( JSON format in body )

Name

Results

Type

object

+Found

int

+Candidates

object[]

++WorkSuit

object

+++UID

string

+++GroupID

string

R/O

Description

Example

R

R

R

R

O

O

0

1

Output parameter of the
search.

The actual number of
entries returned by this
search.

Information list of work
uniform to be selected.
Maximum 50
information lists can be
returned at one time.

Searched work uniform
information list.

12

Work uniform identifier.
The maximum length is
31 characters.

Compliance database
ID. The maximum

0005

10000

Video Analyse APIs 412

+++GroupName

string

+++FeatureState uint

O

O

+++FeatureErrC
ode

uint

O

Group1

0

0

length is 63 characters.

Name of work uniform
group.

Feature status. 0:
Unknown. 1: Extraction
failed. 2: Extraction
succeeded. 3:
Algorithm upgrade
makes data unavailable
and it needs to be
remodeled. 4:
Calculating features.

Recorded reasons for
modeling failure.
Only valid when
FailedCnt is greater
than 0.
0: Unknown (other
errors)
1: Modeling failed.
2: System errors (for
example, errors caused
by invalid license and
unstarted modeling
analyzer).
3: Database operation
failed.
4: image decoding
failed.
5: Multiple targets.
6: No target.

+++ImagePath

string

+++SourceUID

string

+++SourceFileN
ame

string

+++Image

object

++++ Width

++++ Height

++++ Offset

uint

uint

uint

++++ Length

uint

Response Example

O

O

O

O

O

O

O

O

Work uniform thumbnail
path.

/mnt/2010/8/1/dav/15:
40:50.jpg

Unique identifier of
panoramic image. It is
generated by the
platform.

Panoramic image
name.

Image information

Image width

Image height

Offset in the binary data
block

1

aaa

[,]

100

50

0

Image size

10000

Video Analyse APIs 413

{
“Results”:{
"Found": 12,
“Candidates”:[{
"WorkSuit": [{
“UID”: “111”,
“GroupID”: “0001”,
“GroupName”: “group1’,
“FeatureState”: 1,
“FeatureErrCode”: 2,
“ImagePath”: "/mnt/2010/8/1/dav/15:40:50.jpg",
“SourceUID”: “1”,
“SourceFileName”: “aaaaa” ,
“Image”: {
“Width”: 1920,
“Height”; 1080,
“Offset”; 0,
“Length”; 1156
},…{}]
}

9.7.9 Stop Find Workwear Information

Request URL http://<server>/cgi-bin/api/WorkSuitCompareServer/stopFind

Method

POST

Request Params ( JSON format in body )

R/O Description

R

Token for search task, which is used to get
search results and stop the search.

Example

46878

Name

Token

Type

uint

Request Example

{
"Token": 46878
}

Response Params ( JSON format in body )

Name

Type

R/O Description

Example

Response Example

{}

9.7.10 Delete Workwear Information

Request URL http://<server>/cgi-bin/api/WorkSuitCompareServer/deleteByUID

Method

POST

Request Params ( JSON format in body )

Video Analyse APIs 414

Name

UID

Type

R/O Description

Example

char[64][32 ]

O

Workwear identifier list, up to 31 characters.

["123", "234"]

Request Example

{
"UID": ["123", "234"]
}

Response Params ( JSON format in body )

Name

ErrCode

Type

R/O Description

uint[64]

O

Error code list, indicating error messages when
deleting information.
0: Success.
1: The workwear does not exist.
2: Database operation failed.

Example

[0,0]

Response Example

{
"ErrCode": [0,0]
}

9.7.11 Re-extracting Features by Workwear

Request URL http://<server>/cgi-bin/api/WorkSuitCompareServer/reAbstract

Method

POST

Request Params ( JSON format in body )

Name

Type

R/O Description

Example

WorkSuit

object[64]

O

+UID

char[32]

Token

uint

O

O

Multiple work suit information, [] means to
reconstruct all work suit with missing or
mismatched feature vectors

Workwear identifier list; each UID is up to 31
characters.

"120837"

The token value of the work clothes modeling.
The token can be obtained through
getappendtoken

1

Request Example

{
"WorkSuit": [{
"UID": "120837"
},…{}],
"Token": 1
}

Response Params ( JSON format in body )

Name

Type

R/O Description

Example

Response Example

Video Analyse APIs 415

{}

9.7.12 Stop Re-extracting Workwear Features

Request URL http://<server>/cgi-bin/api/WorkSuitCompareServer/stopReAbstract

Method

POST

Request Params ( JSON format in body )

Name

Type

R/O Description

Example

Request Example

{}

Response Params ( JSON format in body )

Name

Type

R/O Description

Example

Response Example

{}

9.8 Smart Motion Detection

9.8.1 [Config] SmartMotionDetect

 Get smart motion detection setting

Syntax

http://<server>/cgi-bin/configManager.cgi?action=getConfig&name=SmartMotionDete
ct

Method

GET

Description

Get smart motion detection setting

[ Request Params ] (None )

[ Response Params ] (key=value format)

Name

table

Type

object

+SmartMotionDetec
t

Array<object>

++Enable

++Sensitivity

bool

string

++ObjectTypes

object

bool

bool

+++Human

+++Vehicle

[ Example ]

Request

Response

R/O

Param Description

R

R

R

R

R

R

R

Config info table.

PrivacyMasking config, each channel has one
config object

Enable/Disable

Detection sensitivity, can be: "Low", "Middle",
"High"

Detection object type

Whether detect motion of human

Whether detect motion of vehicle

http://192.168.1.108/cgi-bin/configManager.cgi?action=getConfig&name=SmartMotionDe
tect

table.SmartMotionDetect[0].Enable=true
table.SmartMotionDetect[0].Sensitivity=Middle
table.SmartMotionDetect[0].ObjectTypes.Human=true
table.SmartMotionDetect[0].ObjectTypes.Vehicle=true
…

Video Analyse APIs 416

 Set smart motion detection setting

Syntax

Method

http://<server>/cgi-bin/configManager.cgi?action=setConfig

GET

Description Set smart motion detection setting

[ Request Params ] (key=value format )

Name

Type

R/O Param Description

SmartMotionDet
ect

Array<object>

+Enable

bool

+Sensitivity

string

+ObjectTypes

object

++Human

++Vehicle

bool

bool

[ Response Params ] ( OK )

R

R

R

R

R

R

Smart motion detection config, each channel has
one config object

Enable/Disable

Detection sensitivity, can be: "Low", "Middle",
"High"

Detection object type

Whether detect motion of human

Whether detect motion of vehicle

[ Example ]

Request

http://192.168.1.108/cgi-bin/configManager.cgi?action=setConfig&SmartMotionDetect[0].E
nable=true&SmartMotionDetect[0].Sensitivity=Middle&SmartMotionDetect[0].ObjectTypes.
Human=true&SmartMotionDetect[0].ObjectTypes.Vehicle=true

Response OK

9.8.2 Start SMD Data Search

Request URL

http://<server>/cgi-bin/api/SmdDataFinder/startFind

Method

POST

Request Params (JSON format in body)

R/O Description

Example

Name

Condition

+Channel

Type

object

int32

+Channels

int[]

R

O

O

+SmdType

char[8][ 32]

O

Search conditions

Channel number. -1 means
searching for all channels

Channel number array (starting
from 0). There should be at least
one field, Channel or Channels.
Generally, If both Channel and
Channels fields exist, Channels
should prevail.

Video type. Array
"smdTypeHuman": Human.
"smdTypeVehicle": Vehicle.
"smdTypeHumanAndVehicle":
Human and vehicle.

+StartTime

char[32] O

Start time

+EndTime

char[32] O

End time

+Order

char[16] O

Search for ordering method.
"ascOrder": Ascending order
(default value).

0

["smdTypeHuman",
"smdTypeVehicle",
"smdTypeHumanAndVehicle"
]

"2017-08-01 00:00:00"

"2017-08-02 00:00:00"

"ascOrder"

Video Analyse APIs 417

"descOrder": Descending order.

Request Example

{

"Condition": {

"Channel": 0,
"Channels": [0,1,2,5],
"SmdType": ["smdTypeHuman", "smdTypeVehicle", "smdTypeHumanAndVehicle" ],
"StartTime": "2017-08-01 00:00:00",
"EndTime": "2017-08-02 00:00:00",
"Order": "ascOrder"

}

}

Response Params ( JSON format in body )

Type R/O Description

int

int

O

O

Return searched ID

Total number of searched entries

Example

1

100

Name

Token

Count

Response Example

{

}

"Token": 1,
"Count": 100

9.8.3 Get SMD Data Search Result

Request URL

http://<server>/cgi-bin/api/SmdDataFinder/doFind

Method

POST

Request Params (JSON format in body)

Type R/O Description

Example

int

R

int32 R

int

R

Search ID

Location offset

Number of searched items

1

0

100

Name

Token

Offset

Count

Request Example

{

}

"Token": 1,
"Offset": 0,
"Count": 100

Response Params ( JSON format in body )

Name

SmdInfo

Type

R/O Description

Example

object[] R

It is an array. Each element represents
the historical data of a record data at a
certain time.

+Channel

int32

O

Channel number, starting from 0

1

Video Analyse APIs 418

+EndTime

char[32] O

End time. "201

+Type

char[32] O

Video type. "smdTypeHuman":
Human.
"smdTypeVehicle": Vehicle.
"smdTypeHumanAndVehicle": Human
and vehicle.

"2017-08-02 00:00:00"

"smdTypeHuman"

+StartTime

char[32] O

Start time

2017-01-01 10:00:

Response Example

{

}

"SmdInfo": [{

"Channel": 1,
"StartTime": "2017-08-01 00:00:00",
"EndTime": "2017-08-02 00:00:00",
"Type": "smdTypeHuman"

},…{}]

9.8.4 End SMD Data Search

Request URL

http://<server>/cgi-bin/api/SmdDataFinder/stopFind

Method

POST

Request Params (JSON format in body)

Name

Token

Type

R/O Description

int

O

Search ID

Example

1

Request Example

{

}

"Token": 1

Response Params ( JSON format in body )

Name

Type

R/O Description

Example

Response Example

{}

9.9 Intelligent analysis tasks

9.9.1 Add task

POST

Request URL http://<server>/cgi-bin/api/analyseTaskManager/add
Method
Request Params ( JSON format in body )
Name
Task
+TaskUserDat

R/O Description
Task object
R
Task data, add it intact
R

Type
object
char[512]

Example

"asdvbtgrffg"

Video Analyse APIs 419

a
+SourceType

char[32]

R

"StreamSource"

to the response
Data source type
Use devVideoAnalyse
component for local
streams (LocalStream),
and it is not included in
this component group.
"LocalStream": Local
stream
Currently, the local
stream is used only by
NVR and SMD. Use
devVideoAnalyse for
other cases.
"RemoteStream":
Remote real stream
"LocalVideoFile": Local
video files
"LocalPictureFile”: Local
picture files
"RemoteVideoFile":
Remote video files
"RemotePictureFile":
Remote picture files
"PushVideoFile":
Actively pushed video
files
"PushPictureFile":
Actively pushed picture
files
"OffLineVideoFile":
Offline video files (from
third parties)
PushPictureFileByRule:
Remote picture files.
Rules and picture
information are not
included when adding
tasks. Through pushing
the picture interface,
each picture is attached
with different rule
information (Used in
energy-related scenes
currently).
"IOTData": IoT device
data

Video Analyse APIs 420

For active pushed files
such as PushVideoFile,
the command does not
specify the file
information, but pushes
data through command
such as
analysePushVideoFile.
Starts immediately after
being created or not
(Valid when the file type
is LocalVideoFile,
LocalPictureFile,
RemoteVideoFile, and
RemotePictureFile. Add,
attach and then start in
case of result loss)
If the value is true, the
command will start
immediately after being
created.
Local real-time video
sources
Valid when SouceType
is LocalStream
Video channel
Stream type:
0: Main stream
1: Sub stream 1
2: Sub stream 2
Remote real-time
stream source
Valid when SouceType
is RemoteStream
Video stream protocol
Supported protocols by
now:
"Private"
"RTSP"
"Onvif"
"GB28181"
"HIKVISION"
"BSCP"
Video stream URL

+IsStart

bool

O

+LocalStream

object

O

++Channel
++Subtype

int
uint8

O
O

+RemoteStrea
m

object

O

++Protocol

char[32]

O

++Path

char[256]

O

true

0
0

"RTSP"

"rtsp://10.35.114.145:55
4/dss/monitor/param?ca
meraid=AGfQv8TwA1A
LIPO29LA9L2&substrea

Video Analyse APIs 421

++IP
++Port
++UserName
++Password
++Channel
++Subtype

char[64]
uint16
char[64]
char[64]
int
uint8

O
O
O
O
O
O

++ChannelId

char[256]

O

+LocalVideoFil
e

object

O

++FileID
++Path
+LocalPicture
File

char[128]
char[260]
object

++Files
+++FileID
+++Path
+RemoteVide
oFile

object[]
char[128]
char[260]
object

O
O
O

O
O
O
O

++Protocol

char[16]

O

++VideoAnaly
sisProcess

uint32

O

m=1&trackID=801"
"10.35.114.145"
554
"admin"
"admin123"
0
0

"1000254$1$0$110"

"file-1234"
"/xxxx/a.dav"

"file-1234"
"/xxxx/a.jpg"

"RTSP"

66

IP Address
Port
Username
Password
Video channel
Stream type:
0: Main stream
1: Sub stream 1
2: Sub stream 2
Platform channel No,
used to bind the device
channels.
Local video file, and only
1 video file is supported
Valid when SouceType
is LocalVideoFile
File ID
File name
Local picture file, and
multiple picture files are
supported.
Valid when SouceType
is LocalPictureFile

File ID
File name
Remote video file, and
only 1 video file is
supported.
Valid when SouceType
is RemoteVideoFile
Protocol for accessing
remote files
"RTSP",
"RabbitMq"
"Private"
"Onvif"
"GB28181"
"HIKVISION"
"BSCP"
(FTP and RTSP are
expected to be covered)
Video analysis progress.
When SourceType is
RemoteVideoFile, the
valid value range is 0–

Video Analyse APIs 422

++Path

char[260]

O

++IP
++Port
++Channel
++Subtype

char[64]
int
int
uint8

++Username
++Password
++FileID
++StartTime
++EndTime
+OffLineVideo
File

char[64]
char[64]
char[128]
char[64]
char[64]
object

O
O
O
O

O
O
O
O
O
O

++Protocol

char[16]

R

++FileSize
++VideoAnaly
sisProcess

uint64
uint32

O
O

++Path

char[260]

R

++IP
++Port
++Username
++Password
++FileID
++isReportPT
S
+RemotePictu
reFile

char[64]
int
char[64]
char[64]
char[128]
bool

object

R
R
R
R
R
O

O

"rtsp://192.168.1.1:554/x
xxx/a.dav"
"192.168.1.1"
554
1
1

"admin"
"123456"
"file-1234"
"2010-05-25 00:00:00"
"2010-05-25 23:59:59"

"RTSP"

1000
66

"rtsp://192.168.1.1:554/x
xxx/a.dav"
"192.168.1.1"
4000
"admin"
"123456"
"file-1234"
true

100. 100 means the
     analysis is compete.
     File path

Remote IP address
Remote port
Video channel
Stream type:
0: Main stream
1: Sub stream 1
2: Sub stream 2
Username
Password
File ID
Start time
End time
Remote video file, and
only 1 video file is
supported (the file
imported from a third
party).
Valid when SouceType
is OffLineVideoFile
Protocol for accessing
remote files

RTSP
File size (in bytes)
Video analysis progress.
When SourceType is
OffLineVideoFile, the
valid value range is 0– 100. 100 means the
analysis is compete.
File path

Remote IP address
Remote port
Username
Password
File ID
Reports the relative
timestamp or not
Remote picture file, and
multiple picture files are
supported. The server
must be identical.

Video Analyse APIs 423

++Protocol

char[16]

O

++IP
++Port
++Username
++Password
++Files
+++FileID
+++Path

char[64]
int
char[64]
char[64]
object[]
char[128]
char[260]

+Global
++Lanes

object
object[8]

O
O
O
O
O
O
O

O
O

+++Enable

bool

O

+++Number
+++LeftLine

int
uint16[20][ 2]

O
O

"HTTP"

"192.168.1.1"
80
"admin"
"123456"

"file-1234"
"http://192.168.1.1:80/xx
xx/a.jpg"

true

0

Valid when SouceType
is RemotePictureFile
Protocol for accessing
remote files
HTTP, RabbitMq,
ActiveMq
(FTP and RTSP are
expected to be covered)
Remote IP address
Remote port
Username
Password
File list
File ID
File name

Global settings
Lane information; each
lane includes 2 border
lines.
Maximum length: 8
arrays
For highway all-in-one
device, a channel
supports up to 8 pairs of
lane lines.
Enable lane
The rules take effect
only when the lane is
enabled. It tackles the
detection errors when a
lane is under
construction in a specific
period.
When the filed is empty,
the lane is enabled by
default.
Lane No.
Left lane line. The
direction of the lane line
refers to the lane
direction, and the line at
the left side of the lane
is left lane line.
The coordinates of the
point is unified within the
range of 0–8192.

Video Analyse APIs 424

+++LeftLineEx
t

uint16[64][ 2]

O

+++LeftLineTy
pe

enumchar[
16]

O

+++RightLine

uint16[20][ 2]

O

+++RightLine
Ext

uint16[64][ 2]

O

+++RightLineT
ype

char[16]

O

++CalibrateAr
ea

object[]

O

LeftLineExt is the
extension filed of
LeftLine. When the point
number of the left lane
line is less than 20, use
LeftLine only. When the
point number of the left
lane line is more than
20, use LeftLine for the
former 20 points, and
LeftLineExt for the rest.
LeftLine and LeftLIneExt
comprise the left lane
line.
Attributes of the left lane
line
enumchar[16]{
"WhiteSolid": White
solid line
"WhiteDotted": White
dotted line
"Yellow": Yellow line
"UpSolidDownDotted":
Solid at the top and
dotted at the bottom
"UpDottedDownSolid":
Dotted at the top and
solid at the bottom
Right lane line. The
direction of the lane line
refers to the lane
direction, and the line at
the right side of the lane
is right lane line.
The coordinates of the
point is unified within the
range of 0–8192.
RightLineExt is the
extension filed of
RightLine.
Attributes of the right
lane line
Refer to LeftLineType
Calibration Area
An array. Each scene
includes multiple
calibration areas. If the

"WhiteSolid"

++++RightLineExt

"WhiteSolid"

Video Analyse APIs 425

file does not exist, the
whole scene is the
calibration area.
CalibrateArea,
CalibrateArea1 ……
CalibrateAreaN refers to
scene, scene 1……
scene N.
For highway all-in-one
device, a channel
supports 1 calibration
area.
Calibrates a polygon
area, and uses all.
For highway all-in-one
device: 1 area.
Ruler line
A calibration area
requires multiple ruler
lines.
Use 4 elements for
depth of field calibration
(3 vertical elements and
1 horizontal element)
Use 2 elements for lane
calibration (an element
for each side)
No element is needed
for license plate
calibration (illegal
parking), and use
VideoAnalyseCalibrate
to configure separately.
No element is needed
for dual-PTZ calibration,
and draw an area.
LaneNew only covers 1
vertical straight line
segment, and the
coordinates of the
vertical straight line
must be entered.
For highway all-in-one
device, 1 Staffs for a
calibration area.
Ruler type
enumchar[32]{

+++Area

uint[20][2] O

+++Staffs

object[]

O

++++Type

enumchar[
32]

O

"Horizontal"

Video Analyse APIs 426

"Horizontal": Horizontal
line segment
"Vertical": Vertical line
segment
"Any": Any line segment,
unused
"Cross": Cross line
segment, unused
}
For highway all-in-one
device (1 staffs): 1 type
Coordinates of the start
point
The coordinates is
unified within the range
of 0–8192
Coordinates of the end
point
The coordinates is
unified within the range
of 0–8192
Actual length, in meters
Note: The current
system layer length, in
meters
Enable detection
identifiers in the area
Arrays in the target
detection area
Area, refer to the
configurations of
DetectRegion.
Target area type
enumchar[16]{
"SignalLight": Signal
light
"LEDScreen": LED
screen
}
Installation height of the
camera
in meters
Module configuration
Zones that should be
excluded from the
detection area, usually
zones that might

[0, 0]

[100, 100]

1.0

false

"SignalLight"

6.2

[, …, ]

++++Start

int[2]

O

++++End

int[2]

O

++++Length

double

O

++GlobalDete
ctionEnable
++ObjectArea

bool

O

object[20]

O

+++Area

+++Type

uint16[20][ 2]

enumchar[
16]

++CameraHei
ght

float

+Module
++ExcludeReg
ion

object
uint16[][20]
[2]

O

O

O

O
O

Video Analyse APIs 427

interfere with the
algorithms. A detection
area might have 0 or
more excluded zones.
Array of areas. For the
definition of area, see
DetectRegion.
The maximum number
depends on the
capability set.
For highway all-in-one
device, up to 10
excluded areas are
supported.
Physical size filter by
default.
If both the default object
type and a specific filter
are selected, choose the
specific filter.
Highway all-in-one
device supports a
maximum box and a
minimum box.
The specific filter for
each object. It is a
number.
Object type. For
available values, see
ObjectTypeEnum.
Size filter
Enable the size filter of
the specific object or not
Detection area.
Coordinates of the
peaks of the polygon.
Specifies the general
service detection area
and exclusion area.
Up to 10 service types
are supported.
Which service scheme
category does the
detection area
parameter suits.
For available values,
see VAClassEnum.

SizeFilter

"Vechicle"

++++SizeFilter
true

+++DetectRegion

"Normal"

++SizeFilter

SizeFilter

O

++ObjectFilter object[]

O

+++ObjectTyp
e

char[16]

O

+++SizeFilter
+++Enable

SizeFilter
bool

++DetectRegi
on

uint16[20][ 2]

O
O

O

++SpecialDete
ctRegion

object[10]

O

+++Type

char[16]

O

Video Analyse APIs 428

+++DetectReg
ion

uint16[10][ 20][2]

+++ExcludeRe
gion

uint16[10][ 20][2]

O

O

+Rules
++Class

object[]
char[16]

R
R

++Type

char[32]

R

++Name

char[128]

R

++ObjectType
s

char[16][16 ]

O

[, …, ]

"ObjectDetect"

"ObjectDetect"

"GuardLine1"

["Human", "Vehicle"]

Detection area
The coordinates of the
peaks is unified within
the range of 0–8192.
Zones that should be
excluded from the
detection area, usually
zones that might
interfere with the
algorithms. A detection
area might have 0 or
more excluded zones.
Analysis rule
Analysis category
The values are identical
with the service scheme
categories of
VideoAnalyseGlobal.
Analysis rule type
The values are identical
with the rule types of
ideoAnalyseRule.
Rule name. Rule name
of devices without
presets must be
different. For devices
with presets, the rule
name in the same
preset must be different.
The name of rules in
different presets can
overlap.
List of detected object
types
Note: Not all rules need
the object type. It is
used primarily for the
earliest behavior
algorithms. We
recommend you add the
parameter to rule config.
Here it is not changed
due to compatibility. It is
identical with
VideoAnalyseRule(Base
).
When only the object

Video Analyse APIs 429

type in the array is
detected, the array
cannot be empty. See
VideoAnalysModule.Obj
ectType
When ObjectTypes is
empty, or there is
unknown filed in the
array, no matter whether
there is other element, it
means the classifier is
not enabled.
If Unknown does not
exist in the array, only
specific object types will
be detected.
For specific rules, see
"VideoAnalyseRule(XXX
X)
Experience database
configuration array
Experience database ID
Similarity threshold:
The range is [1–100],
and it is 67 by default.
True or not:
true: True
false: False
MQ configurations. See
PaaS protocol
configuration center >
Operator configuration.
When the remote
access type is RabbitMq
or ActiveMq, try to
acquire MQ from this
field. ActiveMq is ised
for the exchange of
sensitive information.
Whether repeation is
allowed. 0 means R,
and it is the default
value.
1 means no.

"1"
67

true

""

0

Video Analyse APIs 430

O
O

O

++Config

object

R

object[128] O

++Experience
Config
+++ID
+++Similarity

char[64]
uint8

+++IsPositive

bool

+MQConfig

char[4096] O

+IsRepeat

int

O

Request Example
{
"Task": {

"TaskUserData": "asdvbtgrffg",
"SourceType": "StreamSource",
"IsStart": true,
"LocalStream": {
"Channel": 0,
"Subtype": 0
},
"RemoteStream": {
"Protocol": "RTSP",
"Path":
"rtsp://10.35.114.145:554/dss/monitor/param?cameraid=AGfQv8TwA1ALIPO29LA9L2&su
bstream=1&trackID=801",
"IP": "10.35.114.145",
"Port": 554,
"UserName": "admin",
"Password": "admin123",
"Channel": 0,
"Subtype": 0,
"ChannelId": "1000254$1$0$110"
},
"LocalVideoFile": {
"FileID": "file-1234",
"Path": "/xxxx/a.dav"
},
"LocalPictureFile": {
"Files": [{
"FileID": "file-1234",
"Path": "/xxxx/a.jpg"
},…{}]
},
"RemoteVideoFile": {
"Protocol": "RTSP",
"VideoAnalysisProcess": 66,
"Path": "rtsp://192.168.1.1:554/xxxx/a.dav",
"IP": "192.168.1.1",
"Port": 554,
"Channel": 1,
"Subtype": 1,
"Username": "admin",
"Password": "123456",
"FileID": "file-1234",
"StartTime": "2010-05-25 00:00:00",
"EndTime": "2010-05-25 23:59:59"
},
"OffLineVideoFile": {
"Protocol": "RTSP",
"FileSize": 1000,

Video Analyse APIs 431

"VideoAnalysisProcess": 66,
"Path": "rtsp://192.168.1.1:554/xxxx/a.dav",
"IP": "192.168.1.1",
"Port": 4000,
"Username": "admin",
"Password": "123456",
"FileID": "file-1234",
"isReportPTS": true
},
"RemotePictureFile": {
"Protocol": "HTTP",
"IP": "192.168.1.1",
"Port": 80,
"Username": "admin",
"Password": "123456",
"Files": [{
"FileID": "file-1234",
"Path": "http://192.168.1.1:80/xxxx/a.jpg"
},…{}]
},
"Global": {
"Lanes": [{
"Enable": true,
"Number": 0,
"LeftLine": ,
"LeftLineExt": ,
"LeftLineType": "WhiteSolid",
"RightLine": ,
"RightLineExt": ++++RightLineExt,
"RightLineType": "WhiteSolid"
},…{}],
"CalibrateArea": [{
"Area": ,
"Staffs": [{
"Type": "Horizontal",
"Start": [0, 0],
"End": [100, 100],
"Length": 1.0
},…{}]
},…{}],
"GlobalDetectionEnable": false,
"ObjectArea": [{
"Area": ,
"Type": "SignalLight"
},…{}],
"CameraHeight": 6.2
},

Video Analyse APIs 432

"Module": {
"ExcludeRegion": [, …, ],
"SizeFilter": SizeFilter,
"ObjectFilter": [{
"ObjectType": "Vechicle",
"SizeFilter": ++++SizeFilter,
"Enable": true
},…{}],
"DetectRegion": +++DetectRegion,
"SpecialDetectRegion": [{
"Type": "Normal",
"DetectRegion": ,
"ExcludeRegion": [, …, ]
},…{}]
},
"Rules": [{
"Class": "ObjectDetect",
"Type": "ObjectDetect",
"Name": "GuardLine1",
"ObjectTypes": ["Human", "Vehicle"],
"Config": {
},
"ExperienceConfig": [{
"ID": "1",
"Similarity": 67,
"IsPositive": true
},…{}]
},…{}],
"MQConfig": "",
"IsRepeat": 0
}
}

Response Params ( JSON format in body )
Name
TaskID

Type
uint32

VirtualChannel uint32

Path

char[256]

O

Response Example
{

R/O Description
Non
e
Non
e

Task ID, > 0. (If it is
failed, the result is false)
The corresponding
virtual channel number
of the task. The value
range is within the
values of
ChannelManager.getVirt
ualChannels.
RTSP address of the AI
stream

Example
1234

1234

"rtsp://192.168.1.1:554/x
x"

Video Analyse APIs 433

"TaskID": 1234,
"VirtualChannel": 1234,
"Path": "rtsp://192.168.1.1:554/xx"
}

9.9.2 Attach task result

Subscribe to all results (do not specify TaskID), or subscribe to specific TaskID. If you want to subscribe
to the results of newly created tasks, to avoid event loss, we recommend you not set immediate start
when creating the tasks. You can subscribe to the results first, and then run the start command.
http://<server>/cgi-bin/api/analyseTaskManager/attachResult
POST

Request URL
Method
Request Params ( JSON format in body )
Type
Name
uint[64]
TaskID

R/O
O

Filters

object

O

+Events
+ImageDataFla
g

char[64][32] O
O
uint32

+ImageDataTy
pe

char[16][16] O

Heartbeat

int

O

Description
Subscribed TaskID
When it is not entered, or
the array is empty, the
results of all tasks are
subscribed to.
Filter conditions for
subscription
Filtered event
0 means containing
pictures. It is the default
value.
1 means not containing
pictures.
Optional. It is used to
combine the images of
the event.
One-dimensional array. If
"ImageDataType” does
not exist, it means
reporting all the pictures
of the event. If there is an
element in the array, it
reports pictures based on
the element
requirements. The value
of each element:

1. "ObjectImage":
   Reporting target cutout
2. "SceneImage":
   Reporting scene image
   Server keep-alive;
   integer; Unit: s;

Example
[ 1, 2, 3 ]

[ "FaceDetection", … ]
0

["ObjectImage",
"SceneImage"]

5

Video Analyse APIs 434

The value range is [1–60].
For example, if the
parameter exists in the
URL and the value is 5,
the device will send
“heartbeat” to the client as
a keep-alive message.
Note: The keep-alive
message must be sent
before the keepalive
parameter expires.

Request Example
{
"TaskID": [ 1, 2, 3 ],
"Filters": {
"Events": [ "FaceDetection", … ],
"ImageDataFlag": 0,
"ImageDataType": ["ObjectImage", "SceneImage"],
"Heartbeat": 5
}
}

Response Params ( JSON format in body )

Name

SID

Infos

Name

uint32

Name Name

Name

R

Subscribed SID

1234U

object[]

None

+TaskID

uint

None

Task ID

1

+TaskUserData

char[512]

None

Task data

"asdvbtgrffg"

+UserData

char[64]

O

+TaskCustomDa
ta

TaskCustomDa
ta

+UserDefineDat
a

char[512]

O

O

"asdvbtgrffg"

Video source data,
including the video
source information,.and
it corresponds to the
UserData field in
addPollingTask.

Custom data

Custom data by the
user, and it corresponds
to the UserDefineData
field in
analyseTaskManager.a

Video Analyse APIs 435

+FileID

char[128]

O

+FileState

int

O

+FileAnalyseMs
g

char[256]

O

+Events

object[]

O

+Flag

uint32

O

nalysePushPictureFileB
yRule.

File ID. Valid when
analyzing the file, and
offered when a file
analysis task is
complete.

"file-1234"

0

File analysis status:
0: Analyzing
1: Complete
2: Failed

Analyzing additional
information, usually the
failure reason.

Event information, such
as TrafficJunction,
HumanTrait and more.
For the format, see
EventInfo in
EventManager.

Offered when the
analysis results come
out.

Simultaneously reports
up to 32 events.

Tag status:
1: Unprocessed
2: Valid
3: Invalid

"Decode Failed,
Download Failed"

[@{Dahua

InformationExcha
nge
Format-Manage
ment
Branch.doc#Eve
ntInfo}Info]//end
of Events

2

0

+Image

object

O

Linked snapshots

++Offset

uint

None Offset of images in
binary data

++Length

uint

None

Image length (in bytes)

60000

Response Example

HTTP/1.1 200 OK

Content-Type: multipart/x-mixed-replace; boundary=<boundary>

Connection: close

--<boundary>

Content-Type: application/json

Video Analyse APIs 436

Content-Length: <data length>

{

        "SID": 1234U,

        "Infos": [

                {

                        "TaskID": 1,

                        "TaskUserData": "asdvbtgrffg",

                        "UserData": "asdvbtgrffg",

                        "TaskCustomData": null,

                        "FileID": "file-1234",

                        "FileState": 0,

                        "FileAnalyseMsg": "Decode Failed, Download Failed",

                        "Events": [{}],

                        "Flag": 2,

                        "Image": {

                                "Offset": 0,

                                "Length": 60000

                        }

                }

        ]

}

--<boundary>

Content-Type: text/plain

Content-Length: 11

Heartbeat

--<boundary>

…

9.9.3 Remove task

POST

Request URL http://<server>/cgi-bin/api/analyseTaskManager/remove
Method
Request Params ( JSON format in body )
Name
TaskID

Type
uint32

Example
1

R/O Description
Non
e

Task ID

Request Example
{

Video Analyse APIs 437

"TaskID": 1
}

Response Params ( JSON format in body )
Name
Response Example
{}

Type

R/O Description

Example

9.9.4 Push Picture File

Valid when data source type is PushPictureFile. support pushing multiple files at the same time, each file
should be completed, not support chunk
Request URL http://<server>/cgi-bin/api/analyseTaskManager/analysePushPictureFile
Method
Request Params ( JSON format in body )
Name
TaskID
Files

R/O Description
是
是

Type
uint
object[]

Example
1

POST

Task ID
File list
URL path and binary
data are supported, but
only one way can be
selected at a time
File ID
Remote file URL , with
the necessary
information for access,
including username,
password
Offset in binary data,
bytes
File size, bytes
Customer information,
X-ray machine
customization
Algorithm model path

"file-1234"
"ftp://username:passwor
d@hostname:port/filepa
th"

0

256000

"/aaa/bbb/ccc"

+FileID
+Url

char[128] 是
char[512] 否

+Offset

uint

+Length
+XRayCustom
Info

uint
XRayCusto
mInfo

否

否
否

char[512] 否

+ModelPath
Request Example
{
"TaskID": 1,
"Files": [{
"FileID": "file-1234",
"Url": "ftp://username:password@hostname:port/filepath",
"Offset": 0,
"Length": 256000,
"XRayCustomInfo": ,
"ModelPath": "/aaa/bbb/ccc"
},…{}]

Video Analyse APIs 438

}
--<boundary>
Content-Type: image/jpeg
Content-Length:<image size>
<JPEG image data>
--<boundary>

Response Params ( JSON format in body )
Name
Response Example
{}

Type

R/O Description

Example

Video Analyse APIs 439

10 Intelligent Traffic APIs

10.1 Intelligent Traffic Event

10.1.1 [Event] TrafficJunction

Table 10-1

Usage

Refer to "4.4.3 Subscribe to Snapshot"for how to subscribe event

Description When detects vehicle passing, send this event.

[ Event Params ] ( key=value format )

Name

Events

Type

R/O

Param Description

array<object> R

Event info array.

+EventBaseInfo

object

++Code

++Action

++Index

+GroupID

+CountInGroup

+IndexInGroup

+Lane

+TriggerType

+Speed

+Vehicle

String

String

int

int

int

int

int

int

int

Object

R

R

R

O

O

O

O

O

O

O

O

++BoundingBox Array<int>

R

++Text

++SubText

++SubBrand

++BrandYear

+TrafficCar

++RecNo

string

string

int

int

object

int

++PlateNumber

string

++PlateType

++PlateColor

++VehicleColor

string

string

string

++BoundingBox Array<int>

O

O

O

O

O

R

R

O

O

O

R

Base info of event.

Event Code. It should be TrafficJunction.

Event Action. It can be "Start", "Stop" or "Pulse".

The channel index relate to this event.

The id of event group.

Event count in the event group.

The index of this event in the event group, start from 1.

Lane number, start from 0.
Trigger type. It can be: 0—car detector, 1—radar, 2—
video.

Vehicle speed, unit is km/hour.

The information of vehicle object.

The detected car bounding box, 4 interge, refer to x's
value of left-top point, y's value of left-top point, x's value
of right-bottom point, y's value of right-bottom point.
Coordinate remap to 0 — 8192.
Vehicle logo.

Vehicle sub logo.

Vehicle sub brand index.

Vehicle brand year index.

Traffic Car info.

The record id.

Car plate number.

Plate type.

Plate color, ex: "Yellow", "Blue", … etc.

Vehicle color, ex: "Yellow", "Blue", … etc.

The detected plate bounding box, 4 interge, refer to x's
value of left-top point, y's value of left-top point, x's value
of right-bottom point, y's value of right-bottom point.

Intelligent Traffic APIs 440

++Country

++Speed

++Event

+CommInfo

++Seat

+++Type

string

int

string

object

Coordinate remap to 0 — 8192.
Country info. Max string length is 19.

Vehicle speed, unit is km/hour.

The event info, ex: "TrafficJunction".

Traffic event common info.

O

O

O

O

array<object> O

Vehicle front seat info.

string

O

Front seat type. It can be: "Main""Slave".

Some driver status. It can be some of the following:
"Smoking", "Calling".

Sunshade status. It can be: "Unknow", "WithSunShade",

"WithoutSunShade".

The detected sun shade bounding box, 4 interge, refer to
x's value of left-top point, y's value of left-top point, x's
value of right-bottom point, y's value of right-bottom point.
Coordinate remap to 0 — 8192.
SafeBelt status. It can be: "Unknow", "WithSafeBelt",
"WithoutSafeBelt".

+++Status

array<string> O

+++SunShade

string

O

+++ShadePos

Array<int>

O

+++SafeBelt

string

O

[ Example ]

--<boundary>
Content-Type: text/plain
Content-Length: <length>

Event

Events[0].EventBaseInfo.Code=TrafficJunction
Events[0].EventBaseInfo.Action=Pulse
Events[0].EventBaseInfo.Index=0
Events[0].GroupID=123
Events[0].CountInGroup=3
Events[0].IndexInGroup=1
Events[0].Lane=0
Events[0].Vehicle.BoundingBox[0]=1341
Events[0].Vehicle.BoundingBox[1]=2451
Events[0].Vehicle.BoundingBox[2]=4513
Events[0].Vehicle.BoundingBox[3]=4135
Events[0].Vehicle.Text=Audi
Events[0].Vehicle.SubText=A6L
Events[0].Vehicle.SubBrand=5
Events[0].Vehicle.BrandYear=2
Events[0].TrafficCar.RecNo=123
Events[0].TrafficCar.PlateNumber=AC00003
Events[0].TrafficCar.PlateColor=Yellow
Events[0].TrafficCar.VehicleColor=Blue
Events[0].TrafficCar.BoundingBox[0]=1341
Events[0].TrafficCar.BoundingBox[1]=2451
Events[0].TrafficCar.BoundingBox[2]=4513
Events[0].TrafficCar.BoundingBox[3]=4135
Events[0].TrafficCar.Country=China
Events[0].CommInfo.Seat[0].Type=Main

Intelligent Traffic APIs 441

Events[0].CommInfo.Seat[0].Status[0]=Smoking
Events[0].CommInfo.Seat[0].SunShade=WithSunShade
Events[0].CommInfo.Seat[0].ShadePos[0]=2021
Events[0].CommInfo.Seat[0].ShadePos[1]=3041
Events[0].CommInfo.Seat[0].ShadePos[2]=2151
Events[0].CommInfo.Seat[0].ShadePos[3]=3661
Events[0].CommInfo.Seat[0].SafeBelt=WithoutSafeBelt
…
--<boundary>
Content-Type: image/jpeg
Content-Length: <image size>

<Jpeg image data>
--<boundary>

10.1.2 [Event] TrafficRetrograde

When detects vehicle retrograde, send this event.

Event params is the same as TrafficJunction, except for event Code is TrafficRetrograde.

10.1.3 [Event] TrafficJam

Table 10-2

Usage

Refer to "4.4.3 Subscribe to Snapshot"for how to subscribe event

Description When detects traffic jam, send this event.

[ Event Params ] ( key=value format )

Name

Events

Type

R/O

Param Description

array<object> R

Event info array.

+EventBaseInfo

object

++Code

++Action

++Index

+GroupID

+CountInGroup

+IndexInGroup

+Lane

+StartJaming

+AlarmInterval

+JamLenght

+JamRealLengt
h

[ Example ]

String

String

int

int

int

int

int

int

int

int

int

R

R

R

O

O

O

O

O

O

O

O

O

Base info of event.

Event Code. It should be TrafficJam.

Event Action. It can be "Start", "Stop" or "Pulse".

The channel index relate to this event.

The id of event group.

Event count in the event group.

The index of this event in the event group, start from 1.

Lane number, start from 0.

Start jam time, UTC seconds.

Alarm interval, unit is second.

Jam length, percentage of the lane.

Jam real length, unit is metre.

Event

--<boundary>
Content-Type: text/plain
Content-Length: <length>

Intelligent Traffic APIs 442

Events[0].EventBaseInfo.Code=TrafficJam
Events[0].EventBaseInfo.Action=Pulse
Events[0].EventBaseInfo.Index=0
Events[0].GroupID=123
Events[0].CountInGroup=3
Events[0].IndexInGroup=1
Events[0].Lane=0
Events[0].StartJaming=123456789
Events[0].AlarmInterval=180
Events[0].JamLenght=70
Events[0].JamRealLength=120
…
--<boundary>
Content-Type: image/jpeg
Content-Length: <image size>

<Jpeg image data>
--<boundary>

10.1.4 [Event] TrafficUnderSpeed

When detects vehicle under speed, send this event.

Event params is the same as TrafficJunction, except for event Code is TrafficUnderSpeed, and
add following params:

[ Extra Event Params ] ( key=value format )

Name

Type

R/O Param Description

Table 10-3

+SpeedLimit

array<int>

+UnderSpeeding
Percentage

int

O

O

Speed limit, 2 integer, min speed and max speed.

Percentage of under speed.

10.1.5 [Event] TrafficOverSpeed

When detects vehicle over speed, send this event.

Event params is the same as TrafficJunction, except for event Code is TrafficOverSpeed, and
add following params:

[ Extra Event Params ] ( key=value format )

Name

Type

R/O Param Description

Table 10-4

+SpeedLimit

array<int>

+SpeedingPerce
ntage

int

O

O

Speed limit, 2 integer, min speed and max speed.

Percentage of over speed.

Intelligent Traffic APIs 443

10.1.6 [Event] TrafficPedestrain

Table 10-5

Usage

Refer to "4.4.3 Subscribe to Snapshot"for how to subscribe event

Description When detects human in the lane, send this event

[ Event Params ] ( key=value format )

Name

Events

Type

R/O Param Description

array<object> R

Event info array.

+EventBaseInfo

object

++Code

++Action

++Index

+GroupID

+CountInGroup

+IndexInGroup

+Lane

+Vehicle

++Category

String

String

int

int

int

int

int

object

string

++BoundingBox Array<int>

R

R

R

O

O

O

O

O

O

R

R

[ Example ]

Event

--<boundary>
Content-Type: text/plain
Content-Length: <length>

Base info of event.

Event Code. It should be TrafficPedestrain.

Event Action. It can be "Start", "Stop" or "Pulse".

The channel index relate to this event.

The id of event group.

Event count in the event group.

The index of this event in the event group, start from 1.

Lane number, start from 0.

Actually this is the human that detected, not vehicle.

Must be "Passerby", means this actually is a human.

The detected car bounding box, 4 interge, refer to x's value
of left-top point, y's value of left-top point, x's value of
right-bottom point, y's value of
right-bottom point.
Coordinate remap to 0 — 8192.

Events[0].EventBaseInfo.Code=TrafficPedestrain
Events[0].EventBaseInfo.Action=Pulse
Events[0].EventBaseInfo.Index=0
Events[0].GroupID=123
Events[0].CountInGroup=3
Events[0].IndexInGroup=1
Events[0].Lane=0
Events[0].Vehicle.Category=Passerby
Events[0].Vehicle.BoundingBox[0]=1341
Events[0].Vehicle.BoundingBox[1]=2451
Events[0].Vehicle.BoundingBox[2]=4513
Events[0].Vehicle.BoundingBox[3]=4135
…
--<boundary>
Content-Type: image/jpeg
Content-Length: <image size>

<Jpeg image data>

Intelligent Traffic APIs 444

--<boundary>

10.1.7 [Event] TrafficParking

When detects vehicle illegal parking, send this event.

Event params is the same as TrafficJunction, except for event Code is TrafficParking, and
remove param "speed", add following params:

[ Extra Event Params ] ( key=value format )

Name

Type

R/O

Param Description

Table 10-6

+StartParking

+AlarmInterval

+ParkingAllowed
Time

int

int

int

O

O

O

10.2 Traffic Flow

The start time of parking, UTC seconds.

The alarm interval.

The allowed time of parking.

10.2.1 [Event] TrafficFlowStat

Table 10-7

Usage

Refer to "4.9.17 Subscribe to Event Message"for how to subscribe event

Description When traffic flow trigger the rule, send this event

[ Event Params ] ( JSON format )

Name

Type

R/O

Param Description

FlowStates

array<object> R

Traffic flow info, each object in list is traffic flow info about
one lane.

+Lane

+Flow

+Period

+PeriodByMili

int

int

int

int

R

R

R

O

Lane number, start from 0.

Traffic flow number.

Traffic stat time, unit is minute.

Traffic stat time, unit is millisecond, value should
between 0 and 59999.

+DrivingDirectio
n

array<string> O

Driving direction, should be an array of three strings:







1st string: direction, can be: "Approach", "Leave"
2nd string: Approach position name
3rd string: Leave position name

[ Example ]

Event

--<boundary>
Content-Type: text/plain
Content-Length: xxxx

Code=TrafficFlowStat;action=Pulse;index=0;data={
"FlowStates": [ { "Lane": 0,
"Flow": 50,

Intelligent Traffic APIs 445

"Period": 5,
"DrivingDirection": [ "Approach", "XXXCity", "YYYCity"]
}, {…}, … ]
}
--<boundary>

10.2.2 Find Traffic Flow History

URL

http://<server>/cgi-bin/recordFinder.cgi?action=find&name=TrafficFlow

Table 10-8

Method

GET

Description

Find traffic flow history record.

[ Request Params ] ( key=value format in URL )

Name

name

count

StartTime

EndTime

condition

+Channel

+Lane

Type

string

int

string

string

object

int

int

R/O Param Description

R

O

O

O

O

O

O

The name of record table. It should be "TrafficFlow".

Max result to return, default is 1024.

The start of the record's CreateTime.

The End of the record's CreateTime.

Search condition.

Video channel index which starts from 0.

Lane index, starts from 0.

[ Response Params ] (key=value format)

Name

totalCount

found

records

+RecNo

+CreateTime

+StatisticsTime

+Period

+Channel

+Lane

+Vehicles

Type

int

int

array<object>

int

int

int

string

int

int

int

+AverageSpeed

float

[ Example ]

Request GET

R/O Param Description

O

O

R

R

R

R

R

R

R

R

O

Total record num that find.

Record num that returned.

The records that returned.

Record id.

The create time of record.

Traffic flow statistics time, UTC seconds.

Statistics period, unit is second.

Video channel index which starts from 0.

Lane index, starts from 0.

Total vehicle num.

Average speed of the vehicle, -1 means no vehicle, 0
means congestion.

http://192.168.1.108/cgi-bin/recordFinder.cgi?action=find&name=TrafficFlow&condition.Cha
nnel=0&condition.Lane=0&StartTime=123456700&EndTime=123456800&count=100

Respons
e

totalCount=1000
found=100
records[0].RecNo=12345
records[0].CreateTime=123456789
records[0].StaticsticsTime=123456789
records[0].Period=300

Intelligent Traffic APIs 446

records[0].Channel=0
records[0].Lane=0
records[0].Vehicles=250
records[0].AverageSpeed=25.4
…
records[1].RecNo=13579
records[1].CreateTime=123456799
records[1].StaticsticsTime=123456799
records[1].Period=300
records[1].Channel=0
records[1].Lane=0
records[1].Vehicles=220
records[1].AverageSpeed=21.8
…

10.2.3 Start Traffic Statistics Search

Request URL http://<server>/cgi-bin/api/trafficFlowStat/startFind

Method

POST

Request Params ( JSON format in body )

Name

condition

Type

object

R/O Description

Example

R

Traffic flow statistical conditions

+StartTime

systemtime R

Start time, accurate to hour

"2010-05-25 00:00:00"

systemtime R

End time, accurate to hour

"2010-05-25 23:59:59"

+EndTime

+Channel

+Lane

+Lanes

int

int

int[]

+ClassType

int

O

O

O

O

+Granularity

enumchar[
8]

O

0

0

[0]

1

"Hour"

Channel number

Lane number

Lane number array, supports data
search by multiple lanes

As video metadata and road
monitoring use the same database
table, they need to be distinguished
according to their types (0
represents video metadata and 1
represents road monitoring).

The granularity of statistical
information that needs to be
returned in the searching process.
This needs to be supported by
getCaps.
Enumchar[8]{
"Minute": By 5 minutes (hourly
report)
"Hour": By hour (daily report)
"Day": By day (monthly report)
"Month": By month (yearly report)
}
The default value is Hour.

Intelligent Traffic APIs 447

+PresetID

+Direction

int[]

enumchar[
16]

O

O

+Channels

int[256]

O

[1]

"Both"

[0,1,2,5]

Preset

Search by statistical direction
enumchar[16]{
"Both"
"LeftToRight"
"RightToLeft"
}

Channel number array. Used in
structured traffic statistics. In
multi-channel query, the channel
number is distributed to query the
total data of all channels
There must be at least one channel
and channels field. Generally, they
should not both exist. If both exist,
channels shall prevail.

Request Example

{
"condition": {
"StartTime": "2010-05-25 00:00:00",
"EndTime": "2010-05-25 23:59:59",
"Channel": 0,
"Lane": 0,
"Lanes": [0],
"ClassType": 1,
"Granularity": "Hour",
"PresetID": [1],
"Direction": "Both",
"Channels": [0,1,2,5]
}
}

Response Params ( JSON format in body )

R/O Description

O

O

token

Total number of results that meet
the query criteria

Example

2342343

333

Name

token

totalCount

Type

uint

uint

Response Example

{
"token": 2342343,
"totalCount": 333
}

10.2.4 Get Traffic Statistics

Request URL http://<server>/cgi-bin/api/trafficFlowStat/doFind

Intelligent Traffic APIs 448

Method

POST

Request Params ( JSON format in body )

Name

token

beginNumber

Type

uint

uint

R/O Description

R

R

Search token.

Search begin number.
That is to start from the beginNumber
records, fetch the count records, and
return.
0<=beginNumber<=totalCount-1

Example

46878

0

count

uint

R

Number of traffic statistic entries per
search

24

Request Example

{
"token": 46878,
"beginNumber": 0,
"count": 24
}

Response Params ( JSON format in body )

Name

found

info

Type

int

Info[]

R/O Description

Example

R

R

Number of entries that are searched

12

Traffic statistics (For details, see
traffic-flow statistics status information
structure in standard.)

[, … ]

Response Example

{
"found": 12,
"info": [{
"PresetID" : 1
"DrivingDirection" : ["Approach", "XXXCity", "YYYCity"],
"Lane" : 1,
"MachineAddress" : "XXX District, YYY Road",
"MachineName" : "Device001",
"UTC" : 1465389203,
"UTCMS" : 123,
……
},…{}]

}

10.2.5 End Traffic Statistics Search

Request URL http://<server>/cgi-bin/api/trafficFlowStat/stopFind

Method

POST

Request Params ( JSON format in body )

Name

token

Type

uint

R/O Description

R

Search token.

Example

46878

Request Example

Intelligent Traffic APIs 449

{
"token": 46878
}

Response Params ( JSON format in body )

Name

Type

R/O Description

Example

Response Example

{}

10.3 Traffic Record

10.3.1 Insert Traffic BlockList/AllowList Record

URL

http://<server>/cgi-bin/recordUpdater.cgi?action=insert&name=<RecordName>

Table 10-9

Method

GET

Description

Insert traffic BlockList/AllowList record.

[ Request Params ] ( key=value format in URL )

Type

R/O

Param Description

Name

name

string

PlateNumber

string

MasterOfCar

PlateColor

PlateType

VehicleType

string

string

string

string

VehicleColor

string

BeginTime

CancelTime

AuthorityList

+OpenGate

string

string

object

bool

R

R

O

O

O

O

O

O

O

O

O

The record table name, "TrafficBlackList" for BlockList and
"TrafficRedList" for AllowList.

The number of car plate, max string length is 31. It must be
unique.

The car owner, max string length is 15

Plate color, max string length is 31, ex: "Yellow", "Blue", … etc.

Plate type, max string length is 31.

Vehicle type, max string length is 31.

Vehicle color, max string length is 31. ex: "Yellow", "Blue", …
etc.

Begin time, ex: "2010-05-25 00:00:00".

Cancel time, ex: "2010-06-25 00:00:00".

Authority list, only valid for "TrafficRedList" table.

Authority to open the gate.

[ Response Params ] (key=value format)

Name

RecNo

[ Example ]

Request

Type

R/O

Param Description

int

R

The new record’s
asynchronously.

id, return -1

if

the device handles

GET
http://192.168.1.108/cgi-bin/recordUpdater.cgi?action=insert&name=TrafficBlackList&Pla
teNumber=AC00001&MasterOfCar=ZhangSan&PlateColor=Yellow&VehicleColor=Blue&
BeginTime=2011-01-01%2012:00:00&CancelTime=2011-01-10%2012:00:00

Response

RecNo=12345

Intelligent Traffic APIs 450

10.3.2 Update Traffic BlockList/AllowList Record

Table 10-10

URL

http://<server>/cgi-bin/recordUpdater.cgi?action=update&name=<RecordName>

Method

GET

Descripti
on

Update Traffic BlockList/AllowList record.
Note: Besides action, name, recno, there should be at least one more parameter to be
updated.

[ Request Params ] ( key=value format in URL )

Type

R/O Param Description

Name

name

recno

string

int

PlateNumber

string

MasterOfCar

string

…<other param>

-

[ Response Params ] ( OK )

[ Example ]

R

R

R

O

-

The record table name, "TrafficBlackList" for BlockList and
"TrafficRedList"for AllowList.

record id

The number of car plate, max string length is 31. It must be
unique.

The car owner, max string length is 15

…<See above insert command for other params of the record.
They are all optional.>

Request

GET
http://192.168.1.108/cgi-bin/recordUpdater.cgi?action=update&name=TrafficBlackList&re
cno=12345&PlateNumber=AC00001&MasterOfCar=ZhangSan&PlateColor=Yellow&Vehi
cleColor=Blue&BeginTime=2011-01-01%2012:00:00&CancelTime=2011-01-10%2012:00
:00

Response

OK

10.3.3 Remove Traffic BlockList/AllowList Record

URL

http://<server>/cgi-bin/recordUpdater.cgi?action=remove&name=<RecordName>

Table 10-11

Method

GET

Descripti
on

Remove Traffic BlockList/AllowList record.

[ Request Params ] ( key=value format in URL )

Name

name

recno

Type

R/O Param Description

string

int

R

R

The record table name, "TrafficBlackList"for BlockList and
"TrafficRedList"for AllowList.

The record id.

[ Response Params ] ( OK )

[ Example ]

Request

GET
http://192.168.1.108/cgi-bin/recordUpdater.cgi?action=remove&name=TrafficBlackList&r
ecno=12345

Intelligent Traffic APIs 451

Response

OK

10.3.4 Find Traffic BlockList/AllowList Record

Table 10-12

URL

Method

http://<server>/cgi-bin/recordFinder.cgi?action=find&name=<RecordName>

GET

Description

Find Traffic BlockList/AllowList record.

[ Request Params ] ( key=value format in URL )

Name

name

count

StartTime

EndTime

condition

+PlateNumber

+PlateNumberV
ague

Type

string

int

string

string

object

string

string

+PlateNumberV
agueGroup

array<string

>

+QueryCount

+QueryResultBe
gin

int

int

R/O Param Description

R

O

O

O

O

O

O

O

O

O

The record table name, "TrafficBlackList"for BlockList and
"TrafficRedList"for AllowList.

Max result to return, default is 1024.

The start of the record's CreateTime.

The end of the record's CreateTime.

Search condition.

Car plate number, max string length is 47.

Car plate number substring, match any car plate number that
contain this substring, max string length is 47.

Car plate number substring array, max string length is 47.

Query count, default is 1000.

Begin number in the result set, default is 0.

[ Response Params ] (key=value format)

Name

totalCount

found

records

+RecNo

+CreateTime

+PlateNumber

+MasterOfCar

+…<other
param>

[ Example ]

Type

int

int

array<object

>

int

int

string

string

-

R/O

Param Description

O

O

R

R

R

R

O

-

Total record num that find.

Record num that returned.

The records that returned.

Record id.

The create time of record.

Car plate number.

Car owner.

…<see above insert command for other params of the
record>

Request

Respons
e

GET
http://192.168.1.108/cgi-bin/recordFinder.cgi?action=find&name=TrafficBlackList&condition.
PlateNumber=AC00001&StartTime=123456700&EndTime=123456800&count=100

totalCount=1000
found=100
records[0].RecNo=12345
records[0].CreateTime=123456789
records[0].PlateNumber=AC00001

Intelligent Traffic APIs 452

records[0].MasterOfCar=ZhangSan
…
records[1].RecNo=13579
records[1].CreateTime=123456799
records[1].PlateNumber=AC00001
records[1].MasterOfCar=LiSi
…

10.3.5 RemoveEx Traffic BlockList/AllowList Record

URL

http://<server>/cgi-bin/recordUpdater.cgi?action=removeEx&name=<RecordName>

Table 10-13

Method

GET

Descripti
on

RemoveEx Traffic BlockList/AllowList record.

[ Request Params ] ( key=value format in URL )

Name

name

RecNo

Type

R/O Param Description

string

int

R

O

O

The record table name, "TrafficBlackList"for BlockList and
"TrafficRedList"for AllowList.

The record id.

The number of car plate, max string length is 31. It must be
unique.

PlateNumber

string

[ Response Params ] ( OK )

[ Example ]

Request

GET
http://192.168.1.108/cgi-bin/recordUpdater.cgi?action=removeEx&name=TrafficBlackList
&PlateNumber=AC00001

Response

OK

10.3.6 Import Traffic BlockList/AllowList



Import the traffic blocklist and allowlist

Upload a blocklist or allowlist file to the device, and then import the data into the device. This
operation might take a long time.

http://<server>/cgi-bin/trafficRecord.cgi?action=uploadFile&Type=<Type>
POST

Request URL
Method
Request Params ( key=value format in URL ; binary data in body )
Name
Type

R/O Description
R

Type
char[16]

File type, value:
"TrafficBlackList” Traffic blocklist
"TrafficRedList" Traffic allowlist
File format, fixed to "CSV”
Encoding format, the value is "utf-8" or
"GB2312”

Example
"TrafficBlackList"

"CSV”
"utf-8"

format
code

char[16]
char[16]

R
R

Request Example

Intelligent Traffic APIs 453

POST http://192.168.1.108/cgi-bin/trafficRecord.cgi?action=uploadFile&Type=TrafficBlackList&format=
CSV&code=utf-8 HTTP/1.1
User-Agent: Client/1.0
Content-Type: multipart/form-data; boundary=<boundary>
Content-Length:XXXX

--<boundary>
Content-Disposition: form-data; name="blackfile"; filename="TrafficBlackList.CSV"
Content-Type: application/vnd.ms-excel

<File data….>
--<boundary>--

Response Params ( OK in body )
Response Example
OK

10.3.7 Export Traffic BlockList/AllowList

 Asynchronously export traffic blocklist and allowlist

Notify the device to export the traffic blocklist and allowlist to the file. This operation is non-blocking.
To obtain the export result, please run the“getFileExportState” command.

http://<server>/cgi-bin/recordUpdater.cgi?action=exportAsyncFile&name=<Name>
GET

Request URL
Method
Request Params ( key=value format in URL )
Name
name

Type
char[16]

R/O Description
R

File type, value:
"TrafficBlackList” Traffic blocklist
"TrafficRedList" Traffic allowlist
Export Filename
File format, fixed to "CSV”
Encoding format, the value is "utf-8" or
"GB2312”

Example
"TrafficBlackList"

"RecordFile01"
CSV
"utf-8"

filename
format
code

char[256] O
R
char[16]
R
char[16]

Request Example
http://<server>/cgi-bin/recordUpdater.cgi?action=exportAsyncFile&name=TrafficBlackList&filename=Re
cordFile01&format=CSV&code=utf-8

Response Params ( OK in body )
Response Example
OK

 Get the status of the exported traffic blocklist and allowlist

Get the result of the exported traffic blocklist and allowlist

Request URL
Method

http://<server>/cgi-bin/recordUpdater.cgi?action=getFileExportState&name=<Name>
GET

Intelligent Traffic APIs 454

Request Params ( key=value format in URL )
Name
name

R/O Description
R

Type
char[16]

File type, value:
"TrafficBlackList” Traffic blocklist
"TrafficRedList" Traffic allowlist

Example
"TrafficBlackList"

Request Example
http://<server>/cgi-bin/recordUpdater.cgi?action=getFileExportState&name=TrafficBlackList

Example
1

Response Params ( key=value format in body )
Name
state

R/O Description
R

Type
int

Exporting status:
0: Success
1: Failure
2: running
3: the file is invalid
4: the file is too large
5: the file has duplicate data

Response Example
state=0

 Download the exported traffic blocklist and allowlist file

Download the exported traffic blocklist and allowlist file

http://<server>/cgi-bin/recordUpdater.cgi?action=downloadFile&Type=<Type>
GET

Request URL
Method
Request Params ( key=value format in URL )
Name
Type

Type
char[16]

R/O Description
R

File type, value:
"TrafficBlackList”: Traffic blocklist
"TrafficRedList": Traffic allowlist
The exported file name must be the
same as the file name used in the
export command.

Example
"TrafficBlackList"

"RecordFile01"

filename

char[256] O

Request Example
http://<server>/cgi-bin/recordUpdater.cgi?action=downloadFile&Type=TrafficBlackList&filename=Recor
dFile01

Response Params ( binary in body )
Response Example
HTTP/1.1 200 OK
Server: Device/1.0
Content-Type: application/octet-stream
Content-Length: xxx

<File Data…>

Intelligent Traffic APIs 455

10.3.8 Export Traffic Flow

 Export traffic flow records

Notify the device to export the traffic flow records to the file. This operation is non-blocking. To obtain
the export result, please run the“getFileExportState” command.

http://<server>/cgi-bin/recordUpdater.cgi?action=exportAsyncFile&name=TrafficFlow
GET

Request URL
Method
Request Params ( key=value format in URL )
Name
name

Type
char[16]

R/O Description
R

File type, fixed value: "TrafficFlow”

filename
format

char[256] O
R
char[16]

code

char[16]

R

Name of the exported file
Format of the exported file, fixed to
"CSV”
Encoding format of the exported file,
the value is "utf-8" or "GB2312”

Example
"TrafficFlow"

"RecordFile01"
CSV

"utf-8"

Request Example
http://<server>/cgi-bin/recordUpdater.cgi?action=exportAsyncFile&name=TrafficFlow&filename=Record
File01&format=CSV&code=utf-8

Response Params ( OK in body )
Response Example
OK

 Get the exported traffic flow record results

Get the exported traffic flow record results

Request URL

http://<server>/cgi-bin/recordUpdater.cgi?action=getFileExportState&name=TrafficFlo
w
GET

Method
Request Params ( key=value format in URL )
Name
name
Request Example
http://<server>/cgi-bin/recordUpdater.cgi?action=getFileExportState&name=TrafficFlow

R/O Description
R

File type, fixed value: "TrafficFlow”

Type
char[16]

Example
"TrafficFlow"

Response Params ( key=value format in body )
Name
state

R/O Description
R

Type
int

Export status, the value is 0: success, 1: failure, 2:
running, 3: the file is invalid, 4: the file is too large,
5: the file has duplicate data

Example
1

Response Example
state=0

 Download Export 0 traffic flow records File

Download the exported traffic flow log file

Request URL

http://<server>/cgi-bin/recordUpdater.cgi?action=downloadFile&Type=TrafficFlow

Intelligent Traffic APIs 456

GET

Method
Request Params ( key=value format in URL )
Name
Type
filename

R/O Description
Type
char[16]
R
char[256] O

File type, fixed value: "TrafficFlow”
The exported file name must be the
same as the file name used in the
export command.

Example
"TrafficFlow"
"RecordFile01"

Request Example
http://<server>/cgi-bin/recordUpdater.cgi?action=downloadFile&Type=TrafficFlow&filename=RecordFile
01

Response Params ( binary in body )
Response Example
HTTP/1.1 200 OK
Server: Device/1.0
Content-Type: application/octet-stream
Content-Length: xxx

<File Data…>

10.3.9 Export Traffic Snap Event Info

 Export traffic snapshot event records

Notify the device to export the traffic snapshot event records to the file. This operation is
non-blocking. To obtain the export result, please run the “getFileExportState” command.

Request URL

http://<server>/cgi-bin/recordUpdater.cgi?action=exportAsyncFileByConditon&name=
TrafficSnapEventInfo
GET

Method
Request Params ( key=value format in URL )
Name
name

R/O Description
R

Type
char[16]

filename
format
code

char[256] O
R
char[16]
R
char[16]

condition
+startTime

object
char[16]

R
R

+endTime

char[16]

R

File type, fixed value:
"TrafficSnapEventInfo”
Export Filename
File format, fixed to "CSV”
Encoding format, the value is "utf-8" or
"GB2312”
Data Conditions
Export the Start time, format:
yyyy-MM-dd HH:mm:ss
Export the End time, format:
yyyy-MM-dd HH:mm:ss

Example
"TrafficSnapEventInfo"

"RecordFile01"
CSV
"utf-8"

"utf-8"
"2010-04-08 16:12:46"

"2010-04-08 18:12:46"

Request Example
http://<server>/cgi-bin/recordUpdater.cgi?action=exportAsyncFileByConditon&name=TrafficSnapEventI
nfo&filename=RecordFile01&format=CSV&code=utf-8&condition.startTime=2010-04-08%2016:12:46&c
ondition.endTime=2010-04-08%2018:12:46

Intelligent Traffic APIs 457

Response Params ( OK in body )
Response Example
OK

 Obtain and export traffic snapshot event record results

Obtain and export traffic snapshot event record results

Request URL

http://<server>/cgi-bin/recordUpdater.cgi?action=getFileExportState&name=TrafficSn
apEventInfo
GET

Method
Request Params ( key=value format in URL )
Name
name

R/O Description
R

Type
char[16]

File type, fixed value:
"TrafficSnapEventInfo”

Example
"TrafficSnapEventInfo"

Request Example
http://<server>/cgi-bin/recordUpdater.cgi?action=getFileExportState&name=TrafficSnapEventInfo

Response Params ( key=value format in body )
Name
state

R/O Description
R

Type
int

Export status, the value is 0: success, 1: failure, 2:
running, 3: the file is invalid, 4: the file is too large,
5: the file has duplicate data

Example
1

Response Example
state=0

 Download the exported traffic snapshot event record file

Download the exported traffic snapshot event record file

Request URL

http://<server>/cgi-bin/recordUpdater.cgi?action=downloadFile&Type=TrafficSnapEve
ntInfo
GET

Method
Request Params ( key=value format in URL )
Name
Type

R/O Description
R

Type
char[16]

filename

char[256] O

File type, fixed value:
"TrafficSnapEventInfo”
The exported file name must be the
same as the file name used in the
export command.

Example
"TrafficSnapEventInfo"

"RecordFile01"

Request Example
http://<server>/cgi-bin/recordUpdater.cgi?action=downloadFile&Type=TrafficSnapEventInfo&filename=
RecordFile01

Response Params ( binary in body )
Response Example
HTTP/1.1 200 OK
Server: Device/1.0
Content-Type: application/octet-stream
Content-Length: xxx

Intelligent Traffic APIs 458

<File Data…>

10.4 Traffic Snap Operation

10.4.1 Open Strobe

Syntax

http://<server>/cgi-bin/trafficSnap.cgi?action=openStrobe&channel=<ChannelNo>&inf
o.openType=<OpenType>&info.plateNumber=<PlateNumber>

Table 10-14

Method

GET

Description

Open the strobe manually.

Example

Success
Return

Comment

http://192.168.1.108/cgi-bin/trafficSnap.cgi?action=openStrobe&channel=1&info.openT
ype=Normal&info.plateNumber=046XRW

OK

Parameters in URL:
ChannelNo: integer, video channel index which starts from 1.
OpenType: string, For now, the value is fixed to "Normal"
PlateNumber: string, the plateNumber of the TrafficCar.

10.4.2 Open/Close Unlicensed Vehicle Detection

Table 10-15

Syntax

http://<server>/cgi-bin/trafficSnap.cgi?action=<Action>&channel=<ChannelNo>&nam
e=UnlicensedVehicle

Method

GET

Description

Open or Close the unlicensed vehicle detection.

Example

Success
Return

Comment

http://192.168.1.108/cgi-bin/trafficSnap.cgi?action=open&channel=1&name=Unlicense
dVehicle

OK

Parameters in URL:
Action: string, this value can be open and close.
ChannelNo: integer, video channel index which starts from 1.

10.4.3 Manual Snap

Table 10-16

Syntax

Method

Description

http://<server>/cgi-bin/trafficSnap.cgi?action=manSnap&channel=<ChannelNo>

GET

Take a snapshot manually. For intelligent traffic device, it should use this method to take
a snapshot.

Intelligent Traffic APIs 459

But, the response is not image data.If you want to get the image data, please follow
these steps:

1.  Use the method mentioned chapter (4.4.3 Subscribe to snapshot) to subscribe

the image data, and the eventcode is "TrafficManualSnap".

2.  Use the "manSnap"to take a snapshot manually.

3.

In the connection which built in the Step 1, the device will send the image data.

http://192.168.1.108/cgi-bin/trafficSnap.cgi?action=manSnap&channel=1

OK

Parameters in URL:
ChannelNo: integer, video channel index which starts from 1.

Example

Success
Return

Comment

10.5 Traffic Parking

10.5.1 Get the Specific Parking Space Status

Table 10-17

Syntax

http://<server>/cgi-bin/trafficSnap.cgi?action=getParkingSpaceStatus&channel=<Chan
nelNo>&<paramName>=<paramValue>[&<paramName>=<paramValue>…]

Method

GET

Description

Get specific parking space(s) status.

Example

http://192.168.1.108/cgi-bin/trafficSnap.cgi?action=getParkingSpaceStatus&condition.L
ane[0]=0&condition.Lane[1]=255

Success
Return

A list of parking space status
status[0].Lane=0
status[0].PictureId=5
status[0].TrafficCar.CountInGroup=1
…
status[1].Lane=1
status[1].PictureId=4
status[1].TrafficCar.CountInGroup=1
…
Parameters in URL:
ChannelNo: integer, video channel index which starts from 1.
paramName and paramValue: detail in table below.

Comment

In table below,
index: The index of type array, start from 0

Parameters in Response :
TrafficCar: the members refer to TrafficCar

Appendix

ParamName

ParamValue type Description

Intelligent Traffic APIs 460

ParamName

ParamValue type Description

condition.Lane[index]

condition.ResponseLevel

int

int

The Lane value

The Level value , refer to condition

10.5.2 Get All Status of Parking Spaces

Table 10-18

Syntax

Method

http://<server>/cgi-bin/trafficParking.cgi?action=getAllParkingSpaceStatus

GET

Description

Get all valid parking spaces status of one device.

Example

http://192.168.1.108/cgi-bin/trafficParking.cgi?action=getAllParkingSpaceStatus

status[0].Lane=0
status[0].CustomParkNo = A2701
status[0].Status = Park
status[0].SpaceType = 0
…
status[1].Lane=1
status[1]. Status = NoPark
…
sceneType = ParkingStatistics
statisticsMode = AreaMode
areaStatus[0].Name = A01
areaStatus[0].Count = 10
areaStatus[0].SpaceType = 0
areaStatus[0].RemainCnt = 5
…
areaStatus[1].Name = A02
areaStauts[1].Count = 20
…

Parameters in Response :
Status : Park or NoPark
CustomParkNo: customized parking space number
SpaceType：0: trolley parking space, 1: Crane parking space
sceneType ： scene
"parkingstatistics": parking space statistics type
statisticsMode：Statistical mode, valid when the sceneType is "parkingstatistics".
"areamode": area mode, "spacemode": parking space mode
areaStatus：area status. It is an array. It is valid when scenetype is "parkingstatistics"
and statisticsmode is "areamode"
SpaceType：parking space type: 0: trolley parking space, 1: Crane parking space

type; "parkingspace": parking space detection

type; and

Success
Return

Comment

10.5.3 [Config] Parking Space Light State

 Get parking space light state

Table 10-19

Intelligent Traffic APIs 461

Syntax

http://<server>/cgi-bin/configManager.cgi?action=getConfig&name=ParkingSpaceLight
State

Method

GET

Description

Use this method. It can get the light state config. For example, it can know that when the
space is free, then the light should be green, and the space is full, the light should be
red.

Example

http://192.168.1.108/cgi-bin/configManager.cgi?action=getConfig&name=ParkingSpac
eLightState

Success
Return

table.ParkingSpaceLightState.SpaceFree.Blue=0
table.ParkingSpaceLightState.SpaceFree.Green=1
table.ParkingSpaceLightState.SpaceFree.Pink=0
table.ParkingSpaceLightState.SpaceFree.Purple=0
table.ParkingSpaceLightState.SpaceFree.Red=0
table.ParkingSpaceLightState.SpaceFree.White=0
table.ParkingSpaceLightState.SpaceFree.Yellow=0
table.ParkingSpaceLightState.SpaceFull.Blue=0
table.ParkingSpaceLightState.SpaceFull.Green=0
table.ParkingSpaceLightState.SpaceFull.Pink=0
table.ParkingSpaceLightState.SpaceFull.Purple=0
table.ParkingSpaceLightState.SpaceFull.Red=1
table.ParkingSpaceLightState.SpaceFull.White=0
table.ParkingSpaceLightState.SpaceFull.Yellow=0
table.ParkingSpaceLightState.SpaceOrder.Blue=0
table.ParkingSpaceLightState.SpaceOrder.Green=0
table.ParkingSpaceLightState.SpaceOrder.Pink=0
table.ParkingSpaceLightState.SpaceOrder.Purple=0
table.ParkingSpaceLightState.SpaceOrder.Red=0
table.ParkingSpaceLightState.SpaceOrder.White=0
table.ParkingSpaceLightState.SpaceOrder.Yellow=1
table.ParkingSpaceLightState.SpaceOverLine.Blue=0
table.ParkingSpaceLightState.SpaceOverLine.Green=0
table.ParkingSpaceLightState.SpaceOverLine.Pink=0
table.ParkingSpaceLightState.SpaceOverLine.Purple=0
table.ParkingSpaceLightState.SpaceOverLine.Red=0
table.ParkingSpaceLightState.SpaceOverLine.White=0
table.ParkingSpaceLightState.SpaceOverLine.Yellow=1
table.ParkingSpaceLightState.SpaceSpecial.Blue=0
table.ParkingSpaceLightState.SpaceSpecial.Green=0
table.ParkingSpaceLightState.SpaceSpecial.Pink=0
table.ParkingSpaceLightState.SpaceSpecial.Purple=0
table.ParkingSpaceLightState.SpaceSpecial.Red=0
table.ParkingSpaceLightState.SpaceSpecial.White=0
table.ParkingSpaceLightState.SpaceSpecial.Yellow=1

Comment

Parameters in Response :
There are five conditions about the space light state: SpaceFree, SpaceFull,
SpaceOrder, SpaceOverLine, and SpaceSpecial. For each condition, you can choose
the light state.

Intelligent Traffic APIs 462

The state value is integer. It can be 0, 1, 2.
0 means close;
1 means open;
2 means twinkle.

 Set parking space light state

Table 10-20

Syntax

http://<server>/cgi-bin/configManager.cgi?action=setConfig&<paramName>=<paramV
alue>[&<paramName>=<paramValue>…]

Method

GET

Description

Set the light state config.

Example

http://192.168.1.108/cgi-bin/configManager.cgi?action=setConfig&ParkingSpaceLightSt
ate.SpaceFree.Blue=1&ParkingSpaceLightState.SpaceFree.Green=0&ParkingSpaceLi
ghtState.SpaceFree.Pink=0&ParkingSpaceLightState.SpaceFree.Purple=0&ParkingSp
aceLightState.SpaceFree.Red=0&ParkingSpaceLightState.SpaceFree.White=0&Parki
ngSpaceLightState.SpaceFree.Yellow=0

Success
Return

Comment

OK

—

10.5.4 Set Order State

Table 10-21

Syntax

http://<server>/cgi-bin/trafficParking.cgi?action=setOrderState&state[0].Lane=<LaneN
umber>&state[0].State=<State>

Method

GET

Description

Set the light order state, order or not

Example

Success
Return

Comment

http://192.168.1.108/cgi-bin/trafficParking.cgi?action=setOrderState&state[0].Lane=0&s
tate[0].State=Ordered

OK

Parameters in URL:
LaneNumber: integer, for now, fixed to 0.
State: string, the value can be "Ordered"or "Free".

10.5.5 Set Light State

Table 10-22

Syntax

http://<server>/cgi-bin/trafficParking.cgi?action=setLightState&state[Index].LightNo=<L
aneNumber>&state[Index].Color=<Color>&state[Index].State=<State>&state[Index].
Enable=<Enable>

Method

GET

Description

Set the light state.

Example

http://192.168.1.108/cgi-bin/trafficParking.cgi?action=setLightState&state[0].LightNo=0

Intelligent Traffic APIs 463

&state[0].Color=Red&state[0].State=0&state[0].Enable=true

Success
Return

OK

Comment

Parameters in URL:
Index: integer, start with 0.
LaneNumber: integer, the No. of the Lane.
Color: string, it can be Red, Yellow, Blue, Green, Purple, White, Pink.
State: integer, it can be 0, 1, 2.0 means close;1 means open;2 means twinkle;
Enable: true or false, enable or not.

10.5.6 [Config] Parking Space Access Filter Setting

 Get parking space access filter setting

Table 10-23

URL

http://<server>/cgi-bin/ConfigManager.cgi?action=getConfig&name=ParkingSpaceAcces
sFilter

Method

GET

Description

Get Parking Space Access Filter config. Using this method, we can get the accessible
address of the device.

[ Request Params ] ( None )

[ Response Params ] ( key=value format )

Name

table

+ParkingSpaceA
ccessFilter

++Enable

++Type

Type

object

object

bool

string

R/O

Param Description

R

R

R

R

config table object

ParkingSpaceAccessFilter config object

Enable filter or not

Filter type, can be: "BannedList", "TrustList".

++TrustList

Array<string> O

IP address list that trust

++BannedList

Array<string> O

IP address list that banned.

[ Example ]

Request

GET
http://10.0.0.8/cgi-bin/ConfigManager.cgi?action=getConfig&name=ParkingSpaceAccessFil
ter

Respons
e

table.ParkingSpaceAccessFilter.Enable=false
table.ParkingSpaceAccessFilter.Type=TrustList
table.ParkingSpaceAccessFilter.TrustList[0]=172.24.2.14
table.ParkingSpaceAccessFilter.BannedList[0]=172.24.2.15

 Set parking space access filter setting

Table 10-24

URL

http://<server>/cgi-bin/ConfigManager.cgi?action=setConfig

Method

GET

Descripti
on

Set Parking Space Access Filter config.

Intelligent Traffic APIs 464

[ Request Params ] ( key=value format at URL )

Name

ParkingSpaceAc
cessFilter

+Enable

+Type

Type

object

bool

string

R/O Param Description

R

R

R

ParkingSpaceAccessFilter config object

Enable filter or not

Filter type, can be: "BannedList", "TrustList".

+TrustList

Array<string> O

IP address list that trust

+BannedList

Array<string> O

IP address list that banned.

[ Response Params ] ( OK )

[ Example ]

Request

GET
http://10.0.0.8/cgi-bin/ConfigManager.cgi?action=setConfig&ParkingSpaceAccessFilter.Ena
ble=true&ParkingSpaceAccessFilter.Type=TrustList&ParkingSpaceAccessFilter.TrustList[0]
=172.24.2.14&ParkingSpaceAccessFilter.BannedList[0]=172.24.2.15

Respons
e

OK

10.5.7 Set OverLine State

Table 10-25

Syntax

http://<server>/cgi-bin/trafficParking.cgi?action=setOverLineState&state[0].Lane=<Lan
eNumber>&state[0].State=<State>

Method

GET

Description

Set the spaceState overLine state or StopOverLine state

Example

Success
Return

Comment

http://192.168.1.108/cgi-bin/trafficParking.cgi?action=setOverLineState&state[0].Lane=
0&state[0].State=OverLine

OK

Parameters in URL:
LaneNumber: integer, for now, fixed to 0.
State: string, the value can be “OverLine” or “StopOverLine”.

10.6 Vehicles Distribution

10.6.1 Subscribe Vehicles Distribution Data

Table 10-26

URL

Method

http://<server>/cgi-bin/vehiclesDistribution.cgi?action=attach
GET

Description Subscribe the vehicles Distribution data.

[ Request Params ] ( key=value format in URL )

Name

Channel

Type

int

R/O

Param Description

R

Video channel index which starts from 1

Intelligent Traffic APIs 465

heartbeat

int

O

Send heartbeat interval, range is [1, 60],unit is second. If the
URL contains this parameter, and the value is 5, it means every
5 seconds the device should send the heartbeat message to
the client, the heartbeat meaage are "Heartbeat". If this
parameter is not present, its default value is 60.

[ Response Params ] ( key=value format)

Name

Channel

VehiclesData

+PtzPresetId

+RuleId

+RuleType

+VehiclesNum

+QueueLen

+Region

[ Example ]

Request

Response

Type

int

array<obj
ect>

int

int

int

int

int

array<arr
ay<int>>

R/O

Param Description

R

R

R

R

R

R

R

R

Video channel index which starts from 1

Vehicles distribution data info.

The ptz preset index which starts from 1.

The rule id.

The rule type, 197 : vehicle congestion detection, 198 : vehicle
limit detection.

The vehicles number.

The vehicle queue length.

The detection region, the first array is point list, max item is 32,
the second array is point, must be two int, means x and y value,
coordinate remap to 0 - 8192.

GET http://192.168.1.108/cgi-bin/vehiclesDistribution.cgi?action=attach&Channel=1&he
artbeat=5

HTTP/1.1 200 OK
Server: Device/1.0
Content-Type: multipart/x-mixed-replace; boundary=<boundary>
Connection: closed

--<boundary>
Content-Type: text/plain
Content-Length: <length>

Channel=1
VehiclesData[0].PtzPresetId=1
VehiclesData[0].RuleId=1
VehiclesData[0].RuleType=197
VehiclesData[0].VehiclesNum=25
VehiclesData[0].QueueLen=53
VehiclesData[0].Region[0][0]=1032
VehiclesData[0].Region[0][1]=1035
VehiclesData[0].Region[1][0]=1045
VehiclesData[0].Region[1][1]=5072
VehiclesData[0].Region[2][0]=6163
VehiclesData[0].Region[2][1]=5127
VehiclesData[0].Region[3][0]=6031
VehiclesData[0].Region[3][1]=1063

--<boundary>

Intelligent Traffic APIs 466

Content-Type: text/plain
Content-Length: 11

Heartbeat -<boundary>
Content-Type: text/plain
Content-Length: <length>

Channel=1
VehiclesData[0].PtzPresetId=2
…

10.7 Vehicle Manager

10.7.1 Adding Vehicle Groups

POST

Add vehicle groups, and then add vehicles to the groups.
Request URL http://<server>/cgi-bin/api/VehicleRegisterDB/createGroup
Method
Request Params ( JSON format in body )
Name
group
+GroupName

R/O Description
R
R

Group information
Group name

Type
object
char[128]

Example

“Serious criminal
database”
"Key criminals"
"AllowListDB"

+GroupDetail
+GroupType

char[256]
enumchar[
16]

O
O

Remarks of the group
Group type
enumchar[16]{
"AllowListDB": Allowlist
"BlockListDB": Blocklist
}

Request Example
{
"group": {
"GroupName": “Serious criminal database”,
"GroupDetail": "Key criminals",
"GroupType": " AllowListDB "
}
}

Response Params ( JSON format in body )
Name
groupID

R/O Description
R

Type
char[64]

Group ID assigned by
server

Example
"10000"

Intelligent Traffic APIs 467

Response Example
{
"groupID": "10000"
}

10.7.2 Modifying Vehicle Groups

POST

Request URL http://<server>/cgi-bin/api/VehicleRegisterDB/modifyGroup
Method
Request Params ( JSON format in body )
Name
group
+GroupID
+GroupName

R/O Description
R
R
O

Group information
Group ID
Group name

Type
object
char[128]
char[128]

Example

"0001"
“Serious criminal
database”
"Key criminals"
" AllowListDB "

+GroupDetail
+GroupType

char[256]
enumchar[
16]

O
O

Remarks of the group
Group type
enumchar[16]{
"AllowListDB": Allowlist
"BlockListDB": Blocklist
}

Request Example
{
"group": {
"GroupID": "0001",
"GroupName": “Serious criminal database”,
"GroupDetail": "Key criminals",
"GroupType": " AllowListDB "
}
}

Response Params ( JSON format in body )
Name
Response Example
{}

Type

R/O Description

10.7.3 Deleting Vehicle Groups

Example

POST

Request URL http://<server>/cgi-bin/api/VehicleRegisterDB/deleteGroup
Method
Request Params ( JSON format in body )
Name
groupID

R/O Description
R

Type
char[64]

Example
"000001"

Group ID. ““ means to delete
all groups.

Request Example
{
"groupID": "000001"

Intelligent Traffic APIs 468

}

Response Params ( JSON format in body )
Name
Response Example
{}

Type

R/O Description

10.7.4 Searching for Vehicle Groups

Example

POST

Request URL http://<server>/cgi-bin/api/VehicleRegisterDB/findGroup
Method
Request Params ( JSON format in body )
Name
groupID

R/O Description
R

Type
char[64]

Group ID. ““ means to search
for all group information.

Example
“000001"

Request Example
{
"groupID": "000001"
}

Response Params ( JSON format in body )
Name
GroupList

R/O Description
R

Type
object[]

+groupID
+groupName

char[64]
char[128]

R
O

List of searched vehicle group
information
Group ID
Group name

+groupDetail

char[256]

O

Remarks of the group

+groupType

enumchar[
16]

O

+groupSize

int

O

+channels

int16[1024] O

Group type
enumchar[16]{
"AllowListDB": Allowlist
"BlockListDB": Blocklist
}
Number of vehicles in the
current group
List of video channel numbers
to which the current group is
bound. If the current group is
not bound to any video
channel, enter [-1] in this
parameter.

Response Example
{
"GroupList": [{
"groupID": "000001",
"groupName": “Serious criminal database”,

Example

"000001"
“Serious criminal
database”
“Vehicles of key
criminals”
"AllowListDB "

30

[0,]

Intelligent Traffic APIs 469

"groupDetail": "Vehicles of key criminals",
"groupType": " AllowListDB",
"groupSize": 30,
"channels": [0]
},…{}]
}

10.7.5 Adding Vehicle Records

Add vehicle records to vehicle groups.

Request URL
Method
Request Params ( JSON format in body )
Type
Name
object[]
vehicle
uint64
+UID

R/O Description
R
R

http://<server>/cgi-bin/api/VehicleRegisterDB/multiAppend
POST

+GroupID

char[64]

R

+GroupName

char[128] O

+PlateNumber
+PlateCountry

char[64] O
char[3]
O

+PlateType
+Type

uint16
uint16

+Brand

uint16

O
O

O

+Serie

uint16

O

+CarSeriesMode
lYearIndex

uint16

O

Multiple vehicle information
Unique identifier of the
vehicle, generated by the
server to represent a unique
identifier (primary key) in the
program. It is different from
the ID field.
Group ID to which the vehicle
belongs
Group name to which the
vehicle belongs (exists only
when the parameter exits)
License plate number
The country where the
vehicle is located (2 bytes),
conforming to ISO3166.
License plate type
Vehicle type (such as sedans
and trucks)
Vehicle logo. You need to get
the real logo through the
mapping table, which is the
same as CarLogoIndex of
ANPR events.
Vehicle sub-brand. You need
to get the real sub-brand
through the mapping table,
which is the same as the
SubBrand of ANPR event.
Vehicle model year. You need
to get the real model year
through the mapping table,
which is the same as

Example
[ , ]
120837

"00001"

"Group1"

"ZA12345”
"CN"

12
2

10

1005

12

Intelligent Traffic APIs 470

BrandYear of ANPR event..
The model year No. of vehicle
head ranges from 1 to 999;
the model year No. of vehicle
tail ranges 1001 to 1999. 0
means unknown, and 1000 is
reserved.
Vehicle color.
The first element represents
the red component value.
The second element
represents the green
component value.
The third element represents
the blue component value.
The fourth element
represents the transparency
component value
(meaningless).
Vehicle color status. 0:
Unknown; 1: Known.
License plate color. It is the
same as vehicle color.
License plate color status. 0:
Unknown; 1: Known.
Name of the vehicle owner
Gender
"Male"
"Female"
"Unknown” (such as no field)
ID card type
IC: IC card
Passport
Officer: Officer card
Unknown
Person ID, employee ID, and
other IDs
Nationality of vehicle owner
(2 bytes), conforming to
ISO3166.
Province
City
Home address of the
registered person (IVSS
requirement)
Email address of the vehicle
owner

[128, 128, 128,
255]

0

[128, 128, 128,
255]
0

“ZhangSan”
"Male"

"IC"

"123456789"

"CN"

"XXX"
"YYY"
“ZZZ Road”

"user@example.c
om"

+VehicleColor

uint8[4]

O

+VehicleColorSta
te
+PlateColor

uint8

O

uint8[4]

O

+PlateColorState uint8

O

+Name
+Sex

char[64] O
char[16] O

+CertificateType

char[16] O

+ID

char[32] O

+Country

char[3]

O

+Province
+City
+HomeAddress

char[64] O
char[64] O
char[128] O

+Email

char[32] O

Intelligent Traffic APIs 471

+PhoneNo

char[128] O

replace

bool

O

Phone No. of the registered
vehicle owner
Overwrite the same record
True: Yes; false: No.

"13xxxxx5678”

true

Request Example
{

"vehicle":
[{
"UID" : 120837,
"GroupID" : "00001",
"GroupName" : "Group1",
"PlateNumber" : "ZA12345",
"PlateCountry" : "CN",
"PlateType" : 12,
"Type" : 2,
"Brand" : 10,
"Serie" : 1005,
"CarSeriesModelYearIndex" : 12,
"VehicleColor" : [128, 128, 128, 255],
"VehicleColorState" : 0,
"PlateColor" : [128, 128, 128, 255],
"PlateColorState" : 0,
"Name" : "ZhangSan",
"Sex" : "Male",
"CertificateType" : "IC",
"ID" : "123456789",
"Country" : "CN",
"Province" : "XXX",
"City" : "YYY",
"HomeAddress" : "ZZZ Road",
"Email" : "user@example.com",
"PhoneNo" : "13xxxxx5678",

},…{}]

        "replace": true

}

Response Params ( JSON format in body )
Name
ErrCode

R/O Description
O

Type
uint[]

Error code. Defined the
hexadecimal error code before you
use the error code.
(Available for new devices).
0x0: Operation successful.
0x11340200: Database operation
failed.
0x11340202: The license plate do
not exist.

Example
[0, 0]

Intelligent Traffic APIs 472

0x11340205: Exceeded the
maximum number of license plate
database.

Response Example
{
"ErrCode": [0, 0]
}

10.7.6 Modifying Vehicle Information

http://<server>/cgi-bin/api/VehicleRegisterDB/modifyVehicle
Request URL
POST
Method
Request Params ( JSON format in body )
Type
Name
object
vehicle
uint64
+UID

R/O Description
R
R

Example

120837

+GroupID

char[64]

R

+GroupName

char[128] O

+PlateNumber
+PlateCountry

char[64] O
char[3]
O

+PlateType
+Type

uint16
uint16

+Brand

uint16

O
O

O

+Serie

uint16

O

Vehicle information
Unique identifier of the
vehicle, generated by the
server to represent a
unique identifier (primary
key) in the program. It is
different from the ID field.
Group ID to which the
vehicle belongs
Group name to which the
vehicle belongs (exists
only when the parameter
exits)
License plate number
The country where the
vehicle is located (2
bytes), conforming to
ISO3166.
License plate type
Vehicle type (such as
sedans and trucks)
Vehicle logo. You need to
get the real logo through
the mapping table, which
is the same as
CarLogoIndex of ANPR
events.
Vehicle sub-brand. You
need to get the real
sub-brand through the
mapping table, which is
the same as the
SubBrand of ANPR

"00001"

"Group1"

"ZA12345”
"CN"

12
2

10

1005

Intelligent Traffic APIs 473

+CarSeriesMod
elYearIndex

uint16

O

+VehicleColor

uint8[4]

O

+VehicleColorS
tate
+PlateColor

uint8

O

uint8[4]

O

+PlateColorStat
e

uint8

O

+Name

char[64] O

+Sex

char[16] O

+CertificateTyp
e

char[16] O

event.
Vehicle model year. You
need to get the real
model year through the
mapping table, which is
the same as BrandYear
of ANPR event..
The model year No. of
vehicle head ranges from
1 to 999; the model year
No. of vehicle tail ranges
1001 to 1999. 0 means
unknown, and 1000 is
reserved.
Vehicle color.
The first element
represents the red
component value.
The second element
represents the green
component value.
The third element
represents the blue
component value.
The fourth element
represents the
transparency component
value (meaningless).
Vehicle color status. 0:
Unknown; 1: Known.
License plate color. It is
the same as vehicle
color.
License plate color
status. 0: Unknown; 1:
Known.
Name of the vehicle
owner
Gender
"Male"
"Female"
"Unknown” (such as no
field)
ID card type
IC: IC card
Passport
Officer: Officer card

12

[128, 128, 128, 255]

0

[128, 128, 128, 255]

0

“ZhangSan”

"Male"

"IC"

Intelligent Traffic APIs 474

+ID

char[32] O

+Country

char[3]

O

char[64] O
+Province
+City
char[64] O
+HomeAddress char[128] O

+Email

char[32] O

+PhoneNo

char[128] O

Unknown
Person ID, employee ID,
and other IDs.
Nationality of vehicle
owner (2 bytes),
conforming to ISO3166.
Province
City
Home address of the
registered person (IVSS
requirement)
Email address of the
vehicle owner
Phone No. of the
registered vehicle owner.

"13xxxxx6789"

"CN"

"XXX"
"YYY"
“ZZZ Road”

"user@example.com"

"13xxxxx5678"

Request Example
{

"vehicle":
{
"UID" : 120837,
"GroupID" : "00001",
"GroupName" : "Group1",
"PlateNumber" : "ZA12345",
"PlateCountry" : "CN",
"PlateType" : 12,
"Type" : 2,
"Brand" : 10,
"Serie" : 1005,
"CarSeriesModelYearIndex" : 12,
"VehicleColor" : [128, 128, 128, 255],
"VehicleColorState" : 0,
"PlateColor" : [128, 128, 128, 255],
"PlateColorState" : 0,
"Name" : "ZhangSan",
"Sex" : "Male",
"CertificateType" : "IC",
"ID" : "123456789",
"Country" : "CN",
"Province" : "XXX",
"City" : "YYY",
"HomeAddress" : "ZZZ Road",
"Email" : "user@example.com",
"PhoneNo" : "13xxxxx5678",
}
}

Response Params ( JSON format in body )

Intelligent Traffic APIs 475

Type

Name
Response Example
{}

R/O Description

Example

10.7.7 Deleting Vehicle Information

POST

Request URL http://<server>/cgi-bin/api/VehicleRegisterDB/deleteVehicle
Method
Request Params ( JSON format in body )
Name
vehicle
+UID

R/O Description
R
R

Type
object
uint64

124

Example

Unique vehicle identifier. It can
also be deleted by groupID and
plateNumber if UID is not
provided.
Vehicle group ID
Licence plate

"3"
"ZA12345”

R
O

char[64]
char[64]

+groupID
+plateNumber
Request Example
{
"vehicle": {
"UID": 124,
"groupID": "3",
"plateNumber": "ZA12345”
}
}

Response Params ( JSON format in body )
Name
Response Example
{}

Type

R/O Description

Example

10.7.8 Searching for Vehicles from Registered Database

http://<server>/cgi-bin/api/VehicleRegisterDB/startFind
POST

Request URL
Method
Request Params ( JSON format in body )
Type
Name
object
vehicle

R/O Description
R

Example

120837

Vehicle information. GroupID is
required. Other vehicle
descriptions are optional, and you
can search for vehicles with these
descriptions from specific
databases.
Unique identifier of the vehicle,
generated by the server to
represent a unique identifier
(primary key) in the program. It is

+UID

uint64

R

Intelligent Traffic APIs 476

+GroupID

char[64]

R

+GroupName

char[128] O

+PlateNumber
+PlateCountry

char[64] O
char[3]
O

+PlateType
+Type

uint16
uint16

+Brand

uint16

O
O

O

+Serie

uint16

O

+CarSeriesMod
elYearIndex

uint16

O

+VehicleColor

uint8[4]

O

+VehicleColorS
tate
+PlateColor

uint8

O

uint8[4]

O

+PlateColorStat
e

uint8

O

different from the ID field.
Group ID to which the vehicle
belongs
Group name to which the vehicle
belongs (exists only when the
parameter exits)
License plate number
The country where the vehicle is
located (2 bytes), conforming to
ISO3166.
License plate type
Vehicle type (such as sedans and
trucks)
Vehicle logo. You need to get the
real logo through the mapping
table, which is the same as
CarLogoIndex of ANPR events.
Vehicle sub-brand. You need to
get the real sub-brand through the
mapping table, which is the same
as the SubBrand of ANPR event.
Vehicle model year. You need to
get the real model year through
the mapping table, which is the
same as BrandYear of ANPR
event..
The model year No. of vehicle
head ranges from 1 to 999; the
model year No. of vehicle tail
ranges 1001 to 1999. 0 means
unknown, and 1000 is reserved.
Vehicle color.
The first element represents the
red component value.
The second element represents
the green component value.
The third element represents the
blue component value.
The fourth element represents the
transparency component value
(meaningless).
Vehicle color status. 0: Unknown;
1: Known.
License plate color. It is the same
as vehicle color.
License plate color status. 0:
Unknown; 1: Known.

"00001"

"Group1"

"ZA12345”
"CN"

12
2

10

1005

12

[128, 128, 128,
255]

0

[128, 128, 128,
255]
0

Intelligent Traffic APIs 477

Name of the vehicle owner
Gender
"Male"
"Female"
"Unknown” (such as no field)
ID card type
IC: IC card
Passport
Officer: Officer card
Unknown
Person ID, employee ID, and
other IDs.
Nationality of vehicle owner (2
bytes), conforming to ISO3166.
Province
City
Home address of the registered
person (IVSS requirement)
Email address of the vehicle
owner
Phone No. of the registered
vehicle owner.

“ZhangSan”
"Male"

"IC"

"123456789"

"CN"

"XXX"
"YYY"
“ZZZ Road”

"user@example
.com"
"13xxxxx5678”

+Name
+Sex

char[64] O
char[16] O

+CertificateTyp
e

char[16] O

+ID

char[32] O

+Country

char[3]

O

+Province
char[64] O
char[64] O
+City
+HomeAddress char[128] O

+Email

char[32] O

+PhoneNo

char[128] O

Request Example
{

"vehicle":

{

        "UID" : 120837,
        "GroupID" : "00001",
        "GroupName" : "Group1",
        "PlateNumber" : "ZA12345",
        "PlateCountry" : "CN",
        "PlateType" : 12,
        "Type" : 2,
        "Brand" : 10,
        "Serie" : 1005,
        "CarSeriesModelYearIndex" : 12,
        "VehicleColor" : [128, 128, 128, 255],
        "VehicleColorState" : 0,
        "PlateColor" : [128, 128, 128, 255],
        "PlateColorState" : 0,
        "Name" : "ZhangSan",
        "Sex" : "Male",
        "CertificateType" : "IC",
        "ID" : "123456789",
        "Country" : "CN",
        "Province" : "XXX",
        "City" : "YYY",

Intelligent Traffic APIs 478

"HomeAddress" : "ZZZ Road",
"Email" : "user@example.com",
"PhoneNo" : "13xxxxx5678",
}
}

Obtained search token
Total number of qualified results 3333

Example
23443U

R/O Description
R
R

Type
uint
int

Response Params ( JSON format in body )
Name
token
totalCount
Response Example
{
"token": 23443U,
"totalCount": 3333
}

10.7.9 Obtaining Vehicle Search Results

POST

Request URL http://<server>/cgi-bin/api/VehicleRegisterDB/doFind
Method
Request Params ( JSON format in body )
Name
condition
+token
+beginNumber uint32

R/O Description
R
R
R

Type
object
uint

Input parameter of face search
Search token
Start number of the search. The
search starts from the
“beginNumber” records, and returns
predefined number (count) of
records.
0<=beginNumber<= totalCount-1
Number of entries obtained each
time

+count

int

R

Request Example
{
"condition": {
"token": 23443U,
"beginNumber": 0,
"count": 20
}
}

Response Params ( JSON format in body )
Name
results
+found

R/O Description
R
R

Type
object
int

Output parameter of the search
Number of searched entries. One
vehicle can be registered to
multiple databases.

Example

23443U
0

20

Example

12

Intelligent Traffic APIs 479

+candidates

object[]

++Vehicle
++DifferentAttr
ibutres

object
char[16][16 ]

O

R
R

Vehicle
["VehicleColor
", "Type"]

Information list of vehicles to be
selected
Vehicle information
A collection of attributes that do not
match the database. The license
plate must be the same, but other
elements might be different for
false-registered vehicle.
Country: License plate registered
place
Brand: Vehicle logo
Type: Vehicle type
VehicleColor: Vehicle color
PlateColor: Plate color

Response Example
{
"results": {
"found": 12,
"candidates": [{
"Vehicle": {Vehicle
},
"DifferentAttributres": ["VehicleColor", "Type"]
},…{}]
}
}

10.7.10 Stopping Searching for Vehicles

POST

Request URL http://<server>/cgi-bin/api/VehicleRegisterDB/stopFind
Method
Request Params ( JSON format in body )
Name
token

R/O Description
Search token
R

Type
uint

Example
23443U

Request Example
{
"token": 23443U
}

Response Params ( JSON format in body )
Name
Response Example
{}

Type

R/O Description

Example

Intelligent Traffic APIs 480

11 Thermography and Radiometry APIs

11.1 Thermography Manager

11.1.1 Get Capability of Thermography

Table 11-1

Syntax

http://<server>/cgi-bin/ThermographyManager.cgi?action=getCaps&channel=<Channe
lNo>

Method

GET

Description

Get thermography capability.

Example

http://192.168.1.108/cgi-bin/ThermographyManager.cgi?action=getCaps&channel=1

Success
Return

caps.PresetModes = Indoor
caps.Brightness.Max = 100
caps.Brightness.Min = 0
caps.Brightness.Step = 1
caps.Sharpness.Max= 100
caps.Sharpness.Min = 0
caps.Sharpness.Step = 5
caps.EZoom.Max= 24
caps.EZoom.Min = 0
caps.EZoom.Step = 1
caps.ThermographyGamma.Max= 8
caps.ThermographyGamma.Min = -8
caps.ThermographyGamma.Step = 1
caps.SmartOptimizer.Max= 100
caps.SmartOptimizer.Min = 0
caps.SmartOptimizer.Step = 5
caps.Agc.Max= 255
caps.Agc.Min = 0
caps.Agc.Step = 5
caps.AgcMaxGain.Max= 255
caps.AgcMaxGain.Min = 0
caps.AgcMaxGain.Step = 5
caps.AgcPlateau.Max= 100
caps.AgcPlateau.Min = 0
caps.AgcPlateau.Step = 5
caps.PresetColorization[i]= Ironbow2
caps.PresetROIModes[j]= Full Screen

Comment

Parameters in URL:
ChannelNo: integer, video channel index which starts from 1.

Thermography and Radiometry APIs 481

Parameters in Response:
PresetModes: the preset mode. Range is { "Indoor", "Outdoor", "Default" }
PresetColorization: Preset colorization mode. Range is { "WhiteHot", "BlackHot",
"Fusion", "Rainbow", "Globow", "Ironbow1", "Ironbow2", "Sepia", "Color1", "Color2",
"Icefire", "Rain", "RedHot", "GreenHot"}.
PresetROIModes: Preset ROI mode. Range is {"Full Screen", "Sky", "Ground",
"Horizon", "Center 75%", "Center 50%", "Center 25%", "Custom"}

11.1.2 [Config] Thermography Options

 Get thermography options config

Table 11-2

Syntax

http://<server>/cgi-bin/configManager.cgi?action=getConfig&name=ThermographyOpti
ons

Method

GET

Description

Thermography options contain EZoom, Colorization, and SmartOptimizer and so on.

Example

http://192.168.1.108/cgi-bin/configManager.cgi?action=getConfig&name=Thermograph
yOptions

Success
Return

head.EZoom=0
head.Colorization=White Hot
head.SmartOptimizer=10
head.OptimizedRegion.Type=Custom
head.OptimizedRegion.Enable= true
head.OptimizedRegion.Regions[i][0u]=0
head.OptimizedRegion.Regions[i][1u]=0
head.OptimizedRegion.Regions[i][2u]=0
head.OptimizedRegion.Regions[i][3u]=0
head.Agc=10
head.AgcMaxGain=10
head.AgcPlateau=10
head.Mode="HighTemperature"
head.Auto.LowToHigh=13
head.Auto.LHROI=15
head.Auto.HighToLow=12
head.Auto.HLROI=95

Comment

Parameters in Response:
head = table.ThermographyOptions [ChannelNo][0]
ChannelNo: integer, array index starts from 0, which means video channel (equals to
video channel index -1, and so 0 means channel 1).
Regions: the region is a rectangle
i: the array index starts from 0.

 Set thermography options config

Table 11-3

Thermography and Radiometry APIs 482

Syntax

http://<server>/cgi-bin/configManager.cgi?action=setConfig&<paramName>=<paramV
alue>[&<paramName>=<paramValue>…]

Method

GET

Description

Set thermography options.

http://192.168.1.108/cgi-bin/configManager.cgi?action=setConfig&ThermographyOptio
ns[0][0].OptimizedRegion.Type=Gound

OK

Parameters in URL:
The paramName and paramValue are in the table below.

In table below,
head = ThermographyOptions[ChannelNo][0]
ChannelNo: integer, array index starts from 0, which means video channel(equals to
video channel index -1, and so 0 means channel 1).
i: the array index starts from 0.

Example

Success
Return

Comment

Appendix

ParamName

ParamValue type

head.EZoom

integer

head.Colorization

String

head.SmartOptimizer

integer

head.OptimizedRegion.Type String

head.OptimizedRegion.Enabl
e

bool

head.OptimizedRegion.Regi
ons[i][0u]

head.OptimizedRegion.Regi
ons[i][1u]

head.OptimizedRegion.Regi
ons[i][2u]

head.OptimizedRegion.Regi
ons[i][3u]

head.Agc

integer

integer

integer

integer

integer

head.AgcMaxGain

integer

Description
Range is [0—24].
Range and step are got from interface in "11.1.1
Get Capability of Thermography".

Range is {"White Hot", "Black Hot", "Ironbow2",
"IceFire"…}.
Range and step are got from interface in "11.1.1
Get Capability of Thermography".
Range is [0—100].
Range and step are got from interface in "11.1.1
Get Capability of Thermography".

is

{"Full

"Sky",

Range
"Ground",
Screen",
"Horizontal", "Center 75%", "Center 50%", "Center
25%", "Custom"}.
true: enable
false: not enable
Range is [0—8191].
i: the region index, starts from 0.
Range is [0—8191].
i: the region index, starts from 0.
Range is [0—8191].
i: the region index, starts from 0.
Range is [0—8191].
i: the region index, starts from 0.
Range is [0—255].
Range and step are got from interface in "11.1.1
Get Capability of Thermography".
Range is [0—255].

Thermography and Radiometry APIs 483

ParamName

ParamValue type

Description

head.AgcPlateau

integer

head.Mode

head.Auto.LowToHigh

head.Auto.LHROI

head.Auto.HighToLow

head.Auto.HLROI

string

integer

integer

integer

integer

Range and step are got from interface in "11.1.1
Get Capability of Thermography".

Range and step are got from interface in "11.1.1
Get Capability of Thermography".

is {"HighTemperature", "LowTemperature",

Range
"Auto"}.
UInt32
UInt32, percentage range is[0—100]
UInt32
UInt32, percentage range is[0—100]

11.1.3 Get ExternSystem Information

Table 11-4

Syntax

http://<server>/cgi-bin/ThermographyManager.cgi?action=getExternSystemInfo&chann
el=<ChannelNo>

Method

GET

Description

Get extern system Info.

Example

Success
Return

http://192.168.1.108/cgi-bin/ThermographyManager.cgi?action=getExternSystemInfo&
channel=1

sysInfo.SerialNumber = 11111111123
sysInfo.SoftwareVersion = 2222222222222
sysInfo.FirmwareVersion= 3333333333333
sysInfo.LibVersion = 4444444444

Comment

Parameters in URL:
ChannelNo: integer, video channel index which starts from 1.

11.1.4 Get Information of Preset Mode

Syntax

http://<server>/cgi-bin/ThermographyManager.cgi?action=getPresetParam&channel=<
ChannelNo>&mode=<modeType>

Table 11-5

Method

GET

Description

Get preset mode info.

Example

http://192.168.1.108/cgi-bin/ThermographyManager.cgi?action=getPresetParam&chan
nel=1&mode=Default

Success
Return

presetInfo.Brightness = 50
presetInfo.Sharpness= 50
presetInfo.EZoom= 12
presetInfo.ThermographyGamma= 0
presetInfo.Colorization= "White Hot"
presetInfo.SmartOptimizer= 10
presetInfo.OptimizedRegion.Type= Full Screen

Thermography and Radiometry APIs 484

presetInfo.OptimizedRegion.Enable= Full Screen
presetInfo.OptimizedRegion.Regions[i][0u]=0
presetInfo.OptimizedRegion.Regions[i][1u]=0
presetInfo.OptimizedRegion.Regions[i][2u]=0
presetInfo.OptimizedRegion.Regions[i][3u]=0
presetInfo.Agc= 10
presetInfo.AgcMaxGain=10
presetInfo.AgcPlateau = 10

Parameters in URL:
ChannelNo: integer, video channel index which starts from 1.
modeType: depends on capability , get from interface in getCaps

Comment

Parameters in Response :
Regions : the region is a rectangle
i : the array index.

11.1.5 Get Optimized Region Information

Table 11-6

Syntax

http://<server>/cgi-bin/ThermographyManager.cgi?action=getOptimizedRegion&chann
el=<ChannelNo>

Method

GET

Description

Get optimized region info.

Example

http://192.168.1.108/cgi-bin/ThermographyManager.cgi?action=getOptimizedRegion&c
hannel=1

Success
Return

Comment

optimizedRegion.Type= Full Screen
optimizedRegion.Enable= true
optimizedRegion.Regions[i][0u]=0
optimizedRegion.Regions[i][1u]=0
optimizedRegion.Regions[i][2u]=0
optimizedRegion.Regions[i][3u]=0

Parameters in URL:
ChannelNo: integer, video channel index which starts from 1.

Parameters in Response:
Regions : the region is a rectangle
i: the region index.

11.1.6 Enable Shutter

Table 11-7

Syntax

http://<server>/cgi-bin/ThermographyManager.cgi?action=enableShutter&channel=<C
hannelNo>&enable=<Enable>

Method

GET

Description

Shutter control, whether enable shutter.

Thermography and Radiometry APIs 485

Example

Success
Return

Comment

http://192.168.1.108/cgi-bin/ThermographyManager.cgi?action=enableShutter&channel
=1&enable=true

OK

Parameters in URL:
ChannelNo: integer, video channel index which starts from 1.
Enable: true or false, enable or not.

11.1.7 Fix Focus

Table 11-8

Syntax

http://<server>/cgi-bin/ThermographyManager.cgi?action=fixFocus&linkVideoChannel[
0]=<ChannelNo>&linkVideoChannel[1]=<ChannelNo>[&speed=<SpeedValue>]

Method

GET

Description

The visual channel change focus to the same as the thermography channel.

Example

Success
Return

Comment

http://192.168.1.108/cgi-bin/ThermographyManager.cgi?action=fixFocus&linkVideoCha
nnel[0]=1&linkVideoChannel[1]=2

OK

Parameters in URL:
ChannelNo: integer, video channel index which starts from 1.
SpeedValue: float, range is 0.0-1.0.

11.1.8 Do Flat Field Correction

Table 11-9

Syntax

http://<server>/cgi-bin/ThermographyManager.cgi?action=doFFC&channel=<Channel
No>

Method

GET

Description

Do flat field correction.

Example

Success
Return

Comment

http://192.168.1.108/cgi-bin/ThermographyManager.cgi?action=doFFC&channel=1

OK

Parameters in URL:
ChannelNo: integer, video channel index which starts from 1.

11.2 Radiometry

11.2.1 Get Capability of Radiometry

Syntax

http://<server>/cgi-bin/RadiometryManager.cgi?action=getCaps[&channel=<ChannelN
o>]

Table 11-10

Thermography and Radiometry APIs 486

Method

GET

Description

Get the capabilities of radiometry manager.

Example

http://192.168.1.108/cgi-bin/RadiometryManager.cgi?action=getCaps&channel=1

Success
Return

caps.TotalNum.MaxNum=8
caps.TotalNum.Spot.MaxSpots=8
caps.TotalNum.Line.MaxLines=1
caps.TotalNum.Area.MaxAreas=8
caps.TemperPresets.MaxPresets=256
caps.MeterInfo.Type[0u]=Spot
caps.MeterInfo.Type[1u]=Area
caps.MeterInfo.ObjectEmissivity.Max=100
caps.MeterInfo.ObjectEmissivity.Min=0
caps.MeterInfo.ObjectEmissivity.Default=0
caps.MeterInfo.ObjectEmissivity.Step=1
caps.MeterInfo.ObjectDistanceMeter.Max=100
caps.MeterInfo.ObjectDistanceMeter.Min=0
caps.MeterInfo.ObjectDistanceMeter.Default=0
caps.MeterInfo.ObjectDistanceMeter.Step=1
caps.MeterInfo.ReflectedTemperature.Max=100
caps.MeterInfo.ReflectedTemperature.Min=0
caps.MeterInfo.ReflectedTemperature.Default=0
caps.MeterInfo.ReflectedTemperature.Step=1
caps.MeterInfo.RelativeHumidity.Max=100
caps.MeterInfo.RelativeHumidity.Min=0
caps.MeterInfo.RelativeHumidity.Default=0
caps.MeterInfo.RelativeHumidity.Step=1
caps.MeterInfo.AtmosphericTemperature.Max=100
caps.MeterInfo.AtmosphericTemperature.Min=0
caps.MeterInfo.AtmosphericTemperature.Default=0
caps.MeterInfo.AtmosphericTemperature.Step=1
caps.Statistics.MinPeriod=60
caps.Isotherm.MaxTemp=327.0
caps.Isotherm.MinTemp=-20.0

Comment

Parameters in URL:
ChannelNo: integer, video channel index which starts from 1.

11.2.2 [Config] Heat Image Thermometry

 Get heat image thermometry config

Table 11-11

Syntax

http://<server>/cgi-bin/configManager.cgi?action=getConfig&name=HeatImagingTherm
ometry

Method

GET

Description

Get HeatImagingThermometry Config.

Thermography and Radiometry APIs 487

Example

http://192.168.1.108/cgi-bin/configManager.cgi?action=getConfig&name=HeatImaging
Thermometry

table.RelativeHumidity = 50
table.AtmosphericTemperature =20
table.ObjectEmissivity =1
table.ObjectDistance =100
table.ReflectedTemperature=20
table.TemperatureUnit= Centigrade
table.Isotherm.Enable=true
table.Isotherm.MaxValue=50
table.Isotherm.MinValue=0
table.Isotherm.ColorBarDisplay=true
table.HotSpotFollow=true
table.TemperEnable=true
—

Success
Return

Comment

 Set heat image thermometry config

Table 11-12

Syntax

http://<server>/cgi-bin/configManager.cgi?action=setConfig&<paramName>=<paramV
alue>[&<paramName>=<paramValue>…]

Method

GET

Description

Set HeatImagingThermometry Config

Example

Success
Return

Comment

Appendix

ParamName

http://192.168.1.108/cgi-bin/configManager.cgi?action=setConfig&HeatImagingThermo
metry.RelativeHumidity=50&HeatImagingThermometry.ObjectDistance=20

OK

Parameters in URL:
The paramName and paramValue are in the table below.

ParamValue type Description

HeatImagingThermometry.RelativeHumidity

integer

HeatImagingThermometry.AtmosphericTemperature

float

HeatImagingThermometry.ObjectEmissivity

float

HeatImagingThermometry.ObjectDistance

integer

The Relative Humidity
range and step are got from
interface in getCaps.

Atmospheric
The
Temperature
range and
step are got from interface
in getCaps.

The Object Emissivity
range and step are got from
interface in getCaps.

The Object Distance range
from
and step are got
interface in getCaps.
Unit is meter.

Thermography and Radiometry APIs 488

ParamName

ParamValue type Description

HeatImagingThermometry.ReflectedTemperature

float

HeatImagingThermometry.TemperatureUnit

HeatImagingThermometry.Isotherm.Enable

string

bool

HeatImagingThermometry.Isotherm.MaxValue

float

HeatImagingThermometry.Isotherm.MinValue

float

The Reflected Temperature
range and step are got from
interface in getCaps

{Centigrade,

Range
is
Fahrenheit}.

true or false

MaxValue range is got form
getCaps.
in
interface
MaxValue must be bigger
than MinVaue

MinValue range is got form
interface
getCaps.
in
MinValue must be smaller
than MaxVaue.

HeatImagingThermometry.Isotherm.ColorBarDisplay bool

HeatImagingThermometry.HotSpotFollow

HeatImagingThermometry.TemperEnable

bool

bool

true or false

true or false

true or false

11.2.3 [Config] Thermometry Rule

 Get thermometry rule config

Table 11-13

Syntax

Method

http://<server>/cgi-bin/configManager.cgi?action=getConfig&name=ThermometryRule

GET

Description

Get thermometry rule.

Example

http://192.168.1.108/cgi-bin/configManager.cgi?action=getConfig&name=Thermometry
Rule

Success
Return

head.Enable = true
head.PresetId =0
head.RuleId=0
head.Name=SpotName
head.Type=Spot
head.MeterRegion.Coordinates[PointNo][0]= 0
head.MeterRegion.Coordinates[PointNo][1]= 0
…
head.T=3
head.Alarm.Id=0
head.Alarm.Enable=true
head.Alarm.Result =Max
head.Alarm.AlarmCondition=Below
head.Alarm.Threshold=20.0
head.Alarm.PreThreshold=10.0
head.Alarm.PreDuration=30
head.Alarm.Hysteresis=0.1

Thermography and Radiometry APIs 489

head.Alarm.Duration=30
head.LocalParameters.Enable=true
head.LocalParameters.ObjectEmissivity=0.95
head.LocalParameters.ObjectDistance=0.95
head.LocalParameters.RefalectedTemp=0

Comment

Parameters in Response :
head =table.ThermometryRule[ChannelNo][RuleNo]
ChannelNo: integer, array index starts from 0, which means video channel (equals to
video channel index -1, and so 0 means channel 1).
RuleNo =rule index.
PointNo = point index
Alarm= AlarmSetting[AlarmNo]
AlarmNo = alarm index

 Set thermometry rule config

Table 11-14

Syntax

http://<server>/cgi-bin/configManager.cgi?action=setConfig&<paramName>=<paramV
alue>[&<paramName>=<paramValue>…]

Method

GET

Description

Set thermometry rule.

Example

Success
Return

Comment

Appendix

ParamName

head.Enable

head.PresetId

head.RuleId

http://192.168.1.108/cgi-bin/configManager.cgi?action=setConfig&ThermometryRule[0]
[0].Name=name1

OK

Parameters in URL:
The paramName and paramValue are in the table below.

In table below,
head = ThermometryRule[ChannelNo][RuleNo]
ChannelNo: integer, array index starts from 0, which means video channel (equals to
video channel index -1, and so 0 means channel 1).
PointNo = point index
RuleNo =rule index.
Alarm= AlarmSetting[AlarmNo]
AlarmNo = alarm index

ParamValue type Description

bool

integer

integer

is

Enable/Disable
Range [0—PresetMax]
PresetMax
got
interface
GetCurrentProtocolCaps.
Range [0—MaxNum]
MaxNum is got from interface
in getCaps.

from
in

Thermography and Radiometry APIs 490

ParamName

head.Name

head.Type

ParamValue type Description

string

string

Radiometry
char[64]

rule

name.

Range is {Spot, Line, Area }.
Range [0—8091]
The Xscale of Region/Line
point
Range [0—8091]
The Yscale of Region/Line
point

Temperature Sample period.
Unit is Second.

[0 — 65535],unique

Range
alarm id

Enable/Disable

Depend on the vaule of Type
Spot : {Vaule}
Line: { Max, Min, Aver}

Area: {Max, Min, Aver, Std, Mid,
ISO}
Range
Above }

is {Below, Match

,

Alarm threshold

Alarm hysteresis

The duration time of alarm.
Unit is second

PreAlarm threshold

The duration time of preAlarm.
Unit is second

Enable/Disable
Range [0 — 1]
Accuracy is 0.01

Object distance
The range is got from interface
in getCaps.

Object Reflected Temperature
The range is got from interface
in getCaps.

head.MeterRegion.Coordinates[PointNo][0]

integer

head.MeterRegion.Coordinates[PointNo][1]

integer

head.T

head.Alarm.Id

head.Alarm.Enable

head.Alarm.Result

head.Alarm.AlarmCondition

head.Alarm.Threshold

head.Alarm.Hysteresis

head.Alarm.Duration

Head.Alarm.PreThreshold

head.Alarm.PreDuration

head.LocalParameters.Enable

head.LocalParameters.ObjectEmissivity

integer

integer

bool

string

string

float

float

integer

float

integer

bool

float

head.LocalParameters.ObjectDistance

float

head.LocalParameters.ReflectedTemp

float

11.2.4 [Config] Heat Image Temper Event

 Get heat image temper event config

Table 11-15

Syntax

http://<server>/cgi-bin/configManager.cgi?action=getConfig&name=HeatImagingTemp
er

Thermography and Radiometry APIs 491

Method

GET

Description

Get Heat Imaging Temper config

Example

Success
Return

Comment

http://192.168.1.108/cgi-bin/configManager.cgi?action=getConfig&name=HeatImagingT
emper

head.Enable=false
head.EventHandler. paramName = paramValue

Parameters in Response:
head= table.HeatImagingTemper[ChannelNo]
ChannelNo: integer, array index starts from 0, which means video channel (equals to
video channel index -1, and so 0 means channel 1).

 Set heat image temper event config

Table 11-16

Syntax

http://<server>/cgi-bin/configManager.cgi?action=setConfig&<paramName>=<paramV
alue>[&<paramName>=<paramValue>…]

Method

GET

Description

Set Heat Imaging Temper config

Example

Success
Return

Comment

http://192.168.1.108/cgi-bin/configManager.cgi?action=setConfig&HeatImagingTemper[
0].Enable=false&HeatImagingTemper[0].EventHandler.BeepEnable=false

OK

Parameters in URL:
The paramName and paramValue are in the table below.

In table below,
head= HeatImagingTemper[ChannelNo]
ChannelNo: integer, array index starts from 0, which means video channel (equals to
video channel index -1, and so 0 means channel 1).

Appendix

ParamName

head.Enable

head.EventHandler

ParamValue type

Description

bool

—

Enable/Disable Heat Imaging Temper feature.

Setting
SetEventHandler.

of EventHandler

is

described

in

11.2.5 Get Temperature of Particular Point

Table 11-17

Syntax

http://<server>/cgi-bin/RadiometryManager.cgi?action=getRandomPointTemper&chann
el=<ChannelNo>&coordinate[0]=x &coordinate[1]=y

Method

GET

Description

Get temperature values of random point.

Example

http://192.168.1.108/cgi-bin/RadiometryManager.cgi?action=getRandomPointTemper&
channel=1&coordinate[0]=1024&coordinate[1]=1024

Thermography and Radiometry APIs 492

Success
Return

TempInfo.Type=Spot
TempInfo.TemperAver=27.5

Comment

Parameters in URL:
ChannelNo: integer, video channel index which starts from 1.
x : The Xscale of the point
y : The Yscale of the point

11.2.6 Get Temperature of Particular Condition

Table 11-18

Syntax

http://<server>/cgi-bin/RadiometryManager.cgi?action=getTemper&<paramName>=<p
aramValue>[&<paramName>=<paramValue>…]

Method

GET

Description

Get temperature values from rules which have been set.

http://192.168.1.108/cgi-bin/RadiometryManager.cgi?action=getTemper&condition.Pres
etId=0&condition.RuleId=0&condition.Type=Spot&condition.Name=Spot1&condition.ch
annel=1

TempInfo.Type=Spot
TempInfo.TemperAver=27.5

Parameters in URL:
The paramName and paramValue are in the table below.

Example

Success
Return

Comment

Appendix

ParamName

ParamValue type Description

condition.Channel

integer

Video channel index. Start from 1

condition.PresetId

integer

condition.RuleId

integer

Range [0- PresetMax]
PresetMax is got from interface in
GetCurrentProtocolCaps.

Range [0- MaxNum]
MaxNum is got from interface in getCaps.

condition.Type

string

Range is {Spot, Line, Area}.

condition.Name

string

Name is got from interface in
GetThermometryRuleConfig.

11.2.7 Find Temperature Information

1.  Start to query temperature information

Table 11-19

Syntax

http://<server>/cgi-bin/RadiometryManager.cgi?action=startFind&condition.StartTime=
<StartTimeValue>&condition.EndTime=<EndTimeValue>&condition.Type=<TypeVal
ue>&condition.channel=<ChannelValue>&condition.Period=<PeriodValue>

Method

GET

Description

Start to query the history data of temperature values.

Example

http://192.168.1.108/cgi-bin/RadiometryManager.cgi?action=startFind&condition.StartTi

Thermography and Radiometry APIs 493

me=2010-04-01%200:00:00&condition.EndTime=2010-04-08%200:00:00&condition.Ty
pe=Spot&condition.channel=1&condition.Period=5

Success
Return

token=46878
totalCount=333

Comment

The parameters in bold face are as table below.

Appendix

ParamName

ParamValue type

Description

condition.StartTime

condition.EndTime

condition.Type

condition.channel

condition.Period

string

string

string

integer

integer

2.  Get the data of temperature

The start time to find.

The end time to find.

The type of data. Range is {Spot, Line, Area}

Video channel index. Start from 1

Range is {5, 10, 15, 30}, minute

Table 11-20

Syntax

Method

http://<server>/cgi-bin/RadiometryManager.cgi?action=doFind&token=<tokenvalue>&
beginNumber=<BeginNumber>&count=<findNum>
GET

Description

Get the history data of temperature.

Example

http://192.168.1.108/cgi-bin/RadiometryManager.cgi?action=doFind&token=46878&be
ginNumber=16&count=16

Success
Return

found=12
info[i].Time=2010-04-08 16:12:46
info[i].PresetId=0
info[i].RuleId=0
info[i].Type=Spot
info[i].Name=xxxx
info[i].Coordinate[0]=1024
info[i].Coordinate[1]=2048
info[i].Channel=0
info[i].TemperatureUnit=Centigrade
info[i].QueryTemperInfo.TemperAve=50.1
info[i].QueryTemperInfo.TemperMax=50.2
info[i].QueryTemperInfo.TemperMin=50.0

Comment

Parameters in URL:
token: query token, get from interface of the first step above.
beginNumber: the begin index in this query.
count: the number you want to query.
Params in Resp:
i: the array index.

3.  Stop finding temperature information

Syntax

http://<server>/cgi-bin/RadiometryManager.cgi?action=stopFind&token=<tokenvalue>

Table 11-21

Thermography and Radiometry APIs 494

Method

GET

Description

Stop to find the history data of temperature values.

Example

Success
Return

http://192.168.1.108/cgi-bin/RadiometryManager.cgi?action=stopFind&token=46878

OK

Comment

token: query token, get from interface of the first step.

11.2.8 Subscribe Temperature Information

Subscribe temperature information

http://<server>/cgi-bin/RadiometryManager.cgi?action=attachTemper
GET

Request URL
Method
Request Params ( key=value format in URL )
Name
channel
heartbeat

R/O Description
R
O

Type
int
int

Example
1
5

Video channel number, starting from 1
Heartbeat interval. The unit is second, and
the default value is 5. When the device
sends temperature data in the response, it
will periodically send a heartbeat message to
keep it alive according to the heartbeat
interval. The content of the message is the
string "Heartbeat".

Request Example
http://192.168.1.108/cgi-bin/RadiometryManager.cgi?action=attachTemper&channel=2&heartbeat=5

Response Params ( multipart ; key=value format in body )
Name
info

Type
object[] R

R/O Description

Temperature information array

+Time

char[32] R

Record time, format: yyyy-MM-dd HH:mm:ss

+PresetId
+RuleId

int
int

O
O

+Type

char[16] R

+Name

char[64] O

+Coordinate

int[8][2] O

+Channel

int

O

+TemperatureUnit

char[16] R

+QueryTemperInfo
++TemperAve

object
float

R
R

the coordinates of

Preset number, starting from 1
Rule number
Search Type
"Spot": Spot
"Area": Area
"Line": Line
Query item name
Query
temperature
monitoring point, up to 8, using the 8192
relative coordinate system.
Video channel number, starting from 0
Temperature unit, value:
"Centigrade" : Centigrade
"Fahrenheit": Fahrenheit
Temperature information
Average temperature

Example

"2010-04-08
16:12:46"
1
1
"Spot"

"xxxx"
[[1024, 2048]]

0
"Centigrade"

50.1

Thermography and Radiometry APIs 495

++TemperMax
++TemperMin

float
float

R
R

Maximum temperature
Minimum temperature

Response Example
HTTP/1.1 200 OK
Server: Device/1.0
Content-Type: multipart/x-mixed-replace; boundary=<boundary>
Connection: closed

50.2
50.0

--<boundary>
Content-Type: text/plain
Content-Length: <data length>

info[0].Time=2010-04-08 16:12:46
info[0].PresetId=1
info[0].RuleId=1
info[0].Type=Spot
info[0].Name=xxxx
info[0].Coordinate[0][0]=1024
info[0].Coordinate[0][1]=2048
info[0].Channel=0
info[0].TemperatureUnit=Centigrade
info[0].QueryTemperInfo.TemperAve=50.1
info[0].QueryTemperInfo.TemperMax=50.2
info[0].QueryTemperInfo.TemperMin=50.0
……
--<boundary>
Content-Type: text/plain
Content-Length: 11

Heartbeat
--<boundary>
……

11.2.9 Subscribe Radiometry Data

Subscribe temperature distribution data

http://<server>/cgi-bin/RadiometryManager.cgi?action=attachProc
GET

Request URL
Method
Request Params ( key=value format in URL )
Name
channel
heartbeat

R/O Description
R
O

Type
int
int

Video channel number, starting from 1
Heartbeat interval. The unit is second, the
value range is [1,60], the default value is 5.
When the device sends temperature data in
the response, it will periodically send a
heartbeat message to keep it alive according
to the heartbeat interval. The content of the

Example
1
5

Thermography and Radiometry APIs 496

Request Example
http://192.168.1.108/cgi-bin/RadiometryManager.cgi?action=attachTemper&channel=2&heartbeat=5

message is the string "Heartbeat".

Response Params ( multipart ; key=value format in body )
Name
dataInfo
+Width
+Height
+Channel

R/O Description
R
R
R
O

Type
object
int
int
int

format: yyyy-MM-dd

Temperature distribution data information
Image width, in pixels
Image height, in pixels
Video channel number, starting from 0
Fetching data
time,
HH:mm:ss
Data length
Algorithm type, value: "Tau”
Decompression
sensorType is Tau
Parameter R
conversion
Parameter B required for temperature
conversion
Parameter F required for temperature
conversion
Parameter O required for temperature
conversion

parameter,

required

for

used when

temperature

Example

1920
1080
0
"2010-04-08
16:12:46"
2073600
"Tau"

1

1

1

1

+Time

+Length
+sensorType

char[32]

int
char[16]

+Unzip

object

++ParamR

++ParamB

++ParamF

++ParamO

uint

uint

uint

uint

R

O
O

O

O

O

O

O

Response Example
HTTP/1.1 200 OK
Server: Device/1.0
Content-Type: multipart/x-mixed-replace; boundary=<boundary>
Connection: closed

--<boundary>
Content-Type: text/plain
Content-Length: <data length>

dataInfo.Width=1920
dataInfo.Height=1080
dataInfo.Channel=0
dataInfo.Time=2010-05-25 00:00:00
dataInfo.Length=2073600
dataInfo.sensorType="Tau"
dataInfo.Unzip.ParamR=1
dataInfo.Unzip.ParamB=1
dataInfo.Unzip.ParamF=1
dataInfo.Unzip.ParamO=1
--<boundary>
Content-Type: application/octet-stream

Thermography and Radiometry APIs 497

Content-Length: <data length>

<Binary data>
--<boundary>
Content-Type: text/plain
Content-Length: 11

Heartbeat
--<boundary>
……

11.2.10 Fetch Radiometry Data

Table 11-22

Syntax

http://<server>/cgi-bin/RadiometryManager.cgi?action=toFetch&channel=<ChannelNo

>

Method

GET

Description

Start to fetch radiometry data.

Example

Success
Return

Comment

http://192.168.1.108/cgi-bin/RadiometryManager.cgi?action=toFetch&channel=2

status=Ready

ChannelNo: integer, video channel index which starts from 1.
status: Range is {Ready, Busy}. "Ready"means service available and "Busy"means
service busy.

11.2.11 [Config] Get FireWarning Config

Table 11-23

Syntax

Method

http://<server>/cgi-bin/configManager.cgi?action=getConfig&name=FireWarning

GET

Description

Get FireWarning config.

Example

http://192.168.1.108/cgi-bin/configManager.cgi?action=getConfig&name=FireWarning

Success
Return

head.Enable=true
head.PresetId=0
head.Row = 31
head.Col = 40
head.Mode="Auto"
head.SmdFilterEnable=false
head.MovingTargetFilterEnable=false
head.SunReflectEnable=false
head.TimeDurationEnable=false
head.FireDuration= 15
head.DetectWindow[windowsNum].Regions[0]=123468789
head.DetectWindow[windowsNum].Regions[1]=123468789
head.DetectWindow[windowsNum].Regions[2]=123468789

Thermography and Radiometry APIs 498

head.DetectWindow[windowsNum].Regions[3]=123468789
head.DetectWindow[windowsNum].Postion[0]=0
head.DetectWindow[windowsNum].Postion[1]=0
head.DetectWindow[windowsNum].Postion[2]=0
head.DetectWindow[windowsNum].Postion[3]=0
head.DetectWindow[windowsNum].Sensitivity = 95
head. DetectWindow[windowsNum].Id=1
head.DetectWindow[windowsNum].Name="windName"
head.EventHandler=(output of EventHandler is described in GetEventHandler)

Parameters in Response:
head= table.FireWarning[ChannleNo][RuleNum]
ChannelNo: integer, array index starts from 0, which means video channel (equals to
video channel index -1, and so 0 means channel 1).
RuleNum: integer,array index starts from 0,which means rules in each Preset,
If FireWarningMode is "SpaceExClude", then only the first rule used.
windowsNum: support 4 Nums if FireWarningMode is "PtzPreset", 8 if "SpaceExClude"
Postion: only valid in "SpaceExClude"Mode

Comment

11.2.12 [Config] Set FireWarning Config

Table 11-24

Syntax

http://<server>/cgi-bin/configManager.cgi?action=setConfig&<paramName>=<paramV
alue>[&<paramName>=<paramValue>…]

Method

GET

Description

Set FireWarning config.

Example

Success
Return

http://192.168.1.108/cgi-bin/configManager.cgi?action=setConfig&FireWarning[0][0].Ea
nble=false

OK

Comment

head = FireWarning[ChNum][RuleNum]

Appendix:

ParamName

head.Enable

head.PresetId

head.Row

head.Col

head.Mode

Head.SmdFilterEnable

Head.MovingTargetFilterEnable

Head.SunReflectEnable

head.TimeDurationEnable

ParamValue type Description

bool

integer

integer

integer

string

bool

bool

bool

bool

whether fire detect take effect

The PresetId

rows of fire detect area

cols of fire detect area

Range is {"Auto","Normal"}.

whether smd filter take effect

whether moving target filter take
effect

whether sun reflect filter take
effect

whether
duration,only

include

fire detect
in

take effect

Thermography and Radiometry APIs 499

ParamName

ParamValue type Description

head.FireDuration

integer

head.DetectWindow[windowsNum].Regions[0]

integer

head.DetectWindow[windowsNum].Sensitivity

integer

head.DetectWindow[windowsNum].Id

head.DetectWindow[windowsNum].Name

integer

string

SpaceExClude mode

fire last times

detect area mask

Rage {0,100}

Rage {0,…}

detect window name

head.EventHandler

EventHandler

Setting of EventHandler
described in SetEventHandler.

is

11.2.13 [Config] Get FireWarningMode Config

Table 11-25

Syntax

Method

http://<server>/cgi-bin/configManager.cgi?action=getConfig&name=FireWarningMode

GET

Description Get FireWarningMode config.

Example

Success
Return

Comment

http://192.168.1.108/cgi-bin/configManager.cgi?action=getConfig&name=FireWarningMo
de

head.Mode="PtzPreset"

Parameters in Response:
head= table.FireWarningMode[ChannelNo]
ChannelNo: integer, array index starts from 0, which means video channel (equals to
video channel index -1, and so 0 means channel 1).

11.2.14 [Config] Set FireWarningMode Config

Table 11-26

Syntax

http://<server>/cgi-bin/configManager.cgi?action=setConfig&<paramName>=<paramV
alue>[&<paramName>=<paramValue>…]

Method

GET

Description

Set FireWarningMode config.

Example

Success
Return

http://192.168.1.108/cgi-bin/configManager.cgi?action=setConfig&FireWarningMode[0]
. Mode ="SpaceExClude"

OK

Comment

head = FireWarningMode[ChannelNo]

Appendix:

ParamName

head.Mode

ParamValue type

Description

string

Rage is {"PtzPreset","SpaceExClude"}

Thermography and Radiometry APIs 500

11.2.15 Get Current Hot Cold Spot

Table 11-27

URL

http://<server>/cgi-bin/TemperCorrection.cgi?action=getCurrentHotColdSpot

Method

GET

Description Get the max and min temperature values.

[ Request Params ] ( key=value format in URL )

channel

int

R

video channel index which starts from 1.

[ Response Params ] (key=value format)

Type

R/O

Param Description

object R

The current hot code spot info.

Name

info

+HotPoint

array<
int>

R

+HotSpotValue

double R

+ColdPoint

array<
int>

O

+ColdSpotValue

double O

The hot spot position, must be two int, means x and y value,
coordinate remap to 0 — 8192.
The hot spot temperature value.

The cold spot position, must be two int, means x and y value,
coordinate remap to 0 — 8192.
The cold spot temperature value.

+TemperatureUnit

int

O

The temperature unit : 0 Centigrade, 1 Fahrenheit

[ Example ]

Request

Response

GET http://192.168.1.108/cgi-bin/TemperCorrection.cgi?action=getCurrentHotColdSpot
&channel=1

info.HotPoint[0]=1150
info.HotPoint[1]=2320
info.HotSpotValue=35.5
info.ColdPoint[0]=5452
info.ColdPoint[1]=6192
info.ColdSpotValue=24.3
info.TemperatureUnit=0

11.2.16 [Config] Heat Image Temper PreAlarm Event

 Get heat image temper pre event config

Table 11-28

Syntax

Method

http://<server>/cgi-bin/configManager.cgi?action=getConfig&name=PreAlarmEvent

GET

Description

Get Heat Imaging Temper PreAlarm Event config

Example

Success
Return

Comment

http://192.168.1.108/cgi-bin/configManager.cgi?action=getConfig&name=PreAlarmEve
nt

head.Enable=false
head.EventHandler. paramName = paramValue

Parameters in Response:
head= table.PreAlarmEvent[ChannelNo]
ChannelNo: integer, array index starts from 0, which means video channel (equals to

Thermography and Radiometry APIs 501

video channel index -1, and so 0 means channel 1).

 Set heat image temper pre event config

Table 11-29

Syntax

http://<server>/cgi-bin/configManager.cgi?action=setConfig&<paramName>=<paramV
alue>[&<paramName>=<paramValue>…]

Method

GET

Description

Set Heat Imaging Temper PreAlarm Event config

Example

Success
Return

Comment

http://192.168.1.108/cgi-bin/configManager.cgi?action=setConfig&PreAlarmEvent[0].En
able=false&PreAlarmEvent[0].EventHandler.BeepEnable=false

OK

Parameters in URL:
The paramName and paramValue are in the table below.

In table below,
head=PreAlarmEvent[ChannelNo]
ChannelNo: integer, array index starts from 0, which means video channel (equals to
video channel index -1, and so 0 means channel 1).

Appendix

ParamName

head.Enable

head.EventHandler

ParamValue type

Description

bool

—

Enable/Disable Heat Imaging Temper feature.

Setting
SetEventHandler.

of EventHandler

is

described

in

11.2.17 Get Heat Map Info

Get Heat Map Info.

Request URL

http://<server>/cgi-bin/RadiometryManager.cgi?action=getHeatMapsDirectly&channel
=<ChannelNo>

Method

GET

Request Params ( key=value format in URL )

Name

channel

Type

R/O

Description

Example

int

R

video channel index which starts
from 1

2

Request Example

http://192.168.1.108/cgi-bin/RadiometryManager.cgi?action=getHeatMapsDirectly&channel=2

Response Params

( multipart, binary in body )

Name

dataInfo

+Height

+Width

Type

R/O Description

Example

object O

Data info

integer O

integer O

height

width

0

0

Thermography and Radiometry APIs 502

+Channel

+Time

+Length

+sensorType

+Unzip

integer O

Channel number

0

string O

Time of getting data

2010-05-25 00:00:00

integer O

Data length

string O

Algorithm type

0

"Tau"

object O

++ParamR

integer O

++ParamB

integer O

++ParamF

integer O

++ParamO

integer O

unzip parameters, it
works when sensorType
was "Tau".

Parameter R for
temperature conversion

Parameter B for
temperature conversion

Parameter F for
temperature conversion

Parameter O for
temperature conversion

1

1

1

1

Response Example

HTTP/1.1 200 OK
Server: Device/1.0
Content-Type: multipart/x-mixed-replace; boundary=<boundary>
Connection: closed

--<boundary>
Content-Type: text/plain
Content-Length: <data length>

dataInfo.Height=0
dataInfo.Width=0
dataInfo.Channel=0
dataInfo.Time=2010-05-25 00:00:00
dataInfo.Length=0
dataInfo.sensorType="Tau"
dataInfo.Unzip.ParamR=1
dataInfo.Unzip.ParamB=1
dataInfo.Unzip.ParamF=1
dataInfo.Unzip.ParamO=1

--<boundary>
Content-Type: application/octet-stream
Content-Length: <data length>

<Binary data>

--<boundary>
……

Thermography and Radiometry APIs 503

11.3 TemperCustom

11.3.1 Set Environment Temperature

Syntax

Method

http://<server>/cgi-bin/TemperCustom.cgi?action=setEnvTemp

GET

Description

Set environment temperature

[ Request Params ] (key=value format at URL )

Name

EnvironmentTe
mp

Type

int

[ Response Params ] ( OK )

R/O Param Description

R

environment temperature Magnified 100 times,the unit is
0.01Celsius degree

Name

Type

R/O Param Description

[ Example ]

Request

http://192.168.1.108/cgi-bin/TemperCustom.cgi?action=setEnvTemp&
EnvironmentTemp=2800

Response

OK

Thermography and Radiometry APIs 504

12 Access Control APIs

12.1 Access Control

12.1.1 Open Door

Open the door

http://<server>/cgi-bin/accessControl.cgi?action=openDoor
GET

Request URL
Method
Request Params ( key=value format in URL )
Name
channel
UserID
Type

R/O Description
Type
R
int
int
O
char[16] O

the index of door, starts from 1
remote user ID
the open type, default value is "Remote"

Example
1
101
"Remote"

Request Example
http://192.168.1.108/cgi-bin/accessControl.cgi?action=openDoor&channel=1&UserID=101&Type=Rem
ote

Response Params ( OK in body )
Response Example
OK

12.1.2 Close Door

Close the door

GET

Request URL http://<server>/cgi-bin/accessControl.cgi?action=closeDoor
Method
Request Params ( key=value format in URL )
Name
channel
UserID
Type

R/O Description
Type
R
int
int
O
char[16] O

the index of door, starts from 1.
remote user ID.
the open type, default value is "Remote".

Example
1
101
"Remote"

Request Example
http://192.168.1.108/cgi-bin/accessControl.cgi?action=closeDoor&channel=1&UserID=101&Type=Rem
ote

Response Params ( OK in body )
Response Example
OK

Access Control APIs 505

12.1.3 Get Door Status

Get status of the door

http://<server>/cgi-bin/accessControl.cgi?action=getDoorStatus
GET

Request URL
Method
Request Params ( key=value format in URL )
Name
channel
Request Example
http://192.168.1.108/cgi-bin/accessControl.cgi?action=getDoorStatus&channel=1

R/O Description
R

the index of door, starts from 1

Type
int

Example
1

Response Params ( key=value format in body )
R/O Description
Type
Name
R
object
Info
char[16] R
+status

door status info
door status, the range is {Open, Break, Close}

Example

"Open"

Response Example
Info.status=Open

12.1.4 Get Lock Status

Syntax

Method

http://<server>/cgi-bin/accessControl.cgi?action=getLockStatus&channel=<ChannelNo>

GET

Description Get status of the lock.

Example

http://192.168.1.108/cgi-bin/accessControl.cgi?action= getLockStatus &channel=1

Success
Return

Comment

onLineStatus =”Online”
status =”Close”

Parameters in URL :
ChannelNo: integer, the index of lock, starts from 1. Default is 1 if not present.
Parameters in Response :
status: the range is {“Open”,”Close”,”Abnormal”, "FakeLocked", "Unknown" }
onLineStatus: the range is { "OnLine", "OffLine" }

12.1.5 Capture Fingerprint

Only ID verification terminals such as ASHZ320/520 are supported. Common access control is not
supported.

Table 12-1

Syntax

Method

http://<server>/cgi-bin/accessControl.cgi?action=captureFingerprint

GET

Description

Capture fingerprint data, then report it via ‘Fingerprint’ event.

[ Request Params ] ( key=value format at URL )

Name

info

+ReaderID

Type

object

string

R/O Param Description

R

R

fingerprint data

Reader machine ID

Access Control APIs 506

+FingerPrintName string

- UserID

heartbeat

timeout

string

int

int

O

O

R

R

Fingerprint name (For smart building products)

User Identity (For smart building products)

Heartbeat interval (sec)

Timeout (sec)

[ Response Params ] (multipart , json format in body , Heartbeat in body)

[ Example ]

Request

http://<server>/cgi-bin/accessControl.cgi?action=captureFingerprint& info.ReaderID=101
&info.FingerPrintName=aaaa&info.UserID=10221&heartbeat=5&timeout=10

HTTP/1.1 200 OK
Cache-Control: no-cache
Pragma: no-cache
Expires: Thu, 01 Dec 2099 16:00:00 GMT
Connection: close
Content-Type: multipart/x-mixed-replace; boundary=myboundary

--myboundary
Content-Type: text/plain
Content-Length: 238002

Code=Fingerprint;action=Pulse;index=0;data={
"CollectResult": true,
"FingerPrintID": 60,
"RecNo": 1234,
"ReaderID": "1",
"UserID": "001",
"CardNo": "001",
"FingerprintPacket": {
"Length": 512,
"Count": 3
},
"FingerprintData": "xxx",
"BinaryData": Binary Data
}

Response

--myboundary
Content-Type: text/plain
Content-Length: 9

Heartbeat

--myboundary
……

12.1.6 Capture Face Picture

Only ID verification terminals such as ASHZ320/520 are supported. Common access control is not
supported.

Access Control APIs 507

Table 12-2

URL

Method

http://<server>/cgi-bin/accessControl.cgi?action=captureCmd

GET

Description

Capture face data, then report it via ‘CitizenPictureCompare’ event.

[ Request Params ] ( key=value format at URL )

Name

+type

- UserID

heartbeat

timeout

Type

R/O Param Description

int

string

int

int

Capture entity types:
0x01 - Face
0x02 - Identification card

User ID

Heartbeat interval (sec)

Timeout (sec)

R

O

R

R

[ Response Params ] (multipart , json format in body , Heartbeat in body )

[ Example ]

Request

http://<server>/cgi-bin/accessControl.cgi?action=captureCmd&type=1&UserID=10221&
heartbeat=5&timeout=10

HTTP/1.1 200 OK
Cache-Control: no-cache
Pragma: no-cache
Expires: Thu, 01 Dec 2099 16:00:00 GMT
Connection: close
Content-Type: multipart/x-mixed-replace; boundary=myboundary

--myboundary
Content-Type: text/plain
Content-Length: 2380

Response

Code=CitizenPictureCompare;action=Pulse;index=0;data={
"UTC": 1999999999,
"CompareResult": true,
"Similarity": 90,
"Threshold": 80,
"Citizen": "ZhangSan",
"Sex": 1,
"Minzu": 1,
"Birth": "1980-01-01",
…
}

--myboundary
Content-Type: text/plain
Content-Length: 9

Heartbeat

--myboundary

Access Control APIs 508

……

12.1.7 Query AccessControl Record

URL

http://<server>/cgi-bin/recordFinder.cgi?action=find&name=<RecordName>

Table 12-3

Method

GET

Description Query AccessControl record.

[ Request Params ] ( key=value format in URL )

Name

name

count

StartTime

EndTime

condition

+CardNo

Type

string

int

string

string

object

string

R/O

Param Description

R

O

O

O

O

O

record

The
"AccessControlCardRec".

table

name.

It

should

be

Max result to return, default is 1024.

The start of the record's CreateTime.

The end of the record's CreateTime.

Search condition.

Access user card number.

[ Response Params ] (key=value format)

R/O

Param Description

Name

totalCount

found

records

+RecNo

+CreateTime

+CardNo

Type

int

int

array<object

>

int

int

int

+CardName

string

+CardType

int

+Password

+UserID

+Type

+Status

string

string

string

int

O

O

R

R

O

R

O

O

O

R

O

O

+Method

int

R

Total record num that find.

Record num that returned.

The records that returned.

Record id.

Record create time, UTC time.

Access user card number.

Access user card name, max string length is 31.

The card type:
0: Normal Card, 1: VIP Card, 2: Visitor Card, 3: Patrol Card,
4: Blocklist Card, 5: Stress Card, 0xff: Mother Card

The Access card's password.

The user's id.

The event type. It can be: "Entry", "Exit".
Open door result. It can be: 0—failed, 1—success.
If this param does not exist, that means success.

Open door method. It can be:













0: by password
1: by access card
2: by access card and then password
3: by password and then access card
6: by fingerprint
15: by face recognition

+Door

int

O

The index of the door. ( This param is not supported by
video talk device )

Access Control APIs 509

+ReaderID

string

+ErrorCode

int

+URL

string

+RecordURL

string

+IsOverTempera
ture

bool

+TemperatureUn
it

integer

+CurrentTemper
ature

float

+CitizenIDResult bool

+CitizenIDName string

+CitizenIDNo

string

+CitizenIDSex

integer

+CitizenIDMinzu

integer

+CitizenIDBirth

string

+CitizenIDAddre
ss

+CitizenIDAutho
rity

+CitizenIDStart

+CitizenIDEnd

string

string

string

string

O

O

O

O

O

O

O

O

O

O

O

O

O

O

O

O

O

The access user card ID of reader. ( This param is not
supported by video talk device )

The error code, valid only when Status is 0.

The picture's URL, max string length is 127. ( This param is
not supported by access control device )

The record video's URL, max string length is 127. ( This
param is not supported by access control device )

is over temperature

temperature unit:{
0: centigrade
1: Fahrenheit
2: Kelvin
}

current temperature

citizen ID compare result

citizen name

citizen ID number

sex:{
0: unknow
1: male
2: female
9: not stated
}

citizen ID Minzu

birthday, format as "1980-01-01"

address

signing and issuing organization

Effective date

Expiration date,
effectiveness

and

"Endless" mens Long

term

[ Example ]

Request

Response

GET http://192.168.1.108/cgi-bin/recordFinder.cgi?action=find&name=AccessControlCard
Rec&StartTime=123456700&EndTime=123456800&condition.CardNo=12001&count=100

totalCount=1000
found=100
records[0].RecNo=12345
records[0].CreateTime=123456789
records[0].CardNo=12001
records[0].CardName=ZhangSan
records[0].UserID=ZhangSan
records[0].Type=Entry
records[0].Method=1

Access Control APIs 510

…
records[1].RecNo=13579
records[1].CreateTime=123456799
records[1].CardNo=12001
records[1].CardName=ZhangSan
records[1].UserID=ZhangSan
records[1].Type=Exit
records[1].Method=1
…

12.1.8 Query Access Control Alarm Record

Table 12-4

Syntax

http://<server>/cgi-bin/recordFinder.cgi?action=find&name=AccessControlAlarmRecor
d[&StartTime=<startTime>&EndTime=<endTime>&count=<countNo>]

Method

GET

Description

Find the AccessControlAlarmRecord record. ( This api is supported by access control
device. )

Example

http://192.168.1.108/cgi-bin/recordFinder.cgi?action=find&name=AccessControlAlarmR
ecord&StartTime=2014-8-25%2000:02:32&EndTime=2014-8-25%2001:02:32&count=5
00

Success
Return

Comment

totalCount=1000
found=500
records[0].RecNo=789
records[0].CreateTime=123456789
records[0].UserID=10113
records[0].EventCode=DoorMagnetism
records[0].DevAddrs=1
records[0].IndexNum=0
records[0].Time=2017-05-10 16:00:01
…

Parameters in URL:
startTime: The start time ,format : 2014-8-25%2000:01:32
endTime: The end time, format: 2014-8-25%2000:02:32
countNo: the number of records to get, The record count, default 1024

Parameters in Response :
totalCount : the record count which match condition
found : the record count to return
EventCode : alarm event code, the range is { "DoorNotClosed", "BreakIn",
"RepeatEnter", "Duress", "AlarmLocal", "ChassisIntruded" }

Access Control APIs 511

12.1.9 [Event] AccessControl

Table 12-5

Usage

Refer to "4.4.3 Subscribe to Snapshot"for how to subscribe event

Description When user trying to open the door, send this event.

[ Event Params ] ( key=value format )

Name

Events

Type

R/O

Param Description

array<object> R

Event info array

+EventBaseInfo

object

++Code

++Action

++Index

+RecNo

+Name

+Type

+Status

String

String

int

int

string

string

int

R

R

R

O

R

O

O

O

Base info of event

Event Code. It should be AccessControl

Event Action. It can be: "Start", "Stop", "Pulse"

The channel index relate to this event.

The record id

The name of the door

The event type. It can be: "Entry", "Exit"
Open door result, can be: 0—failed, 1—success
If this param does not exist, that means success.

Access Control APIs 512

+Method

int

R

Open door method, can be:
0: by password
1: by access card
2: by access card and then password
3: by password and then access card
6: by fingerprint
7: by password and access card and fingerprint together
8 : by password and fingerprint together
9 : by access card and fingerprint together
10: reserved
11: by multiple access user
12: by key
13: by duress password
14: by QR code, local
15: by face recognition, local
16: reserved
17: by ID card
18: by face and ID card
19: by Bluetooth
20: by custom password
21: by UserId and password
22: by face and password
23: by fingerprint and password
24: by fingerprint and face
25: by access card and face
26: by face or password
27: by fingerprint or password
28: by fingerprint or face
29: by access card or face
30: by access card or fingerprint
31: by fingerprint and face and password
32: by access card and face and password
33: by access card and fingerprint and password
34: by access card and fingerprint and face
35: by fingerprint or face or password
36: by access card or face or password
37: by access card or fingerprint or face
38: by access card and fingerprint and face and password
39: by access card or fingerprint or face or password
40: by ID card and face, or access card or face
41: by ID card or QR code or face
42: by DTMF(SIPINFO，RFC2833，INBAND)
43: by QR code, remote
44: by face recognition, remote
45: by ID card ( match with fingerprint in ID card )
46: by temporary password
47: by health code

Access Control APIs 513

+CardNo

+UserID

string

string

+ErrorCode

integer

+ObjectPropertie
s

object

+Mask

integer

+ManTemperatu
reInfo

++CurrentTempe
rature

object

float

++TemperatureU
nit

integer

++IsOverTemper
ature

bool

[ Example ]

O

R

O

O

O

O

O

O

O

Card number if the door is opened by card

The user id

error code

Dynamic structure info

is with mask, it can be {
0: unknow
1: without mask
2: with mask
}

people’s temperature info

people’s current temperature

temperature unit:{
0: centigrade
1: Fahrenheit
2: Kelvin
}

is over temperature

Event

--<boundary>
Content-Type: text/plain
Content-Length: <length>

Events[0].EventBaseInfo.Code=TrafficJam
Events[0].EventBaseInfo.Action=Pulse
Events[0].EventBaseInfo.Index=0
Events[0].RecNo=123
Events[0].Name=Door1
Events[0].Type=Entry
Events[0].Status=1
Events[0].Method=1
Events[0].CardNo=09DDAABB
Events[0].UserID=101
…
--<boundary>
Content-Type: image/jpeg
Content-Length: <image size>

<Jpeg image data>
--<boundary>

Access Control APIs 514

12.1.10 [Event] CitizenPictureCompare

Table 12-6

Usage

Refer to "4.4.3 Subscribe to Snapshot" for how to subscribe event

Description When user trying to open the door, send this event.

[ Event Params ] ( key=value format )

Name

Events

Type

R/O

Param Description

array<object> R

Event info array

+EventBaseInfo

object

++Code

++Action

++Index

+UTC

String

String

int

uint32

+CompareResult bool

+Similarity

integer

+Threshold

integer

+Citizen

+Sex

String

integer

+Minzu

+Birth

+Address

+Number

+Authority

+Start

+End

integer

String

String

String

String

String

String

R

R

R

O

O

O

O

O

O

O

O

O

O

O

O

O

O

+ImageInfo

array<object> O

Base info of event

Event Code. It should be CitizenPictureCompare

Event Action. It can be: "Pulse"

The channel index relate to this event.

UTC time

compare result. If the similarity is greater than or equal to
the threshold, the comparison is considered successful

Similarity of two pictures, Unit: percentage
range[1, 100]

check threshold
range[1, 100]

citzen name

sex, it can be: {
0 unknow
1 male
2 female
9 not stated
}

Minzu (refer to CitizenIDCard)

birthday, such as "1980-01-01"

address

citizen ID

signing and issuing organization

Effective date

Expiration date, and "Endless" mens Long term
effectiveness

Picture information, the first for the face cutout, the second
for the ID card photo

++Offset

++Length

++Width

++Height

integer

integer

integer

integer

O

O

O

O

the offset in binary data

length of picture, unit: Byte

Picture width, pixels

Picture height, pixels

+ImageInfoEx

array<object> O

extension of picture info, (The total number of images
uploaded is determined by imageinfo and imageinfoex)
6 at most

++Type

integer

O

picture type
0 Local face database

Access Control APIs 515

++Offset

++Length

++Width

++Height

+CardNo

+CellPhone

+BuildingNumbe
r

+BuildingUnitNu
mber

+BuildingRoomN
umber

+PersonnelRelat
ionship

integer

integer

integer

integer

String

String

String

String

String

String

+Method

integer

+EventGroupID

integer

+CallNumber

String

+EventType

integer

+UserID

+FaceIndex

+Mask

String

integer

integer

O

O

O

O

O

O

O

O

O

O

O

O

O

O

O

O

O

1 Shooting scene map

the offset in binary data

length of picture, unit: Byte

Picture width, pixels

Picture height, pixels

IC card number (for building products)

phone number (input number before comparison) (for
building products)

building number (for building products)

building entrance number (for building products)

room number (for building products)

relationship (for building products)

method (refer to OpenDoorMethod)

event group id, used to associate different events are with
same action. (Used with AccessControlevents)

phone number to be called.(called after compare succeed)
(for building products)

event type:
0: compare result
1: Face acquisition
2: visitor registration
3: Face permission distribution
4: inquirement of ID card face group

user ID

face index, range [0,4]

is with mask, it can be {
0: unknow
1: without mask
2: with mask
}
default 0.

[ Example ]

Event

--<boundary>
Content-Type: text/plain
Content-Length: <length>

Events[0].EventBaseInfo.Code= CitizenPictureCompare
Events[0].EventBaseInfo.Action=Pulse
Events[0].EventBaseInfo.Index=0
Events[0].UTC=1999999999
Events[0].CompareResult=true
Events[0].Similarity=80

Access Control APIs 516

Events[0].Threshold=75
…
--<boundary>
Content-Type: image/jpeg
Content-Length: <image size>

<Jpeg image data>
--<boundary>

12.1.11 [Event] Door Status Event

Usage

Refer to "4.4.3 Subscribe to Snapshot" for how to subscribe event.

Description Door status event

[ Event Params ] ( key=value format )

Name

Events

Type

R/O

Param Description

array<object> R

Event array

+EventBaseInfo

object

++Code

++Action

++Index

+UTC

String

String

int

uint32

R

R

R

O

- +Status

enumchar[32]

-

Basic information of event

Event code ("DoorStatus")

Event action ("Pulse")

Door channel

Standard UTC time (without DST deviation of time zone).
Required for access control products, and optional for
intercom products.

Door status
Enumchar[32]{
"Open"
"Close"
"CloseAlways"
"OpenAlways"
"Normal"
}

Example

Event

--<boundary>
Content-Type: text/plain
Content-Length: <length>

Events[0].EventBaseInfo.Code= DoorStatus
Events[0].EventBaseInfo.Action=Pulse
Events[0].EventBaseInfo.Index=0
Events[0].UTC=1999999999
Events[0].Status= CloseAlways
--<boundary>

12.1.12 [Config] Access Control General Setting

 Get access control general setting

Access Control APIs 517

URL

http://<server>/cgi-bin/configManager.cgi?action=getConfig&name=AccessControlGener
al

Table 12-7

Method

GET

Description Get access control general setting.

[ Request Params ] ( None )

[ Response Params ] ( key=value format )

R/O

Param Description

Name

table

+AccessControl
General

++AccessProper
ty

Type

object

object

string

+ABLock

object

+++Enable

bool

+++Doors

Array<
Array<int> >

++CustomPass
wordEnable

++CommonPass
word

++ButtonExitEna
ble

++CheckSensor
BeforeLock

++CheckSensor
Time

++DuressPassw
ord

bool

string

bool

bool

int

string

++DuressEnable bool

R

R

O

O

O

O

O

O

O

O

O

O

O

++UnlockRecord
Type

Array<string> O

config table object

AccessControlGeneral config object

Access property, can be : “unidirect”, “bidirect” ( This
param is supported by access control device. )

AB Lock setting ( This param is supported by access
control device. )

Enable AB Lock or not.

AB Lock groups, each group has several doors, one door
can be opened only when all other doors in the AB lock
group are in closed state.

Whether to enable custom password. ( This param is
supported by video talk device. )

The common password. ( This param is supported by
video talk device. )

Whether to enable the open door button. ( This param is
supported by video talk device. )

Whether to check the sensor before lock the door. ( This
param is supported by video talk device. )

The check sensor time, in seconds. ( This param is
supported by video talk device. )

The duress password. ( This param is supported by video
talk device. )

Whether to enable duress password. ( This param is
supported by video talk device. )

Unlock Record Type,can be
{"Password", "Button",
"FingerPrint", "QRCode", "Card","Remote", "BlueTooth",
"Face"}

++SensorType

integer

++CallLiftType

string

++CallLiftEnable bool

++AccessVoice

object

+++CurrentVoice
ID

integer

O

O

O

O

O

sensor type,
0 for always open; 1 for always close.

call lift protocol type

whether to enable call lift

Door opening prompt tone

the current prompt tone ID, default value 0

+++VoiceList

array<object> O

voice list, max length is 16
voice ID can be: {

Access Control APIs 518

0: Validate succeed
1: door open succeed
2: unlock succeed
3: punch time clocks succeed
4: welcome
5: Welcome to come again
6: thank you
7: custom voice
}

++++VoiceID

integer

++++VoiceName string

++++FileName

string

[ Example ]

O

O

O

voice id

voice info

file full path with name

Request

http://10.0.0.8/cgi-bin/configManager.cgi?action=getConfig&name=AccessControlGeneral

Respons
e

table.AccessControlGeneral.AccessProperty=bidirect
table.AccessControlGeneral.ABLock.Enable=true
table.AccessControlGeneral.ABLock.Doors[0][0]=1
table.AccessControlGeneral.ABLock.Doors[0][1]=2
table.AccessControlGeneral.ABLock.Doors[0][2]=3
table.AccessControlGeneral.ABLock.Doors[1][0]=4
table.AccessControlGeneral.ABLock.Doors[1][1]=5
table.AccessControlGeneral.ABLock.Doors[1][2]=6
table.AccessControlGeneral.CustomPasswordEnable=true
table.AccessControlGeneral.CommonPassword=123456
table.AccessControlGeneral.ButtonExitEnable=true
table.AccessControlGeneral.CheckSensorBeforeLock=true
table.AccessControlGeneral.CheckSensorTime=30
table.AccessControlGeneral.DuressPassword=654321
table.AccessControlGeneral.DuressEnable=true

 Set access control general setting

URL

http://<server>/cgi-bin/configManager.cgi?action=setConfig

Table 12-8

Method

GET

Descripti
on

Set access control general setting.

[ Request Params ] ( key=value format at URL )

Name

AccessControlG
eneral

+AccessPropert
y

Type

object

string

…<other param> —

[ Response Params ] ( OK )

[ Example ]

R/O Param Description

R

O

—

AccessControlGeneral config object

Access property, can be : “unidirect”, “bidirect” ( This param
is supported by access control device. )

…<See above getConfig command for other params of the
config object, They are all optional.>

Access Control APIs 519

Request

http://10.0.0.8/cgi-bin/configManager.cgi?action=setConfig&AccessControlGeneral.Access
Property=bidirect&AccessControlGeneral.ABLock.Enable=false&AccessControlGeneral.Cu
stomPasswordEnable=true&AccessControlGeneral.CommonPassword=123456&AccessC
ontrolGeneral.ButtonExitEnable=true&AccessControlGeneral.CheckSensorBeforeLock=tru
e

Respons
e

OK

12.1.13 [Config] Access Control Setting

 Get access control setting

Table 12-9

URL

http://<server>/cgi-bin/configManager.cgi?action=getConfig&name=AccessControl

Method

GET

Description Get access control setting.

[ Request Params ] ( None )

[ Response Params ] ( key=value format )

Name

table

Type

object

R/O

Param Description

R

The config table

+AccessControl

array<object> R

++Enable

++State

bool

string

O

O

++Method

int

O

The AccessControl config array for every access control
channel

Whether to enable config for this channel.

Door state, can be
“OpenAlways”, “NoPersonNC”, “NoPersonNO”

“Normal”,

:

“CloseAlways”,

Open door method, can be following value, default is 2 :
0 : only by password
1 : only by access card
2 : by password or access card
3 : by access card first then password
4 : by password first then access card
5 : different method in differenct time range
6 : only by fingerprint
7 : by password or access card or fingerprint
8 : by password and access card and fingerprint together
9 : by password and fingerprint together
10 : by access card and fingerprint together
11 : by multiple access user
12 : by face ( match with picture in ID card )
13 : by face and ID card
14 : by face ( match with picture in ID card ) or access card
or fingerprint
15 : by face and ID card, or access card or fingerprint
16 : by UserID and password
17 : only by face
18 : by face and password together

Access Control APIs 520

19 : by fingerprint and password together
20 : by fingerprint and face together
21 : by access card and face together
22 : by face or password
23 : by fingerprint or password
24 : by fingerprint or face
25 : by access card or face
26 : by access card or fingerprint
27 : by fingerprint and face and password together
28 : by access card and face and password together
29 : by access card and fingerprint and password together
30 : by access card and fingerprint and face together
31 : by fingerpint or face or password
32 : by access card or face or password
33 : by access card or fingerprint or face
34 by access card and fingerprint and face and password
together
35 : by access card or fingerprint or face or password
36 : by face and ID card, or access card or face
37 : by face ( match with picture in ID card ) or access card
or face
38 : by access card and password, or fingerprint and
password
39 : by ID card ( match with picture in ID card ) or face
40 : by ID card ( match with fingerprint in ID card )
41 : by ID card ( match with fingerprint and picture in ID
card )
42 : by ID card or access card or fingerprint or face or
password
43 : by multy user method
44 : by ID card or health code

time

range
The
AccessTimeSechdule config.

that working, value

is

index

in

The time range that always closed, value is index in
AccessTimeSechdule config.

The time range that working in holidays, value is index in
AccessTimeSechdule config.

The Unlock holding interval, unit is milliseconds, value
should between 250 to 20000. ( This param is also
supported by video talk device. )

The Unlock reload interval, unit is milliseconds. ( This
param is also supported by video talk device. )

The access control process, can be : "Local", "Dahua",
"Remote", "Private" ( This param is also supported by
video talk device. )

Whether to enable the breakin alarm.

Access Control APIs 521

++OpenAlwaysT
ime

++CloseAlwaysT
ime

int

int

++HolidayTime

int

++UnlockHoldInt
erval

++UnlockReload
Interval

int

int

++AccessProtoc
ol

string

++BreakInAlarm
Enable

bool

O

O

O

O

O

O

O

++RepeatEnterA
larm

++DoorNotClose
dAlarmEnable

++DuressAlarm
Enable

++FirstEnter

+++Enable

+++Status

+++Time

++CardNoConve
rt

++MaliciousAcc
essControlEnabl
e

+AutoRemoteCh
eck

+++Enable

+++Time

bool

bool

bool

object

bool

string

int

int

bool

object

bool

uint

++Name

string

++RepeatEnterT
ime

integer

++CloseTimeout

integer

++SensorEnable bool

O

O

O

O

O

O

O

O

O

O

O

O

O

O

Whether to enable the repeat enter alarm.

Whether to enable the alarm when door not closed.

Whether to enable the duress alarm.

The first enter setting.

Whenther to enable the first enter function,

The status, can be : “KeepOpen” “Normal”

The time range that enable first enter function, value is
index in AccessTimeSechdule config.

The card number convert setting : 0 – not convert, 1 –
convert using NOT operation, 2 : use HIDpro convert

Whether to enable malicious access alarm.

auto open door remotely

whether to enable the function

working period , value is index in AccessTimeSechdule
config.

name

Repeat entry time, unit second, 0 means do not start

Closing overtime

sensor enable

++TimeSchedule

Array<Array<
object>>

Open the door in different periods
it works when Method is "different method in differenct
time range".

+++TimeSection

string

O

time section, format as "hh:mm:ss-hh:mm:ss"

+++Method

integer

O

Open door method, can be following value, default is 2 :
0 : only by password
1 : only by access card
2 : by password or access card
3 : by access card first then password
4 : by password first then access card
5 : different method in differenct time range
6 : only by fingerprint
7 : by password or access card or fingerprint
8 : by password and access card and fingerprint together
9 : by password and fingerprint together
10 : by access card and fingerprint together
11 : by multiple access user
17 : only by face
35 : by access card or fingerprint or face or password

++CustomPass

bool

O

whether to enable admin password

Access Control APIs 522

wordEnable

++RemoteCheck bool

O

Is platform validation required

[ Example ]

Request

http://10.0.0.8/cgi-bin/configManager.cgi?action=getConfig&name=AccessControl

Respons
e

table.AccessControl[0].Enable=true
table.AccessControl[0].State=Normal
table.AccessControl[0].Method=2
table.AccessControl[0].OpenAlwaysTime=1
table.AccessControl[0].CloseAlwaysTime=2
table.AccessControl[0].UnlockHoldInterval=500
table.AccessControl[0].AccessProtocol=Local
table.AccessControl[0].BreakInAlarmEnable=true
table.AccessControl[0].DuressAlarmEnable=true
table.AccessControl[0].CardNoConvert=0
table.AccessControl[0].MaliciousAccessControlEnable=true
…

 Set access control setting

URL

http://<server>/cgi-bin/configManager.cgi?action=setConfig

Table 12-10

Method

GET

Descripti
on

Set access control setting.

[ Request Params ] ( key=value format at URL )

Name

Type

R/O Param Description

AccessControl

array<object> R

AccessControl config object array

+Enable

bool

…<other param> —

O

—

Whether to enable config for this channel.

…<See above getConfig command for other params of the
config object, They are all optional.>

[ Response Params ] ( OK )

[ Example ]

Request

http://10.0.0.8/cgi-bin/configManager.cgi?action=setConfig&AccessControl[0].Enable=true&
AccessControl[0].State=Normal&AccessControl[0].Method=2&AccessControl[0].OpenAlwa
ysTime=1&AccessControl[0].CloseAlwaysTime=2&AccessControl[0].UnlockHoldInterval=5
00&AccessControl[0].AccessProtocol=Local&AccessControl[0].BreakInAlarmEnable=true&
AccessControl[0].DuressAlarmEnable=true&AccessControl[0].CardNoConvert=0&AccessC
ontrol[0].MaliciousAccessControlEnable=true

Respons
e

OK

12.1.14 [Config] Wiegand Setting

 Get Wiegand setting

Table 12-11

Access Control APIs 523

URL

http://<server>/cgi-bin/configManager.cgi?action=getConfig&name=Wiegand

Method

GET

Description Get Wiegand setting.

[ Request Params ] ( None )

[ Response Params ] ( key=value format )

Type

object

R/O

Param Description

R

config table object

array<object> R

Wiegand config

Name

table

+Wiegand

++Mode

++PulseWidth

++PulseStep

int

int

int

++TransferMode

int

++OutType

int

++InputType

integer

O

R

R

R

R

R

Wiegand mode, 0: wiegand input, 1 : wiegand output

The pulse width, unit is microseconds

The pulse step, unit is microseconds

The transfer mode, 0 : wiegand 34bit transfer, 4 byte card
number, 2 bit checksum, 1 : wiegand 66bit transfer, 8 byte
card number, 2 bit checksum, 2 : wiegand 26bit transfer, 3
byte card number, 2 bit checksum,

The output type, 0 : output ID, 1 : output card number

the input type, the value is 32bits. It won’t accept any input
when value is 0.
Bit0: card number input
Bit1: password input
bit2~Bit31:reserved

++Doors

[ Example ]

integer

O

door index, starts from 0, and 0 means door 1

Request

http://10.0.0.8/cgi-bin/configManager.cgi?action=getConfig&name=Wiegand

Respons
e

table.Wiegand[0].Mode=1
table.Wiegand[0].PulseWidth=200
table.Wiegand[0].PulseStep=1000
table.Wiegand[0].TransferMode=1
table.Wiegand[0].OutType=1
table.Wiegand[1].Mode=1
table.Wiegand[0].InputType=3
table.Wiegand[0].Doors=0
…

 Set Wiegand setting

URL

http://<server>/cgi-bin/configManager.cgi?action=setConfig

Table 12-12

Method

GET

Descripti
on

Set Wiegand setting.

[ Request Params ] ( key=value format at URL )

Name

Wiegand

Type

R/O Param Description

array<object> R

Wiegand config object

+Mode
int
…<other param> —

O
—

Wiegand mode, 0 : wiegand input, 1 : wiegand output

…<See above getConfig command for other params of the

Access Control APIs 524

[ Response Params ] ( OK )

config object, They are all optional.>

[ Example ]

Request

http://10.0.0.8/cgi-bin/configManager.cgi?action=setConfig&Wiegand[0].Mode=1&Wiegand
[0].PulseWidth=200&Wiegand[0].PulseStep=1000&Wiegand[0].TransferMode=1&Wiegand
[0].OutType=1

Respons
e

OK

12.1.15 [Config] Access Time Schedule Setting

The following Apis are not supported by video talk device.

 Get access time schedule setting

Table 12-13

URL

http://<server>/cgi-bin/configManager.cgi?action=getConfig&name=AccessTimeSchedul
e

Method

GET

Description Get access time schedule setting.

[ Request Params ] ( None )

[ Response Params ] ( key=value format )

Name

table

Type

R/O

Param Description

array<object> R

config table object

+AccessTimeSc
hedule

array<object> R

AccessTimeSchedule config object array

++Name

++Enable

string

bool

O

R

The schedule name, max string length is 63.

Whether to enable this time schedule

++TimeSechdule

array< array<
string > >

O

The time schedule array, first array has max 8 iterm, refer
to 7 day in a week (the first one is Sunday)and last one is
holiday, each item is an array has max 6 time section,
each
is “enable,
is a string,
hour:minite:second – hour:minite:second”, for example : "1
00:00:00-12:00:00"

time section

format

[ Example ]

Request

http://10.0.0.8/cgi-bin/configManager.cgi?action=getConfig&name=AccessTimeSchedule

Respons
e

table.AccessTimeSchedule[0].Name=TS1
table.AccessTimeSchedule[0].Enable=true
table.AccessTimeSchedule[0].TimeSchedule[0][0]=1 00:00:00-12:00:00
table.AccessTimeSchedule[0].TimeSchedule[0][1]=1 15:00:00-20:00:00
table.AccessTimeSchedule[0].TimeSchedule[1][0]=1 00:00:00-12:00:00
table.AccessTimeSchedule[0].TimeSchedule[1][1]=1 15:00:00-20:00:00
…

 Set access time schedule setting

Table 12-14

Access Control APIs 525

URL

http://<server>/cgi-bin/configManager.cgi?action=setConfig

Method

GET

Descripti
on

Set access time schedule setting.

[ Request Params ] ( key=value format at URL )

Name

Type

R/O Param Description

AccessTimeSch
edule

array<object> R

The access time schedule config object array

+Name

string

…<other param> —

O

—

The schedule name, max string length is 63.

…<See above getConfig command for other params of the
config object, They are all optional.>

[ Response Params ] ( OK )

[ Example ]

Request

http://10.0.0.8/cgi-bin/configManager.cgi?action=setConfig&AccessTimeSchedule[0].Name
=TS1&AccessTimeSchedule[0].Enable=true&AccessTimeSchedule[0].TimeSchedule[0][0]=
1%2000:00:00-12:00:00&AccessTimeSchedule[0].TimeSchedule[0][1]=1%2015:00:00-20:0
0:00&AccessTimeSchedule[0].TimeSchedule[1][0]=1%2000:00:00-12:00:00&AccessTimeS
chedule[0].TimeSchedule[1][1]=1%2015:00:00-20:00:00

Respons
e

OK

12.1.16 [Config] Special Day Group Setting

The following Apis are not supported by video talk device.

 Get special day group setting

Table 12-15

URL

http://<server>/cgi-bin/configManager.cgi?action=getConfig&name=SpecialDayGroup

Method

GET

Description Get special day group setting.

[ Request Params ] ( None )

[ Response Params ] ( key=value format )

Name

table

Type

object

R/O

Param Description

R

config table object

+SpecialDayGro
up

++Name

++Enable

++Days

array<object> R

SpecialDayGroup config object array

string

bool

O

R

The special day group name

Whether to enable this special day group

array<object> O

The special days in group

+++SpecialDayN
ame

+++StartTime

+++EndTime

[ Example ]

string

string

string

O

O

O

The special day name.

The special day start datetime

The special day end datetime

Request

http://10.0.0.8/cgi-bin/configManager.cgi?action=getConfig&name=SpecialDayGroup

Access Control APIs 526

Respons
e

table.SpecialDayGroup[0].Name=SpecialDayGroup1
table.SpecialDayGroup[0].Enable=true
table.SpecialDayGroup[0].Days[0].SpecialDayName=NationalDay
table.SpecialDayGroup[0].Days[0].StartTime=2017-10-01 00:00:00
table.SpecialDayGroup[0].Days[0].StartTime=2017-10-07 23:59:59
…

 Set special day group setting

Table 12-16

URL

http://<server>/cgi-bin/configManager.cgi?action=setConfig

Method

GET

Descripti
on

Set special day group setting.

[ Request Params ] ( key=value format at URL )

Name

Type

R/O Param Description

SpecialDayGrou
p

array<object> R

The special day group config object array

+Name

string

…<other param> —

O

—

The special day group name

…<See above getConfig command for other params of the
config object, They are all optional.>

[ Response Params ] ( OK )

[ Example ]

Request

http://10.0.0.8/cgi-bin/configManager.cgi?action=setConfig&SpecialDayGroup[0].Name=Sp
ecialDayGroup1&SpecialDayGroup[0].Enable=true&SpecialDayGroup[0].Days[0].SpecialD
ayName=NationalDay&SpecialDayGroup[0].Days[0].StartTime=2017-10-01%2000:00:00&
SpecialDayGroup[0].Days[0].StartTime=2017-10-07%2023:59:59

Respons
e

OK

12.1.17 [Config] Special Days Schedule Setting

The following Apis are not supported by video talk device.

 Get special days schedule setting

Table 12-17

URL

http://<server>/cgi-bin/configManager.cgi?action=getConfig&name=SpecialDaysSchedul
e

Method

GET

Description Get special days schedule setting.

[ Request Params ] ( None )

[ Response Params ] ( key=value format )

Name

table

Type

object

R/O

Param Description

R

config table object

+SpecialDaysSc
hedule

array<object> R

SpecialDaysSchedule config object array

Access Control APIs 527

++Name

++Enable

string

bool

++GroupNo

int

O

R

R

++TimeSection

array<string> R

The special day schedule name

Whether to enable this special day schedule

The special day group number, value is the index of
SpecialDayGroup setting array.

The time section array, the format of the item is “enable,
hour:minite:second – hour:minite:second”, for example : "1
00:00:00-12:00:00".

++Doors

[ Example ]

array<int>

R

The doors array.

Request

http://10.0.0.8/cgi-bin/configManager.cgi?action=getConfig&name=SpecialDaysSchedule

Respons
e

table.SpecialDaysSchedule[0].Name=SpecialDayGroup1
table.SpecialDaysSchedule[0].Enable=true
table.SpecialDaysSchedule[0].GroupNo=1
table.SpecialDaysSchedule[0].TimeSection[0]=1 00:00:00-12:00:00
table.SpecialDaysSchedule[0].TimeSection[1]=1 15:00:00-20:00:00
table.SpecialDaysSchedule[0].Doors[0]=2
table.SpecialDaysSchedule[0].Doors[1]=3
…

 Set special days schedule setting

Table 12-18

URL

http://<server>/cgi-bin/configManager.cgi?action=setConfig

Method

GET

Descripti
on

Set special days schedule setting.

[ Request Params ] ( key=value format at URL )

Name

Type

R/O Param Description

SpecialDaysSch
edule

array<object> R

The special days schedule config object array

+Name

string

…<other param> —

O

—

The special day schedule name

…<See above getConfig command for other params of the
config object, They are all optional.>

[ Response Params ] ( OK )

[ Example ]

Request

http://10.0.0.8/cgi-bin/configManager.cgi?action=setConfig&SpecialDaysSchedule[0].Name
=SpecialDayGroup1&SpecialDaysSchedule[0].Enable=true&SpecialDaysSchedule[0].Grou
pNo=1&SpecialDaysSchedule[0].TimeSection[0]=1%2000:00:00-12:00:00&SpecialDaysSc
hedule[0].TimeSection[1]=1%2015:00:00-20:00:00&SpecialDaysSchedule[0].Doors[0]=2&S
pecialDaysSchedule[0].Doors[1]=3

Respons
e

OK

12.1.18 [Config] MeasureTemperature Setting

The following Apis are not supported by video talk device.

Access Control APIs 528

 Get measure temperature setting

Table 12-19

URL

http://<server>/cgi-bin/configManager.cgi?action=getConfig&name=MeasureTemperatur
e

Method

GET

Description Get measure temperature setting.

[ Request Params ] ( None )

[ Response Params ] ( key=value format )

Name

table

+MeasureTempe
rature

Type

object

object

++Enable

bool

++MaskOpt

uint

++OnlyTemperat
ureMode

++TemperatureD
isplay

bool

bool

++TemperatureU
nit

uint

R/O

Param Description

R

R

R

R

O

R

O

config table object

MeasureTemperature config object

whether to enable measure temperature function

mask mode
0: don not detect mask
1: mask prompt
2: mask intercept

to enable

whether
monitoring

the single

function,

temperature

whether to show the temperature

temperature unit:{
0: centigrade
1: Fahrenheit
}

++Type

integer

R

++GuideModule
Param

object

+++Threshold

float

+++CalibrationM
odel

uint32

+++Correct

Float

+++DebugModel
Enable

+++HeatDisplay
Enbale

Bool

bool

+++MaxDistance uint32

O

O

O

O

O

O

O

Temperature monitoring method, it can be:
0: Single chip microcomputer
monitoring
1: the thermal imaging principle of temperature monitoring
2: Temperature monitoring module of Guide
3: single point temperature monitoring at wrist

temperature

infrared

param of temperature monitoring module of Guide

the temprerature threshold, unit is ℃
Calibration Model, it can be:
0: indoor mode
1: wall mounting mode
2: Gate mode
3: exclusive floor mode
temperature correct value, unit is ℃
whether
monitoring, show temperature on the top of face

tou enable debug mode of

temperature

whether to show heat

the max distance for temperature monitoring, unit: cm

Access Control APIs 529

+++ProjectDebu
gModel

bool

+++RectEnable

Bool

+++TempRandR
eplaceThreshold

Float

+++ValidTemper
atureLowerLimit

++InfraredTemp
eratureParam

+++Correct

+++DebugModel
Enable

float

object

float

bool

+++MaxDistance Uint32

+++OverTemper
atureMaxDistanc
e

Uint32

+++RectEnable

bool

+++RetentionTi
me

Uint32

+++SensorType

string

+++Threshold

Uint32

+++ValidTemper
atureLowerLimit

++ThermalImagi
ngParam

+++RetentionTi
me

Flaot

object

Uint32

+++Threshold

Uint32

++WristTempera
tureParam

Object

+++Correct

Float

+++InvalidTemp
eratureDistance

+++Temperature
Timeout

Uint32

Uint32

+++Threshold

Float

+++ValidTemper
atureDistance

Uint32

+++ValidTemper

flaot

O

O

O

O

O

O

O

O

O

O

O

O

O

O

O

O

O

O

O

O

O

O

O

O

whether to enable project debug mode

whether to show the rectangle of temperature monitoring
area on the video.

the threshold under which the temperature value will be
replaced with valid one. When threshold value is 0, the
function won’t work.

the lower limit of valid temperature value

param of infrared temperature monitoring

temperature correct value, unit is ℃
whether
monitoring, show temperature on the top of face

tou enable debug mode of

temperature

the max distance for temperature monitoring, unit: cm

Maximum distance for reporting high temperature events,
In this distance, the high temperature was measured and
reported directly. Beyond
the high
temperature was measured, it will indicates closing to the
point, and then measured again (CM)

this distance,

whether to show the rectangle of temperature monitoring
area on the video.

temperature retention Time, unit: ms

sensor type in temperature monitoring module
"90641"，
"90640"
temperature threshold, unit : ℃

the lower limit of valid temperature value

param of thermallmaging

temperature retention Time, unit: ms

temperature threshold, unit : ℃

param of wrist temperature monitoring

temperature correct value, unit is ℃

invalid temperature monitoring distance

timeout of temperature monitoring, unit: s

temperature threshold, unit : ℃

valid temperature monitoring distance,

the lower limit of valid temperature value

Access Control APIs 530

atureLowerLimit

[ Example ]

Request

http://10.0.0.8/cgi-bin/configManager.cgi?action=getConfig&name= MeasureTemperature

Respons
e

table.MeasureTemperature.Enable=true
table.MeasureTemperature.GuideModuleParam.CalibrationModel=1
table.MeasureTemperature.GuideModuleParam.Correct=0
table.MeasureTemperature.GuideModuleParam.DebugModelEnable=false
table.MeasureTemperature.GuideModuleParam.HeatDisplayEnbale=false
table.MeasureTemperature.GuideModuleParam.MaxDistance=0
table.MeasureTemperature.GuideModuleParam.ProjectDebugModel=false
table.MeasureTemperature.GuideModuleParam.RectEnable=true
table.MeasureTemperature.GuideModuleParam.TempRandReplaceThreshold=0
table.MeasureTemperature.GuideModuleParam.Threshold=37.300000
table.MeasureTemperature.GuideModuleParam.ValidTemperatureLowerLimit=30
table.MeasureTemperature.InfraredTemperatureParam.Correct=0
table.MeasureTemperature.InfraredTemperatureParam.DebugModelEnable=false
table.MeasureTemperature.InfraredTemperatureParam.MaxDistance=100
table.MeasureTemperature.InfraredTemperatureParam.OverTemperatureMaxDistance=100
table.MeasureTemperature.InfraredTemperatureParam.RectEnable=true
table.MeasureTemperature.InfraredTemperatureParam.RetentionTime=500
table.MeasureTemperature.InfraredTemperatureParam.SensorType=
table.MeasureTemperature.InfraredTemperatureParam.Threshold=37.300000
table.MeasureTemperature.InfraredTemperatureParam.ValidTemperatureLowerLimit=30
table.MeasureTemperature.MaskOpt=0
table.MeasureTemperature.OnlyTemperatureMode=false
table.MeasureTemperature.TemperatureDisplay=true
table.MeasureTemperature.TemperatureUnit=0
table.MeasureTemperature.ThermalImagingParam.RetentionTime=30
table.MeasureTemperature.ThermalImagingParam.Threshold=60
table.MeasureTemperature.Type=3
table.MeasureTemperature.WristTemperatureParam.Correct=0
table.MeasureTemperature.WristTemperatureParam.InvalidTemperatureDistance=24
table.MeasureTemperature.WristTemperatureParam.TemperatureTimeout=10
table.MeasureTemperature.WristTemperatureParam.Threshold=37.300000
table.MeasureTemperature.WristTemperatureParam.ValidTemperatureDistance=5
table.MeasureTemperature.WristTemperatureParam.ValidTemperatureLowerLimit=35
…

 Set measure temperature setting

Table 12-20

URL

http://<server>/cgi-bin/configManager.cgi?action=setConfig

Method

GET

Descripti
on

Set measure temperature setting.

[ Request Params ] ( key=value format at URL )

Name

Type

R/O Param Description

Access Control APIs 531

MeasureTemper
ature

+Name

object

string

…<other param> —

[ Response Params ] ( OK )

R

O

—

The measure temperature config object

The measure temperature name

…<See above getConfig command for other params of the
config object, They are all optional.>

[ Example ]

Request

http://10.0.0.8/cgi-bin/configManager.cgi?action=setConfig&MeasureTemperature.Enable=t
rue&MeasureTemperature.GuideModuleParam.Threshold=38.5&MeasureTemperature.Mas
kOpt=2

Respons
e

OK

12.1.19 [Config] CitizenPictureCompare Setting

 Get citizen picture compare setting

URL

http://<server>/cgi-bin/configManager.cgi?action=getConfig&name=CitizenPictureCompa
re

Table 12-21

Method

GET

Description Get citizen picture compare setting

[ Request Params ] ( None )

[ Response Params ] ( key=value format )

Name

table

+CitizenPictureCom
pare

Type

object

object

++Threshold

uint8

++UnlockEnable

bool

++FuncEnable

++CitizenIDCheck

bool

bool

++SysMode

string

[ Example ]

R/O

Param Description

R

R

R

R

O

O

O

config table object

CitizenPictureCompare config object

threshold of citizen picture compare, range [1, 100]

whether enable unlock
if false, it won’t unlock, when citizen picture compare
succeed.

whether to enable citizen picture comparison

is citizen ID check supported

device work mode, it can be:
{
"CitizenIDCheck", "Other" }

"FaceCollect"

,

"VisitorVerify",

"CitizenCompare",

Request

http://10.0.0.8/cgi-bin/configManager.cgi?action=getConfig&name= CitizenPictureCompare

Respons
e

table.CitizenPictureCompare.SysMode=CitizenCompare
table.CitizenPictureCompare.Threshold=50
table.CitizenPictureCompare.UnlockEnable=false
table.CitizenPictureCompare.FuncEnable=false
table.CitizenPictureCompare.CitizenIDCheck=false
…

 Set citizen picture compare setting

Access Control APIs 532

URL

http://<server>/cgi-bin/configManager.cgi?action=setConfig

Table 12-22

Method

GET

Descripti
on

Set citizen picture compare setting

[ Request Params ] ( key=value format at URL )

Name

CitizenPictureCo
mpare

Type

object

R/O Param Description

R

CitizenPictureCompare config object

…<other param> —

—

…<See above getConfig command for other params of the
config object, They are all optional.>

[ Response Params ] ( OK )

[ Example ]

Request

http://10.0.0.8/cgi-bin/configManager.cgi?action=setConfig&CitizenPictureCompare.SysMo
de= CitizenIDCheck&CitizenPictureCompare.Threshold=80&CitizenPictureCompare.Unloc
kEnable=true&CitizenPictureCompare.FuncEnable=true&CitizenPictureCompare.CitizenID
Check=true

Respons
e

OK

12.2 Access Control Manager

12.2.1 Get Access Control Capability

URL

http://<server>/cgi-bin/accessControlManager.cgi?action=getCaps

Table 12-23

Method

GET

Description Get access control capabilities.

[ Request Params ] ( none )

[ Response Params ] ( key=value )

caps

object

+AccessControl
Channels

+AccessControl
AlarmRecord

+CustomPasswo
rdEncryption

+SupportFinger
Print

+OnlySingleDoo
rAuth

int

bool

int

int

int

R

R

O

O

O

O

The access control capabilities.

The access control channel number.

Support log access control alarm record or not. ( This param is
not supported by video talk device )

The custom password crypt type, 0 : plain text, 1 : MD5

Support fingerprint type, 0 : unknown, 1 : not support, 2 :
support

Support single door auth type, 0 : not support, 1 : support,
( This param is not used by video talk device )

Access Control APIs 533

+AsynAuth

int

+SpecialDaysSc
hedule

object

++Support

bool

++MaxSpecialD
aysSchedules

++MaxTimePeri
odsPerDay

++MaxSpecialD
ayGroups

++MaxDaysInSp
ecialDayGroup

[ Example ]

uint

uint

uint

uint

O

O

O

O

O

O

O

Support async auth type, 0 : not support, 1 : support, ( This
param is not supported by video talk device )

Special days schedule capabilities, ( This param is not
supported by video talk device )

Support special days schedule or not. ( This param is not
supported by video talk device )

Max special days schedule number. ( This param is not
supported by video talk device )

Max time periods per day. ( This param is not supported by
video talk device )

Max special day groups. ( This param is not supported by video
talk device )

Max special days in special day group. ( This param is not
supported by video talk device )

Request

http://192.168.1.108/cgi-bin/accessControlManager.cgi?action=getCaps

Response

caps.AccessControlChannels=3
caps.AccessControlAlarmRecord=true
caps.CustomPasswordEncryption=1
caps.SupportFingerPrint=1
caps.OnlySingleDoorAuth=1
caps.AsynAuth=1
caps.SpecialDaysSchedule.Support=true
caps.SpecialDaysSchedule.MaxSpecialDaysSchedules=5
caps.SpecialDaysSchedule.MaxTimePeriodsPerDay=5
caps.SpecialDaysSchedule.MaxSpecialDayGroups=5
caps.SpecialDaysSchedule.MaxDaysInSpecialDayGroup=5

12.2.2 Add SubController

Syntax

http://<server>/cgi-bin/accessControlManager.cgi?action=addDevice&devAddr=<devA
ddr>&name=<name>

Table 12-24

Method

GET

Description

Add SubController.

Example

Success
Return

Comment

http://192.168.1.108/cgi-bin/accessControlManager.cgi?action=addDevice&devAddr=1
&name=Sub1

FaiedCode=0

Params in URL:

devAddr: SubController ID, range is [1...255]

name: SubController Name

Params in Response:

Access Control APIs 534

FaiedCode: 0-Success; 1-Already exists; 2-Reach quantity limit; 3-Other reason

12.2.3 Modify SubController

Syntax

http://<server>/cgi-bin/accessControlManager.cgi?action=modifyDevice&devAddr=<de
vAddr>&name=<name>

Table 12-25

Method

GET

Description

Modify SubController.

Example

Success
Return

Comment

http://192.168.1.108/cgi-bin/accessControlManager.cgi?action=modifyDevice&devAddr
=1&name=Sub11

OK

Params in URL:

devAddr: SubController ID, range is [1...255]

name: SubController Name

12.2.4 Remove SubController

Syntax

http://<server>/cgi-bin/accessControlManager.cgi?action=removeDevice&devAddrs[0]=
<devAddr0>[& devAddrs[1]=<devAddr1>&...&devAddrs[n]=<devAddrn>]

Table 12-26

Method

GET

Description

Remove SubController.

Example

Success
Return

http://192.168.1.108/cgi-bin/accessControlManager.cgi?action=removeDevice&devAdd
rs[0]=4&devAddrs[1]=5

devInfo[0].DevAddr=4
devInfo[0].FaiedCode=0
devInfo[1].DevAddr=5
devInfo[1].FaiedCode=1

Comment

Params in URL:

devAddr0...devAddrn: SubController ID, range is [1...255]

Params in Response:

DevAddr: the removed SubController ID

FaiedCode: 0-Success; 1-Fail; 2-Other

12.2.5 Get SubController Info

Table 12-27

Access Control APIs 535

Syntax

http://<server>/cgi-bin/accessControlManager.cgi?action=getSubControllerInfo&devAd
drs[0]=<devAddr0>[& devAddrs[1]=<devAddr1>&...&devAddrs[n]=<devAddrn>]

Method

GET

Description

Get SubController Info.

Example

Success
Return

http://192.168.1.108/cgi-bin/accessControlManager.cgi?action=getSubControllerInfo&d
evAddrs[0]=4&devAddrs[1]=5

devInfo[0].DevAddr=4
devInfo[0].Name=Sub4
devInfo[0].AccessProperty=unidirect
devInfo[0].DeviceType=ACS-1202B-S
devInfo[0].VerSion=V1.00428
devInfo[0].DoorToReadID[0].Door=0
devInfo[0].DoorToReadID[0].ReaderID[0]=1
devInfo[0].DoorToReadID[0].ReaderID[1]=2
devInfo[0].DoorToReadID[1].Door=1
devInfo[0].DoorToReadID[1].ReaderID[0]=3
devInfo[0].DoorToReadID[1].ReaderID[1]=4
devInfo[1].DevAddr=5
devInfo[1].Name=Sub5
devInfo[1].AccessProperty=bidirect
devInfo[1].DeviceType=ACS-1202B-S
devInfo[1].VerSion=V1.00428
devInfo[1].DoorToReadID[0].Door=0
devInfo[1].DoorToReadID[0].ReaderID[0]=11
devInfo[1].DoorToReadID[0].ReaderID[1]=12

Comment

Params in URL:

devAddr0...devAddrn: SubController ID, range is [1...255]

Params in Response:

DevAddr: SubController ID, range is [1...255]

AccessProperty: range is [unidirect, bidirect]

DoorToReadID: ReaderID used by the door

12.2.6 Get SubController States

Table 12-28

Syntax

http://<server>/cgi-bin/accessControlManager.cgi?action=getSubControllerStates&dev
Addrs[0]=<devAddr0>[& devAddrs[1]=<devAddr1>&...&devAddrs[n]=<devAddrn>]

Method

GET

Description

Get SubController States.

Example

http://192.168.1.108/cgi-bin/accessControlManager.cgi?action=getSubControllerStates
&devAddrs[0]=4&devAddrs[1]=5

Success
Return

devStates[0].DevAddr=4
devStates[0].State=0

Access Control APIs 536

devStates[1].DevAddr=5
devStates[1].State=1

Comment

Params in URL:

devAddr0...devAddrn: SubController ID, range is [1...255]

Params in Response:

DevAddr: SubController ID, range is [1...255]

State: 0-Offline; 1-Online; 2-Other

12.2.7 Set RepeatEnter Route

Table 12-29

Syntax

http://<server>/cgi-bin/accessControlManager.cgi?action=setRepeatEnterRoute&index
=<index>&routeInfo.PointInfo[x0].ReaderID[0]=<ReadID0>&routeInfo.PointInfo[x0].Re
aderID[1]=<ReadID1>[&routeInfo.PointInfo[x1].ReaderID[0]=<ReadID0>&routeInfo.Poi
ntInfo[x1].ReaderID[1]=<ReadID1>]&routeInfo.TimeSections=<TimeIndex>&routeInfo.
Flag=<Flag>&routeInfo.Name=<Name>

Method

GET

Description

Set RepeatEnter Route.

Example

Success
Return

Comment

http://192.168.1.108/cgi-bin/accessControlManager.cgi?action=setRepeatEnterRoute&i
ndex=0&routeInfo.PointInfo[0].ReaderID[0]=11&routeInfo.PointInfo[0].ReaderID[1]=22&
routeInfo.PointInfo[1].ReaderID[0]=33&routeInfo.PointInfo[1].ReaderID[1]=44&routeInf
o.TimeSections=1&routeInfo.Flag=1&routeInfo.Name=123

OK

Params in URL:

index: route index

x0,x1: PointInfo index

TimeIndex: subscript of AccessTimeSchedule

Flag: 0-Disable this route; 1-Enable this route

Name: route name

12.2.8 Get RepeatEnter Route

Syntax

http://<server>/cgi-bin/accessControlManager.cgi?action=getRepeatEnterRoute&index
=<index>

Table 12-30

Method

GET

Description

Get RepeatEnter Route.

Example

http://192.168.1.108/cgi-bin/accessControlManager.cgi?action=getRepeatEnterRoute&i
ndex=0

Access Control APIs 537

Success
Return

Comment

routeInfo.PointInfo[0].ReaderID[0]=11
routeInfo.PointInfo[0].ReaderID[1]=22
routeInfo.PointInfo[1].ReaderID[0]=33
routeInfo.PointInfo[1].ReaderID[1]=44
routeInfo.TimeSections=1
routeInfo.Flag=1
routeInfo.Name=123

Params in URL:

index: route index

Params in Response:

PointInfo: is an array, stands for points in route

TimeSections: subscript of AccessTimeSchedule

Flag: 0-Disable this route; 1-Enable this route

Name: route name

12.2.9 Set ABLock Route

Table 12-31

Syntax

http://<server>/cgi-bin/accessControlManager.cgi?action=setABLockRoute&index=<in
dex>&routeInfo.PointInfo[x0].Doors[0]=<DoorID0>&routeInfo.PointInfo[x0].Doors[1]=<
DoorID1>[&routeInfo.PointInfo[x1].Doors[0]=<DoorID0>&routeInfo.PointInfo[x1].Doors
[1]=<DoorID1>]&routeInfo.TimeSections=<TimeIndex>&routeInfo.Flag=<Flag>&routeI
nfo.Name=<Name>

Method

GET

Description

Set ABLock Route.

Example

Success
Return

Comment

http://192.168.1.108/cgi-bin/accessControlManager.cgi?action=setABLockRoute&index
=0&routeInfo.PointInfo[0].Doors[0]=11&routeInfo.PointInfo[0].Doors[1]=22&routeInfo.P
ointInfo[1].Doors[0]=33&routeInfo.PointInfo[1].Doors[1]=44&routeInfo.TimeSections=1
&routeInfo.Flag=1&routeInfo.Name=123

OK

Params in URL:

index: route index

x0,x1: PointInfo index

TimeIndex: subscript of AccessTimeSchedule

Flag: 0-Disable this route; 1-Enable this route

Name: route name

Access Control APIs 538

12.2.10 Get ABLock Route

Syntax

http://<server>/cgi-bin/accessControlManager.cgi?action=getABLockRoute&index=<in
dex>

Table 12-32

Method

GET

Description

Get ABLock Route.

Example

Success
Return

Comment

http://192.168.1.108/cgi-bin/accessControlManager.cgi?action=getABLockRoute&index
=0

routeInfo.PointInfo[0].Doors[0]=11
routeInfo.PointInfo[0].Doors [1]=22
routeInfo.PointInfo[1].Doors [0]=33
routeInfo.PointInfo[1].Doors [1]=44
routeInfo.TimeSections=1
routeInfo.Flag=1
routeInfo.Name=123

Params in URL:

index: route index

Params in Response:

PointInfo: is an array, stands for points in route

TimeSections: subscript of AccessTimeSchedule

Flag: 0-Disable this route; 1-Enable this route

Name: route name

12.2.11 Get Log Status

Syntax

http://<server>/cgi-bin/accessControlManager.cgi?action=getLogStatus&devAddr=<de
vAddr>

Table 12-33

Method

GET

Description

Get Log Status.

Example

Success
Return

Comment

http://192.168.1.108/cgi-bin/accessControlManager.cgi?action=getLogStatus&devAddr
=1

OK

Params in URL:

devAddr: SubController ID, range is [1...255]

Access Control APIs 539

12.2.12 Sync Offline Log

Syntax

http://<server>/cgi-bin/accessControlManager.cgi?action=syncOfflineLog&devAddr=<d
evAddr>

Table 12-34

Method

GET

Description

Sync Offline Log.

Example

Success
Return

Comment

http://192.168.1.108/cgi-bin/accessControlManager.cgi?action=syncOfflineLog&devAd
dr=1

OK

Params in URL:

devAddr: SubController ID, range is [1...255]

12.2.13 Sync SubController Time

Table 12-35

Syntax

http://<server>/cgi-bin/accessControlManager.cgi?action=syncSubControllerTime&dev
Addrs[0]=<devAddr0>[& devAddrs[1]=<devAddr1>&...&devAddrs[n]=<devAddrn>]

Method

GET

Description

Sync SubController Time.

Example

Success
Return

Comment

http://192.168.1.108/cgi-bin/accessControlManager.cgi?action=syncSubControllerTime
&devAddrs[0]=4&devAddrs[1]=5

errorDevAddrs[0]=4

Params in URL:

devAddr0...devAddrn: SubController ID, range is [1...255]

Params in Response:

errorDevAddrs: is an array, stands for DevAddr which failed in sync time

Access Control APIs 540

12.3 Access User Account ( V1 )

12.3.1 Add Access User Face

Table 12-36

URL

Method

http://<server>/cgi-bin/FaceInfoManager.cgi?action=add

POST

Description

Add an access user face.

[ Request Params ] ( JSON format in body )

Name

UserID

Info

+UserName

Type

string

object

string

R/O Param Description

R

R

O

The user's id.

The user's info.

The user's name.

+RoomNo

array<string> O

+FaceData

array<string> O

+PhotoData

array<string> O

The user's room num list, max array size is 32, max string
size is 12. ( This param is not supported by access control. )

The user's face feature, encode with base64, max array size
is 20, and max string size is 2k.
Note: There must be at least one between FaceData and
PhotoData.

The user's face photo, encode with base64, max array size is
5, and max string size is 200k.
Note: There must be at least one between FaceData and
PhotoData.

[ Response Params ] (JSON format in body )

[ Example ]

POST http://<server>/cgi-bin/FaceInfoManager.cgi?action=add
Content-Type: application/json
Content-Length: <length>

Request

{ "UserID": "102",
"Info": {
"UserName": "ZhangSan",
"RoomNo": [ "301", "303", … ],
"FaceData": [ "xxxx", "xxxx", … ],
"PhotoData": [ "yyyy", "yyyy", … ]
}
}

Response

{}

12.3.2 Modify Access User Face

URL

http://<server>/cgi-bin/FaceInfoManager.cgi?action=update

Table 12-37

Access Control APIs 541

Method

POST

Description Update an access user face.

[ Request Params ] ( JSON format in body )

Name

UserID

Info

Type

string

object

+UserName

string

+RoomNo

array<string>

R

R

O

O

R/O Param Description

+FaceData

array<string>

O

+PhotoData

array<string>

O

The user's id.

The user's info.

The user's name.

The user's room num list, max array size is 32, max string
size is 12. ( This param is not supported by access control. )

The user's face feature, encode with base64, max array size
is 20, and max string size is 2k.
Note: There must be at least one between FaceData and
PhotoData.

The user's face photo, encode with base64, max array size is
5, max string size is 200k.
Note: There must be at least one between FaceData and
PhotoData.

[ Response Params ] ( JSON format in body)

[ Example ]

POST http://<server>/cgi-bin/FaceInfoManager.cgi?action=update
Content-Type: application/json
Content-Length: <length>

Request

{ "UserID": "102",
"Info": {
"UserName": "ZhangSan",
"RoomNo": ["301", "303", …],
"FaceData": ["xxxx", "xxxx", …],
"PhotoData": ["yyyy", "yyyy", …]
}
}

Response

{}

12.3.3 Delete Access User Face

URL

http://<server>/cgi-bin/FaceInfoManager.cgi?action=remove

Table 12-38

Method

GET

Description Delete an access user face.

[ Request Params ] ( key=value format in URL )

Name

UserID

Type

string

R/O

Param Description

R

The user's id.

[ Response Params ] ( OK )

[ Example ]

Request

GET http://<server>/cgi-bin/FaceInfoManager.cgi?action=remove&UserID=102

Access Control APIs 542

Response

OK

12.3.4 Find Access User Face

 Start to find access user face

URL

http://<server>/cgi-bin/FaceInfoManager.cgi?action=startFind

Table 12-39

Method

GET

Descripti
on

Start to find access user face.

[ Request Params ] ( key=value format in URL )

Name

Condition

+UserID

Type

object

string

R/O Param Description

O

O

Search condition.

The user's id.

[ Response Params ] ( JSON format )

Name

Token

Total

[ Example ]

Type

R/O Param Description

int

int

O

O

The token of this search, use this token to get result and stop
search.

Result num, return 0 if not found.

Request

GET http://<server>/cgi-bin/FaceInfoManager.cgi?action=startFind

Response

{ "Token": 1234,
"Total": 20
}

 Get the find result

URL

http://<server>/cgi-bin/FaceInfoManager.cgi?action=doFind

Table 12-40

Method

GET

Descripti
on

Get the find result.

[ Request Params ] ( key=value format in URL )

Name

Token

Offset

Count

Type

R/O Param Description

int

int

int

R

R

R

The token of this search, use this token to get result and stop
search.

Offset in the result record set, range is [0, Total – 1].

Count of result to get.

[ Response Params ] ( JSON format )

Type

R/O Param Description

Name

Info

array<object>

+UserID

string

+MD5

array<string>

[ Example ]

R

R

O

The face information of user.

The user's id.

The user's face photo's MD5 hash string, max array size is 5,
max string size is 33.

Access Control APIs 543

Request

GET
http://<server>/cgi-bin/FaceInfoManager.cgi?action=doFind&Token=1234&Offset=0&Coun
t=20

Response

{ "Info": [ {
"UserID": "102",
"MD5": [ "xxxx", "xxxx", … ]
}, { … }, … ]
}

 Stop the find session

Table 12-41

URL

Method

http://<server>/cgi-bin/FaceInfoManager.cgi?action=stopFind

GET

Description

Stop the find session.

[ Request Params ] ( key=value format in URL )

Name

Token

Type

R/O

Param Description

int

R

Token for this search, use this token to get result and stop
search.

[ Response Params ] ( OK )

[ Example ]

Request

GET http://<server>/cgi-bin/FaceInfoManager.cgi?action=stopFind&Token=1234

Response

OK

12.3.5 Add Access User Card and Fingerprint

 Add Access user card only

URL

http://<server>/cgi-bin/recordUpdater.cgi?action=insert&name=AccessControlCard

Table 12-42

Method

GET

Description

Insert access user card info.

[ Request Params ] ( key=value format in URL )

Name

name

CardName

CardNo

UserID

Type

R/O Param Description

string

string

string

string

R

R

R

R

Access user card and fingerprint record name, should be
"AccessControlCard".

Access user card name, max string length is 32.

Access user card number.

The user's id.

Access Control APIs 544

CardStatus

int

R

CardType

int

Password

string

O

O

Doors

array<int> O

TimeSections

array<int> O

VTOPosition

string

ValidDateStart

ValidDateEnd

IsValid

string

string

bool

O

O

O

O

Card status, 0 means normal, and abnormal status can be sum
of following:













1 << 0: report the loss of the card
1 << 1: the card is withdrawed
1 << 2: the card is frozen
1 << 3: the card is arrearage
1 << 4: the card exceeds the time limit
1 << 5: the card is arrearage but still can open the door, and
there will be voice prompts.

The card type:
0 : Normal Card, 1: VIP Card, 2: Visitor Card, 3: Patrol Card, 4:
Blocklist Card, 5: Stress Card, 0xff: Mother Card

The Access card's password. ( This param is not supported by
video talk device )

The index of the doors that this card can open. ( This param is
not supported by video talk device )

The index of the time sections of each door that this card can
open. ( This param is not supported by video talk device )

VTO position number. ( This param is not supported by access
control device )

The start of valid date, format is "yyyyMMdd hhmmss".

The end of valid date, format is "yyyyMMdd hhmmss".

Is the card still valid. ( This param is not supported by video talk
device )

[ Response Params ] (key=value format)

Name

RecNo

[ Example ]

Type

int

R/
O

R

Param Description

The record id.

Request

GET
http://192.168.1.108/cgi-bin/recordUpdater.cgi?action=insert&name=AccessControlCard&
CardName=ZhangSan&CardNo=12345&UserID=102&CardStatus=0&CardType=0&Pass
word=123456&Doors[0]=1&Doors[1]=3&Doors[2]=5&VTOPosition=01018001&ValidDateS
tart=20151022%20093811&ValidDateEnd=20151222%20093811

Response RecNo=12345

 Add access user card with fingerprint

Add access user card with fingerprint. If add only access user card, please use :
http://<server>/cgi-bin/recordUpdater.cgi?action=insert&name=AccessControlCard

Table 12-43

URL

http://<server>/cgi-bin/recordUpdater.cgi?action=insertEx&name=AccessControlCard

Method

POST

Description

Insert access user card and fingerprint. ( This api is not supported by video talk device )

[ Request Params ] ( key=value format in URL )

Name

Type

R/O Param Description

Access Control APIs 545

name

CardName

CardNo

UserID

string

string

string

string

R

O

O

R

CardStatus

int

O

CardType

int

O

Access user card and fingerprint record name, should be
"AccessControlCard".

Access user card name, max string length is 32.

Access user card number.

The user's id.

Card status, 0 means normal, and abnormal status can be sum
of following:













1 << 0: report the loss of the card
1 << 1: the card is withdrawed
1 << 2: the card is frozen
1 << 3: the card is arrearage
1 << 4: the card exceeds the time limit
1 << 5: the card is arrearage but still can open the door,
and there will be voice prompts.

The card type:
0: Normal Card, 1: VIP Card, 2: Visitor Card, 3: Patrol Card, 4:
Blocklist Card, 5: Stress Card, 0xff: Mother Card

Password

string

O

The Access card's password.

Doors

array<int> O

The index of the doors that this card can open.

TimeSections

array<int> O

VTOPosition

string

ValidDateStart

ValidDateEnd

IsValid

FingerprintPack
et

+Length

+Count

string

string

bool

object

int

int

O

O

O

O

O

O

O

The index of the time sections of each door that this card can
open.

VTO position number. ( This param is not supported by access
control device )

The start of valid date, format is "yyyyMMdd hhmmss".

The end of valid date, format is "yyyyMMdd hhmmss".

Is the card still valid.

The fingerprint packet info.

The length of each fingerprint packet.

The count of fingerprint packet.

[ Response Params ] (key=value format)

Name

RecNo

[ Example ]

Request

Type

int

R/
O

R

Param Description

The record id.

POST
http://192.168.1.108/cgi-bin/recordUpdater.cgi?action=insertEx&name=AccessControlCar
d&CardName=ZhangSan&CardNo=12345&UserID=102&CardStatus=0&Password=1234
56&Doors[0]=1&Doors[1]=3&Doors[2]=5&VTOPosition=01018001&ValidDateStart=20151
022%20093811&ValidDateEnd=20151222%20093811&FingerprintPacket.Length=500&Fi
ngerprintPacket.Count=3
Content-Type: application/octet-stream
Content-Length: <length>

<fingerprint packet binary data>

Response RecNo=12345

Access Control APIs 546

12.3.6 Modify Access User Card and Fingerprint

 Update Access user card only

Table 12-44

URL

Method

Description

http://<server>/cgi-bin/recordUpdater.cgi?action=update&name=AccessControlCard

GET

Update access user card info.
Note: You should provide at lease one optional param to update.

[ Request Params ] ( key=value format in URL )

Type

R/O

Param Description

Name

name

recno

CardName

CardNo

UserID

string

…<other param> —

—

[ Response Params ] ( OK )

[ Example ]

string

int

string

string

R

R

O

O

O

Access user card and fingerprint record name, should be
"AccessControlCard".

The record id.

Access user card name, max string length is 31.

Access user card number.
Primary key, modification is not allowed in principle

The user's id.
Primary key, modification is not allowed in principle

…<See above insert command for other params of the record,
They are all optional.>

Request

GET
http://192.168.1.108/cgi-bin/recordUpdater.cgi?action=update&name=AccessControlCar
d&recno=12345&CardName=ZhangSan&CardNo=12345&UserID=102&CardStatus=0&
CardType=0&Password=123456&Doors[0]=1&Doors[1]=3&Doors[2]=5&ValidDateStart=
20151022%20093811&ValidDateEnd=20151222%20093811

Response

OK

 Update access user card and fingerprint

Table 12-45

URL

http://<server>/cgi-bin/recordUpdater.cgi?action=updateEx&name=AccessControlCard

Method

POST

Description

Update access user card info and fingerprint. ( This api is not supported by video talk
device )
Note: You should provide at lease one optional param to update.

[ Request Params ] ( key=value format in URL )

Name

name

recno

CardName

Type

R/O Param Description

string

int

string

R

R

O

Access user card and fingerprint record name, should be
"AccessControlCard".

The record id.

Access user card name, max string length is 32.

Access Control APIs 547

CardNo

string

UserID

string

…<other param>

FingerprintPack
et

+Length

+Count

object

int

int

[ Response Params ] ( OK )

[ Example ]

O

O

O

O

O

Access user card number.
Primary key, modification is not allowed in principle

The user's id.
Primary key, modification is not allowed in principle

…<See above insert command for other params of the record.
They are all optional.>

The fingerprint packet info.

The length of each fingerprint packet.

The count of fingerprint packet.

POST
http://192.168.1.108/cgi-bin/recordUpdater.cgi?action=updateEx&name=AccessControlC
ard&recno=12345&CardName=ZhangSan&CardNo=12345&UserID=102&CardStatus=0
&CardType=0&Password=123456&Doors[0]=1&Doors[1]=3&Doors[2]=5&ValidDateStart
=20151022%20093811&ValidDateEnd=20151222%20093811&FingerprintPacket.Length
=500&FingerprintPacket.Count=3
Content-Type: application/octet-stream
Content-Length: <length>

Request

<fingerprint packet binary data>

Response

OK

12.3.7 Delete Access User Card and Fingerprint

 Delete Access user card and fingerprint record by recno

Table 12-46

URL

http://<server>/cgi-bin/recordUpdater.cgi?action=remove&name=AccessControlCard

Method

GET

Descriptio
n

Remove the access user card and fingerprint record. ( The video talk device can not delete
fingerprint data.)

[ Request Params ] ( key=value format in URL )

Name

name

recno

Type

R/O

Param Description

string

int

R

R

Access user card and fingerprint record name, should be
"AccessControlCard".

The record id.

[ Response Params ] ( OK )

[ Example ]

Request

GET
http://192.168.1.108/cgi-bin/recordUpdater.cgi?action=remove&name=AccessControlCar
d&recno=12345

Response

OK

 Delete all Access user card and fingerprint records

Access Control APIs 548

Table 12-47

URL

http://<server>/cgi-bin/recordUpdater.cgi?action=clear&name=AccessControlCard

Method

GET

Descriptio
n

Remove all the access user card and fingerprint records. ( The video talk device can not
delete fingerprint data.)

[ Request Params ] ( key=value format in URL )

Name

name

Type

R/O

Param Description

string

R

Access user card and fingerprint record name, should be
"AccessControlCard".

[ Response Params ] ( OK )

[ Example ]

Request

GET
http://192.168.1.108/cgi-bin/recordUpdater.cgi?action=clear&name=AccessControlCard

Response

OK

12.3.8 Find Access User Card and Fingerprint



Find Access user card by condition

Table 12-48

URL

Method

http://<server>/cgi-bin/recordFinder.cgi?action=find&name=AccessControlCard

GET

Description

Find Access user card record by condition.

[ Request Params ] ( key=value format in URL )

Name

name

count

StartTime

EndTime

condition

+CardNo

+UserID

+IsValid

Type

string

int

string

string

object

string

string

bool

R/O Param Description

R

O

O

O

O

O

O

O

Record Name, should be "AccessControlCard".

Max result to return, default is 1024.

The start of the record's CreateTime.

The End of the record's CreateTime.

Search condition.

Access user card number.

The user's id.

The access card valid or not.

[ Response Params ] (key=value format)

Name

totalCount

found

records

+RecNo

+CreateTime

+CardName

+CardNo

+UserID

Type

int

int

R/O Param Description

O

O

The total record num that find.

The record num that returned.

array<object> R

The records that returned.

int

int

string

string

string

R

O

R

R

R

The record id.

The create time of record.

The access user card name, max string length is 32.

The access user card number.

The user's id.

Access Control APIs 549

+CardStatus

int

R

+CardType

int

+Password

string

+Doors

array<int>

+TimeSections array<int>

+VTOPosition

string

+ValidDateStar
t

string

+ValidDateEnd

string

+IsValid

+Handicap

bool

bool

+CitizenIDNo

string

+RepeatEnter
RouteTimeout

integer

+UserType

integer

+FirstEnter

bool

+DynamicChec
kCode

string

+UseTime

integer

O

O

O

O

O

O

O

O

O

O

O

O

O

O

O

Card status, 0 means normal, and abnormal status can be
sum of following:













1 << 0: report the loss of the card
1 << 1: the card is withdrawed
1 << 2: the card is frozen
1 << 3: the card is arrearage
1 << 4: the card exceeds the time limit
1 << 5: the card is arrearage but still can open the door,
and there will be voice prompts.

The card type:
0: Normal Card, 1: VIP Card, 2: Visitor Card, 3: Patrol Card, 4:
Blocklist Card, 5: Stress Card, 0xff: Mother Card

The Access card's password. ( This param is not supported
by video talk device )

The index of the doors that this card can open. ( This param is
not supported by video talk device )

The index of the time sections of each door that this card can
open. ( This param is not supported by video talk device )

VTO position number. ( This param is not supported by
access control device )

The start of valid date, format is "yyyyMMdd hhmmss".

The end of valid date, format is "yyyyMMdd hhmmss".

Is the card still valid. ( This param is not supported by video
talk device )

is the cad of extend time

citizen card id

timeout of repeater enter route, unit: s

user type, it can be {
1: normal user
2: user in Blocklist
}

is with first enter authority

dynamic check code

count of use

[ Example ]

Request

GET http://192.168.1.108/cgi-bin/recordFinder.cgi?action=find&name=AccessControlCard
&condition.UserID=103&StartTime=123456700&EndTime=123456800&count=100

Access Control APIs 550

Response

totalCount=1000
found=100
records[0].RecNo=12345
records[0].CreateTime=123456789
records[0].CardName=ZhangSan
records[0].CardNo=300
records[0].UserID=103
records[0].CardStatus=0
records[0].CardType=0
records[0].Doors[0]=1
records[0].Doors[1]=3
records[0].Doors[2]=5
records[0].VTOPosition=01018001
records[0].ValidStart=20151022 093811
records[0].ValidEnd=20151222 093811
records[0].IsValid=true
…
records[1].RecNo=13579
records[1].CreateTime=123456799
records[1].StaticsticsTime=123456799
records[1].CardName=ZhangSan
records[1].CardNo=302
records[1].UserID=103
records[1].CardStatus=0
records[1].CardType=0
records[1].Doors[0]=2
records[1].Doors[1]=4
records[1].Doors[2]=6
records[1].VTOPosition=01018002
records[1].ValidStart=20151022 093811
records[1].ValidEnd=20151222 093811
records[1].IsValid=true
…



Find Access user card by recno

Table 12-49

URL

Method

http://<server>/cgi-bin/recordUpdater.cgi?action=get&name=AccessControlCard

GET

Description

Find Access user card record by recno.

[ Request Params ] ( key=value format in URL )

Name

name

recno

Type

string

int

R/O Param Description

R

R

Record Name, should be "AccessControlCard".

The record id.

[ Response Params ] (key=value format)

Name

record

Type

object

R/O

Param Description

R

The record that returned.

Access Control APIs 551

+RecNo

+CreateTime

+CardName

+CardNo

int

int

string

string

string

+UserID
…<other param> —
[ Example ]

R

O

R

R

R
—

The record id.

The create time of record.

The access user card name, max string length is 32.

The access user card number.

The user's id.

…<See above find command for other params of the record.>

Request

GET http://192.168.1.108/cgi-bin/recordUpdater.cgi?action=get&name=AccessControlCar
d&recno=4

Response

record.RecNo=4
record.CreateTime=123456789
record.CardName=ZhangSan
record.CardNo=300
record.UserID=103
record.CardStatus=0
record.CardType=0
record.Doors[0]=1
record.Doors[1]=3
record.Doors[2]=5
record.VTOPosition=01018001
record.ValidStart=20151022 093811
record.ValidEnd=20151222 093811
record.IsValid=true
…



Find Access user card and fingerprint by recno

Table 12-50

URL

Method

Description

http://<server>/cgi-bin/recordUpdater.cgi?action=getEx&name=AccessControlCard

GET

Find Access user card and fingerprint record by recno. ( This api is not supported by
video talk device )

[ Request Params ] ( key=value format in URL )

Name

name

recno

Type

string

int

R/O Param Description

R

R

Record Name, should be "AccessControlCard".

The record id.

[ Response Params ] (key=value format)

Name

record

+RecNo

+CreateTime

+CardName

+CardNo

Type

object

int

int

string

string

+UserID
…<other param> —

string

R/O

Param Description

R

R

O

R

R

R
—

The record that returned.

The record id.

The create time of record.

The access user card name, max string length is 32.

The access user card number.

The user's id.

…<See above find command for other params of the record.>

Access Control APIs 552

+FingerprintPac
ket

object

int

int

O

O

O

The fingerprint packet info.

The length of each fingerprint packet.

The count of fingerprint packet.

++Length

++Count

[ Example ]

Request

Response

GET http://192.168.1.108/cgi-bin/recordUpdater.cgi?action=getEx&name=AccessControl
Card&recno=4

HTTP/1.1 200 OK
Server: Device/1.0
Content-Type: multipart/x-mixed-replace; boundary=<boundary>
Content-Length: <length>

--<boundary>
Content-Type: text/plain
Content-Length: <length>

record.RecNo=4
record.CreateTime=123456789
record.CardName=ZhangSan
record.CardNo=300
record.UserID=103
record.CardStatus=0
record.CardType=0
record.Doors[0]=1
record.Doors[1]=3
record.Doors[2]=5
record.VTOPosition=01018001
record.ValidStart=20151022 093811
record.ValidEnd=20151222 093811
record.IsValid=true
…
record.FingerprintPacket.Length=500
record.FingerprintPacket.Count=3
--<boundary>
Content-Type: application/octet-stream
Content-Length: <length>

<fingerprint packet binary data>
--<boundary>--

12.3.9 Get the Total Number of Records of Access User Card and

Fingerprint

Table 12-51

Access Control APIs 553

URL

http://<server>/cgi-bin/recordFinder.cgi?action=getQuerySize&name=AccessControlCar
d

Method

GET

Description Get the total number of records of the access user card record.

[ Request Params ] ( key=value format in URL )

Name

name

Type

R/O Param Description

string

R

Access user card and fingerprint record name, should be
"AccessControlCard".

[ Response Params ] ( key=value )

count

[ Example ]

Request

int

R

The total number of records.

GET
http://192.168.1.108/cgi-bin/recordFinder.cgi?action=getQuerySize&name=AccessContr
olCard

Response

count=150

12.4 Access User Account ( V2 )

12.4.1 Add Access User



Insert or update multiple new users. Update when the current user exists. This only applies to
the AccessUser entity here.

Table 12-52

URL

Method

http://<server>/cgi-bin/AccessUser.cgi?action=insertMulti

POST

Description

Insert person information.

[ Request Params ] ( JSON format in body )

Name

UserList

+UserID

+UserName

+UserType

+UseTime

+IsFirstEnter

+FirstEnterDoors

+UserStatus

+Authority

+CitizenIDNo

+Password

Type

R/O Param Description

array<object> R

User list, with up to 10 entries

string

string

uint16

uint16

bool

int16[]

uint16

uint8

string

string

R

O

O

O

O

O

O

O

O

O

User ID

User name

0: General user, by default; 1: Blocklist user (report
the blocklist event ACBlocklist); 2: Guest user; 3:
Patrol user; 4: VIP user; 5: Extend time user

Limit of passing times for guest users

First user authority or not. false: No; true: Yes

-1 indicates all channels.

0: Normal; 1: Frozen

User authority (attendance machine field). 1: Admin;
2: General user

ID card number

The password when unlocking by card + password.

Access Control APIs 554

The password when unlocking by User ID +
password

Door authority. The index in the controller is used
with TimeSections, and the value corresponds to the
subscript of the AC configuration.

The door authority corresponds to the period index.
For example, door 3 corresponds to period 2. Each
element corresponds to the door in Doors.

Holiday plan identification. The value is the subscript
number
by SpecialDaysSchedule
(defined in the configuration).

configured

"yyyy-MM-dd HH:mm:ss", start of validity period.
Note: The original "ValidDateStart" is deprecated.

"yyyy-MM-dd HH:mm:ss", end of validity period.
Note: The original "ValidDateEnd" is deprecated.

+Doors

int16[]

O

+TimeSections

uint16[]

O

+SpecialDaysSchedule

uint32[64]

O

+ValidFrom

+ValidTo

string

string

O

O

[ Response Params ] ( OK )

[ Example ]

Request

{
UserList[{
"UserID": "100013",
"UserName": "",
"UserType": 0,
"UseTime": 1,
"IsFirstEnter": true,
"FirstEnterDoors": [0, 1],
"UserStatus": 0,
"Authority": 1,
"CitizenIDNo": "123456789012345678",
"Password": "xxxxxxxxxx",
"Doors": [1,3,5,7],
"TimeSections": [1,2,3,4],
"SpecialDaysSchedule": [1,2],
"ValidFrom": "2018-01-02 00:00:00",
"ValidTo": "2018-01-02 01:00:00",
} ,…,{}]
}

Response

OK

12.4.2 Modify Access User

Update information of multiple users.

URL

Method

http://<server>/cgi-bin/AccessUser.cgi?action=updateMulti

POST

Table 12-53

Access Control APIs 555

Description

Update person information.

[ Request Params ] ( JSON format in body )

Type

R/O

Param Description

array<object> R

User list, with up to 10 entries

Name

UserList

- UserID

+UserName

+UserType

+UseTime

+IsFirstEnter

+FirstEnterDoors

+UserStatus

+Authority

+CitizenIDNo

+Password

string

string

uint16

uint16

bool

int16[]

uint16

uint8

string

string

+Doors

int16[]

+TimeSections

uint16[]

O

+SpecialDaysSchedule uint32[64]

O

+ValidFrom

+ValidTo

string

string

O

O

[ Response Params ] ( OK )

[ Example ]

R

O

O

O

O

O

O

O

O

O

O

User ID

User name

0: General user, by default; 1: Blocklist user (report
the blocklist event ACBlocklist); 2: Guest user; 3:
Patrol user; 4: VIP user; 5: Extend time user

Limit of passing times for guest users

First user authority or not. false: No; true: Yes

-1 indicates all channels.

0: Normal; 1: Frozen

User authority (attendance machine field). 1: Admin;
2: General user

ID card number

The password when unlocking by card + password.
The password when unlocking by User ID + password

Door authority. The index in the controller is used with
TimeSections, and the value corresponds to the
subscript of the AC configuration.

The door authority corresponds to the period index.
For example, door 3 corresponds to period 2. Each
element corresponds to the door in Doors.

Holiday plan identification. The value is the subscript
number configured by SpecialDaysSchedule (defined
in the configuration).

"yyyy-MM-dd HH:mm:ss", start of validity period.
Note: The original "ValidDateStart" is deprecated.

"yyyy-MM-dd HH:mm:ss", end of validity period. Note:
The original "ValidDateEnd" is deprecated.

Request

{
UserList[{
"UserID": "100013",
"UserName": "",
"UserType": 0,
"UseTime": 1,
"IsFirstEnter": true,
"FirstEnterDoors": [0, 1],
"UserStatus": 0,
"Authority": 1,
"CitizenIDNo": "123456789012345678",
"Password": "xxxxxxxxxx",

Access Control APIs 556

"Doors": [1,3,5,7],
"TimeSections": [1,2,3,4],
"SpecialDaysSchedule": [1,2],
"ValidFrom": "2018-01-02 00:00:00",
"ValidTo": "2018-01-02 01:00:00",

} ,…,{}]

}

Response

OK

12.4.3 Delete All Access User

Delete all user information.

Table 12-54

URL

Method

http://<server>/cgi-bin/AccessUser.cgi?action=removeAll

GET

Description

Clear information of all persons.

[ Request Params ] ( key=value format at URL )

Name

Type

R/O

Param Description

[ Response Params ] ( OK )

[ Example ]

Request

http://192.168.1.108/cgi-bin/AccessUser.cgi?action=removeAll

Response

OK

12.4.4 Delete Multiple Access Users

Delete information of multiple users.

Table 12-55

URL

Method

http://<server>/cgi-bin/AccessUser.cgi?action=removeMulti

GET

Description

Delete user data.

[ Request Params ] ( key=value format at URL )

Name

UserIDList

[ Response Params ] ( OK )

Type

R/O

Param Description

array<string>

R

User ID list, with up to 10 entries

[ Example ]

Request

Respons
e

http://192.168.1.108/cgi-bin/AccessUser.cgi?action=removeMulti&UserIDList[0]=102&UserI
DList [1]=102

OK

Access Control APIs 557

12.4.5 Find Multiple Access Users

Search for information of multiple users.

Table 12-56

URL

Method

http://<server>/cgi-bin/AccessUser.cgi?action=list

GET

Description

Search for user data.

[ Request Params ] ( key=value format at URL )

Type

R/O Param Description

array<string> R

User ID list, with up to 10 entries

array<object> R

The records that returned

Name

UserIDList

[ Response Params ]

Users

- UserID

+UserName

+UserType

+UseTime

+IsFirstEnter

+FirstEnterDoors

+UserStatus

+Authority

+CitizenIDNo

+Password

string

string

uint16

uint16

bool

int16[]

uint16

uint8

string

string

+Doors

int16[]

+TimeSections

uint16[]

R

O

O

O

O

O

O

O

O

O

O

O

User ID

User name

0: General user, by default; 1: Blocklist user (report
the blocklist event ACBlocklist); 2: Guest user; 3:
Patrol user; 4: VIP user; 5: Extend time user

Limit of passing times for guest users

First user authority or not. false: No; true: Yes

-1 indicates all channels

0: Normal; 1: Frozen

User authority (attendance machine field). 1: Admin;
2: General user

ID card number

The password when unlocking by card + password.
The password when unlocking by UserID +
password

Door authority. The index in the controller is used
with TimeSections, and the value corresponds to the
subscript of the AC configuration.

The door authority corresponds to the period index.
For example, door 3 corresponds to period 2. Each
element corresponds to the door in Doors.

Holiday plan identification. The value is the subscript
number configured by SpecialDaysSchedule
(defined in the configuration).

"yyyy-MM-dd HH:mm:ss", start of validity period.
Note: The original "ValidDateStart" is deprecated.

"yyyy-MM-dd HH:mm:ss", end of validity period.
Note: The original "ValidDateEnd" is deprecated.

+SpecialDaysSchedule

uint32[64]

O

string

string

O

O

+ValidFrom

+ValidTo

[ Example ]

Request

http://192.168.1.108/cgi-bin/AccessUser.cgi?action=list&UserIDList[0]=102&UserIDList[1]=
102

Respons

Users[0].UserID=100013

Access Control APIs 558

e

Users[0].UserName=Name
Users[0].UserType=1
Users[0].UseTime=1
Users[0].IsFirstEnter=ZhangSan
Users[0].FirstEnterDoors=0
Users[0].UserStatus=12345678
Users[0].Authority=1
Users[0].CitizenIDNo=1
Users[0].Password=ZhangSan
Users[0].Doors=0
Users[0].TimeSections=12345678
Users[0].SpecialDaysSchedule=1
Users[0].ValidFrom=1
records[0].ValidTo=ZhangSan
…

12.4.6 Start Find Access User Related Information

Start searching for user related information.

Table 12-57

URL

Method

http://<server>/cgi-bin/AccessUser.cgi?action=startFind

GET

Description

Start searching for user related information.

[ Request Params ] ( key=value format at URL )

Type

R/O Param Description

Name

Condition

+UserID

+UserName

+UserType

+UseTime

+IsFirstEnter

+FirstEnterDoors

+UserStatus

+Authority

+CitizenIDNo

+Password

object

string

string

uint16

uint16

bool

int16[]

uint16

uint8

string

string

R

O

O

O

O

O

O

O

O

O

O

+Doors

int16[]

O

Search conditions. Users can perform conditional search
according to the user information field.

User ID

User name

0: General user, by default; 1: Blocklist user (report the
blocklist event ACBlocklist); 2: Guest user; 3: Patrol user;
4: VIP user; 5: Extend time user

Limit of passing times for guest users

First user authority or not. false: No; true: Yes

-1 indicates all channels.

0: Normal; 1: Frozen

(attendance machine

field). 1: Admin;

User authority
2: General user

ID card number

The password when unlocking by card + password. The
password when unlocking by UserID + password

Door authority. The index in the controller is used with
TimeSections, and the value corresponds to the subscript
of the AC configuration.

+TimeSections

uint16[]

O

The door authority corresponds to the period index. For

Access Control APIs 559

+SpecialDaysSchedule uint32[64] O

+ValidFrom

+ValidTo

[ Response Params ]

Token

Total

Caps

[ Example ]

string

string

uint32

uint32

uint32

O

O

R

R

R

example, door 3 corresponds to period 2. Each element
corresponds to the door in Doors.

Holiday plan identification. The value is the subscript
number configured by SpecialDaysSchedule (defined in
the configuration).

"yyyy-MM-dd HH:mm:ss", start of validity period. Note:
The original "ValidDateStart" is deprecated.

"yyyy-MM-dd HH:mm:ss", end of validity period. Note: The
original "ValidDateEnd" is deprecated.

Search token.

Total number of entries found this time

Search capability: Maximum number of records that can
be returned each time.

Request

http://192.168.1.108/cgi-bin/AccessUser.cgi?action=startFind&Condition.UserID=1

Response

{
"Token": 1234,
"Total": 20,
"Caps ": 20
}

12.4.7 Get Find Result of Access User Related Information

Get user related information.

Table 12-58

URL

Method

http://<server>/cgi-bin/AccessUser.cgi?action=doFind

GET

Description

Get user related information.

[ Request Params ] ( key=value format at URL )

Name

Token

Offset

Count

[ Response Params ]

Type

R/O

Param Description

int

int

int

R

R

R

Search token

Offset

Number of entries obtained this time

info

[ Example ]

Request

array<object> R

Person information

http://192.168.1.108/cgi-bin/AccessUser.cgi?action=doFind&Token=1234&Offset=0&Count
=20

{
"Info": [ {

Respons
e

"UserID": "102",
…

}, { … }, … ]
}

Access Control APIs 560

12.4.8 Stop Find Access User Related Information

Get user related information.

URL

Method

http://<server>/cgi-bin/AccessUser.cgi?action=stopFind

GET

Table 12-59

Description

Get user related information.

[ Request Params ] ( key=value format at URL )

Name

Type

R/O Param Description

Token
[ Response Params ]（OK）
[ Example ]

int

R

Search token.

Request

http://192.168.1.108/cgi-bin/AccessUser.cgi?action=stopFind&Token=1234

Response

OK

12.4.9 Add Multiple Access Cards

Send information of multiple card numbers.

Table 12-60

URL

Method

http://<server>/cgi-bin/AccessCard.cgi?action=insertMulti

POST

Description

Insert card number information.

[ Request Params ] ( JSON format in body )

Type

R/O

Param Description

Name

CardList

+CardNo

+UserID

array<object>

string

string

R

R

R

+CardType

uint16

O

+CardName

string

+CardStatus

uint32

O

O

User list, with up to 10 entries

Card No.

User ID

Card type
Enumint{
0: Ordinary card
1: VIP card
2: Guest card
3: Patrol card
4: Blocklist card
5: Duress card

Card name

Card status. Different card status results in
different person status.
0: Normal
1<<0: Reported for loss
1<<1: Canceled
1<<2: Frozen

Access Control APIs 561

1<<3: Arrearage
1<<4: Overdue

[ Response Params ] ( OK )

[ Example ]

Request

{
CardList[{
"UserID" : "100013"
"CardNo" : ""
"CardType" : 0
"CardName" : "201 - ZhangSan"
"CardStatus" : 0
} ,…,{}]
}

Response

OK

12.4.10 Modify Multiple Access Cards

Update information of multiple card numbers.

Table 12-61

URL

Method

http://<server>/cgi-bin/AccessCard.cgi?action=updateMulti

POST

Description

Update card number information.

[ Request Params ] ( JSON format in body )

Type

R/O

Param Description

Name

CardList

+CardNo

+UserID

array<object>

string

string

R

R

R

+CardType

uint16

O

User list, with up to 10 entries

Card No.

User ID

Card type
Enumint{
0: Ordinary card
1: VIP card
2: Guest card
3: Patrol card
4: Blocklist card
5: Duress card

+CardName

string

O

Card name

+CardStatus

uint32

O

[ Response Params ] ( OK )

Card status. Different card status results in
different person status.
0: Normal
1<<0: Reported for loss
1<<1: Canceled
1<<2: Frozen
1<<3: Arrearage
1<<4: Overdue

Access Control APIs 562

[ Example ]

{

CardList[{

Request

    "UserID" : "100013"
    "CardNo" : ""
    "CardType" : 0
    "CardName" : "201 - ZhangSang"
    "CardStatus" : 0

} ,…,{}]
}

Response

OK

12.4.11 Delete All Access Cards

Remove all card number information.

Table 12-62

URL

Method

http://<server>/cgi-bin/AccessCard.cgi?action=removeAll

GET

Description

Clear all card information.

[ Request Params ] ( key=value format at URL )

Name

Type

R/O

Param Description

[ Response Params ] ( OK )

[ Example ]

Request

http://192.168.1.108/cgi-bin/AccessCard.cgi?action=removeAll

Response

OK

12.4.12 Delete Multiple Access Cards

Remove information of multiple card numbers.

Table 12-63

URL

Method

http://<server>/cgi-bin/AccessCard.cgi?action=removeMulti

GET

Description

Delete card number data.

[ Request Params ] ( key=value format at URL )

Name

Type

R/O

Param Description

CardNoList

array<string> R

User card number list, with up to 10 entries

[ Response Params ] ( OK )

[ Example ]

Request

http://192.168.1.108/cgi-bin/AccessCard.cgi?action=removeMulti&CardNoList[0]=1234567
8&CardNoList[1]=12345687

Response OK

Access Control APIs 563

12.4.13 Find Multiple Access Cards

Search for information of multiple card numbers.

Table 12-64

URL

Method

http://<server>/cgi-bin/AccessCard.cgi?action=list

GET

Description

Search for card number data.

[ Request Params ] ( key=value format at URL )

Name

CardNoList

[ Response Params ]

records

+CardNo

+UserID

Type

R/O Param Description

array<string> R

User ID list, with up to 10 entries

array<object> R

The records that returned.

string

string

R

R

Card No.

User ID

+CardType

uint16

O

Card type
Enumint{
0: Ordinary card
1: VIP card
2: Guest card
3: Patrol card
4: Blocklist card
5: Duress card

+CardName

string

O

Card name

+CardStatus

uint32

O

Card status. Different card status results in different
person status.
0: Normal
1<<0: Reported for loss
1<<1: Canceled
1<<2: Frozen
1<<3: Arrearage
1<<4: Overdue

[ Example ]

Request

Response

http://192.168.1.108/cgi-bin/AccessCard.cgi?action=list&CardNoList
[0]=102&CardNoList[1]=102

Cards[0].CardNo=12345678
Cards[0].UserID=1
Cards[0].CardType=1
Cards[0].CardName=ZhangSan
Cards[0].CardStatus=0
…
Cards[1].CardNo=12345679
Cards[1].UserID=2
Cards[1].CardType=1
Cards[1].CardName=LiSi
Cards[1].CardStatus=0

Access Control APIs 564

…

12.4.14 Start Find Access User Card Related Information

Start searching for card number related information.

Table 12-65

URL

Method

http://<server>/cgi-bin/ AccessCard.cgi?action=startFind

GET

Description

Start searching for card number related information.

[ Request Params ] ( key=value format at URL )

Name

Type

R/O Param Description

Condition

+UserID

+CardNo

object

string

string

R

O

O

+CardType

uint16

O

Search conditions. Users can perform conditional search
according to the user information field.

User ID

User card number

Card type
Enumint{
0: Ordinary card
1: VIP card
2: Guest card
3: Patrol card
4: Blocklist card
5: Duress card

+CardName

string

O

Card name

Card status Different card status results in different person
status.
0: Normal
1<<0: Reported for loss
1<<1: Canceled
1<<2: Frozen
1<<3: Arrearage
1<<4: Overdue

Search token.

Total number of entries found this time

Search capability: Maximum number of records that can be
returned each time.

+CardStatus

uint32

O

[ Response Params ]

Token

Total

Caps

[ Example ]

uint32

uint32

uint32

R

R

R

Request

http://192.168.1.108/cgi-bin/AccessCard.cgi?action=startFind&Condition.UserID=1

Response

{
"Token": 1234,
"Total": 20,
"Caps ": 20
}

Access Control APIs 565

12.4.15 Get Find Result of Access User Card Related Information

Get card number related information.

Table 12-66

URL

Method

http://<server>/cgi-bin/AccessCard.cgi?action=doFind

GET

Description

Get card number related information.

[ Request Params ] ( key=value format at URL )

Name

Token

Offset

Count

Type

R/O Param Description

int

int

int

R

R

R

Search token.

Offset

Number of entries obtained this time

[ Response Params ]

info

[ Example ]

Request

Response

array<object>

R

Person information

http://192.168.1.108/cgi-bin/AccessCard.cgi?action=doFind&Token=1234&Offset=0&Coun
t=20

{

"Info": [ {

"UserID": "102",
…
}, { … }, … ]
}

12.4.16 Stop Find Access User Card Related Information

Stop searching for card number related information.

Table 12-67

URL

Method

http://<server>/cgi-bin/AccessCard.cgi?action=stopFind

GET

Description

Stop searching for card number related information.

[ Request Params ] ( key=value format at URL )

Name

Type

R/O Param Description

Token
[ Response Params ]（OK）
[ Example ]

int

R

Search token.

Request

http://192.168.1.108/cgi-bin/AccessCard.cgi?action=stopFind&Token=1234

Response

OK

12.4.17 Add Multiple Access User Fingerprint

Insert multiple fingerprint information.

Access Control APIs 566

Table 12-68

URL

Method

http://<server>/cgi-bin/AccessFingerprint.cgi?action=insertMulti

POST

Description

Insert fingerprint information.

[ Request Params ] ( JSON format in body )

Type

R/O Param Description

Name

vecPackets

array<string>

AccessFingerprints

array<object>

+UserID

+FingerprintPacket

++Length

++Count

string

object

uint32

uint32

R

R

R

R

R

R

Fingerprint feature data

Fingerprint list, with up to 1 entry

User ID

Send fingerprint information list.

Length of a single fingerprint package

Number of fingerprint packages

Either cloud storage URL of fingerprint data or
Length. If the Length exists and is not 0, this field
is invalid when it is subject to Length. Only HTTP
URL is available now.

Duress fingerprint number, with a value range of
[1, count]. This field is invalid if the value is illegal.
That is, there is no duress fingerprint. For
example, 0 indicates no duress fingerprint.

++DataURL

array<string>

O

++DuressIndex

Uint8

R

[ Response Params ] ( OK )

[ Example ]

{
“vecPackets“: [ "xxxx", "xxxx", … ],

“AccessFingerprints”:[

{

"UserID": "102",

      "FingerprintPacket" :

{
"Length" : 810,

                            "Count" : 3,
                            "DuressIndex" : 2

}

}

Request

]

}

OK

Response

12.4.18 Modify Access User Fingerprint

Update multiple fingerprint information.

URL

Method

http://<server>/cgi-bin/AccessFingerprint.cgi?action=updateMulti

POST

Table 12-69

Access Control APIs 567

Description

Update fingerprint information.

[ Request Params ] ( JSON format in body )

Name

vecPackets

Type

R/O Param Description

array<string> R

Binary fingerprint data (Binary Data).

AccessFingerprints

array<object> R

Fingerprint list, with up to 1 entry

+UserID

+FingerprintPacket

++Length

++Count

string

object

uint32

uint32

R

R

R

R

User ID

Send fingerprint information list.

Length of a single fingerprint package

Number of fingerprint packages

++DataURL

array<string> O

++DuressIndex

Uint8

R

[ Response Params ] ( OK )

[ Example ]

{

Either cloud storage URL of fingerprint data or Length.
If the Length exists and is not 0, this field is invalid
when it is subject to Length. Only HTTP URL is
available now.

Duress fingerprint number, with a value range of [1,
count]. This field is invalid if the value is illegal. That
is, there is no duress fingerprint. For example, 0
indicates no duress fingerprint.

Request

“vecPackets“: [ "xxxx", "xxxx", … ],
“AccessFingerprints”:[

{

"UserID": "102",

      "FingerprintPacket" :

{
"Length" : 810,

                            "Count" : 3,
                            "DuressIndex" : 2

}

}

]

}

OK

Response

12.4.19 Delete All Access User Fingerprint

Delete all fingerprint information.

Table 12-70

URL

Method

http://<server>/cgi-bin/AccessFingerprint.cgi?action=removeAll

GET

Description

Clear all fingerprint information.

[ Request Params ] ( key=value format at URL )

Name

Type

R/O

Param Description

[ Response Params ] ( OK )

Access Control APIs 568

[ Example ]

Request

http://192.168.1.108/cgi-bin/AccessFingerprint.cgi?action=removeAll

Response

OK

12.4.20 Delete Multiple Access User Fingerprint

Delete fingerprint information.

Table 12-71

URL

Method

http://<server>/cgi-bin/AccessFingerprint.cgi?action=removeMulti

GET

Description

Delete fingerprint data.

[ Request Params ] ( key=value format at URL )

Name

UserIDList

Type

R/O Param Description

array<string> R

User card number list, with up to 1 entry

[ Response Params ] ( OK )

[ Example ]

Request

http://192.168.1.108/cgi-bin/AccessFingerprint.cgi?action=removeMulti&
UserIDList[0]=101&UserIDList[1]=102

Response

OK

12.4.21 Find Access User Fingerprint

Search for user fingerprint information.

Table 12-72

URL

Method

http://<server>/cgi-bin/AccessFingerprint.cgi?action=get

GET

Description

Search for user fingerprint information.

[ Request Params ] ( key=value format at URL )

Name

UserID

Type

string

R/O Param Description

R

User ID list, with up to 1 entry

[ Response Params ]

FingerprintData

BinaryData

FingerprintPacket

+Length

+Count

object

uint32

uint32

R

R

R

R

Binary fingerprint data (Binary Data).

Description of fingerprint data

Length of a single fingerprint package

Number of fingerprint packages

+DataURL

array<string> O

+DuressIndex

Uint8

R

Either cloud storage URL of fingerprint data or
Length. If the Length exists and is not 0, this field is
invalid when it is subject to Length. Only HTTP URL is
available now.

Duress fingerprint number, with a value range of [1,
count]. This field is invalid if the value is illegal. That
is, there is no duress fingerprint. For example, 0
indicates no duress fingerprint.

Access Control APIs 569

[ Example ]

Request

http://192.168.1.108/cgi-bin/AccessFingerprint.cgi?action=get&UserID=1

Response

FingerprintPacket.Length=810
FingerprintPacket.Count=3
FingerprintPacket.DuressIndex=1
FingerprintData=xxx

12.4.22 Add Multiple Access User Face

Insert multiple face information.

Table 12-73

URL

Method

http://<server>/cgi-bin/AccessFace.cgi?action=insertMulti

POST

Description

Insert face information.

[ Request Params ] ( JSON format in body )

Type

R/O Param Description

Name

FaceList

+UserID

array<object>

string

+FaceData

array<string>

+PhotoData

array<string>

+PhotoURL

array<string>

O

[ Response Params ] ( OK )

[ Example ]

{

“FaceList”:[

{

R

R

O

O

Face list, with up to 10 entries

User ID

Base64 of red
Bytes/per face, maximum 20.

face

light

templates, 8192

Base64 of white light face images, 200kx5.

Either cloud storage URL of white light face
images or PhotoData. If PhotoData exists, this
field is invalid when it is subject to PhotoData.
Only HTTP URL is available now.

"UserID": "102",
"FaceData": [ "xxxx", "xxxx", … ],
"PhotoData": [ "yyyy", "yyyy", … ],
" PhotoURL": [ "yyyy", "yyyy", … ],

Request

},

….
]

Response

}

OK

12.4.23 Update Multiple Access User Face

Update multiple face information.

Table 12-74

Access Control APIs 570

URL

Method

http://<server>/cgi-bin/AccessFace.cgi?action=updateMulti

POST

Description

Update face information.

[ Request Params ] ( JSON format in body )

Type

R/O Param Description

Name

FaceList

+UserID

array<object>

string

+FaceData

array<string>

+PhotoData

array<string>

+PhotoURL

array<string>

O

[ Response Params ] ( OK )

[ Example ]

{

“FaceList”:[

{

R

R

O

O

Face list, with up to 10 entries

User ID

Base64 of red
Bytes/per face, maximum 20.

face

light

templates, 8192

Base64 of white light face images, 200kx5.

Either cloud storage URL of white light face
images or PhotoData. If PhotoData exists, this
field is invalid when it is subject to PhotoData.
Only HTTP URL is available now.

"UserID": "102",
"FaceData": [ "xxxx", "xxxx", … ],
"PhotoData": [ "yyyy", "yyyy", … ],
" PhotoURL": [ "yyyy", "yyyy", … ],

Request

},

….
]

Response

}

OK

12.4.24 Delete All Access User Face

Delete all face information.

Table 12-75

URL

Method

http://<server>/cgi-bin/AccessFace.cgi?action=removeAll

GET

Description

Clear all face information.

[ Request Params ] ( key=value format at URL )

Name

Type

R/O

Param Description

[ Response Params ] ( OK )

[ Example ]

Request

http://192.168.1.108/cgi-bin/AccessFace.cgi?action=removeAll

Response

OK

Access Control APIs 571

12.4.25 Delete Multiple Access User Face

Delete multiple face information.

Table 12-76

URL

Method

http://<server>/cgi-bin/AccessFace.cgi?action=removeMulti

GET

Description

Delete face data.

[ Request Params ] ( key=value format at URL )

Name

Type

R/O Param Description

UserIDList

array<string> R

User card number list, with up to 10 entries

[ Response Params ] ( OK )

[ Example ]

Request

http://192.168.1.108/cgi-bin/AccessFace.cgi?action=removeMulti& UserIDList[0]=101&U
serIDList[1]=102

Response

OK

12.4.26 Find Access User Face

Search for access user face information.

Table 12-77

URL

Method

http://<server>/cgi-bin/AccessFace.cgi?action=list

GET

Description

Search for user face data.

[ Request Params ] ( key=value format at URL )

Name

UserIDList

[ Response Params ]

FaceDataList

+UserID

string

Type

R/O Param Description

array<string> R

User ID list, with up to 10 entries

array<object> R

The records that returned.

+FaceData

array<string>

+PhotoData

array<string>

+PhotoURL

array<string>

O

R

O

O

User ID

Base64 of red light face templates, 8192 Bytes/per
face, maximum 20.

Base64 of white light face images, 200kx5.

Either cloud storage URL of white light face images
or PhotoData. If PhotoData exists, this field is
invalid when it is subject to PhotoData. Only HTTP
URL is available now.

[ Example ]

Request

Response

http://192.168.1.108/cgi-bin/AccessFace.cgi?action=list&UserIDList
[0]=1&UserIDList[1]=2
FaceDataList[0].UserID=1
FaceDataList[0].PhotoData[0]="xxxx",
FaceDataList[0].PhotoData[1]="xxxx", ,
FaceDataList[0].FaceData[0]="xxxx"
FaceDataList[0].FaceData[1]="xxxx",

Access Control APIs 572

…
FaceDataList[1].UserID=2
FaceDataList[1].PhotoData[0]="xxxx",
FaceDataList[1].PhotoData[1]="xxxx", ,
FaceDataList[1].FaceData[0]="xxxx"
FaceDataList[1].FaceData[1]="xxxx",
…

12.4.27 Start Find Access User Face Related Information

Start searching for face related information.

Table 12-78

URL

Method

http://<server>/cgi-bin/AccessFace.cgi?action=startFind

GET

Description

Start searching for face related information.

[ Request Params ] ( key=value format at URL )

Name

Type

R/O Param Description

Condition

+UserID

object

string

[ Response Params ]

Token

Total

Caps

[ Example ]

uint32

uint32

uint32

R

O

R

R

R

Search conditions. Users can perform conditional search
according to the user information field.

User ID

Search token.

Total number of entries found this time

Search capability: Maximum number of records that can be
returned each time.

Request

http://192.168.1.108/cgi-bin/AccessFace.cgi?action=startFind&Condition.UserID=1

Response

{
"Token": 1234,
"Total": 20,
"Caps ": 20
}

12.4.28 Get Find Result of Access User Face Related Information

Get face related information.

Table 12-79

URL

Method

http://<server>/cgi-bin/AccessFace.cgi?action=doFind

GET

Description

Get face related information.

[ Request Params ] ( key=value format at URL )

Name

Token

Offset

Count

Type

R/O Param Description

int

int

int

R

R

R

Search token.

Offset

Number of entries obtained this time

Access Control APIs 573

[ Response Params ]

info

[ Example ]

Request

Response

array<object>

R

Person information

http://192.168.1.108/cgi-bin/AccessFace.cgi?action=doFind&Token=1234&Offset=0&Coun
t=20

{

"Info": [ {

"UserID": "102",

…

    }, { … }, … ]

}

12.4.29 Stop Find Access User Face Related Information

Stop searching for face related information.

Table 12-80

URL

Method

http://<server>/cgi-bin/AccessFace.cgi?action=stopFind

GET

Description

Stop searching for face related information.

[ Request Params ] ( key=value format at URL )

Name

Token

Type

R/O Param Description

int

R

Search token.

[ Response Params ]（OK）
[ Example ]

Request

Response

http://192.168.1.108/cgi-bin/AccessFace.cgi?action=stopFind&Token=1234

OK

12.4.30 Access Control Protocol Capability Query

Second-Generation Access Control Protocol Capability Query
Request URL http://<server>/cgi-bin/api/AC/getCaps
Method
Request Params ( JSON format in body )
Name
WantMethods

Type
bool

POST

R/O Description
No Whether to request to return the
Methods list, please obtain according
to actual needs.

Example
true

No Whether to request to return to the
list, please obtain

capability
item
according to actual needs.

true

WantCaps

bool

Request Example
{
"WantMethods": True
}

Access Control APIs 574

Response Params
Name
Caps
+AC
++Channels

Type
object
object
uint32

R/O Description
Yes Capability set
No
No

++HasAlarmR
ecord

++Encryption
Method

bool

No

uint8

No

Example

4

False

0

AC capability set
Number of supported access control
channels. The former is
"AccessControlChannels”.
Supports recording access control
alarm logs. The former is
“AccessControlAlarmRecord”.
The storage method of passwords in
the ACCustomPassword record set.
The former is
"CustomPasswordEncryption”.
0: Plaintext, the default value is 0.
1: MD5.

++HasFingerp
rintAuth

uint8

No Whether fingerprint authentication is

0

++HasCardAu
th

bool

supported. The former is
"SupportFingerprint”.
0: Unknown, compatible with
previous one (default);
1: Not supported; 2: Supported.
No Whether card authentication is

supported.
False: Not supported; true:
Supported.

False

++HasFaceAu
th

++OnlySingle
DoorAuth

bool

No Whether \*\* identification

False

authentication is supported.
False: Not supported; true:
Supported.

uint8

No Whether only single-door

++IsAsynAuth uint8

++IsUserIsolat
e

uint8

No Whether it is a person-card

authorization (card issuing)
multi-door controller is supported.
0: Not supported; 1: Supported
No Whether asynchronous return

authentication is supported.
0: Not supported; 1: Supported

separation scheme. In the
person-card separation scheme,
one person can have several cards.
0: No; 1: Yes
The general maximum number of
data can be sent at a time. Default
conservative set value similar to
BIOS.

0

0

0

10

++MaxInsertR
ate

uint16

No

Access Control APIs 575

++ScheduleC
aps

object

+++Support

bool

No

The schedule capability of the
device, corresponding to the former
SpecialDaysSchedules.
No Whether the new schedule is

False

+++MaxSched
ules

uint16

No

+++MaxTimeP
eriodsPerDay
+++MaxSpeci
alDayGroups

uint8

uint16

No

No

+++MaxDaysI
nSpecialDayG
roup
++UnlockMod
es

uint16

No

uint16[128] No

++SupportBac
kendAI

bool

++SupportFas
tImport

enumint

No

++SupportFas
tCheck

enumint

No

++SupportRap
idCheck

enumint

No

supported.
False: Not supported; true:
Supported.
The maximum number of holiday
plan capabilities supported by one
access controller.
The maximum number of time
periods that can be defined in a day.
The maximum number of holiday
plan groups supported by the
access controller.
The maximum number of holidays
supported by a holiday group.

6

6

6

16

The combination of unlocking
modes supported by the device. The
element value corresponds to the
former "Opening Method", namely
the Method value in the
AccessControl configuration.
No Whether the AI identification mode

[1, 2, ...]

True

is supported.
True: Supported; false: Not
supported.
Supports fast import function
Enumint {
0: Not supported
1: Supported
}
Not supported if it does not exist.
Supports quick review function (only
compare userID)
Enumint {
0: Not supported
1: Supported
}
Not supported if it does not exist.
Supports rapid review function
Enumint {
0: Not supported
1: Supported
}
Not supported if it does not exist.

0

0

0

Access Control APIs 576

++IncrementI
mport

enumint

No

++FingerCom
pareMode

uint8

No

++SupportHel
met

enumint

No

++UserName
MaxLen
++SupportAS
GManager

uint32

bool

No

No

++SnapPicPat
h

char[512]

No

Supports incremental delivery
Enumint {
0: Not supported
1: Supported
} Not supported if it does not exist.
HasFingerprintAuth supports
fingerprint authentication function,
this field is valid.
0: Unknown, meaningless
1: The device only supports
front-end fingerprint comparison.
2: The device only supports
back-end fingerprint comparison.
3: Indicates that the device supports
both front-end and back-end
fingerprint comparison.
Supports safety helmet function.
( Takend from IsSupportHelmet)
Enumint{
0: Not supported
1: Supported
} Not supported if it does not exist.
Supports limiting name length on the
device.
Supports turnstile business
components (the turnstile was
previously hung on the access
controller as a sub-device, and the
related configuration of the turnstile
was written in the access control.
Now divide the turnstile from the
access control.)
true: supported.
False: Not supported.
The local storage directory of the
door-opening snapshots; the file
name is stored in the door-opening
record database, and the absolute
path of the snapshot can be
obtained by appending this
directory.
\*\* The local storage directory of
base pictures.

0

2

0

32

True

"/mnt/data/u
serpic/"

"/mnt/data/F
aceImage/"
False

"/mnt/data/I
mage/"

char[512]

++FaceImage
Path
++HasIrisAuth bool

No

No Whether \*\* identification

++IrisImagePa
th

char[512]

No

authentication is supported.
Added ** opening authentication
type, and added ** base storage

Access Control APIs 577

+AccessUser
++MaxInsertR
ate
++MaxUsers

object
uint16

uint32

uint8

uint8

uint8

object
uint16

uint32
object

uint16

uint16

uint32

uint32

uint32

object
uint16

uint32
uint8

uint16

++MaxFingerP
rintsPerUser
++MaxCardsP
erUser
++MaxFacesP
erUser
+AccessCard
++MaxInsertR
ate
++MaxCards
+AccessFinge
rprint
++MaxInsertR
ate
++MaxFingerp
rintSize
++MaxFingerp
rints
++AlgorithmVe
ndor
++AlgorithmVe
rsion

+AccessFace
++MaxInsertR
ate
++MaxFaces
++Recognition
Type
++Recognition
AlgorithmVend
er

++Recognition
Version

uint32

No

No
No

No

No

No

No

No
No

No
No

No

No

No

No

No

No
No

No
No

No

5

10

600

path.
AccessUser capability set.
Maximum number of inserts per
time.
Maximum number of users that can
be recorded and processed.
Maximum number of fingerprints
that can be recorded per person.
Maximum number of card that can
be recorded per person.
Maximum number of \*\* photo that
can be recorded per person.
AccessCard capability set.
Maximum number of inserts per
time.
Maximum storage number of cards. 600

-

10

5

1

-

10

810

600

0

10

600
1

0

Maximum number of inserts per
time.
Maximum bytes number of single
fingerprint data.
Fingerprint storage limit.

Fingerprint algorithm manufacturer;
0: Unknown;1: Dahua; 2: Brmicro.
Fingerprint algorithm version
number; each 8 bit represents a
version from high to low according
to Major/Minor, for example, 1.5.2
represents as 0x0001050.
AccessFace capability set.
Maximum number of inserts per
time.
** Storage Limit.
** Recognition Type.

** Identification algorithm provider.
0: Unknown; 1: Dahua; 2:
SenseTime; 3: Yitu; 4: Hanvon; 5:
Huoyan.
** Identification algorithm (model)
version number, if the version
number has multiple digits, each 8
bit represents a version from high to
low according to Major/Minor, for
example, 1.5.2 represents as

Access Control APIs 578

++MinPhotoSi
ze
++MaxPhotoSi
ze
++MaxGetPho
toRate

uint16

uint16

uint16

No

No

No

0x00010502.
Minimum size of white light photo,
KB.
Maximum size of white light photo,
KB.
The maximum amount of
acquisitions per time by the white
light list method.
Unit (number/per time).

20

20

20

++IsSupportG
etPhoto

++IsSupportO
nlyIssueFaceE
igen
++MultiFaceD
etect
+++Support

bool

No Whether the list interface is

True

supported to obtain white light
photos.

bool

No Whether only sending the

True-

characteristic value is supported.

object

No

-

bool

No Whether multi-detection

True

+++MaxNums uint32

3

identification is supported.
The maximum number of detections
supported at a time.
AccessIris capability set.
Maximum number of inserts per
time.
Minimum size of the image, unit KB. 1

10

No

No
No

No

object
uint16

uint16

uint16

No

Maximum size of the image, unit KB. 50

+AccessIris
++MaxInsertR
ate
++MinIrisPhot
oSize
++MaxIrisPhot
oSize
++MaxIrisGro
up
++Recognition
AlgorithmVend
er
++Recognition
Version

uint16

uint16

No

No

uint32

No

++MaxIrisesC
ount

uint32

No

Response Example

Maximum number of groups
supported by each user**.
** Identification algorithm provide
identification, 0: Unknown; 1:
Dahua.
** The algorithm (model) version
number, if the version number has
multiple digits, every 8 bit represents
a version from high to low according
to Major/Minor, for example, 1.5.2
represents as 0x00010502.
** Storage Limit.

1

0

10000

Access Control APIs 579

12.5 Admin Password

12.5.1 Add Access Control Admin Password

URL

http://<server>/cgi-bin/recordUpdater.cgi?action=insert&name=AccessControlCustomPa
ssword

Table 12-81

Method

GET

Description

Insert access control admin password.

[ Request Params ] ( key=value format in URL )

Type

R/O Param Description

Name

name

UserID

OpenDoorPass
word

string

string

string

AlarmPassword

string

R

R

R

O

Doors

array<int> O

TimeSections

array<int> O

VTOPosition

string

ValidDateStart

ValidDateEnd

ValidCounts

OriginSmartGate
Way

string

string

int

string

O

O

O

O

O

Access control admin password record name, should be
"AccessControlCustomPassword".

The user's id.

Ths user’s open door password.

Ths user’s alarm password. ( This param is not supported by
video talk device )

The index of the doors that admin password can open. ( This
param is not supported by video talk device )

The index of the time sections of each door that this card can
open. ( This param is not supported by video talk device )

VTO position number. ( This param is not supported by access
control device )

The start of valid date, format is "yyyyMMdd hhmmss".

The end of valid date, format is "yyyyMMdd hhmmss".

The password’s valid counts.

The origin smart gateway address. ( Video talk device
customize. )

[ Response Params ] (key=value format)

Name

RecNo

[ Example ]

Request

Type

int

R/
O

R

Param Description

The record id.

http://192.168.1.108/cgi-bin/recordUpdater.cgi?action=insert&name=AccessControlCusto
mPassword&UserID=102&OpenDoorPassword=123456&Doors[0]=1&Doors[1]=3&Doors
[2]=5&VTOPosition=01018001&ValidDateStart=20151022%20093811&ValidDateEnd=201
51222%20093811&ValidCounts=30

Response RecNo=12345

12.5.2 Modify Access Control Admin Password

Table 12-82

Access Control APIs 580

URL

http://<server>/cgi-bin/recordUpdater.cgi?action=update&name=AccessControlCustom
Password

Method

GET

Description

Update access control admin password.
Note: You should provide at lease one optional param to update.

[ Request Params ] ( key=value format in URL )

Name

name

recno

UserID

OpenDoorPass
word

Type

R/O Param Description

string

int

string

string

R

R

R

R

Access control admin password record name, should be
"AccessControlCustomPassword".

The record id.

The user's id.

Ths user’s open door password.

Doors

array<int> O

The index of the doors that admin password can open.

…<other param> —

—

…<See above insert command for other params of the record,
They are all optional.>

[ Response Params ] ( OK )

[ Example ]

Request

http://192.168.1.108/cgi-bin/recordUpdater.cgi?action=update&name=AccessControlCus
tomPassword&recno=12345&UserID=102&OpenDoorPassword=123456&Doors[0]=1&D
oors[1]=3&Doors[2]=5&ValidDateStart=20151022%20093811&ValidDateEnd=2015122
2%20093811

Response

OK

12.5.3 Delete Access Control Admin Password

 Delete access control admin password record by recno

Table 12-83

URL

http://<server>/cgi-bin/recordUpdater.cgi?action=remove&name=AccessControlCustomPa
ssword

Method

GET

Descriptio
n

Remove the access control admin password record by recno.

[ Request Params ] ( key=value format in URL )

Name

name

recno

Type

R/O

Param Description

string

int

R

R

Access control admin password record name, should be
"AccessControlCustomPassword".

The record id.

[ Response Params ] ( OK )

[ Example ]

Request

http://192.168.1.108/cgi-bin/recordUpdater.cgi?action=remove&name=AccessControlCu
stomPassword&recno=12345

Response

OK

 Delete all the access control admin password records

Access Control APIs 581

URL

http://<server>/cgi-bin/recordUpdater.cgi?action=clear&name=AccessControlCustomPass
word

Table 12-84

Method

GET

Descriptio
n

Remove all the access control admin password records

[ Request Params ] ( key=value format in URL )

Name

name

Type

R/O

Param Description

string

R

Access control admin password record name, should be
"AccessControlCustomPassword".

[ Response Params ] ( OK )

[ Example ]

Request

http://192.168.1.108/cgi-bin/recordUpdater.cgi?action=clear&name=AccessControlCusto
mPassword

Response

OK

12.5.4 Find Access Control Admin Password



Find Access control admin password by condition

Table 12-85

URL

http://<server>/cgi-bin/recordFinder.cgi?action=find&name=AccessControlCustomPass
word

Method

GET

Description

Find Access control admin password by condition.

[ Request Params ] ( key=value format in URL )

Name

name

count

StartTime

EndTime

condition

+UserID

Type

string

int

string

string

object

string

R/O Param Description

R

O

O

O

O

O

Record Name, should be "AccessControlCustomPassword".

Max result to return, default is 1024.

The start of the record's CreateTime.

The End of the record's CreateTime.

Search condition.

The user's id.

[ Response Params ] (key=value format)

Name

totalCount

found

records

+RecNo

+CreateTime

+UserID

+OpenDoorPa
ssword

+AlarmPasswo
rd

Type

int

int

R/O Param Description

O

O

The total record num that find.

The record num that returned.

array<object> R

The records that returned.

int

int

string

string

string

R

O

R

R

O

The record id.

The create time of record.

The user's id.

Ths user’s open door password.

Ths user’s alarm password. ( This param is not supported by
video talk device )

Access Control APIs 582

+Doors

array<int>

+TimeSections array<int>

VTOPosition

string

+ValidDateStar
t

string

+ValidDateEnd

string

+ValidCounts

int

+OriginSmartG
ateWay

[ Example ]

string

O

O

O

O

O

O

O

The index of the doors that admin password can open. ( This
param is not supported by video talk device )

The index of the time sections of each door that this card can
open. ( This param is not supported by video talk device )

VTO position number. ( This param is not supported by video
talk device )

The start of valid date, format is "yyyyMMdd hhmmss".

The end of valid date, format is "yyyyMMdd hhmmss".

The password’s valid counts.

The origin smart gateway address. ( Video talk device
customize. )

Request

http://192.168.1.108/cgi-bin/recordFinder.cgi?action=find&name=AccessControlCustomPa
ssword&condition.UserID=103&StartTime=123456700&EndTime=123456800&count=100

Response

totalCount=1000
found=100
records[0].RecNo=12345
records[0].CreateTime=123456789
records[0].UserID=103
records[0].OpenDoorPassword=123456
records[0].Doors[0]=1
records[0].Doors[1]=3
records[0].Doors[2]=5
records[0].VTOPosition=01018001
records[0].ValidStart=20151022 093811
records[0].ValidEnd=20151222 093811
…
records[1].RecNo=13579
records[1].CreateTime=123456799
records[1].UserID=103
records[0].OpenDoorPassword=123456
records[1].Doors[0]=2
records[1].Doors[1]=4
records[1].Doors[2]=6
records[1].VTOPosition=01018002
records[1].ValidStart=20151022 093811
records[1].ValidEnd=20151222 093811
…



Find Access control admin password by recno

Table 12-86

URL

http://<server>/cgi-bin/recordUpdater.cgi?action=get&name=AccessControlCustomPas
sword

Method

GET

Description

Find Access control admin password by recno.

Access Control APIs 583

[ Request Params ] ( key=value format in URL )

Name

name

recno

Type

string

int

R/O Param Description

R

R

Record Name, should be "AccessControlCustomPassword".

The record id.

[ Response Params ] (key=value format)

Name

record

+RecNo

+CreateTime

Type

object

int

int

+UserID
…<other param> —
[ Example ]

string

R/O Param Description

R

R

O

R
—

The record that returned.

The record id.

The create time of record.

The user's id.

…<See above find command for other params of the record.>

Request

http://192.168.1.108/cgi-bin/recordUpdater.cgi?action=get&name=AccessControlCustomP
assword&recno=3

Response

record.RecNo=3
record.CreateTime=123456789
record.UserID=103
record.OpenDoorPassword=123456
record.Doors[0]=1
record.Doors[1]=3
record.Doors[2]=5
record.VTOPosition=01018001
record.ValidStart=20151022 093811
record.ValidEnd=20151222 093811
…

12.5.5 Get the Total Number of Records of Access Control Admin

Password

Table 12-87

URL

http://<server>/cgi-bin/recordFinder.cgi?action=getQuerySize&name=AccessControlCust
omPassword

Method

GET

Description Get the total number of records of the access control admin password.

[ Request Params ] ( key=value format in URL )

Name

name

Type

R/O Param Description

string

R

Access control admin password record name, should be
"AccessControlCustomPassword".

[ Response Params ] ( key=value )

count

[ Example ]

Request

int

R

The total number of records.

http://192.168.1.108/cgi-bin/recordFinder.cgi?action=getQuerySize&name=AccessContr
olCustomPassword

Response

count=150

Access Control APIs 584

13 Intelligent Building APIs

13.1 Video Talk

The following Apis are supported by VTT / VTA products.

13.1.1 Subscribe Video Talk Status

Subscribe the video talk status. When client disconnect, it will unsubscribe.

http://<server>/cgi-bin/VideoTalkPeer.cgi?action=attachState
Request URL
GET
Method
Request Params ( key=value format in URL )
Name
Type
Request Example
http://192.168.1.108/cgi-bin/VideoTalkPeer.cgi?action=attachState

Description

R/O

Example

Response Params ( multipart ; key=value format in body )
Name
SID
state
+State

Type
integer
object
string

R/O
No
No
No

Description
Server subscription ID
Called state
Call state
Enumchar[32]{
"Ringing": passive call
"Inviting": active call
"Answer"
"Refuse"
"Cancel"
"Hangup"
"Busying"
}
Transmission method, audio and
video encoding format, listening port
and other session description
information
Packing Mode
It only supports "RTP” currently.
Transport protocol type
Enumchar[32]{
TCP
UDP
}
Talk type

Example
13606

Answer

RTP

UDP

Talk

Intelligent Building APIs 585

+Talkback

object

No

++Pack

string

++Protocol

string

No

No

++Type

string

No

++Audio
+++Format
++++Compressio
n

object
object[]
string

No
No
No

++++Frequency
++++Depth
++Video
+++VideoPort

integer
integer
object
integer

+++Format
++++Compressio
n

object[]
string

No
No
No
No

No
No

++++Frequency
++MediaAddr

integer
string

No
No

Enumchar[32]{
"Talk": Talk
"Broadcast": Broadcast
}
Audio Description
Supported audio decoding formats
Audio compression format
Enumchar[32]{
PCM
ADPCM
"G.711A"
"G.711Mu"
"G.726"
"G.729"
"MPEG2"
AMR
AAC
}
Audio Sampling Frequency
Sampling depth
Video description
Receive video stream port
When receiving multiple video
channels, use different ports
respectively.
Supported video decoding formats
Video compression format
Enumchar[32]{
"MPEG4"
"MPEG2"
"MPEG1"
"MJPG"
"H.263"
"H.264"
}
Video sampling frequency
Streaming address
It can be an intercom or broadcast
address

PCM

44000
16

7000

H.264

9000
224.10.10.10

Response Example
HTTP/1.1 200 OK
Server: Device/1.0
Content-Type: multipart/x-mixed-replace; boundary=<boundary>
Connection: closed

--<boundary>
Content-Type: text/plain

Intelligent Building APIs 586

Content-Length: <data length>

SID=315
state.State=Answer
state.Talkback.Pack=RTP
state.Talkback.Protocol=UDP
state.Talkback.Type=Talk
state.Talkback.Audio.AudioPort=6000
state.Talkback.Audio.Format[0].Compression=PCM
state.Talkback.Audio.Format[0].Frequency=44000
state.Talkback.Audio.Format[0].Depth=16
state.Talkback.Audio.Format[1].Compression=G.711A
state.Talkback.Audio.Format[1].Frequency=44000
state.Talkback.Audio.Format[1].Depth=16
state.Talkback.Video.VideoPort=7000
state.Talkback.Video.Format[0].Compression=H.264
state.Talkback.Video.Format[0].Frequency=90000
state.Talkback.Video.Format[1].Compression=MJPG
…
state.Talkback. MediaAddr=224.10.10.10
--<boundary>
…

13.1.2 Unsubscribe Video Talk Status

Unsubscribe the video talk status.

http://<server>/cgi-bin/VideoTalkPeer.cgi?action=detachState
GET

Request URL
Method
Request Params ( key=value format in URL )
Name
SID

R/O Description
R

Type
int

the subscribe id, which is the response of
attachState

Example
13606

Request Example
http://192.168.1.108/cgi-bin/VideoTalkPeer.cgi?action=detachState&SID=101

Response Params ( OK in body )
Response Example
OK

13.1.3 Invite Server on Video Talk

Start the video talk conversation.

http://<server>/cgi-bin/VideoTalkPeer.cgi?action=invite
Request URL
GET
Method
Request Params ( key=value format in URL )
Type
Name

R/O Description

Example

Intelligent Building APIs 587

Talkback
+Pack

integer
string

+Protocol

string

R
O

O

+Type

string

O

+Audio
++Format
+++Compression string

object
object[]

O
O
O

+++Frequency
+++Depth
+Video
++VideoPort

integer
integer
object
integer

++Format
+++Compression string

object[]

O
O
O
O

O
O

+++Frequency
+MediaAddr

integer
string

O
O

Channel number, starting from 1
Packing Mode
It only supports "RTP” currently.
Transport protocol type
Enumchar[32]{
TCP
"UDP"
}
Talk type
Enumchar[32]{
"Talk": Talk
"Broadcast": Broadcast
}
Audio Description
Supported audio decoding formats
Audio compression format
Enumchar[32]{
PCM
"ADPCM"
"G.711A"
"G.711Mu"
"G.726"
"G.729"
"MPEG2"
"AMR"
"AAC"
}
Audio Sampling Frequency
Sampling depth
Video description
Receive video stream port
When receiving multiple video channels,
use different ports respectively.
Supported video decoding formats
Video compression format
Enumchar[32]{
"MPEG4"
"MPEG2"
"MPEG1"
"MJPG"
"H.263"
"H.264"
}
Video sampling frequency
Streaming address
It can be an intercom or broadcast
address

1
RTP

UDP

Talk

PCM

44000
16

7000

H.264

9000
224.10.10.10

Intelligent Building APIs 588

Request Example
http://192.168.1.108/cgi-bin/VideoTalkPeer.cgi?action=invite&Talkback.Protocol=UDP&Talkback.Type=T
alk&Talkback.MediaAddr=224.10.10.10

Response Params ( OK in body )
Response Example
OK

13.1.4 Cancel the Video Talk

Cancel video talk conversation.

http://<server>/cgi-bin/VideoTalkPeer.cgi?action=cancel
GET

Request URL
Method
Request Params ( key=value format in URL )
Type
Name
Request Example
http://192.168.1.108/cgi-bin/VideoTalkPeer.cgi?action=cancel

Description

R/O

Example

Response Params ( OK in body )
Response Example
OK

13.1.5 Answer the Invitation

Answer the call.

http://<server>/cgi-bin/VideoTalkPeer.cgi?action=answer
Request URL
GET
Method
Request Params ( key=value format in URL )
Type
Name
integer
Talkback
string
+Pack

R/O Description
R
O

Channel number, starting from 1
Packing Mode
It only supports "RTP” currently.
Transport protocol type
Enumchar[32]{
TCP
"UDP"
}
Talk type
Enumchar[32]{
"Talk": Talk
"Broadcast": Broadcast
}
Audio Description
Supported audio decoding formats
Audio compression format

Example
1
RTP

UDP

Talk

PCM

+Protocol

string

O

+Type

string

O

+Audio
++Format
+++Compression string

object
object[]

O
O
O

Intelligent Building APIs 589

Enumchar[32]{
PCM
"ADPCM"
"G.711A"
"G.711Mu"
"G.726"
"G.729"
"MPEG2"
"AMR"
"AAC"
}
Audio Sampling Frequency
Sampling depth
Video description
Receive video stream port
When receiving multiple video
channels, use different ports
respectively.
Supported video decoding formats
Video compression format
Enumchar[32]{
"MPEG4"
"MPEG2"
"MPEG1"
"MJPG"
"H.263"
"H.264"
}
Video sampling frequency
Streaming address
It can be an intercom or broadcast
address

44000
16

7000

H.264

9000
224.10.10.10

+++Frequency
+++Depth
+Video
++VideoPort

integer
integer
object
integer

O
O
O
O

++Format
+++Compression string

object[]

O
O

+++Frequency
+MediaAddr

integer
string

O
O

Example
http://192.168.1.108/cgi-bin/VideoTalkPeer.cgi?action=answer&Talkback.Protocol=UDP&Talkback.Type
=Talk&Talkback.MediaAddr=224.10.10.10

Response Params ( OK in body )
Response Example
OK

13.1.6 Refuse to Answer the Video Talk Invitation

Refuse answer the call.

Request URL
Method
Request Params ( key=value format in URL )

http://<server>/cgi-bin/VideoTalkPeer.cgi?action=refuse
GET

Intelligent Building APIs 590

Type

Name
Request Example
http://192.168.1.108/cgi-bin/VideoTalkPeer.cgi?action=refuse

Description

R/O

Example

Response Params ( OK in body )
Response Example
OK

13.1.7 Hang Up

Close it when the conversation is over.

http://<server>/cgi-bin/VideoTalkPeer.cgi?action=hangup
GET

Request URL
Method
Request Params ( key=value format in URL )
Type
Name
Request Example
http://192.168.1.108/cgi-bin/VideoTalkPeer.cgi?action=hangup

Description

R/O

Example

Response Params ( OK in body )
Response Example
OK

13.2 Intelligent Building Record

13.2.1 Query Video Talk Log Record

This Api is supported by VTO products.

Table 13-1

Syntax

http://<server>/cgi-bin/recordFinder.cgi?action=find&name=VideoTalkLog[&condition.C
allType=<Type>&condition.EndState=<State>&count=<countNo>]

Method

GET

Description

Find the VideoTalkLog record.

Example

http://192.168.1.108/cgi-bin/recordFinder.cgi?action=find&name=VideoTalkLog&conditi
on.CallType=Incoming&condion.EndState=Missed&count=500

Success
Return

totalCount=1000
found=500
records[0].RecNo=789
records[0].CreateTime=123456789
records[0].CallType=Incoming
records[0].EndState=Received
records[0].PeerNumber=501
…

Comment

Parameters in URL:

Intelligent Building APIs 591

Type: call type
State: end state of the call
countNo: the number of records to get

Parameters in Response :
totalCount : the record count which match condition
found : the record count to return
CallType: call type. The range is {"Incoming", "Outgoing"}.
EndState: the range is {"Missed" , "Received"}

13.2.2 Insert Announcement Record

This api is supported by VTO products.

Table 13-2

Syntax

http://<server>/cgi-bin/recordUpdater.cgi?action=insert&name=Announcement&Conten
t=<Content>&ExpirTime=<ExpirTime>&IssueTime=<IssueTime>&Title=<Title>&User
=<User>&State=<State>&ReadFlag=<ReadFlag>

Method

GET

Description

Insert the Announcement record.

Example

Success
Return

Comment

http://192.168.1.108/cgi-bin/recordUpdater.cgi?action=insert&name=Announcement&C
ontent=stringData&ExpirTime=2012-01-01%2012:00:00&IssueTime=2012-01-01%201
2:00:00&Title=Anounce1&User=101&State=0&ReadFlag=0

RecNo=<RecNo>

Parameters in URL:
Content: Announcement Content
ExpirTime: the time when the Announcement expire, format: 2012-01-01%2012:00:00
IssueTime: Announcement issue time, format: 2012-01-01%2012:00:00
Title: title of the announcement
User: the number the Announcement issued to
State: the state of the Announcement. 0 init, 1 send , 2 overdue
ReadFlag: the read flag. 0 not read, 1 read.
Parameters in Response :
RecNo: the record index of the new record

13.2.3 Query Alarm Record

Table 13-3

Syntax

http://<server>/cgi-bin/recordFinder.cgi?action=find&name=AlarmRecord[&StartTime=<
startTime>&EndTime=<endTime>&count=<countNo>]

Method

GET

Description

Find the AlarmRecord record. ( This api is supported by video talk device. )

Example

http://192.168.1.108/cgi-bin/recordFinder.cgi?action=find&name=AlarmRecord&StartTi
me=2014-8-25%2000:02:32&EndTime=2014-8-25%2001:02:32&count=500

Intelligent Building APIs 592

Success
Return

totalCount=1000
found=500
records[0].RecNo=789
records[0].CreateTime=123456789
records[0].Channel=0
records[0].SenseMethod=DoorMagnetism
records[0].RoomNumber=501
records[0].ReadFlag=0
records[0].Comment=Friend
…

Parameters in URL:
startTime: The start time ,format : 2014-8-25%2000:01:32
endTime: The end time, format: 2014-8-25%2000:02:32
countNo: the number of records to get, The record count, default 1024

Comment

Parameters in Response :
totalCount : the record count which match condition
found : the record count to return
SenseMethod :the range is { "DoorMagnetism", "PassiveInfrared", "GasSensor",
"SmokingSensor", "WaterSensor", "ActiveInfrared", "CallButton", "UrgencyButton",
"Steal", "Perimeter", "PreventRemove", "DoorBell" }

13.3 SIP

The user needs to connect video intercom through CGI protocol, but do not know how to use this
protocol to configure the device. This document provides the corresponding CGI protocol according
to the configuration data format involved in the specific service.

13.3.1 [Config] SIP Configuration

 Get SIP Configuration

Table 13-4

Syntax

Method

Description

http://<server>/cgi-bin/configManager.cgi?action=getConfig&name
=SIP

GET

Get SIP server configuration.

[ Request Params ] (None)

[ Response Params ] ( key=value format )

Name

table

+SIP

++AccoutName

++SIPServer

++SIPServerPort

Type

object

object

string

string

int

R/O Param Description

R

R

O

R

R

Configuration data table

Configuration name

Account name

SIP server
IP address or domain name
SIP server port number

Intelligent Building APIs 593

++OutboundProxy

++OutboundProxyID

++OutboundProxyPort

++UserID

++UserType

++AuthID

++AuthPassword

++STUNServer

++RegisterRealm

++RegExpiration

++LocalSIPPort

++LocalRTPPort

string

string

Int

String

int

String

String

String

String

int

Int

int

++UnregisterOnReboot

bool

++DefaultCallNumber

++MediaDetail

string

Object

O

O

O

R

O

R

R

O

R

O

R

R

O

O

O

+++VideoStream

string

O

+++AudioStream

string

O

++RouteEnable

++Route

bool

string

++SIPServerLoginUserName

string

++SIPServerLoginPWD

string

++IsMainVTO

string

O

O

O

O

O

Proxy server IP address or domain name
Proxy server ID
Proxy server port number
User account ID
Generally a phone number
User type
Authentication ID
Authentication password
STUN (Simple Traversal of UDP over
NATs) server
IP address or domain name
Registration domain
Registration interval, in seconds
Local SIP port
0-65535
Local RTP port
0-65535
Restart to delete registration information.
true: Delete
false: Not delete
Default call number
Media configuration
Video stream
enumchar[32]{
"Main": Main stream
"Extra1": Sub stream 1
"Extra2": Sub stream 2
"Extra3": Sub stream 3
}
Audio stream
enumchar[32]{
"Main": Main stream
"Extra1": Sub stream 1
"Extra2": Sub stream 2
"Extra3": Sub stream 3
}
Enable SIP cross-router or not.
Router address, which can be IP
address or domain name.
Username to log in to VTNC
For intelligent building only
Password to log in to VTNC
For intelligent building only
Whether the door station is a standby
server
For intelligent building only

Intelligent Building APIs 594

++SIPServerRedundancy

string

++SIPServerRedundancyUserNa
me

++SIPServerRedundancyPassWo
rd

string

string

++AnalogNumberStart

string

++AnalogNumberEnd

string

++UserEnable

bool

O

O

O

O

O

R

Standby server IP address
For intelligent building only
Standby server login username
For intelligent building only
Standby server login password
For intelligent building only
The start number of the analog indoor
monitor supported in the analog system
For intelligent building only
The end number of the analog indoor
monitor supported in the analog system
For intelligent building only
Enable registration
For intelligent building only
true: Register to the SIP server.
false: Not register to the SIP server.

[ Example ]

Request

http://10.0.0.8/cgi-bin/configManager.cgi?action=getConfig&name=SIP

Response

table.SIP.AuthID=8001
table.SIP.AuthPassword=pass123456
table.SIP.IsMainVTO=0
table.SIP.LocalRTPPort=15000
table.SIP.LocalSIPPort=5060
table.SIP.OutboundProxy=192.168.1.111
table.SIP.OutboundProxyID=8000
table.SIP.OutboundProxyPort=5060
table.SIP.RegisterRealm=VDP
table.SIP.Route[0]=sip:10.30.1.2:5060;lr
table.SIP.RouteEnable=true
table.SIP.SIPServer=192.168.1.111
table.SIP.SIPServerID=8000
table.SIP.SIPServerLoginPWD=pass123456
table.SIP.SIPServerLoginUserName=admin
table.SIP.SIPServerPort=5060
table.SIP.SIPServerRedundancyPassWord=pass123456
table.SIP.SIPServerRedundancyUserName=admin
table.SIP.UserEnable=true
table.SIP.UserID=8001
table.SIP.UserType=2

 Set SIP Configuration

URL

http://<server>/cgi-bin/configManager.cgi?action=setConfig

Table 13-5

Method

GET

Description Modify SIP configuration.

[ Request Params ] ( key=value at URL )

Intelligent Building APIs 595

Name

+SIP

Type

object

++AccoutName

string

++SIPServer

string

++SIPServerPor
t

int

++OutboundPro
xy

++OutboundPro
xyID

++OutboundPro
xyPort

string

string

Int

++UserID

String

++UserType

int

++AuthID

++AuthPasswor
d

String

String

++STUNServer

String

++RegisterReal
m

String

++RegExpiration

int

++LocalSIPPort

Int

++LocalRTPPort

int

++UnregisterOn
Reboot

bool

++DefaultCallNu
mber

string

++MediaDetail

Object

+++VideoStream string

O

R/O Param Description

R

O

R

R

O

O

O

R

O

R

R

O

R

O

R

R

O

O

O

Configuration name

Account name

SIP server
IP address or domain name

SIP server port number

Proxy server IP address or domain name

Proxy server ID

Proxy server port number

User account ID
Generally a phone number
User type
Authentication ID

Authentication password

STUN (Simple Traversal of UDP over NATs) server
IP address or domain name

Registration domain

Registration interval, in seconds
Local SIP port
0-65535
Local RTP port
0-65535
Restart to delete registration information.
true: Delete
false: Not delete

Default call number

Media configuration
Video stream
enumchar[32]{
"Main": Main stream
"Extra1": Sub stream 1
"Extra2": Sub stream 2
"Extra3": Sub stream 3
}

Intelligent Building APIs 596

+++AudioStream string

O

++RouteEnable

bool

++Route

string

++SIPServerLog
inUserName

++SIPServerLog
inPWD

string

string

++IsMainVTO

string

++SIPServerRe
dundancy

++SIPServerRe
dundancyUserN
ame

++SIPServerRe
dundancyPassW
ord

string

string

string

++AnalogNumbe
rStart

string

++AnalogNumbe
rEnd

string

++UserEnable

bool

[ Response Params ] ( OK )

O

O

O

O

O

O

O

O

O

O

R

Audio stream
enumchar[32]{
"Main": Main stream
"Extra1": Sub stream 1
"Extra2": Sub stream 2
"Extra3": Sub stream 3
}
Enable SIP cross-router or not.
Router address, which can be IP address or domain
name.
Username to log in to VTNC
For intelligent building only
Password to log in to VTNC
For intelligent building only
Whether the door station is a standby server
For intelligent building only
Standby server IP address
For intelligent building only

Standby server login username
For intelligent building only

Standby server login password
For intelligent building only

The start number of the analog indoor monitor supported
in the analog system
For intelligent building only
The end number of the analog indoor monitor supported
in the analog system
For intelligent building only
Enable registration
For intelligent building
true: Register to the SIP server.
false: Not register to the SIP server.

[ Example ]

Request

http://10.0.0.8/cgi-bin/configManager.cgi?action=setConfig&SIP.SIPServer=192.168.1.10
8&SIP.SIPServerPort=5060&SIP.RegisterRealm=VDP&SIP.RouteEnable=true

Response

OK

13.3.2 [Config] Registar Configuration

 Get Registar Configuration

Table 13-6

Syntax

http://<server>/cgi-bin/configManager.cgi?action=getConfig&name= Registar

Intelligent Building APIs 597

Method

Description

GET

Get Registar configuration.

[ Request Params ] (None)

[ Response Params ] ( key=value format )

Name

table

+Registar

Type

object

object[]

++RegistarName

char[]

R/O Param Description

R

R

O

Configuration data table

One-dimensional array. Each subscript represents a
registration server.

Registration server name, which must be unique.
(Note: For VTH, use the IP address and port in the
configuration to connect VTO.)

++Enable

bool

O

Register to the registration server or not.

++ServerType

enumchar[32] R

++GeneralServerInfo

object

+++Address

+++Port

+++Password

[ Example ]

char[40]

uint

char[64]

O

O

O

O

Server type, which is used only for SIP video talk,
instead of VT video talk.
Enumchar[32]{
"VTO"
"H500"
"VTNC"
"ZYCOO"
"ThirdParty"
"3CXSystem"
"Asterisk"
}

IP address

Registration port number

Password registered to the register server, which will
be used when registration authentication is required.

Request

http://10.0.0.8/cgi-bin/configManager.cgi?action=getConfig&name=Registar

Response

table.Registar[0].ServerType=VTO

 Set Registar Configuration

URL

http://<server>/cgi-bin/configManager.cgi?action=setConfig

Table 13-7

Method

GET

Description Modify Registar configuration.

[ Request Params ] ( key=value at URL )

Name

+Registar

++RegistarNam
e

Type

object[]

char[]

R/O Param Description

R

O

One-dimensional array. Each subscript represents a register
server.

Registration server name, which must be unique.
(Note: For VTH, use the IP address and port in the
configuration to connect VTO.)

++Enable

bool

O

Register to the registration server or not.

Intelligent Building APIs 598

++ServerType

enumchar[32] R

++GeneralServe
rInfo

object

+++Address

char[40]

+++Port

uint

+++Password

char[64]

O

O

O

O

[ Response Params ] ( OK )

[ Example ]

Server type, which is used only for SIP video talk, instead of
VT video talk.
Enumchar[32]{
"VTO"
"H500"
"VTNC"
"ZYCOO"
"ThirdParty"
"3CXSystem"
"Asterisk"
}

IP address

Registration port number

Password registered to the registration server, which will be
used when registration authentication is required.

Request

http://10.0.0.8/cgi-bin/configManager.cgi?action=setConfig&Registar.ServerType=VTO

Response

OK

13.4 Room Number Database Management

13.4.1 Adding Room Number

URL

http://<server>/cgi-bin/recordUpdater.cgi?action=insert&name=VideoTalkContact

Table 13-8

Method

GET

Description Add room number to the contacts.

[ Request Params ] (key=value format in URL)

Name

CreateTime

FirstName

FamilyName

VTShortNumber

Type

uint

string

string

string

VTMiddleNumber

string

VTLongNumber

string

VTNetAddress

MacAdress

VTOPosition

string

string

string

VTSlaveBindMod

enumint

R/O Param Description

O

O

O

R

O

O

O

O

O

O

Start time
UTC seconds, read only

First name

Last name

Short number for video intercom

Middle number for video intercom

Long number for video intercom or serial number of analog
indoor monitor

Network address for video intercom

MAC address

Door number linked with indoor monitor

Mode when accessing to the analog indoor monitor for video

Intelligent Building APIs 599

e

VTSlaveId

uint32

O

VTSlavePort

uint32

O

VTSlaveAddress

NickName

Notes

Type

string

string

string

enumcha
r[32]

O

O

O

O

RegisterType

enumcha
r[32]

R

VTHPassword

VTOBuilding

VTOUnit

GroupNumber

Channel

Floors

string

string

string

string

uint32

char[256]
[4]

LiftControlByVTH

bool

R

O

O

O

O

O

O

talk
Enumint{
0: SubAddress
1: SubID+SubPort
}

Allocator address when accessing to the analog indoor monitor
for video talk
(Change string to uint32 for consistency)

Allocator port when accessing to the analog indoor monitor for
video talk
(Change string to uint32 for consistency)

Address of the analog indoor monitor for video talk

Nickname

Notes

User type
Enumchar[32]{
"VTH": Indoor monitor
"VTO": Door station
}

Registration method
Enumchar[32]{
"public"
"local"
}

Registration password

Building number

Unit number

Group

Channel number, based on which the mobile phone subscribes
to the call notification message.

Floor number (lift control requirements), with up to 256
characters

Lift control is triggered by the indoor monitor opening the door.

[ Response Params ] (key=value format )

Name

RecNo

[ Example ]

Request

Type

int

R/O Param Description

R

Record ID of successfully creation

http://<server>/cgi-bin/recordUpdater.cgi?action=insert&name=VideoTalkContact&VTShort
Number=101&RegisterType=public&VTHPassword=pass123456

Response RecNo=12345

13.4.2 Getting Records by Video Talk short number

URL

http://<server>/cgi-bin/recordFinder.cgi?action=find&name=VideoTalkContact

Table 13-9

Intelligent Building APIs 600

Method

GET

Description Search for records by room number

[ Request Params ] (key=value format in URL)

Name

count

condition

+VTShortNumbe
r

Type

int

object

string

R/O Param Description

O

R

R

Maximum record number of search result

search condition

video talk short number

[ Response Params ] (key=value format )

Type

R/O Param Description

Name

totalCount

found

records

+RecNo

+CreateTime

+FirstName

+FamilyName

+VTShortNumbe
r

+VTMiddleNumb
er

+VTLongNumbe
r

int

int

array<obje
ct>

int

uint

string

string

string

string

string

+VTNetAddress

string

+MacAdress

+VTOPosition

+VTSlaveBindM
ode

string

string

enumint

O

O

R

R

O

O

O

R

O

O

O

O

O

O

+VTSlaveId

uint32

O

+VTSlavePort

uint32

O

+VTSlaveAddres
s

+NickName

+Notes

+Type

string

string

string

enumchar[
32]

O

O

O

O

total record number of search result

Number of records returned

Records returned

Record ID

Start time
UTC seconds, read only

First name

Last name

Short number for video intercom

Middle number for video intercom

Long number for video intercom or serial number of VTH
analog indoor monitor

Network address for video intercom

MAC address

Door number linked with indoor monitor

Mode when accessing to the analog indoor monitor for video
talk
Enumint{
0: SubAddress
1: SubID+SubPort
}

Allocator address when accessing to the analog indoor monitor
for video talk
(Change string to uint32 for consistency)

Allocator port when accessing to the analog indoor monitor for
video talk
(Change string to uint32 for consistency)

Address of the analog indoor monitor for video talk

Nickname

Notes

User type
Enumchar[32]{

Intelligent Building APIs 601

+RegisterType

enumchar[
32]

R

+VTHPassword

string

+VTOBuilding

+VTOUnit

string

string

+GroupNumber

string

R

O

O

O

"VTH": Indoor monitor
"VTO": Door station
}

Registration method
Enumchar[32]{
"public"
"local"
}

Registration password

Building number

Unit number

Group

[ Example ]

Request

http://<server>/cgi-bin/recordFinder.cgi?action=find&name=VideoTalkContact&count=10&
condition.VTShortNumber=101

Response

totalCount=10
found=1
records[0].RecNo=12345
records[0].CreateTime=123456789
records[0].FirstName=San
records[0].FamilyName=Zhang
records[0].VTShortNumber=0101
records[0].VTMiddleNumber=11010101
records[0].VTLongNumber=330103001101010151
records[0].VTNetAddress=127.0.0.1
records[0].MacAdress=0A:3E:FF:2A:50:41
records[0].VTOPosition=01018001
records[0].VTSlaveBindMode=0
records[0].VTSlaveId=1258421
records[0].VTSlavePort=1258421
records[0].VTSlaveAddress=04:b3:01:f7
records[0].NickName=Nick
records[0].Notes=Friend
records[0].Type=VTH
records[0].RegisterType=public
records[0].VTHPassword=123456
records[0].VTOBuilding=01
records[0].VTOUnit=01
records[0].GroupNumber=301
records[0].Channel=1
records[0].Floors[0]=1
records[0].LiftControlByVTH=true

13.4.3 Getting Records by recno

Table 13-10

Intelligent Building APIs 602

URL

http://<server>/cgi-bin/recordUpdater.cgi?action=get&name=VideoTalkContact

Method

GET

Description Search for room number records by recno.

[ Request Params ] (key=value format in URL)

Name

recno

Type

int

R/O Param Description

R

Record ID

[ Response Params ] (key=value format )

R/O Param Description

Name

+RecNo

+CreateTime

+FirstName

+FamilyName

+VTShortNumbe
r

+VTMiddleNumb
er

+VTLongNumbe
r

Type

int

uint

string

string

string

string

string

+VTNetAddress

string

+MacAdress

+VTOPosition

+VTSlaveBindM
ode

string

string

enumint

R

O

O

O

R

O

O

O

O

O

O

+VTSlaveId

uint32

O

+VTSlavePort

uint32

O

+VTSlaveAddres
s

+NickName

+Notes

+Type

string

string

string

enumchar[
32]

O

O

O

O

+RegisterType

enumchar[
32]

R

Record ID

Start time
UTC seconds, read only

First name

Last name

Short number for video intercom

Middle number for video intercom

Long number for video intercom or serial number of VTH
analog indoor monitor

Network address for video intercom

MAC address

Door number linked with indoor monitor

Mode when accessing to the analog indoor monitor for video
talk
Enumint{
0: SubAddress
1: SubID+SubPort
}

Allocator address when accessing to the analog indoor monitor
for video talk
(Change string to uint32 for consistency)

Allocator port when accessing to the analog indoor monitor for
video talk
(Change string to uint32 for consistency)

Address of the analog indoor monitor for video talk

Nickname

Notes

User type
Enumchar[32]{
"VTH": Indoor monitor
"VTO": Door station
}

Registration method
Enumchar[32]{
"public"

Intelligent Building APIs 603

"local"
}

+VTHPassword

string

+VTOBuilding

+VTOUnit

string

string

+GroupNumber

string

R

O

O

O

Registration password

Building number

Unit number

Group

[ Example ]

Request

http://<server>/cgi-bin/recordUpdater.cgi?action=get&name=VideoTalkContact&recno=123
45

Response

record.RecNo=12345
record.CreateTime=123456789
record.FirstName=Dafei
record.FamilyName=Wang
record.VTShortNumber=0101
record.VTMiddleNumber=11010101
record.VTLongNumber=330103001101010151
record.VTNetAddress=127.0.0.1
record.MacAdress=0A:3E:FF:2A:50:41
record.VTOPosition=01018001
record.VTSlaveBindMode=0
record.VTSlaveId=1258421
record.VTSlavePort=1258421
record.VTSlaveAddress=04:b3:01:f7
record.NickName=Nick
record.Notes=Friend
record.Type=VTH
record.RegisterType=public
record.VTHPassword=123456
record.VTOBuilding=01
record.VTOUnit=01
record.GroupNumber=301
record.Channel=1
record.Floors[0]=1
record.LiftControlByVTH=true

13.4.4 Updating Room Number Records

URL

http://<server>/cgi-bin/recordUpdater.cgi?action=update&name=VideoTalkContact

Table 13-11

Method

GET

Description Update Room number database records.

[ Request Params ] (key=value format in URL)

Name

recno

CreateTime

Type

int

uint

R/O Param Description

R

O

Record ID

Start time
UTC seconds, read only

Intelligent Building APIs 604

FirstName

FamilyName

string

string

VTShortNumber

string

VTMiddleNumbe
r

string

VTLongNumber

string

VTNetAddress

MacAdress

VTOPosition

VTSlaveBindMo
de

string

string

string

enumint

O

O

O

O

O

O

O

O

O

VTSlaveId

uint32

O

VTSlavePort

uint32

O

VTSlaveAddress string

NickName

Notes

Type

string

string

enumchar[
32]

O

O

O

O

RegisterType

enumchar[
32]

O

VTHPassword

VTOBuilding

VTOUnit

GroupNumber

Channel

string

string

string

string

uint32

Floors

LiftControlByVT
H

char[256][4 ]

bool

[ Response Params ] (OK)

O

O

O

O

O

O

O

First name

Last name

Short number for video intercom

Middle number for video intercom

Long number for video intercom or serial number of VTH
analog indoor monitor

Network address for video intercom

MAC address

Door number linked with indoor monitor

Mode when accessing to the analog indoor monitor for video
talk
Enumint{
0: SubAddress
1: SubID+SubPort
}

Allocator address when accessing to the analog indoor monitor
for video talk
(Change string to uint32 for consistency)

Allocator port when accessing to the analog indoor monitor for
video talk
(Change string to uint32 for consistency)

Address of the analog indoor monitor for video talk

Nickname

Notes

User type
Enumchar[32]{
"VTH": Indoor monitor
"VTO": Door station
}

Registration method
Enumchar[32]{
"public"
"local"
}

Registration password

Building number

Unit number

Group

Channel number, based on which the mobile phone subscribes
to the call notification message.

Floor number (lift control requirements), with up to 256
characters

Lift control is triggered by the indoor monitor opening the door.

Intelligent Building APIs 605

[ Example ]

Request

http://<server>/cgi-bin/recordUpdater.cgi?action=update&name=VideoTalkContact&recno=
12345&FirstName=Green&FamilyName=Jim&VTHPassword=654321

Response OK

13.4.5 Deleting Records by recno

URL

http://<server>/cgi-bin/recordUpdater.cgi?action=remove&name=VideoTalkContact

Table 13-12

Method

GET

Description Delete records by recno.

[ Request Params ] (key=value format in URL)

Name

recno

Type

int

R/O Param Description

R

Record ID

[ Response Params ] (OK)

[ Example ]

Request

http://<server>/cgi-bin/recordUpdater.cgi?action=remove&name=VideoTalkContact&recno
=12345

Response OK

13.4.6 Clearing All Room Numbers

URL

http://<server>/cgi-bin/recordUpdater.cgi?action=clear&name=VideoTalkContact

Table 13-13

Method

GET

Description Delete all records .

[ Request Params ] (key=value format in URL)

Name

name

Type

string

[ Response Params ] (OK)

[ Example ]

R/O Param Description

R

Database name, which must be VideoTalkContact.

Request

http://<server>/cgi-bin/recordUpdater.cgi?action=clear&name=VideoTalkContact

Response OK

13.4.7 Getting Total Quantity of Room Number

Table 13-14

URL

http://<server>/cgi-bin/recordFinder.cgi?action=getQuerySize&name=VideoTalkContact

Method

GET

Description Get the total number of records of the database VideoTalkContact.

[ Request Params ] (key=value format in URL)

Name

name

Type

string

R/O Param Description

R

Database name, which must be VideoTalkContact.

Intelligent Building APIs 606

[ Response Params ] (key=value format )

Name

count

[ Example ]

Type

int

R/O Param Description

R

Total number of records

Request

http://<server>/cgi-bin/recordFinder.cgi?action=getQuerySize&name=VideoTalkContact

Response Count=200

13.5 ElevatorFloorCounter

13.5.1 Set Elevator Floor Info

URL

http://<server>/cgi-bin/ElevatorFloorCounter.cgi?action=setElevatorFloorInfo&CheckBas
eFloor=<Second>&channel=<ChannelNo>

Method

GET

Description Set elevator floor infomation

[ Request Params ] (key=value format in URL)

Name

Channel

Type

int

CheckBaseFloor string

R/O Param Description

R

R

ChannelNo, start from 1, default 1

Calibrate base floor, unit floor, It's not necessarily numbers

[ Response Params ] (key=value format )

Name

[ Example ]

Request

Type

R/O Param Description

http://192.168.1.108/cgi-bin/ElevatorFloorCounter.cgi?action=setElevatorFloorInfo&Check
BaseFloor=5&Channel=1

Response OK

13.5.2 Get Elevator WorkInfo

URL

http://<server>/cgi-bin/ElevatorFloorCounter.cgi?action=getElevatorWorkInfo&Channel=
<ChannelNo>

Method

GET

Description Get elevator work infomation

[ Request Params ] (key=value format in URL)

Name

Channel

Type

int

R/O Param Description

R

ChannelNo, start from 1, default 1

[ Response Params ] (key=value format )

Name

table

[ Example ]

Request

Response

Type

R/O Param Description

object

R

Operation information, including the current floor, status, speed,
whether to calibrate

http://192.168.1.108/cgi-bin/ElevatorFloorCounter.cgi?action=getElevatorWorkInfo&Chann
el=1

table.ElevatorFloor=20
table.ElevatorWorkState=1
table.ElevatorWorkSpeed=20

Intelligent Building APIs 607

table.IsCheckFloor=true

13.5.3 Get Capability

URL

http://<server>/cgi-bin/ElevatorFloorCounter.cgi?action=getCaps&Channel=<ChannelNo

>

Method

GET

Description Get elevator floor capacities.

[ Request Params ] (key=value format in URL)

Name

Channel

Type

int

R/O Param Description

R

ChannelNo, start from 1, default 1

[ Response Params ] (key=value format )

Name

caps

+IsElevatorFloor
Counter

[ Example ]

Type

object

bool

R/O Param Description

R

R

elevator floor capacities

Whether the floor configuration function is supported

Request

http://192.168.1.108/cgi-bin/ ElevatorFloorCounter.cgi?action=getCaps&channel=1

Response

caps.IsElevatorFloorCounter=true

Intelligent Building APIs 608

14 DVR Custom APIs

14.1 File Finder

14.1.1 Create a File Finder

Table 14-1

Syntax

http://<server>/cgi-bin/FileFindHelper.cgi?action=startFind&condition.channel=<Channe
lNo>&condition.startTime=<start>&condition.endTime=<end>&condition.streamType=<
stream>[&condition.flags[0]=<flag>&condition.events[0]=<event>&combineMode.granu
larity=<granularityValue>&combineMode.types[0]=<combineType>]

Method

GET

Description

Start to find files.

Example

Find a file in channel 1. Event type is "AlarmLocal" or "VideoMotion". Time lines between
2014-1-1 12:00:00 and 2015-1-10 12:00:00. Combine "AlarmLocal" or "VideoMotion"
files with granularity 16.
URL is:
http://172.23.1.66/cgi-bin/fileFindHelper.cgi?action=startFind&condition.channel=1&con
dition.startTime=2014-1-1%2012:00:00&condition.endTime=2015-1-10%2012:00:00&co
ndition.streamType=Main&condition.flags[0]=Event&condition.events[0]=AlarmLocal&co
ndition.events[1]=VideoMotion&combineMode.granularity=16&combineMode.types[0]=A
larmLocal&combineMode.types[0]=VideoMotion

Success
Return

result=08137

Comment

Start to find a file with the above condition and combine files with certain type. If it
succeeds, return to find id. Otherwise return to Error.
Parameters in URL:
ChannelNo: integer, video channel index which starts from 1.
start / end: the start/end time when recording.
flag: which flags of the file you want to find. It is an array. The index starts from 0. The
range of flag is {"Timing", "Marked", "Event", "Restrict"}. If omitted, find files with all the
flags.
event: by which event the record file is triggered. It is an array. The index starts from 0.
The range of event is {"AlarmLocal", "VideoMotion", "VideoLoss"}. This condition can be
omitted. If omitted, find files of all the events.
stream: which video stream type you want to find. The range of stream is {"Main",
"Extra1", "Extra2", "Extra3"}.
combineType: which types of the file you want to combined. It is an array. The index
starts from 0. The range of combine type is {"AlarmLocal", "VideoMotion", "Timing",
"VideoLoss"}. This condition can be omitted. If omitted, file will not be combined.
granularityValue: by which granularity to combine files
Example:

DVR Custom APIs 609

File 1:
items[0].Channel =1
items[0].StartTime =2011-1-1 12:00:00
items[0].EndTime =2011-1-1 13:00:00
items[0].Events[0]=AlarmLocal
items[0].VideoStream=Main
items[0].Length =790
items[0].Duration = 3600

File 2:
items[0].Channel =1
items[0].StartTime =2011-1-1 13:00:00
items[0].EndTime =2011-1-1 14:00:00
items[0].Events[0]=AlarmLocal
items[0].VideoStream=Main
items[0].Length =790
items[0].Duration = 3600

file1 and file2 will be combined to file3
File 3:
items[0].Channel =1
items[0].StartTime =2011-1-1 12:00:00
items[0].EndTime =2011-1-1 14:00:00
items[0].Events[0]=AlarmLocal
items[0].VideoStream=Main
items[0].Length =1580
items[0].Duration = 7200

14.1.2 Create a Motion File Finder

Table 14-2

Syntax

http://<server>/cgi-bin/FileFindHelper.cgi?action=startMotionFind&condition.channel=<C
hannelNo>&condition.startTime=<start>&condition.endTime=<end>&condition.streamT
ype=<stream>&motionRegion.senseLevel=<level>[&motionRegion.rects[rectNo][0]=<r
ect0>&motionRegion.rects[rectNo][1]=<rect1>&motionRegion.rects[rectNo][2]=<rect2>
&motionRegion.rects[rectNo][3]=<rect3>]

Method

GET

Description

Start to find motion files.

Example

Find a file in channel 1, event type is "AlarmLocal" or "VideoMotion", and time between
2014-1-1 12:00:00 and 2015-1-10 12:00:00, motion region is [0,0,21,17]
URL is:
http://172.23.1.66/cgi-bin/fileFindHelper.cgi?action=startMotionFind&condition.channel=
1&condition.startTime=2014-1-1%2012:00:00&condition.endTime=2015-1-10%2012:00:
00&condition.streamType=Main&condition.flags[0]=Event&condition.events[0]=AlarmLoc
al&condition.events[1]=VideoMotio&motionRegion.senseLevel=1&motionRegion.rects[1]
[0]=0&motionRegion.rects[1][1]=0&motionRegion.rects[1][2]=21&motionRegion.rects[1]

DVR Custom APIs 610

3]=17

result=08137

Success
Return

Comment

Start to find a file with the above condition and combine files with certain type. If success,
return find id, else return Error.
Parameters in URL:
ChannelNo: integer, video channel index which starts from 1.
start / end: the start/end time when recording.
flag: which flags of the file you want to find. It is an array. The index starts from 0. The
range of flag is {"Timing", "Marked", "Event", "Restrict"}. If omitted, find files with all the
flags.
event: by which event the record file is triggered. It is an array. The index starts from 0.
The range of event is {"AlarmLocal", "VideoMotion"}. This condition can be omitted. If
omitted, find files of all the events.
stream: which video stream type you want to find. The range of stream is {"Main",
"Extra1", "Extra2", "Extra3"}.
level: the motion sensitive level, range is 0–6, 0 represent all level
rectNo: the rects array index, start from 1
rect0 & rect1 & rect2 & rect3 : relative coordinates, rect0 and rect2 range is 0—21, rect1
and rect3 range is 0—17. {0,0,0,0} top—left, {21,0,0,0} top—right, {0,17,0,0} bottom
—left, {21,17,0,0} bottom—right

14.1.3 Get the File Information Found by the Finder

Table 14-3

Syntax

http://<server>/cgi-bin/FileFindHelper.cgi?action=findNext&findId=<findId>&count=<file
Count>

Method

GET

Description

Find the next files no more than fileCount number.

Example

http://192.168.1.108/cgi-bin/FileFindHelper.cgi?action=findNext&findId=08137&count=10
0

Success
Return

found=1
items[0].channel =1
items[0].startTime =2011-1-1 12:00:00
items[0].endTime =2011-1-1 13:00:00
items[0].fileType =dav
items[0].events[0]=AlarmLocal
items[0].streamType=Main
items[0].length =790
items[0].duration = 3600

Comment

findId: The find Id is created by API Create a file finder or API Create a motion file finder.
Must create a finder before finding files.

DVR Custom APIs 611

14.1.4 Stop the Finder

Table 14-4

Syntax

Method

http://<server>/cgi-bin/FileFindHelper.cgi?action=stopFind&findId=<findId>

GET

Description

Stop the searching operation.

Example

Success
Return

Comment

http://192.168.1.108/cgi-bin/FileFindHelper.cgi?action=stopFind&findId=08137

OK

findId: The find Id is created by API Create a file finder or API Create a motion file
finder. Must create a finder before finding files.

14.1.5 Get Bound Files

Table 14-5

Syntax

http://<server>/cgi-bin/FileFindHelper.cgi?action=getBoundFile&condition.channel=<Cha
nnelNo>&condition.startTime=<start>&condition.endTime=<end>&condition.streamTyp
e=<stream>[&condition.flags[0]=<flag>&condition.events[0]=<event>]

Method

GET

Description Get bound files.

Example

http://<server>/cgi-bin/FileFindHelper.cgi?action=getBoundFile&condition.channel=1&co
ndition.startTime=2014-1-1%2012:00:00&condition.endTime=2015-1-10%2012:00:00&c
ondition.streamType=Main&condition.flags[0]=Timing

Success
Return

found=2
items[0].channel =1
items[0].startTime =2011-1-1 12:00:00
items[0].endTime =2011-1-1 13:00:00
items[0].flags [0]= Timing
items[0].streamType=Main
items[0].length =790
items[0].duration = 3600
items[1].channel =1
items[1].startTime =2011-1-1 13:00:00
items[1].endTime =2011-1-1 14:00:00
items[1].events[0]= Timing
items[1].streamType=Main
items[1].length =790
items[1].duration = 3600

Comment

Params is same as FileFindHelper.startFind

DVR Custom APIs 612

14.2 BandLimit

14.2.1 Get Bandwidth Limit State

Table 14-6

Syntax

Method

http://<server>/cgi-bin/BandLimit.cgi?action=getLimitState

GET

Description

Get bandwidth limit state.

Example

Success
Return

http://192.168.1.108/cgi-bin/bandLimit.cgi?action=getLimitState

limit=true

Comment

—

14.3 Record Files Protection

14.3.1 Add Protection

Table 14-7

Syntax

http://<server>/cgi-bin/FileManager.cgi?action=addConditionList&condition.Types[0]=<
paramValue>&condition.StartTime=<paramValue>&condition.EndTime=<paramValu
e>&condition.Channel[0]=<paramValue>

Method

GET

Description

Add protection or access control for record files.

http://192.168.1.108/cgi-bin/FileManager.cgi?action=addConditionList&condition.Types
[0]=RecordRestrict&condition.Types[1]=RecordProtect&condition.StartTime=2014-7-3
%2021:02:32&condition.EndTime=2014-7-3%2023:02:32&condition.Channel[0]=1&con
dition.Channel[1]=3

OK

In table below:
TypeIndex: The index of type array
ChIndex: The index of channel number array

Example

Success
Return

Comment

Appendix:

ParamName

ParamValue type

Description

condition.Type[TypeIndex]

string

condition.StartTime

condition.EndTime

string

string

An array. The range is {"RecordProtect",
"RecordRestrict"}.

The time format is "Y-M-D H-m-S", example
2011-7-3%2021:02:32

The time format is "Y-M-D H-m-S"

condition.Channel[ChIndex]

integer

Video channel index which starts from 1.

DVR Custom APIs 613

14.3.2 Cancel Protection

Table 14-8

Syntax

http://<server>cgi-bin/FileManager.cgi?action=cancelConditionList&condition.Types[0]
=<paramValue>&condition.StartTime=<paramValue>&condition.EndTime=<paramVa
lue>&condition.Channel[0]=<paramValue>

Method

GET

Description

Cancel protection of record files.

Example

http://192.168.1.108/cgi-bin/FileManager.cgi?action=cancelConditionList&condition.Ty
pes[0]=RecordRestrict&condition.Types[1]=RecordProtect&condition.StartTime=2014-
7-3%2021:02:32&condition.EndTime=2014-7-3%2023:02:32&condition.Channel[0]=1&
condition.Channel[1]=3

Success
Return

OK

Comment

paramValue as Appendix above.

14.3.3 Remove Protection

Table 14-9

Syntax

http://<server>/cgi-bin/FileManager.cgi?action=removeConditionList&condition.Types[0
]=<paramValue>&condition.StartTime=<paramValue>&condition.EndTime=<paramV
alue>&condition.Channel[0]=<paramValue>

Method

GET

Description

Remove protection of record files.

Example

http://192.168.1.108/cgi-bin/FileManager.cgi?action=removeConditionList&condition.Ty
pes[0]=RecordRestrict&condition.Types[1]=RecordProtect&condition.StartTime=2014-
7-3%2021:02:32&condition.EndTime=2014-7-3%2023:02:32&condition.Channel[0]=0&
condition.Channel[1]=3

Success
Return

OK

Comment

paramValue as Appendix above.

14.3.4 DownloadFile

download file

http://<server>/cgi-bin/FileManager.cgi?action=downloadFile
GET

Request URL
Method
Request Params ( key=value format in URL )
Name
fileName
Request Example
http://192.168.1.108/cgi-bin/FileManager.cgi?action=downloadFile&fileName=download.jpg

R/O Description
R

filename or path

Type
string

Example
download.jpg

DVR Custom APIs 614

Example

R/O Description

Response Params (multipart binary data )
Name
Type
Response Example
HTTP/1.1 200 OK
Content-type: text/plain;charset=utf-8
CONNECTION: close
Set-Cookie:secure; HttpOnly
CONTENT-LENGTH: <length>

<Binary Data>

14.3.5 UploadFile

Upload radar photos

Request URL

http://<server>/cgi-bin/FileManager.cgi?action=uploadFile&fileName=<FileName>&Pat
h=<Path>
POST

Method
Request Params ( key=value format in url )
Name

Type

R/O

fileName

string

R

Description
File name, only the types bmp and jpg
are available for radars.
The file path to store

Example

"xxxxxx.bmp"

R

string

Path
Request Example
POST http://192.168.1.108/cgi-bin/FileManager.cgi?action=uploadFile&fileName=xxxxxx.bmp&fileLengt
h=124879 HTTP/1.1
Host: 192.168.1.108
Connection: keep-alive
Content-Type: multipart/form-data;boundary=---------------------------8655433224198
Content-Length: xxxxxxxxx

/upload_pic

-----------------------------8655433224198
Content-Disposition:form-data;name="upload"; filename="xxxxxx.bmp"
Content-Type: image/jpeg or application/x-MS-bmp

photo data….

-----------------------------8655433224198--

Response Params ( OK in body )
Parameter
Response Example
OK

Type

Required Description

Example

DVR Custom APIs 615

14.3.6 List all elements in the specified directory

POST

Request URL http://<server>/cgi-bin/api/FileManager/list
Method
Request Params ( JSON format in body )
Name
path

R/O Description
R

Type
char[260]

To get the path, there will be
internal security verification. For
files uploaded externally, such as
obtaining the SFTP directory, you
can obtain the NAS configuration
and find the corresponding
directory for query.

Request Example
{
"path": "/mnt/dvr/sda0/2010/8/11/dav"
}

Example
"/mnt/dvr/sda0/
2010/8/11/dav"

Response Params ( JSON format in body )
Name
elementInfo
+type

R/O Description
R
O

Type
object[]
enumchar[
16]

+file

object

++FileType

char[64]

++CreateTime char[20]
char[20]
++ModifyTime
double
++Size

O

O

O
O
O

++path

char[260]

O

++Desc
+directory

char[128]
object

O
O

++CreateTime char[20]

O

++path

char[260]

O

File element information
File element type
enumchar[16]{
"File"
"Directory"
}
File info（valid when
Type="File" ）
file node type
"Wireshark/tcpdump",
See Wireshark packet
capture file type
Creation time
Modification time
File size, the decimal
part is meaningless.
Unit: byte
Absolute path

File Custom Description
directory information ,it
works when
Type="Directory"
Creation time, formatted
as "Y-M-D H-m-S"
Absolute path

Example

"File"

"Wireshark/tcpdump"

"2010-4-15 9:58:32"
"2010-4-15 9:58:32"
1873.0

"/mnt/dvr/sda0/2010/8/1
1/dav.jpg"
"xxxxxxx"

"2010-4-15 9:58:32"

"/mnt/dvr/sda0/2010/8/1

DVR Custom APIs 616

1/dav"

Response Example
{
"elementInfo": [{
"type": "File",
"file": {
"FileType": "Wireshark/tcpdump",
"CreateTime": "2010-4-15 9:58:32",
"ModifyTime": "2010-4-15 9:58:32",
"Size": 1873.0,
"path": "/mnt/dvr/sda0/2010/8/11/dav.jpg",
"Desc": "xxxxxxx"
},
"directory": {
"CreateTime": "2010-4-15 9:58:32",
"path": "/mnt/dvr/sda0/2010/8/11/dav"
}
},…{}]
}

14.4 Daylight

14.4.1 Get Daylight

Table 14-10

Syntax

Method

http://<server>/cgi-bin/global.cgi?action=getDST

GET

Description

Get daylight saving time state.

Example

Success
Return

http://192.168.1.108/cgi-bin/global.cgi?action=getDST

result = 1

Comment

result: 1/0, yes or not in daylight saving time

DVR Custom APIs 617

15 Other APIs

15.1 Discover Devices

15.1.1 Discover Devices on Internet

Table 15-1

Syntax

Method

http://<server>/cgi-bin/deviceDiscovery.cgi?action=attach[&DeviceClass=<deviceClass>]

GET

Description Discover devices on internet.

Example

http://192.168.1.108/cgi-bin/deviceDiscovery.cgi?action=attach&DeviceClass=VTO

Success
Return

deviceInfo[index].AlarmInputChannels=8
deviceInfo[index].AlarmOutputChannels=0
deviceInfo[index].DeviceClass=VTO
deviceInfo[index].DeviceType=VTO2000A
deviceInfo[index].HttpPort=80
deviceInfo[index].IPv4Address.DefaultGateway=172.12.0.1
deviceInfo[index].IPv4Address.DhcpEnable=false
deviceInfo[index].IPv4Address.IPAddress=172.12.7.102
deviceInfo[index].IPv4Address.SubnetMask=255.255.0.0
deviceInfo[index].IPv6Address.DefaultGateway=2008::1
deviceInfo[index].IPv6Address.DhcpEnable=false
deviceInfo[index].IPv6Address.IPAddress=2008::6/112
deviceInfo[index].Mac=00:01:5b:01:44:77
deviceInfo[index].MachineName=YZZ4DZ008D00031
deviceInfo[index].Port=37777
deviceInfo[index].RemoteVideoInputChannels=0
deviceInfo[index].SerialNo=YZZ4DZ008D00031
deviceInfo[index].Vendor=Multi
deviceInfo[index].Version=1.200.0.0
deviceInfo[index].VideoInputChannels=1
deviceInfo[index].VideoOutputChannels=16

Comment

Parameters in URL:
deviceClass: in range of {VTO, VTH, VTT, VTS, VTNC, SHG}
Parameters in Response:
index: the array index which starts from 0.
Version: Software Version

Other APIs 618

15.2 Open Platform

15.2.1 Application Start and Stop

 Start Application

Syntax

http://<server>/cgi-bin/installManager.cgi?action=start&appname=<appname>&appid=
<appid>

Table 15-2

Method

GET

Description

Start application.

Example

Success
Return

Comment

http://192.168.1.108/cgi-bin/installManager.cgi?action=start&appname=FaceDemo&ap
pid=1

OK

Parameters in URL:
appname: the application name,
appid: optional, the application id

 Stop Application

Table 15-3

Syntax

http://<server>/cgi-bin/installManager.cgi?action=stop&appname=<appname>&appid=
<appid>

Method

GET

Description

Stop application.

Example

Success
Return

Comment

http://192.168.1.108/cgi-bin/installManager.cgi?action=stop&appname=FaceDemo&ap
pid=1

OK

Parameters in URL:
appname: the application name,
appid: optional, the application id

15.2.2 Install Application



Install application with app data

URL

http://<server>/cgi-bin/dhop.cgi?action=uploadApp

Table 15-4

Method

POST

Description

Install application.

[ Request Params ] (None)

[ Response Params ] ( OK )

[ Example ]

Other APIs 619

POST /cgi-bin/dhop.cgi?action=uploadApp HTTP/1.1
Host: 172.29.2.176
Content-Length: 413124
Content-Type:multipart/form-data;boundary=<boundary>

Request

--<boundary>
Content-Disposition: form-data; name="dev_upgrade"; filename="demo.bin"
Content-Type: application/octet-stream

<app data>
--<boundary>--

Response

OK



Install Application with app download url

Table 15-5

URL

http://<server>/cgi-bin/dhop.cgi?action=installAppByUrl

Method

GET

Description

Install application.

[ Request Params ] (key=value format in URL)

Url

string

R

The app download url

[ Response Params ] ( OK )

[ Example ]

Request

http://192.168.1.108/cgi-bin/dhop.cgi?action=installAppByUrl&Url=https://aaa/bbb/ccc/ap
p.bin

Response

OK

15.2.3 Update Application and License

 Update Application with app download url

Table 15-6

URL

http://<server>/cgi-bin/dhop.cgi?action=updateAppByUrl

Method

GET

Description Update Application

[ Request Params ] (key=value format in URL)

appName

Url

string

string

[ Response Params ] ( OK )

R

R

The app name

The app download url

[ Example ]

Request

http://192.168.1.108/cgi-bin/dhop.cgi?action=updateAppByUrl&appName=xxx&Url=http
s://aaa/bbb/ccc/app.bin

Response

OK

 Update firmware with firmware download url

Table 15-7

Other APIs 620

URL

http://<server>/cgi-bin/dhop.cgi?action=updateFirmwareByUrl

Method

GET

Description Update firmware

[ Request Params ] (key=value format in URL)

Url

string

R

The firmware download url

[ Response Params ] ( OK )

[ Example ]

Request

http://192.168.1.108/cgi-bin/dhop.cgi?action=updateFirmwareByUrl&Url=https://aaa/bbb/
ccc/firmware.bin

Response

OK

 Update application license with license download url

Table 15-8

URL

http://<server>/cgi-bin/dhop.cgi?action=updateLicenseByUrl

Method

GET

Description Update application license.

[ Request Params ] (key=value format in URL)

appName

Url

string

string

[ Response Params ] ( OK )

R

R

The app name

The license download url

[ Example ]

Request

http://192.168.1.108/cgi-bin/dhop.cgi?action=updateLicenseByUrl&appName=xxx&Url=h
ttps://aaa/bbb/ccc/license.bin

Response

OK

 Update application license with license data

URL

http://<server>/cgi-bin/dhop.cgi?action=uploadLicense

Table 15-9

Method

POST

Description Update application license.

[ Request Params ] (key=value format in URL)

appName

string

R

The app name

[ Response Params ] ( OK )

[ Example ]

POST /cgi-bin/dhop.cgi?action=uploadLicense&appName=xxx HTTP/1.1
Host: 172.29.2.176
Content-Type: application/octet-stream
Content-Length: <length>

Request

<app license data>

Response

OK

Other APIs 621

15.2.4 Uninstall Application

URL

http://<server>/cgi-bin/dhop.cgi?action=uninstall

Method

GET

Description Uninstall application.

[ Request Params ] (key=value format in URL)

appName

string

R

The app name

[ Response Params ] ( OK )

[ Example ]

Request

http://192.168.1.108/cgi-bin/dhop.cgi?action=uninstall&appName=xxx

Response

OK

15.2.5 Download Application Log

URL

http://<server>/cgi-bin/dhop.cgi?action=downloadLog

Method

GET

Description Download application log.

[ Request Params ] (key=value format in URL)

appName

string

R

The app name

[ Response Params ] ( log file content )

[ Example ]

Request

http://192.168.1.108/cgi-bin/dhop.cgi?action=downloadLog&appName=xxx

HTTP/1.1 200 OK
Server: Device/1.0
Content-Type: Application/octet-stream
Content-Length: <length>

Response

<log file data>

15.3 GPS

15.3.1 Get Capablity

Get the capability of position system.

Syntax

Method

http://<ip>/cgi-bin/GpsControl.cgi?action=getCaps

GET

Description

Get GpsControl caps.

Example

Success
Return

http://192.168.1.108/cgi-bin/GpsControl.cgi?action=getCaps

caps.SUPPORTMODE[0]=”GPS”
caps.SUPPORTMODE[1]=”BEIDOU”

Other APIs 622

15.3.2 [Config] GPS config



get config of position system

Syntax

Method

http://<ip>/cgi-bin/configManager.cgi?action=getConfig&name=GPS

GET

Description

Get the config of position system.

Example

Success
Return

http://192.168.1.108/cgi-bin/global.cgi?action= getConfig&name=GPS

Table.GPS[0].Enable[0]=true
Table.GPS[1].Enable[1]=false
Table.GPS[0].CurMode[0]="GPS"
Table.GPS[1].CurMode[1]="BEIDOU"
Table.GPS[0].SyncTime[0]=true
Table.GPS[1].SyncTime[1]=false



set config of position system.

Syntax

http://<ip>/cgi-bin/configManager.cgi?action=setConfig&<paramName>=<paramValue>[
&<paramName>=<paramValue>...]

Comment

In below table, head =GPS

OK or ERROR

Success
Return

Appendix:

ParamName

head.Enable

head.CurMode

head.SyncTime

ParamVal
ue type

bool

string

bool

Description

true/false

"GPS"/"BEIDOU"

true/false

15.3.3 Get GPS Status

Syntax

Method

http://<server>/cgi-bin/positionManager.cgi?action=getStatus

GET

Description

Get gps info

Example

Success
Return

Comment

http://192.168.1.108/cgi-bin/positionManager.cgi?action=getStatus

status.Time=2011-07-03 21:02:32
status.Longitude=120.175556
status.Latitude=30.186389
status.Speed=30.00
status.Altitude=45.0
status.Bearing=45.3
status.SatelliteCount=11
status.WorkStatus=1
Time：time, ex: 2012-01-04 23:30:30.
Longitude：Longitude, in degrees, positive East, negative West
Latitude：Latitude, in degrees, positive north, negative South

Other APIs 623

Speed：speed, unit: km/h
Altitude：Altitude, unit: m
Bearing：Direction angle，unit: degree
SatelliteCount：Satellite number
WorkStatus：GPS working status，0= unlocated，1= un-differenced positioning，2=
differential positioning，3= invalid PPS，6= estimating

15.4 Lens Function

15.4.1 Get Lens Capability

URL

http://<server>/cgi-bin/LensFunc.cgi?action=getCaps

Method

GET

Description Get Caps

[ Request Params ] ( key=value format at URL )

Name

Channel

Type

uint

R/O Param Description

R

Video channel index which starts from 1.

[ Response Params ] ( key=value format )

Name

Caps

+DepthField

+AngleAdjust

Type

object

uint8

object

++Support

uint8

++MaxVelocity

uint8

[ Example ]

R/O Param Description

R

R

O

R

R

The capacity.

Whether support depth field adjust, 0 : not support, 1 : support

The angel adjust capacity.

Whether support angel adjust, 0 : not support, 1 : only support
horizontal adjust, 2 : only support vertical adjust, 3 : support
both horizontal and vertical adjust.

The max velocity, range from 1 to 8

Request

http://192.168.1.108/cgi-bin/LensFunc.cgi?action=getCaps&Channel=1

Response

Caps.DepthField=1
Caps.AngelAdjust.Support=3
Caps.AngelAdjust.MaxVelocity=8

15.4.2 Adjust Angle Continuously

URL

http://<server>/cgi-bin/LensFunc.cgi?action=adjustAngleContinuously

Method

GET

Description Adjust the angel continuously.

[ Request Params ] ( key=value format at URL )

Name

Channel

Type

uint

Direction

uint8

Velocity

uint8

R/O Param Description

R

R

R

Video channel index which starts from 1.

The moving direction, 0 : negative X axis direction, 1 : positive
X axis direction, 2 : negative Y axis direction, 3 : positive Y axis
direction

The adjust velocity, range from 1 to MaxVelocity

Other APIs 624

[ Response Params ] ( OK )

[ Example ]

Request

http://192.168.1.108/cgi-bin/LensFunc.cgi?action=adjustAngleContinuously&Channel=1
&Direction=2&Velocity=2

Response

OK

15.4.3 Stop Adjusting Angle

URL

http://<server>/cgi-bin/LensFunc.cgi?action=stopAdjustingAngle

Method

GET

Description Stop adjusting angel

[ Request Params ] ( key=value format at URL )

Name

Channel

Type

uint

[ Response Params ] ( OK )

[ Example ]

R/O Param Description

R

Video channel index which starts from 1.

Request

http://192.168.1.108/cgi-bin/LensFunc.cgi?action=stopAdjustingAngle&Channel=1

Response

OK

15.4.4 Adjust Depth Field

URL

http://<server>/cgi-bin/LensFunc.cgi?action=adjustDepthField

Method

GET

Description Adjust depth position

[ Request Params ] ( key=value format at URL )

Name

Channel

DepthField

Type

uint

float

[ Response Params ] ( OK )

R/O Param Description

R

R

Video channel index which starts from 1.

The sensor depth position, range from 0 to 1, -1 means reset.

[ Example ]

Request

http://192.168.1.108/cgi-bin/LensFunc.cgi?action=adjustDepthField&Channel=1&DepthF
ield=0.3

Response

OK

15.4.5 Adjust Depth Field Continuously

URL

http://<server>/cgi-bin/LensFunc.cgi?action=adjustDepthFieldContinuously

Method

GET

Description Adjust depth position continuously.

[ Request Params ] ( key=value format at URL )

Name

Channel

Type

uint

DepthFieldSpee

float

R/O Param Description

R

R

Video channel index which starts from 1.

The sensor depth position adjust velocity, range from -1 to 1,

Other APIs 625

d

[ Response Params ] ( OK )

positive and negative value means difference direction, 0
means stop adjust.

[ Example ]

Request

http://192.168.1.108/cgi-bin/LensFunc.cgi?action=adjustDepthFieldContinuously&Chann
el=1&DepthFieldSpeed=0.03

Response

OK

15.4.6 Get Depth Field Status

URL

http://<server>/cgi-bin/LensFunc.cgi?action=getDepthFieldStatus

Method

GET

Description Get depth position status.

[ Request Params ] ( key=value format at URL )

Name

Channel

Type

uint

R/O Param Description

R

Video channel index which starts from 1.

[ Response Params ] ( key=value format )

Name

Status

+Status

Type

object

string

+DepthField

float

+DepthFieldStep
s

uint

+ResetResult

string

[ Example ]

R/O Param Description

R

R

R

R

O

The depth position status.

The depth position status, “Normal” : normal status,
“AutoDepthField” : adjusting depth position.

The sensor board relative position, range from 0 to 1

The depth position total step.

The depth position reset result, only valid when reset.
“Success” : reset success, ”Failed” : reset failed

Request

http://192.168.1.108/cgi-bin/LensFunc.cgi?action=getDepthFieldStatus&Channel=1

Response

Status.Status=Normal
Status.DepthField=0.3
Status.DepthFieldSteps=1000
Status.ResetResult=Success

15.4.7 Auto Adjust Depth Field

URL

http://<server>/cgi-bin/LensFunc.cgi?action=autoAdjustDepthField

Method

GET

Description Automatic adjust depth position

[ Request Params ] ( key=value format at URL )

Name

Channel

Type

uint

[ Response Params ] ( OK )

[ Example ]

R/O Param Description

R

Video channel index which starts from 1.

Request

http://192.168.1.108/cgi-bin/LensFunc.cgi?action=autoAdjustDepthField&Channel=1

Response

OK

Other APIs 626

R/O Description

Example

15.4.8 Scene Correction

Request URL

http://<server>/cgi-bin/api/LensFunc/correctScene

Method

POST

Request Params (JSON format in body)

Name

Channel

Type

Type

int

enumint

R

R

Channel number, starting from 1.

Correction type.
enumint{
0: Automatic correction
1: Manual correction
}

Direction

enumint

O

Step

int

O

Mode

enumint

O

Rotation direction. This parameter is only valid
when the correction method is manual
correction.
enumint{
0: Clockwise
1: Counter clockwise
}

Speed (range: 0–8).
0 means stop rotation. When the rotation
mode is continuous rotation, it means the
rotation speed. When the rotation mode is
point-based rotation, it means the speed of
each rotation. This parameter is only valid
when the correction mode is manual
correction.
Rotation mode. This parameter is only valid
when the correction mode is manual
correction.
enumint{
0: Continuous rotation
1: Point-based rotation
}

Request Example

{

}

"Channel": 1,
"Type": 1,
"Direction": 1,
"Step": 5,
"Mode": 1

1

1

1

5

1

Response Params ( JSON format in body )

Name

Type

R/O

Description

Example

Response Example

{}

Other APIs 627

15.4.9 Reset Angle

Reset camera lens angle

URL

http://< server >/cgi-bin/LensManager.cgi?action=resetAngle

Method

GET

Description

Reset camera lens angle

[ Request Params ] ( key=value format at URL )

Name

Channel

Type

uint

R/O

R

[ Response Params ] ( OK )

[ Example ]

Param Description

Video channel index which starts from 1.

Request

http://172.27.1.153/cgi-bin/LensManager.cgi?action=resetAngle&Channel=1

Response

OK

15.5 FishEye

15.5.1 Get FishEye Capability

The method described in the Section “4.5.12 Get video input capability” should be used first.In the
response, it will contain these message "caps.FishEye=false", if the value of the FishEye is true,
Then you can use the method described below to get the detail capability.

Syntax

http://<server>/cgi-bin/devVideoInput.cgi?action=getCapsEx&channel=<ChannelNo>&
name=VideoInFishEye

Table 15-10

Method

GET

Description

Get fisheye capability.

Example

http://192.168.1.108/cgi-bin/devVideoInput.cgi?action=getCapsEx&channel=1&name=
VideoInFishEye

Success
Return

caps.Type=Chip
caps.MountMode[0]=WallMode
caps.MountMode[1]=CeilMode
……
caps.CalibrateMode[0]=Original
caps.CalibrateMode[1]=Config
caps.CalibrateMode[2]=Panorama
……
caps.EPtzCmd[0]=Up
caps.EPtzCmd[1]=Down
…….

Other APIs 628

Comment

Parameters in Response:
Type: string, it can be Chip, Plugin, and ChipAndPlugin. Chip means only support
calibrate by device.
Plugin means only support calibrate by plugin. ChipAndPlugin means support
both.
MountMode: string and array.and MountMode means the install mode, it can be
WallMode,CeilMode, FloorMode,180CeilMode.
CalibrateMode: string and array. It can be Original, Config, Panorama,
DoublePanorama, OriginalPlusThreeEPtzRegion, Single, FourEPtzRegion,
TwoEPtzRegion, and Normal.
EPtzCmd: string and array. It can be ZoomIn, ZoomOut, Up, Down, Left, Right,
RotateClock, RotateAntiClock, Stop, TapView, and ShowRegion.

15.5.2 [Config] FishEye Setting

 Get FishEye config

Table 15-11

Syntax

Method

http://<server>/cgi-bin/configManager.cgi?action=getConfig&name=FishEye

GET

Description Get FishEye config.

Example

http://192.168.1.108/cgi-bin/configManager.cgi?action=getConfig&name=FishEye

Success
Return

head.PlaceHolder=1
head.CalibrateMode=Original
……..

Comment

Parameters in Response:
head = table.FishEye[ChannelNo]
ChannelNo: integer, array index starts from 0, which means video channel (equals to
video channel index -1, and so 0 means channel 1).
PlaceHolder：integer， it can be 1(CeilMode), 2(WallMode), 3(FloorMode).
CalibrateMode: string. It can be Original, Config, Panorama, DoublePanorama,
OriginalPlusThreeEPtzRegion, Single, FourEPtzRegion, TwoEPtzRegion, and Normal.

 Set FishEye config

Syntax

http://<server>/cgi-bin/configManager.cgi?action=setConfig&<paramName>=<paramV
alue>[&<paramName>=<paramValue>…]

Table 15-12

Method

GET

Description

Set FishEye config.

Change the placeholder setting of channel 1:
http://192.168.1.108/cgi-bin/configManager.cgi?action=setConfig&FishEye[0].PlaceHol
der=1

Example

Change the calibratemode setting of channel 1:
http://192.168.1.108/cgi-bin/configManager.cgi?action=setConfig&FishEye[0].Calibrate

Other APIs 629

Mode=Panorama

Also can use
http://192.168.1.108/cgi-bin/configManager.cgi?action=setConfig&FishEye[0].Calibrate
Mode=Panorama&FishEye[0].PlaceHolder=1
calibratemode in one message.

the placeholder and

to change

Success
Return

Comment

OK

—

15.6 Radar Adaptor

15.6.1 Get Radar Capability

Note: This interface is deprecated. Please use the interface getCapsEx.

Radar equipment detection capability request

Syntax

Method

http://<server>/cgi-bin/radarAdaptor.cgi?action=getCaps&channel=< ChannelNo >

GET

Description

Request radar device detection capabilities

Example

Success
Return

Comment

http://192.168.1.108/cgi-bin/radarAdaptor.cgi?action=getCaps&channel=1

caps.DetectionRange = 5000 //Zoom in 100 times, while the true value is 50.00
caps.DetectionAngle = 8003 //Zoom in 100 times
caps.DetectionHuman = 4000 //Zoom in 100 times

Parameters in URL:
ChannelNo: integer, channel index which starts from 1.

15.6.2 Get Radar Capbility ( Enhanced )

Radar equipment caps request

Syntax

Method

http://<server>/cgi-bin/radarAdaptor.cgi?action=getCapsEx&channel=<ChannelNo>

GET

Description Request radar device detection capabilities

Example

http://192.168.1.108/cgi-bin/radarAdaptor.cgi?action=getCapsEx&channel=1

Success
Return

caps.DetectionRange = 5000 // Radar detection range
caps.DetectionAngle = 8003 // Radar detection angle
caps.DetectionHuman = 4000 // Radar human detection range
caps.Capacity.Support = true //Power setting enable
caps.Capacity.List[0] = 150 // Power allows setting list, no more than 24 choices
...
caps.Capacity.List[23] = 300
caps.RadarScene.Support = true // Scene setting enable
caps.RadarChannel.Support = true // Radar channel setting enable
caps.RadarChannel.List[0] = 1 // Channel allows setting list, no more than 24 choices
…
caps.RadarChannel.List[23] = 2

Other APIs 630

caps.MovedDetect.Support = true // Device motion detection setting enabled

Comment

Parameters in URL:
ChannelNo: integer, channel index which starts from 1.

15.6.3 Get Status

Radar Equipment Status Request

Syntax

Method

http://<server>/cgi-bin/radarAdaptor.cgi?action=getStatus&channel=<ChannelNo>

GET

Description

Request radar device status

Example

Success
Return

Comment

Appendix:

ParamName

State

http://192.168.1.108/cgi-bin/radarAdaptor.cgi?action=getCaps&channel=1

status.State = Normal

Parameters in URL:
ChannelNo: integer, channel index which starts from 1.

ParamValue type Description

string

Radar state, the range is { "Normal" , "Abnormal" }

15.6.4 Calculate Real Size

Radar real map size calculation

Syntax

http://<server>/cgi-bin/radarAdaptor.cgi?action=calculateRealSize&channel=<Channel
No>&distance=<distance>&startPoint[0]=<startX>&startPoint[1]=<startY>&endPoint[0
]=<endX>&endPoint[1]<endY>

Method

GET

Description

Calculate radar real map size

Example

Success
Return

Comment

Appendix:

ParamName

realMap

http://192.168.0.108/cgi-bin/radarAdaptor.cgi?action=calculateRealSize&channel=1&dis
tance=10.01&startPoint[0]=10&startPoint[1]=20&endPoint[0]=30&endPoint[1]=40

realSize.realMap[0]=300
realSize.realMap[1]=400

Parameters in URL:
ChannelNo: integer, channel index which starts from 1.
Distance: Segment distance, Unit: m
startPoint: Line segment start coordinates
endPoint: Line segment end coordinates

ParamValue type Description

array<integer>

Length and width of actual map, unit:meter

15.6.5 Subscribe Alarm Point Info

Radar track point request

Other APIs 631

Syntax

http://<server>/cgi-bin/radarAdaptor.cgi?action=attachAlarmPointInfo&channel=<Chan
nelNo>&[&heartbeat=<Heartbeat>]

Method

GET

Description

Request radar track points

[ Request Params ] ( key=value format in URL )

Name

Channel

Type

int

R/O Param Description

R

Video channel index which starts from 1

heartbeat

int

O

Send heartbeat interval, range is [1, 60],unit is second. If the URL
contains this parameter, and the value is 5, it means every 5
seconds the device should send the heartbeat message to the
client, the heartbeat meaage are "Heartbeat". If this parameter is
not present, its default value is 60.

Example

Success
Return

http://192.168.0.108/cgi-bin/radarAdaptor.cgi?action=attachAlarmPointInfo&channel=1
& heartbeat=5

HTTP/1.1 200 OK
Server: Device/1.0
Content-Type: multipart/x-mixed-replace; boundary=<boundary>
Connection: closed

--<boundary>
Content-Type: application/octet-stream
Content-Length: <length>

Channel=1
info[0].PointType=0x80
info[0].RegionNumber=1
info[0].ObjectType=1
info[0].TrackID=1
info[0].Distance=1001 //Zoom in 100 times, while the true value is 10.01
info[0].Angle=2010 //Zoom in 100 times
info[0].Speed=501 //Zoom in 100 times
……
info[3].PointType=0x80
……

--<boundary>
Content-Type: text/plain
Content-Length: 11

Heartbeat -<boundary>
Content-Type: application/octet-stream
Content-Length: <length>

Channel=1
info[0].PointType=0x80
……

Other APIs 632

--<boundary>
…

Comment

Parameters in URL:
ChannelNo: integer, channel index which starts from 1.

Notice:
A detach occurs when the connection is disconnected.

15.6.6 Manual Locate

Radar manual positioning request

Syntax

http://<server>/cgi-bin/radarAdaptor.cgi?action=manualLocate&channel=<ChannelNo>&
point[0]=<x>&point[1]=<y>

Method

GET

Description Request manual radar positioning

Example

Success
Return

Comment

http://192.168.1.108/cgi-bin/radarAdaptor.cgi?action=manualLocate&channel=1&point[0]
=10&point[1]=10

OK

Parameters in URL:
ChannelNo: integer, channel index which starts from 1.
point: Pixel coordinates in the code stream

15.6.7 Start Radar Calibration

Radar equipment calibration

Syntax

http://<server>/cgi-bin/radarAdaptor.cgi?action=startRadarCalibration&channel=<Chan
nelNo>&mode=<mode>&direction=<direction>&step=<step>

Method

GET

Description

Calibration of radar equipment

Example

Success
Return

Comment

http://192.168.1.108/cgi-bin/radarAdaptor.cgi?action=startRadarCalibration&channel=1
&mode=1&direction=1&step=5

OK

Parameters in URL:
ChannelNo: integer, channel index which starts from 1.
mode: Calibration mode, 0:auto, 1: manual,2:init
direction: Calibration direction, effective in manual mode , 0：invalid, 1：top, 2：bottom,
3：left, 4: right, 5: left_top, 6: right_top, 7: left_bottom, 8: right_bottom
step: step size

15.6.8 Add Radar Link SD

Radar link SD added

Request URL

http://<server>/cgi-bin/radarAdaptor.cgi?action=addRadarLinkSD

Other APIs 633

GET

Method
Request Params ( key=value format in URL )
Name
Devices

R/O Description
R

Type
array<o
bject>
char[32] R
R
char[12
8]
integer R
char[32] R
integer R

+PassWord
+UserName

+Port
+SDLinkIP
Channel

Add or update the added device login
information
password, plaintext
user name

Example

"123456"
"admin"

port
device ip adress
video channel, which starts from 1.

5000
"192.168.1.108"
1

Request Example
http://192.168.1.108/cgi-bin/radarAdaptor.cgi?action=addRadarLinkSD&Devices[0].SDLinkIP=10.11.17.
98&Devices[0].Port=5000&Devices[0].Usename=admin&Devices[0].PassWord=123456&Channel=1

Response Params ( key=value format in body )
Name
SD
+Info
++ErrorCode

R/O Description
R
R
R

Type
object
object
integer

dome camera
information
errorcode
0：normal
1：overtime
2：Wrong user name or password
3：The device does not support linkage

Response Example
SD.Info.ErrorCode=0

15.6.9 Del Radar Link SD

Remove radar link SD

GET

Request URL http://<server>/cgi-bin/radarAdaptor.cgi?action=delRadarLinkSD
Method
Request Params ( key=value format in URL )
Name
Devices

R/O Description
R

Type
array<obje
ct>

Delete the SD added in radar equipment
Empty array will delete all linkage
equipment by default
device to be deleted
video channel, which starts from 1.

+SDLinkIP
Channel

char[32]
integer

R
R

Example

0

Example

"192.168.1.108"
1

Request Example
http://192.168.1.108/cgi-bin/radarAdaptor.cgi?action=delRadarLinkSD&Devices[0].SDLinkIP=10.11.17.9
8&Channel=1

Response Params ( key=value format in body )
Name

R/O Description

Type

Example

Other APIs 634

Response Example
OK

15.6.10 Get Link SD State

Linked device status request

Syntax

http://<server>/cgi-bin/radarAdaptor.cgi?action=getLinkSDState&channel=<ChannelNo>
&ip[0]=<ip>&ip[1]=<ip>......&ip[23]=<ip>

Method

GET

Description Request linkage device status

Example

Success
Return

http://192.168.0.108/cgi-bin/radarAdaptor.cgi?action=getLinkSDState&channel=1&ip[0]=1
92.168.1.115&ip[1]=192.168.1.116

state[0].SDLinkIP=192.168.1.115
state[0].State=0
state[0].Channel=1
state[1].SDLinkIP=192.168.1.116
state[1].State=0
state[1].Channel=2

Comment

Parameters in URL:
ChannelNo: integer, channel index which starts from 1.
ip: IP address of the linkage device

Appendix:

ParamName

State

ParamValue type Description

integer

device state, 0: out of time, 1: offline, 2: disconnected

15.6.11 [Config] MapPara

map parameters:

Parameter

Type

R/O Description

Example

MapPara

object[]

+RadarCoordinate
object
++RadarDirectionAngle double
integer
++RadarPixelPoint
object
+MapSize

++PixelLine

integer[][]

++Distance

double

R

R
R
R
R
R

R

One-dimensional array, with one
configuration for each video channel
Configuration of radar position on the map
Configuration of radar direction (°)
Pixel coordinates of radar on the map
Configuration of map size
Pixel coordinates of line segment in the
image
The actual length represented by the line
segment in the image (m)

Example
http://192.168.1.108/cgi-bin/configManager.cgi?action=getConfig&name=MapPara

Appendix: configuration operation method

null
70.5
[10, 20]
null
[[10,10],
[20,20]]

10.1

configname and configobject in the following table correspond to specific configuration names
and configuration contents.

Other APIs 635

special explanation：

In the return of getConfig, there is a "table" level above the specific configuration.

In the request of setConfig, there is no "table" level above the specific configuration.



getConfig

http://<server>/cgi-bin/configManager.cgi?action=getConfig&name=configName
GET

Syntax
Method
Request Params ( key=value format in URL )
Type
Name
string
name

R/O
R

Description
config name

Example
MapPara

Request Example
http://10.0.0.8/cgi-bin/configManager.cgi?action=getConfig&name=MapPara

Response Params ( key=value format in body )
Name
table
+MapPara

Type
object
object[]

R/O
R
R

Description
table prefix
Specific configuration information

Response Example
table.MapPara[0].RadarCoordinate.RadarDirectionAngle=70.5
table.MapPara[0].RadarCoordinate.RadarPixelPoint[0]=10
table.MapPara[0].RadarCoordinate.RadarPixelPoint[1]=20
table.MapPara[0].MapSize.PixelLine[0][0]=10
table.MapPara[0].MapSize.PixelLine[0][1]=10
table.MapPara[0].MapSize.PixelLine[1][0]=20
table.MapPara[0].MapSize.PixelLine[1][1]=20
table.MapPara[0].MapSize.Distance=10.1
table.MapPara[1].RadarCoordinate.RadarDirectionAngle=70.5
…



setConfig

http://<server>/cgi-bin/configManager.cgi?action=setConfig
GET

Syntax
Method
Request Params ( key=value format in URL )
Type
Name
object[]
MapPara

R/O
R

Description
Specific configuration content

Example

Example

Request Example
http://10.0.0.8/cgi-bin/configManager.cgi?action=setConfig&MapPara[0].RadarCoordinate.RadarDirectio
nAngle=70.5&MapPara[0].RadarCoordinate.RadarPixelPoint[0]=10&MapPara[0].RadarCoordinate.Rad
arPixelPoint[1]=20&MapPara[0].MapSize.PixelLine[0][0]=10&MapPara[0].MapSize.PixelLine[0][1]=10&
MapPara[0].MapSize.Distance=10.1

Response Params ( OK in body )
Name
Response Example
OK

Type

R/O

Description

Example

Other APIs 636

15.6.12 [Config] RadarAnalyseRule

RadarAnalyseRule parameters:

Parameter

Type

R/O
R

RadarAnalys
eRule

object[][]

+EventHandl
er

object

++LogEnable bool

++TimeSectio
n

TimeSect
ion[][]

++SnapshotC
hannels

int[]

++SnapshotE
nable
++RecordLat
ch

bool

integer

++RecordCha
nnels

int[]

++RecordEna
ble

bool

R

R

R

R

R

R

R

R

Example

Description
Radar alarm linkage configuration
object[][24]
Two-dimensional array. The first dimension
indicates video channel, and the second
dimension indicates multiple linkage
configurations.

Alarm linkage configuration

null

Whether to record alarm logs. The type is
fixed to EventStart/EventStop/EventPulse
and the original event type is recorded in
the Detail.Code field in the log.

false

Alarm period.
TimeSection is used for the filtering of notify
action. No data is sent if it is not within the
period.
All fields except this one are used for
listener response.

[["1
00:00:00-23:59:59",
"0
00:00:00-23:59:59",
"0
00:00:00-23:59:59",
"0
00:00:00-23:59:59",
"0
00:00:00-23:59:59",
"0
00:00:00-23:59:59",]
]

List of snapshot channel numbers.
One-dimensional array. Each member
indicates that the corresponding channel
needs to take snapshot, and the channel
number starts from 0.

Enable snapshotg

Record delay time (second)
Range [10, 300]
List of record channel numbers.
One-dimensional array. Each member
indicates that the corresponding channel
needs to record, and the channel number
starts from 0.
Record enabling, with RecordChannels.
Record is enabled if it is true; start
recording when the event action is start and

[0]

false

10

[0]

false

Other APIs 637

bool

bool

++VoiceEnabl
e
++BeepEnabl
e
++MessageE
nable
++MailEnable bool
bool
++TipEnable

bool

++AlarmOutL
atch

integer

++AlarmOutE
nable

bool

++AlarmOutC
hannels

int[]

+Enable
+AlarmOutNu
mber

bool

integer

R

R

R

R
R
R

R

R

R
R

+SDLinkIP

char[32] O

stop recording when it is stop. Record is not
enabled if it is false.

Voice prompt

Buzzer

Upload to the alarm center server.

Send email.
Local message box prompt
Output delay time (second) after the alarm
output stops.
Range [10, 300]

Enable alarm output

List of alarm output channel numbers.
One-dimensional array. Each member
indicates that the corresponding channel
needs to output alarm, and the channel
number starts from 0.
Enable alarm enabling
Alarm configuration number, which is
unique.
Controlled device IP (which is optional and
reserved. Ignore this field due to business
adjustment).

false

false

false

false
false

10

false

[0]

false

1

"192.168.1.108"

Example
http://192.168.1.108/cgi-bin/configManager.cgi?action=getConfig&name=RadarAnalyseRule

Note: Please refer to appendix in chapter 15.6.11 for configuration operation method

15.6.13 [Config] RadarCalibration

RadarCalibration

Parameter

Type

R/O Description

Example

RadarCalibration

object[]

R

+SlopeAngle
+InstallHeight
+CalibrationParas

double
double
object[]

R
R
R
R

++TiltRecoupAngle double

Configuration of radar and PTZ cameras
calibration.
One-dimensional array, with one
configuration for each video channel.
Slope compensation angle.
Radar installation height (m).
Calibration parameter.
Vertical compensation angle of linked
PTZ camera.
The range is -90° to 90°; 0° in the
horizontal direction; 0 to 90° below the
horizontal direction; -90° to 0° above the

10.0
10.5
null

5.0

Other APIs 638

++LinkSDHeight

double

++CalibrationPos

object[]

R

R
R

+++Ptz

float[3]

horizontal direction.
Installation height of linked PTZ camera
(m).
Array of calibration points.
PTZ value (normalized value) of
calibration points.
The first element is the horizontal angle,
which is normalized to -1 to 1.
The second element is the vertical
angle, which is normalized to -1 to 1.
The third element is the zoom times,
which is normalized to 0 to 1.
Pixel coordinates of calibration points.
Controlled device IP.

10.5

null

[0.95, 0.43, 0.12]

+++AlarmPixelPoint
++SDLinkIP
Example
http://192.168.1.108/cgi-bin/configManager.cgi?action=getConfig&name=RadarCalibration

int[2]
R
char[32] R

[10, 20]
"192.168.1.108"

Note: Please refer to appendix in chapter 15.6.11 for configuration operation method

15.6.14 [Config] RadarGuardLine

RadarGuardLine

Parameter

Type

RadarGuardLine

object[][10]

+AlarmOutNumber

integer

+TargetFilter

integer

+Polygon

integer

+Type

char[32]

+Enable

bool

+RegionNumber

integer

R

R

R

R

+Name

char[128]

R

R/O Description
R

Two-dimensional array. The first
dimension indicates video channel, and
the second dimension indicates multiple
rule lines (up to 10).
Alarm output configuration. Configure the
AlarmOutNumber field according to
RadarAnalyseRule.
Target filtering
bit0: Reserved
bit1: Human.
bit2: Vehicle.
bit3: Animal
(Enable by setting it to 1)
Rule point, pixel coordinates [width,
height].
Range of number of points [3, 24]
Rule type, alarm or shield type.
High Alarm
Alarm
Shield

R Whether to enable the rules
R

Rule line number
Range [1, 10]
Rule name, which cannot be repeated.

Example

1

0x01

[[0, 0], [128,
128],…,[]]

"Alarm"

true

1

"GuardLine1"

Other APIs 639

Example
http://192.168.1.108/cgi-bin/configManager.cgi?action=getConfig&name=RadarGuardLine

Note: Please refer to appendix in chapter 15.6.11 for configuration operation method

15.6.15 [Config] RadarLink

RadarLink

Parameter Type

RadarLink

object[]

+RadarLink bool

R

R/O Description
R

One-dimensional array, with one configuration for each video
channel
Enable radar-PTZ linkage

Example

true

Example
http://192.168.1.108/cgi-bin/configManager.cgi?action=getConfig&name= RadarLink

Note: Please refer to appendix in chapter 15.6.11 for configuration operation method

15.6.16 [Config] RadarLinkDevice

RadarLinkDevice

Parameter

Type

RadarLinkDevice

object[][]

R/O Description
R

Example

Remote device linkage configuration.
object[][24]
Two-dimensional array. The first
dimension indicates video channel,
and the second dimension indicates
multiple remote linkage devices.
Device name
Device type
Device source
Controlled device IP

+DeviceName
+DeviceType
+Vendor
+SDLinkIP
Example
http://192.168.1.108/cgi-bin/configManager.cgi?action=getConfig&name=RadarLinkDevice

char[128] R
R
char[32]
R
char[32]
R
char[32]

"XXX North Gate"
"200W PTZ camera"
"VVV"
"192.168.1.108"

Note: Please refer to appendix in chapter 15.6.11 for configuration operation method

15.6.17 [Config] RadarPara

RadarPara

Parameter

Type

R/O Description

Example

RadarPara

object[] R

+Sensitivity

object O

++Level

integer O

Radar function configuration.
One-dimensional array, with one configuration for
each video channel.
Recognition sensitivity information.
Optional. Skip if this field does not exist. The range is
-5 to 5; 0 is the default value; the smaller the value,
the higher the human recognition rate; the larger the
value, the higher the vehicle recognition rate.

null

0

Other APIs 640

+TargetRatio

object R
R

++Ratio

integer

+RadarChannel

++Route

+Capacity

++Power

+Structured
++TrackDisplayTime
++TrackType
++Enable
+Scene

object R
R

integer

object R
R

integer

object R
integer O
integer O
R
bool
object R
R

++Type

integer

Tracking screen ratio for radar-PTZ linkage.
Reciprocal of screen ratio.
Required. Calculate the reciprocal. For example,
when the screen ratio is 0.5, Ratio = 2; when the
screen ratio is 0.25, Ratio = 4.
Radar channel configuration.
Channel selection.
1: Channel 1
2: Channel 2
Configuration of radar transmitting power.
Radar transmitting power is measured by detection
distance (m).
Structured information configuration
Range [1, 30] (s).
0: Disable 1: Trajectory box 2: Trajectory
Enable structured information display
Scene configuration
Scene selection.
1: Default.
2: Shrub.
3: Spacious.
4: Custom.

null

1

null

1

null

300

null
5
0
false
null

1

Example
http://192.168.1.108/cgi-bin/configManager.cgi?action=getConfig&name=RadarPara

Note: Please refer to appendix in chapter 15.6.11 for configuration operation method

15.6.18 [Config] RadarTrackGlobal

RadarTrackGlobal

Parameter

Type

R/O Description

Example

RadarTrackGlobal

object[] R

+TrackSwitchMode char[32] R

+TrackSwitchTime

integer R

+TrajectoryTime

integer R

One-dimensional array, with one
configuration for each video channel
Tracking switching mode
Tour/time priority/distance priority
Rotation/TimePriority/DistancePriority
Tracking switching time (s)
Range [1, 15]
Trajectory time (s)
Range [3, 30]
Enable protection area hiding

"Rotation"

5

5

+SectorDisable
Example
http://192.168.1.108/cgi-bin/configManager.cgi?action=getConfig&name=RadarTrackGlobal

false

bool

R

Note: Please refer to appendix in chapter 15.6.11 for configuration operation method

Other APIs 641

15.6.19 [Config] RemoteSDLink

RemoteSDLink

Parameter

Type

R/O Description

Example

RemoteSDLink object[][24] R

Remote device linkage enabling configuration.
Two-dimensional array. The first dimension
indicates video channel, and the second
dimension indicates multiple remote linkage
devices.
Enable linkage.
Controlled device IP.

bool
char[32]

+RadarLink
+SDLinkIP
Example
http://192.168.1.108/cgi-bin/configManager.cgi?action=getConfig&name=RemoteSDLink

R
R

true
"192.168.1.108"

Note: Please refer to appendix in chapter 15.6.11 for configuration operation method

15.7 Water Radar

15.7.1 Acquire Radar Capability

Request URL http://<server>/cgi-bin/api/WaterRadar/getCaps
Method

POST

Request Params ( JSON format in body )

Type

Name
Request Example
{}

R/O Description

Example

Response Params ( JSON format in body )

R/O Description
R

Whether the water conservancy
radar function is supported.
false: Not Supported
true: Supported

Example
true

Name
Support

Type
bool

Response Example
{

"Support": true

}

15.7.2 Get Radar Detection Target Data

Request URL http://<server>/cgi-bin/api/WaterRadar/getObjectInfo

Method

POST

Request Params ( JSON format in body )

Name

Type

R/O Description

Example

Request Example

{}

Other APIs 642

Response Params ( JSON format in body )

R/O Description

R

Water level, CM

Example

1000.0

Name

WaterLevel

Type

float

Response Example

{
"WaterLevel": 1000.0
}

15.8 Water Quality Detection

15.8.1 Get Capability

Acquiring the interface for water quality detection.

POST

Request URL http://<server>/cgi-bin/api/WaterDataStatServer/getCaps
Method
Request Params ( JSON format in body )
Name
Request Example
{}

R/O Description

Type

Response Params ( JSON format in body )
Name
Support

R/O Description
O

Type
enumint

Supports water quality detection
currently. enumint{
0: No
1: Yes
}
Supports local storage.
enumint{
0: No
1: Yes
}

SupportLocal
DataStore

enumint

O

Response Example
{
"Support": 0,
"SupportLocalDataStore": 0
}

Example

Example
0

0

15.8.2 Get Real-time Detection Data

The water quality detection data is refreshed every minute, and you can acquire the data in real
time.

Request URL http://<server>/cgi-bin/api/WaterDataStatServer/getWaterData

Other APIs 643

POST

Method
Request Params ( JSON format in body )
Name
Type

R/O Description
O

Type
enumchar[
32][32]

enumchar[32][32]{
"Quality": Water quality category
"PH": pH value
“NTU": Turbidity value
"NH3-N": Ammonia nitrogen value
}

Request Example
{
"Type": ["PH"," NTU ", …]
}

Example
["PH"," NTU ", …]

Response Params ( JSON format in body )
Name
Quality

R/O Description
O

Type
enumint

Example
1

The smaller the category value, the
better the water quality.
enumint {
1: I Category
2: II Category
3: III Category
4: IV Category
5: V Category
}
Reported data of water quality detection.
Reports all water quality detection data
when an alarm is triggered.
5.2
pH (1–14)
200.0
Turbidity (0–500 NTU)
20.0
Ammonia nitrogen (0–50 mg/L)
25.0
Ammonia nitrogen (0–50 mg/L)
Transparency (0–30 m)
20.0
Chemical oxygen demand (0–100 mg/ L) 50.0
20.0
Nitrite-nitrogen (0-500 mg/ L)
5.0
Dissolved oxygen (0–10 mg/L)
200.0
Chlorophyll A (0–300 ug/ L)
2.5
Total phosphorus (0–5 mg/L)
20.0
Permanganate index (0–100 mg/L)
20.0
Floating objects (0–1000 mg/ L)
25.0
Biochemical oxygen demand for 5 days
(0–50 mg/L)
Nitrate (0–500 mg/ L)
Eutrophic index (no range)
Black and odorous level
enumchar[32]{

20.0
20.0
"Light"

UploadInfo

object

O

+PH
+NTU
+NH3-N
+TN
+SD
+COD
+NN
+DO
+Chl-a
+TP
+CODMn
+SS
+BOD5

float
float
float
float
float
float
float
float
float
float
float
float
float

+NO3-N
+TSI
+BlackSmellyL
evel

float
float
enumchar[
32]

O
O
O
O
O
O
O
O
O
O
O
O
O

O
O
O

Other APIs 644

"Normal”
"Light”
"Heavy”
}
Parameter value exceeds its threshold
enumchar[32][32]{
"PH": pH value
“NTU": Turbidity value
"NH3-N": Ammonia nitrogen value
}

["PH"," NTU ", …]

FlunkType

enumchar[
32][32]

O

Response Example
{
"Quality": 1,
"UploadInfo": {
"PH": 5.2,
"NTU": 200.0,
"NH3-N": 20.0,
"TN": 25.0,
"SD": 20.0,
"COD": 50.0,
"NN": 20.0,
"DO": 5.0,
"Chl-a": 200.0,
"TP": 2.5,
"CODMn": 20.0,
"SS": 20.0,
"BOD5": 25.0,
"NO3-N": 20.0,
"TSI": 20.0,
"BlackSmellyLevel": "Light"
},
"FlunkType": ["PH"," NTU ", …]
}

15.8.3 Start Find Water Quality Report

Searching for water quality report.

POST

Request URL http://<server>/cgi-bin/api/WaterDataStatServer/startFind
Method
Request Params ( JSON format in body )
Name
condition

R/O Description
O

Type
Object

+StartTime

char[20]

+Type

enumchar[
32][32]

O

O

Search conditions of water quality
detection
Start time (temporarily accurate to the
hour)
enumchar[32][32]{
"Quality": Water quality category

Example

"5/25/2010 00:00:00"

["PH"," NTU"]

Other APIs 645

+PresetID
+EndTime

int[]
char[20]

O
O

"PH": pH value
“NTU": Turbidity value
"NH3-N": Ammonia nitrogen value
}
Preset ((one-dimensional array)
End time (temporarily accurate to the
hour)

[1]
"2010-05-25 00:00:00"

Request Example
{
"condition": {
"StartTime": "2010-05-25 00:00:00",
"Type": ["PH"," NTU"],
"PresetID": [1],
"EndTime": "2010-05-25 00:00:00"
}
}

Response Params ( JSON format in body )
Name
token
totalCount

R/O Description
O
O

Type
uint32
uint32

Obtained search token
Total number of qualified results

Example
2342343
233

Response Example
{
"token": 2342343,
"totalCount": 233
}

15.8.4 Get Find Water QUality Report Search Results

Searching for water quality report.

POST

Request URL http://<server>/cgi-bin/api/WaterDataStatServer/doFind
Method
Request Params ( JSON format in body )
Name
token
beginNumber

Type
uint32
uint32

R/O Description
Search token
O
Starting sequence number of the search. It
O
means that the search starts from the
beginNumber records, and returns count
records. 0 ≤ beginNumber ≤ totalCount-1.
Number of traffic statistics for each search

O

count

int32

Request Example
{
"token": 46878,
"beginNumber": 0,
"count": 24
}

Example
46878
0

24

Other APIs 646

Response Params ( JSON format in body )
Name
found
info

R/O Description
O
O

Type
uint32
object[]

Number of searched entries
Traffic statistics. It is an array and each
element represents a traffic record that
satisfies the condition.
Start time

enumint {
1: I Category
2: II Category
3: III Category
4: IV Category
5: V Category
}
pH (1–14)
Turbidity (0–500 NTU)
Ammonia nitrogen (0–50 mg/L)
Total nitrogen (0–50 mg/L)
Transparency (0–30 m)
Chemical oxygen demand (0–100 mg/ L)
Nitrite-nitrogen (0–500 mg/ L)
Chlorophyll A (0–300 ug/ L)
Total phosphorus (0–5 mg/L)
Permanganate index (0–100 mg/L)
Floating objects (0–1000 mg/ L)
Biochemical oxygen demand for 5 days (0–50
mg/L)
Nitrate (0–500 mg/ L)
Eutrophic index (no range)
Black and odorous level
enumchar[32]{
"Normal”
"Light”
"Heavy”
}
Dissolved oxygen (0–10 mg/L)

+StartTime

char[20]

+Quality

enumint

+PH
+NTU
+NH3-N
+TN
+SD
+COD
+NN
+Chl-a
+TP
+CODMn
+SS
+BOD5

float
float
float
float
float
float
float
float
float
float
float
float

+NO3-N
+TSI
+BlackSmellyL
evel

float
float
enumchar[
32]

O

O

O
O
O
O
O
O
O
O
O
O
O
O

O
O
O

+DO

float

O

Response Example
{
"found": 12,
"info": [{
"StartTime": "2012-03-14 00:00:00",
"Quality": 1,
"PH": 5.5,
"NTU": 250.0,
"NH3-N": 25.0,
"TN": 25.0,

Example
12

2018-03-03
00:00:00",
1

5.5
250.0
25.0
25.0
20.0
20.0
250.0
20.0
2.5
20.0
500.0
25.0

250.0
25.0
"Light"

20.0

Other APIs 647

"SD": 20.0,
"COD": 20.0,
"NN": 250.0,
"Chl-a": 20.0,
"TP": 2.5,
"CODMn": 20.0,
"SS": 500.0,
"BOD5": 25.0,
"NO3-N": 250.0,
"TSI": 25.0,
"BlackSmellyLevel": "Light",
"DO": 20.0
},…{}]
}

15.8.5 Stop Find Water Quality Report

Stopping the search of water quality detection database.

POST

Request URL http://<server>/cgi-bin/api/WaterDataStatServer/stopFind
Method
Request Params ( JSON format in body )
Name
token
Request Example
{
"token": 46284
}

R/O Description
Search token
O

Type
uint32

Example
46284

Response Params ( JSON format in body )
Name
Response Example
{}

Type

R/O Description

Example

15.9 Advertisement

15.9.1 Changing Stay Time of Advertisement Image

Change the stay time of advertisement image.

Syntax

Method

http://<server>/cgi-bin/VideoOutput.cgi?action=changeSustain&Sustain=5

GET

Parameter Format

key=value format at URL

Parameter

Sustain

Complete Example

Type

R/O

int

R

Description

Example

Stay time of each Image. 5

http://<server>/cgi-bin/VideoOutput.cgi?action=changeSustain&Sustain=5

Other APIs 648

15.9.2 Acquiring Video and Image Files Played by the Device

Acquire video and image files played by the device.

Syntax

Method

Parameter
Format

Parameter

Request Example

http://<server>/cgi-bin/VideoOutput.cgi?action=queryDeliveredFile

GET

key=value format at URL

Type R/O

Description

Example

http://<server>/cgi-bin/VideoOutput.cgi?action=queryDeliveredFile

Parameter
Format

key=value format at URL

Parameter

Type

R/O Description

Example

params

+Enable

+Number

object[]

bool

int

R

O

R

+TimeSecti
on

TimeSched
ule

R

+Name

char[128]

+StartTime:

char[20]

+EndTime:

char[20]

+Mode

char[16]

O

O

O

O

All play information

Enable play function.

The current advertisement plan
number. The caller can use this
number to set up different
advertisement plans.

Advertisement playing period. It is a
two-dimensional array in which the first
seven elements correspond to seven
days of a week, and the eighth
element corresponds to holidays, with
a maximum of six periods per day. The
eighth element can be left blank or
entered as null, indicating that the
holiday period is not supported.

Advertisement name

Start time

End time

Video play mode.
Once: Each file in the list is played
once.
Repeat: Files in the list are played
repeatedly until end time.
Alone: Cut-in play (playing alone).

true

0

[ ["1 00:00:00-07:00:00",
"2 09:00:00-17:30:00", "3
17:30:00-23:59:59" ], …,
[ ], ]

“Happly holliday”

"2016-08-10 10:00:00"

"2016-08-10 12:00:00"

"Once"

+FileList

object[]

O

Video file list.

++Downloa
ded

++FileType

bool

enumchar[1
6]

O

O

Check whether the file has been
downloaded to the device.

File type.
enumchar[16]{
"Video": Video file

Up to 20 file lists are
supported.

true

"Video"

Other APIs 649

"Image": Image file
"Audio": Audio file
}

++LocalPat
h

char[128]

O

The path where the file is downloaded
to the device.

"/mnt/appdata/Publish/1.
dav"

++Sustain

int

O

++URL

char[512]

O

++TimeSect
ion

TimeSched
ule

O

Stay time of each Image, which is valid
only when FileType is Image. Unit:
Second.

5

"ftp://192.168.1.108/1.da
v"

[ ["1 00:00:00-07:00:00",
"1 09:00:00-17:30:00", "1
17:30:00-23:59:59" ], …,
[ ], ]

The resource address of the file, and
the maximum length is 512 bytes. It
has the same length as the
VideoOutput.deliveryFile interface
(used by video intercom and delivered
at the same time).

Advertisement playing period. It is a
two-dimensional array in which the first
seven elements correspond to seven
days of a week, and the eighth
element corresponds to holidays, with
a maximum of six periods per day. The
eighth element can be left blank or
entered as null, indicating that the
holiday period is not supported.

++Size

++ID

int

int

Reponse Example

O

O

Files size. Unit: Byte.

File number.

102400

3

params[0].Enable=true
params[0].Number=0
params[0].TimeSection[0][0]=6 00:00:00-23:59:59
params[0].TimeSection[0][1]=0 00:00:00-23:59:59
params[0].TimeSection[0][2]=0 00:00:00-23:59:59
params[0].TimeSection[0][3]=0 00:00:00-23:59:59
params[0].TimeSection[0][4]=0 00:00:00-23:59:59
params[0].TimeSection[0][5]=0 00:00:00-23:59:59
params[0].TimeSection[1][0]=6 00:00:00-23:59:59
params[0].TimeSection[1][1]=0 00:00:00-23:59:59
params[0].TimeSection[1][2]=0 00:00:00-23:59:59
params[0].TimeSection[1][3]=0 00:00:00-23:59:59
params[0].TimeSection[1][4]=0 00:00:00-23:59:59
params[0].TimeSection[1][5]=0 00:00:00-23:59:59
…
params[0].Name="Happy"
params[0].StartTime="2016-08-10 10:00:00"
params[0].EndTime="2016-08-10 12:00:00"
params[0].Mode="Once"
params[0].FileList.Downloaded=true
params[0].FileList.FileType="Video"

Other APIs 650

params[0].FileList.LocalPath="/mnt/appdata/Publish/1.dav"
params[0].FileList.Sustain=5
params[0].FileList.URL="ftp://192.168.1.108/1.dav"
params[0].FileList.Size=102400
params[0].FileList.ID=3
...

Other APIs 651
